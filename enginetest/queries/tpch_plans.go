// Code generated by plangen.

// Copyright 2023 Dolthub, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package queries

var TpchPlanTests = []QueryPlanTest{
	{
		Query: `
--(Q1)
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= '1998-12-01' - interval '90' day
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_returnflag:8!null, lineitem.l_linestatus:9!null, sum(lineitem.l_quantity):7!null as sum_qty, sum(lineitem.l_extendedprice):6!null as sum_base_price, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):5!null as sum_disc_price, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))):4!null as sum_charge, avg(lineitem.l_quantity):2 as avg_qty, avg(lineitem.l_extendedprice):1 as avg_price, avg(lineitem.l_discount):0 as avg_disc, count(1):3!null as count_order]\n" +
			" └─ Sort(lineitem.l_returnflag:8!null ASC nullsFirst, lineitem.l_linestatus:9!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [avg(lineitem.l_discount):0, avg(lineitem.l_extendedprice):1, avg(lineitem.l_quantity):2, count(1):3!null, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))):4!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):5!null, sum(lineitem.l_extendedprice):6!null, sum(lineitem.l_quantity):7!null, lineitem.l_returnflag:8!null, lineitem.l_linestatus:9!null, sum(lineitem.l_quantity):7!null as sum_qty, sum(lineitem.l_extendedprice):6!null as sum_base_price, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):5!null as sum_disc_price, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))):4!null as sum_charge, avg(lineitem.l_quantity):2 as avg_qty, avg(lineitem.l_extendedprice):1 as avg_price, avg(lineitem.l_discount):0 as avg_disc, count(1):3!null as count_order]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: AVG(lineitem.l_discount:2!null), AVG(lineitem.l_extendedprice:1!null), AVG(lineitem.l_quantity:0!null), COUNT(1 (bigint)), SUM(((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null)) * (1 (tinyint) + lineitem.l_tax:3!null))), SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), SUM(lineitem.l_extendedprice:1!null), SUM(lineitem.l_quantity:0!null), lineitem.l_returnflag:4!null, lineitem.l_linestatus:5!null\n" +
			"             ├─ group: lineitem.l_returnflag:4!null, lineitem.l_linestatus:5!null\n" +
			"             └─ Filter\n" +
			"                 ├─ LessThanOrEqual\n" +
			"                 │   ├─ lineitem.l_shipdate:6!null\n" +
			"                 │   └─ 1998-09-02 00:00:00 +0000 UTC (datetime(6))\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: lineitem\n" +
			"                         └─ columns: [l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate]\n" +
			"",
	},
	{
		Query: `
--(Q2)
select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 15
	and p_type like '%BRASS'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_acctbal:14!null, supplier.s_name:10!null, nation.n_name:22!null, part.p_partkey:0!null, part.p_mfgr:2!null, supplier.s_address:11!null, supplier.s_phone:13!null, supplier.s_comment:15!null]\n" +
			" └─ Sort(supplier.s_acctbal:14!null DESC nullsFirst, nation.n_name:22!null ASC nullsFirst, supplier.s_name:10!null ASC nullsFirst, part.p_partkey:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [part.P_PARTKEY:12!null, part.P_NAME:13!null, part.P_MFGR:14!null, part.P_BRAND:15!null, part.P_TYPE:16!null, part.P_SIZE:17!null, part.P_CONTAINER:18!null, part.P_RETAILPRICE:19!null, part.P_COMMENT:20!null, supplier.S_SUPPKEY:5!null, supplier.S_NAME:6!null, supplier.S_ADDRESS:7!null, supplier.S_NATIONKEY:8!null, supplier.S_PHONE:9!null, supplier.S_ACCTBAL:10!null, supplier.S_COMMENT:11!null, partsupp.PS_PARTKEY:0!null, partsupp.PS_SUPPKEY:1!null, partsupp.PS_AVAILQTY:2!null, partsupp.PS_SUPPLYCOST:3!null, partsupp.PS_COMMENT:4!null, nation.N_NATIONKEY:21!null, nation.N_NAME:22!null, nation.N_REGIONKEY:23!null, nation.N_COMMENT:24, region.R_REGIONKEY:25!null, region.R_NAME:26!null, region.R_COMMENT:27]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ partsupp.ps_supplycost:3!null\n" +
			"             │   └─ Subquery\n" +
			"             │       ├─ cacheable: false\n" +
			"             │       ├─ alias-string: select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE'\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [min(partsupp.ps_supplycost):28!null as min(ps_supplycost)]\n" +
			"             │           └─ GroupBy\n" +
			"             │               ├─ select: MIN(partsupp.ps_supplycost:30!null)\n" +
			"             │               ├─ group: \n" +
			"             │               └─ Filter\n" +
			"             │                   ├─ Eq\n" +
			"             │                   │   ├─ part.p_partkey:12!null\n" +
			"             │                   │   └─ partsupp.ps_partkey:28!null\n" +
			"             │                   └─ LookupJoin\n" +
			"             │                       ├─ Eq\n" +
			"             │                       │   ├─ nation.n_regionkey:34!null\n" +
			"             │                       │   └─ region.r_regionkey:35!null\n" +
			"             │                       ├─ LookupJoin\n" +
			"             │                       │   ├─ Eq\n" +
			"             │                       │   │   ├─ supplier.s_nationkey:32!null\n" +
			"             │                       │   │   └─ nation.n_nationkey:33!null\n" +
			"             │                       │   ├─ LookupJoin\n" +
			"             │                       │   │   ├─ Eq\n" +
			"             │                       │   │   │   ├─ supplier.s_suppkey:31!null\n" +
			"             │                       │   │   │   └─ partsupp.ps_suppkey:29!null\n" +
			"             │                       │   │   ├─ Table\n" +
			"             │                       │   │   │   ├─ name: partsupp\n" +
			"             │                       │   │   │   └─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"             │                       │   │   └─ IndexedTableAccess(supplier)\n" +
			"             │                       │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"             │                       │   │       └─ Table\n" +
			"             │                       │   │           ├─ name: supplier\n" +
			"             │                       │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"             │                       │   └─ IndexedTableAccess(nation)\n" +
			"             │                       │       ├─ index: [nation.N_NATIONKEY]\n" +
			"             │                       │       └─ Table\n" +
			"             │                       │           ├─ name: nation\n" +
			"             │                       │           └─ columns: [n_nationkey n_regionkey]\n" +
			"             │                       └─ Filter\n" +
			"             │                           ├─ Eq\n" +
			"             │                           │   ├─ region.r_name:29!null\n" +
			"             │                           │   └─ EUROPE (longtext)\n" +
			"             │                           └─ IndexedTableAccess(region)\n" +
			"             │                               ├─ index: [region.R_REGIONKEY]\n" +
			"             │                               └─ Table\n" +
			"             │                                   ├─ name: region\n" +
			"             │                                   └─ columns: [r_regionkey r_name]\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ nation.n_regionkey:23!null\n" +
			"                 │   └─ region.r_regionkey:25!null\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ supplier.s_nationkey:8!null\n" +
			"                 │   │   └─ nation.n_nationkey:21!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ part.p_partkey:12!null\n" +
			"                 │   │   │   └─ partsupp.ps_partkey:0!null\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   ├─ supplier.s_suppkey:5!null\n" +
			"                 │   │   │   │   └─ partsupp.ps_suppkey:1!null\n" +
			"                 │   │   │   ├─ ProcessTable\n" +
			"                 │   │   │   │   └─ Table\n" +
			"                 │   │   │   │       ├─ name: partsupp\n" +
			"                 │   │   │   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                 │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                 │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: supplier\n" +
			"                 │   │   │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ AND\n" +
			"                 │   │       │   ├─ Eq\n" +
			"                 │   │       │   │   ├─ part.p_size:5!null\n" +
			"                 │   │       │   │   └─ 15 (tinyint)\n" +
			"                 │   │       │   └─ part.p_type LIKE '%BRASS'\n" +
			"                 │   │       └─ IndexedTableAccess(part)\n" +
			"                 │   │           ├─ index: [part.P_PARTKEY]\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: part\n" +
			"                 │   │               └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"                 │   └─ IndexedTableAccess(nation)\n" +
			"                 │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: nation\n" +
			"                 │           └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ region.r_name:1!null\n" +
			"                     │   └─ EUROPE (longtext)\n" +
			"                     └─ IndexedTableAccess(region)\n" +
			"                         ├─ index: [region.R_REGIONKEY]\n" +
			"                         └─ Table\n" +
			"                             ├─ name: region\n" +
			"                             └─ columns: [r_regionkey r_name r_comment]\n" +
			"",
	},
	{
		Query: `
--Q3
select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'BUILDING'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-15'
	and l_shipdate > '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_orderkey:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue, orders.o_orderdate:2!null, orders.o_shippriority:3!null]\n" +
			" └─ Sort(sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue DESC nullsFirst, orders.o_orderdate:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, lineitem.l_orderkey:1!null, orders.o_orderdate:2!null, orders.o_shippriority:3!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), lineitem.l_orderkey:0!null, orders.o_orderdate:6!null, orders.o_shippriority:7!null\n" +
			"             ├─ group: lineitem.l_orderkey:0!null, orders.o_orderdate:6!null, orders.o_shippriority:7!null\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ customer.c_custkey:8!null\n" +
			"                 │   └─ orders.o_custkey:5!null\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ lineitem.l_orderkey:0!null\n" +
			"                 │   │   └─ orders.o_orderkey:4!null\n" +
			"                 │   ├─ Filter\n" +
			"                 │   │   ├─ GreaterThan\n" +
			"                 │   │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"                 │   │   │   └─ 1995-03-15 (longtext)\n" +
			"                 │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: lineitem\n" +
			"                 │   │           └─ columns: [l_orderkey l_extendedprice l_discount l_shipdate]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ LessThan\n" +
			"                 │       │   ├─ orders.o_orderdate:2!null\n" +
			"                 │       │   └─ 1995-03-15 (longtext)\n" +
			"                 │       └─ IndexedTableAccess(orders)\n" +
			"                 │           ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: orders\n" +
			"                 │               └─ columns: [o_orderkey o_custkey o_orderdate o_shippriority]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(orders.o_custkey:5!null)\n" +
			"                     ├─ right-key: TUPLE(customer.c_custkey:0!null)\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ customer.c_mktsegment:1!null\n" +
			"                         │   └─ BUILDING (longtext)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: customer\n" +
			"                                 └─ columns: [c_custkey c_mktsegment]\n" +
			"",
	},
	{
		Query: `
--Q4
select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= '1993-07-01'
	and o_orderdate < '1993-07-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [orders.o_orderpriority:1!null, count(1):0!null as order_count]\n" +
			" └─ Sort(orders.o_orderpriority:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, orders.o_orderpriority:1!null, count(1):0!null as order_count]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), orders.o_orderpriority:5!null\n" +
			"             ├─ group: orders.o_orderpriority:5!null\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [orders.o_orderkey:1!null, orders.O_CUSTKEY:2!null, orders.O_ORDERSTATUS:3!null, orders.O_TOTALPRICE:4!null, orders.o_orderdate:5!null, orders.O_ORDERPRIORITY:6!null, orders.O_CLERK:7!null, orders.O_SHIPPRIORITY:8!null, orders.O_COMMENT:9!null]\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ lineitem.l_orderkey:0!null\n" +
			"                     │   └─ orders.o_orderkey:1!null\n" +
			"                     ├─ Distinct\n" +
			"                     │   └─ Project\n" +
			"                     │       ├─ columns: [lineitem.l_orderkey:0!null]\n" +
			"                     │       └─ Filter\n" +
			"                     │           ├─ LessThan\n" +
			"                     │           │   ├─ lineitem.l_commitdate:11!null\n" +
			"                     │           │   └─ lineitem.l_receiptdate:12!null\n" +
			"                     │           └─ IndexedTableAccess(lineitem)\n" +
			"                     │               ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │               ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: lineitem\n" +
			"                     │                   └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                     └─ Filter\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ GreaterThanOrEqual\n" +
			"                         │   │   ├─ orders.o_orderdate:4!null\n" +
			"                         │   │   └─ 1993-07-01 (longtext)\n" +
			"                         │   └─ LessThan\n" +
			"                         │       ├─ orders.o_orderdate:4!null\n" +
			"                         │       └─ 1993-10-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"                         └─ IndexedTableAccess(orders)\n" +
			"                             ├─ index: [orders.O_ORDERKEY]\n" +
			"                             ├─ static: [{[NULL, ∞)}]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"",
	},
	{
		Query: `
--Q5
select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'ASIA'
	and o_orderdate >= '1994-01-01'
	and o_orderdate < '1994-01-01' + interval '1' year
group by
	n_name
order by
	revenue desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [nation.n_name:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue]\n" +
			" └─ Sort(sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, nation.n_name:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:2!null * (1 (tinyint) - lineitem.l_discount:3!null))), nation.n_name:12!null\n" +
			"             ├─ group: nation.n_name:12!null\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ lineitem.l_orderkey:0!null\n" +
			"                 │   │   │   └─ orders.o_orderkey:6!null\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ customer.c_nationkey:10!null\n" +
			"                 │   │       └─ supplier.s_nationkey:5!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ supplier.s_nationkey:5!null\n" +
			"                 │       └─ nation.n_nationkey:11!null\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ lineitem.l_suppkey:1!null\n" +
			"                 │   │   └─ supplier.s_suppkey:4!null\n" +
			"                 │   ├─ ProcessTable\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: lineitem\n" +
			"                 │   │       └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount]\n" +
			"                 │   └─ IndexedTableAccess(supplier)\n" +
			"                 │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: supplier\n" +
			"                 │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(lineitem.l_orderkey:0!null, supplier.s_nationkey:5!null, supplier.s_nationkey:5!null)\n" +
			"                     ├─ right-key: TUPLE(orders.o_orderkey:0!null, customer.c_nationkey:4!null, nation.n_nationkey:5!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ nation.n_regionkey:13!null\n" +
			"                         │   └─ region.r_regionkey:14!null\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ customer.c_nationkey:10!null\n" +
			"                         │   │   └─ nation.n_nationkey:11!null\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ customer.c_custkey:9!null\n" +
			"                         │   │   │   └─ orders.o_custkey:7!null\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ AND\n" +
			"                         │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                         │   │   │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                         │   │   │   │   │   └─ 1994-01-01 (longtext)\n" +
			"                         │   │   │   │   └─ LessThan\n" +
			"                         │   │   │   │       ├─ orders.o_orderdate:2!null\n" +
			"                         │   │   │   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"                         │   │   │   └─ ProcessTable\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: orders\n" +
			"                         │   │   │           └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                         │   │   └─ IndexedTableAccess(customer)\n" +
			"                         │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: customer\n" +
			"                         │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                         │   └─ IndexedTableAccess(nation)\n" +
			"                         │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │       └─ Table\n" +
			"                         │           ├─ name: nation\n" +
			"                         │           └─ columns: [n_nationkey n_name n_regionkey]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ region.r_name:1!null\n" +
			"                             │   └─ ASIA (longtext)\n" +
			"                             └─ IndexedTableAccess(region)\n" +
			"                                 ├─ index: [region.R_REGIONKEY]\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: region\n" +
			"                                     └─ columns: [r_regionkey r_name]\n" +
			"",
	},
	{
		Query: `
--Q6
select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= '1994-01-01'
	and l_shipdate < '1994-01-01' + interval '1' year
	and l_discount between .06 - 0.01 and .06 + 0.01
	and l_quantity < 24;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * lineitem.l_discount)):0!null as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:1!null * lineitem.l_discount:2!null))\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │   │   └─ 1994-01-01 (longtext)\n" +
			"         │   │   │   └─ LessThan\n" +
			"         │   │   │       ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"         │   │   └─ (lineitem.l_discount:2!null BETWEEN 0.05 (decimal(3,2)) AND 0.07 (decimal(3,2)))\n" +
			"         │   └─ LessThan\n" +
			"         │       ├─ lineitem.l_quantity:0!null\n" +
			"         │       └─ 24 (tinyint)\n" +
			"         └─ ProcessTable\n" +
			"             └─ Table\n" +
			"                 ├─ name: lineitem\n" +
			"                 └─ columns: [l_quantity l_extendedprice l_discount l_shipdate]\n" +
			"",
	},
	{
		Query: `
--Q7
select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')
			)
			and l_shipdate between '1995-01-01' and '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [shipping.supp_nation:1!null, shipping.cust_nation:2!null, shipping.l_year:3!null, sum(shipping.volume):0!null as revenue]\n" +
			" └─ Sort(shipping.supp_nation:1!null ASC nullsFirst, shipping.cust_nation:2!null ASC nullsFirst, shipping.l_year:3!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum(shipping.volume):0!null, shipping.supp_nation:1!null, shipping.cust_nation:2!null, shipping.l_year:3!null, sum(shipping.volume):0!null as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM(shipping.volume:3!null), shipping.supp_nation:0!null, shipping.cust_nation:1!null, shipping.l_year:2!null\n" +
			"             ├─ group: shipping.supp_nation:0!null, shipping.cust_nation:1!null, shipping.l_year:2!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: shipping\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [n1.n_name:14!null as supp_nation, n2.n_name:12!null as cust_nation, extract('YEAR' from lineitem.l_shipdate) as l_year, (lineitem.l_extendedprice:2!null * (1 (tinyint) - lineitem.l_discount:3!null)) as volume]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Or\n" +
			"                         │   ├─ AND\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ n1.n_name:14!null\n" +
			"                         │   │   │   └─ FRANCE (longtext)\n" +
			"                         │   │   └─ Eq\n" +
			"                         │   │       ├─ n2.n_name:12!null\n" +
			"                         │   │       └─ GERMANY (longtext)\n" +
			"                         │   └─ AND\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ n1.n_name:14!null\n" +
			"                         │       │   └─ GERMANY (longtext)\n" +
			"                         │       └─ Eq\n" +
			"                         │           ├─ n2.n_name:12!null\n" +
			"                         │           └─ FRANCE (longtext)\n" +
			"                         └─ LookupJoin\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ supplier.s_nationkey:6!null\n" +
			"                             │   └─ n1.n_nationkey:13!null\n" +
			"                             ├─ LookupJoin\n" +
			"                             │   ├─ Eq\n" +
			"                             │   │   ├─ customer.c_nationkey:10!null\n" +
			"                             │   │   └─ n2.n_nationkey:11!null\n" +
			"                             │   ├─ LookupJoin\n" +
			"                             │   │   ├─ Eq\n" +
			"                             │   │   │   ├─ customer.c_custkey:9!null\n" +
			"                             │   │   │   └─ orders.o_custkey:8!null\n" +
			"                             │   │   ├─ LookupJoin\n" +
			"                             │   │   │   ├─ Eq\n" +
			"                             │   │   │   │   ├─ orders.o_orderkey:7!null\n" +
			"                             │   │   │   │   └─ lineitem.l_orderkey:0!null\n" +
			"                             │   │   │   ├─ LookupJoin\n" +
			"                             │   │   │   │   ├─ Eq\n" +
			"                             │   │   │   │   │   ├─ supplier.s_suppkey:5!null\n" +
			"                             │   │   │   │   │   └─ lineitem.l_suppkey:1!null\n" +
			"                             │   │   │   │   ├─ Filter\n" +
			"                             │   │   │   │   │   ├─ (lineitem.l_shipdate:4!null BETWEEN 1995-01-01 (longtext) AND 1996-12-31 (longtext))\n" +
			"                             │   │   │   │   │   └─ Table\n" +
			"                             │   │   │   │   │       ├─ name: lineitem\n" +
			"                             │   │   │   │   │       └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"                             │   │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                             │   │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                             │   │   │   │       └─ Table\n" +
			"                             │   │   │   │           ├─ name: supplier\n" +
			"                             │   │   │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                             │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                             │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                             │   │   │       └─ Table\n" +
			"                             │   │   │           ├─ name: orders\n" +
			"                             │   │   │           └─ columns: [o_orderkey o_custkey]\n" +
			"                             │   │   └─ IndexedTableAccess(customer)\n" +
			"                             │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                             │   │       └─ Table\n" +
			"                             │   │           ├─ name: customer\n" +
			"                             │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                             │   └─ TableAlias(n2)\n" +
			"                             │       └─ IndexedTableAccess(nation)\n" +
			"                             │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                             │           └─ Table\n" +
			"                             │               ├─ name: nation\n" +
			"                             │               └─ columns: [n_nationkey n_name]\n" +
			"                             └─ TableAlias(n1)\n" +
			"                                 └─ IndexedTableAccess(nation)\n" +
			"                                     ├─ index: [nation.N_NATIONKEY]\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: nation\n" +
			"                                         └─ columns: [n_nationkey n_name]\n" +
			"",
	},
	{
		Query: `
--Q8
select
	o_year,
	sum(case
		when nation = 'BRAZIL' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between '1995-01-01' and '1996-12-31'
			and p_type = 'ECONOMY ANODIZED STEEL'
	) as all_nations
group by
	o_year
order by
	o_year;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [all_nations.o_year:2!null, (sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end):0!null / sum(all_nations.volume):1!null) as mkt_share]\n" +
			" └─ Sort(all_nations.o_year:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end):0!null, sum(all_nations.volume):1!null, all_nations.o_year:2!null, (sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end):0!null / sum(all_nations.volume):1!null) as mkt_share]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM(CASE  WHEN Eq\n" +
			"             │   ├─ all_nations.nation:2!null\n" +
			"             │   └─ BRAZIL (longtext)\n" +
			"             │   THEN all_nations.volume:1!null ELSE 0 (tinyint) END), SUM(all_nations.volume:1!null), all_nations.o_year:0!null\n" +
			"             ├─ group: all_nations.o_year:0!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: all_nations\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [extract('YEAR' from orders.o_orderdate) as o_year, (lineitem.l_extendedprice:3!null * (1 (tinyint) - lineitem.l_discount:4!null)) as volume, n2.n_name:10!null as nation]\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ lineitem.l_orderkey:0!null\n" +
			"                         │   └─ orders.o_orderkey:11!null\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ supplier.s_nationkey:8!null\n" +
			"                         │   │   └─ n2.n_nationkey:9!null\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ supplier.s_suppkey:7!null\n" +
			"                         │   │   │   └─ lineitem.l_suppkey:2!null\n" +
			"                         │   │   ├─ LookupJoin\n" +
			"                         │   │   │   ├─ Eq\n" +
			"                         │   │   │   │   ├─ part.p_partkey:5!null\n" +
			"                         │   │   │   │   └─ lineitem.l_partkey:1!null\n" +
			"                         │   │   │   ├─ Table\n" +
			"                         │   │   │   │   ├─ name: lineitem\n" +
			"                         │   │   │   │   └─ columns: [l_orderkey l_partkey l_suppkey l_extendedprice l_discount]\n" +
			"                         │   │   │   └─ Filter\n" +
			"                         │   │   │       ├─ Eq\n" +
			"                         │   │   │       │   ├─ part.p_type:1!null\n" +
			"                         │   │   │       │   └─ ECONOMY ANODIZED STEEL (longtext)\n" +
			"                         │   │   │       └─ IndexedTableAccess(part)\n" +
			"                         │   │   │           ├─ index: [part.P_PARTKEY]\n" +
			"                         │   │   │           └─ Table\n" +
			"                         │   │   │               ├─ name: part\n" +
			"                         │   │   │               └─ columns: [p_partkey p_type]\n" +
			"                         │   │   └─ IndexedTableAccess(supplier)\n" +
			"                         │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: supplier\n" +
			"                         │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                         │   └─ TableAlias(n2)\n" +
			"                         │       └─ IndexedTableAccess(nation)\n" +
			"                         │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: nation\n" +
			"                         │               └─ columns: [n_nationkey n_name]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(lineitem.l_orderkey:0!null)\n" +
			"                             ├─ right-key: TUPLE(orders.o_orderkey:0!null)\n" +
			"                             └─ LookupJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ n1.n_regionkey:17!null\n" +
			"                                 │   └─ region.r_regionkey:18!null\n" +
			"                                 ├─ LookupJoin\n" +
			"                                 │   ├─ Eq\n" +
			"                                 │   │   ├─ customer.c_nationkey:15!null\n" +
			"                                 │   │   └─ n1.n_nationkey:16!null\n" +
			"                                 │   ├─ LookupJoin\n" +
			"                                 │   │   ├─ Eq\n" +
			"                                 │   │   │   ├─ orders.o_custkey:12!null\n" +
			"                                 │   │   │   └─ customer.c_custkey:14!null\n" +
			"                                 │   │   ├─ Filter\n" +
			"                                 │   │   │   ├─ (orders.o_orderdate:2!null BETWEEN 1995-01-01 (longtext) AND 1996-12-31 (longtext))\n" +
			"                                 │   │   │   └─ Table\n" +
			"                                 │   │   │       ├─ name: orders\n" +
			"                                 │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                                 │   │   └─ IndexedTableAccess(customer)\n" +
			"                                 │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: customer\n" +
			"                                 │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                                 │   └─ TableAlias(n1)\n" +
			"                                 │       └─ IndexedTableAccess(nation)\n" +
			"                                 │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: nation\n" +
			"                                 │               └─ columns: [n_nationkey n_regionkey]\n" +
			"                                 └─ Filter\n" +
			"                                     ├─ Eq\n" +
			"                                     │   ├─ region.r_name:1!null\n" +
			"                                     │   └─ AMERICA (longtext)\n" +
			"                                     └─ IndexedTableAccess(region)\n" +
			"                                         ├─ index: [region.R_REGIONKEY]\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: region\n" +
			"                                             └─ columns: [r_regionkey r_name]\n" +
			"",
	},
	{
		Query: `
--Q9
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [profit.nation:1!null, profit.o_year:2!null, sum(profit.amount):0!null as sum_profit]\n" +
			" └─ Sort(profit.nation:1!null ASC nullsFirst, profit.o_year:2!null DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum(profit.amount):0!null, profit.nation:1!null, profit.o_year:2!null, sum(profit.amount):0!null as sum_profit]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM(profit.amount:2!null), profit.nation:0!null, profit.o_year:1!null\n" +
			"             ├─ group: profit.nation:0!null, profit.o_year:1!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: profit\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [nation.n_name:14!null as nation, extract('YEAR' from orders.o_orderdate) as o_year, ((lineitem.l_extendedprice:4!null * (1 (tinyint) - lineitem.l_discount:5!null)) - (partsupp.ps_supplycost:10!null * lineitem.l_quantity:3!null)) as amount]\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ orders.o_orderkey:15!null\n" +
			"                         │   └─ lineitem.l_orderkey:0!null\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ supplier.s_nationkey:12!null\n" +
			"                         │   │   └─ nation.n_nationkey:13!null\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ AND\n" +
			"                         │   │   │   ├─ Eq\n" +
			"                         │   │   │   │   ├─ supplier.s_suppkey:11!null\n" +
			"                         │   │   │   │   └─ lineitem.l_suppkey:2!null\n" +
			"                         │   │   │   └─ Eq\n" +
			"                         │   │   │       ├─ supplier.s_suppkey:11!null\n" +
			"                         │   │   │       └─ partsupp.ps_suppkey:9!null\n" +
			"                         │   │   ├─ LookupJoin\n" +
			"                         │   │   │   ├─ AND\n" +
			"                         │   │   │   │   ├─ Eq\n" +
			"                         │   │   │   │   │   ├─ partsupp.ps_suppkey:9!null\n" +
			"                         │   │   │   │   │   └─ lineitem.l_suppkey:2!null\n" +
			"                         │   │   │   │   └─ Eq\n" +
			"                         │   │   │   │       ├─ partsupp.ps_partkey:8!null\n" +
			"                         │   │   │   │       └─ lineitem.l_partkey:1!null\n" +
			"                         │   │   │   ├─ LookupJoin\n" +
			"                         │   │   │   │   ├─ Eq\n" +
			"                         │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"                         │   │   │   │   │   └─ lineitem.l_partkey:1!null\n" +
			"                         │   │   │   │   ├─ Table\n" +
			"                         │   │   │   │   │   ├─ name: lineitem\n" +
			"                         │   │   │   │   │   └─ columns: [l_orderkey l_partkey l_suppkey l_quantity l_extendedprice l_discount]\n" +
			"                         │   │   │   │   └─ Filter\n" +
			"                         │   │   │   │       ├─ part.p_name LIKE '%green%'\n" +
			"                         │   │   │   │       └─ IndexedTableAccess(part)\n" +
			"                         │   │   │   │           ├─ index: [part.P_PARTKEY]\n" +
			"                         │   │   │   │           └─ Table\n" +
			"                         │   │   │   │               ├─ name: part\n" +
			"                         │   │   │   │               └─ columns: [p_partkey p_name]\n" +
			"                         │   │   │   └─ IndexedTableAccess(partsupp)\n" +
			"                         │   │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: partsupp\n" +
			"                         │   │   │           └─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"                         │   │   └─ IndexedTableAccess(supplier)\n" +
			"                         │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: supplier\n" +
			"                         │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                         │   └─ IndexedTableAccess(nation)\n" +
			"                         │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │       └─ Table\n" +
			"                         │           ├─ name: nation\n" +
			"                         │           └─ columns: [n_nationkey n_name]\n" +
			"                         └─ IndexedTableAccess(orders)\n" +
			"                             ├─ index: [orders.O_ORDERKEY]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 └─ columns: [o_orderkey o_orderdate]\n" +
			"",
	},
	{
		Query: `
--Q10
select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= '1993-10-01'
	and o_orderdate < '1993-10-01' + interval '3' month
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [customer.c_custkey:1!null, customer.c_name:2!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue, customer.c_acctbal:3!null, nation.n_name:4!null, customer.c_address:5!null, customer.c_phone:6!null, customer.c_comment:7!null]\n" +
			" └─ Sort(sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, customer.c_custkey:1!null, customer.c_name:2!null, customer.c_acctbal:3!null, nation.n_name:4!null, customer.c_address:5!null, customer.c_phone:6!null, customer.c_comment:7!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:13!null * (1 (tinyint) - lineitem.l_discount:14!null))), customer.c_custkey:3!null, customer.c_name:4!null, customer.c_acctbal:8!null, nation.n_name:11!null, customer.c_address:5!null, customer.c_phone:7!null, customer.c_comment:9!null\n" +
			"             ├─ group: customer.c_custkey:3!null, customer.c_name:4!null, customer.c_acctbal:8!null, customer.c_phone:7!null, nation.n_name:11!null, customer.c_address:5!null, customer.c_comment:9!null\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ lineitem.l_orderkey:12!null\n" +
			"                 │   └─ orders.o_orderkey:0!null\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ customer.c_nationkey:6!null\n" +
			"                 │   │   └─ nation.n_nationkey:10!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ customer.c_custkey:3!null\n" +
			"                 │   │   │   └─ orders.o_custkey:1!null\n" +
			"                 │   │   ├─ Filter\n" +
			"                 │   │   │   ├─ AND\n" +
			"                 │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │   │   └─ 1993-10-01 (longtext)\n" +
			"                 │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │       ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │       └─ 1994-01-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: orders\n" +
			"                 │   │   │           └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   └─ IndexedTableAccess(customer)\n" +
			"                 │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: customer\n" +
			"                 │   │           └─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_comment]\n" +
			"                 │   └─ IndexedTableAccess(nation)\n" +
			"                 │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: nation\n" +
			"                 │           └─ columns: [n_nationkey n_name]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(orders.o_orderkey:0!null)\n" +
			"                     ├─ right-key: TUPLE(lineitem.l_orderkey:0!null)\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ lineitem.l_returnflag:3!null\n" +
			"                         │   └─ R (longtext)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: lineitem\n" +
			"                                 └─ columns: [l_orderkey l_extendedprice l_discount l_returnflag]\n" +
			"",
	},
	{
		Query: `
--Q11
select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'GERMANY'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'GERMANY'
		)
order by
	value desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [partsupp.ps_partkey:1!null, sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null as value]\n" +
			" └─ Sort(sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null as value DESC nullsFirst)\n" +
			"     └─ Having\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       ├─ alias-string: select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY'\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [(sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null * 0.0001 (decimal(11,10))) as sum(ps_supplycost * ps_availqty) * 0.0001000000]\n" +
			"         │           └─ LookupJoin\n" +
			"         │               ├─ Eq\n" +
			"         │               │   ├─ supplier.s_nationkey:7!null\n" +
			"         │               │   └─ nation.n_nationkey:8!null\n" +
			"         │               ├─ LookupJoin\n" +
			"         │               │   ├─ Eq\n" +
			"         │               │   │   ├─ partsupp.ps_suppkey:5!null\n" +
			"         │               │   │   └─ supplier.s_suppkey:6!null\n" +
			"         │               │   ├─ Table\n" +
			"         │               │   │   ├─ name: partsupp\n" +
			"         │               │   │   └─ columns: [ps_suppkey]\n" +
			"         │               │   └─ IndexedTableAccess(supplier)\n" +
			"         │               │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │               │       └─ Table\n" +
			"         │               │           ├─ name: supplier\n" +
			"         │               │           └─ columns: [s_suppkey s_nationkey]\n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ nation.n_name:6!null\n" +
			"         │                   │   └─ GERMANY (longtext)\n" +
			"         │                   └─ IndexedTableAccess(nation)\n" +
			"         │                       ├─ index: [nation.N_NATIONKEY]\n" +
			"         │                       └─ Table\n" +
			"         │                           ├─ name: nation\n" +
			"         │                           └─ columns: [n_nationkey n_name]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null, partsupp.ps_partkey:1!null, partsupp.PS_SUPPLYCOST:2!null, partsupp.PS_AVAILQTY:3!null, sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null as value]\n" +
			"             └─ GroupBy\n" +
			"                 ├─ select: SUM((partsupp.ps_supplycost:3!null * partsupp.ps_availqty:2!null)), partsupp.ps_partkey:0!null, partsupp.PS_SUPPLYCOST:3!null, partsupp.PS_AVAILQTY:2!null\n" +
			"                 ├─ group: partsupp.ps_partkey:0!null\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ supplier.s_nationkey:8!null\n" +
			"                     │   └─ nation.n_nationkey:12!null\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ partsupp.ps_suppkey:1!null\n" +
			"                     │   │   └─ supplier.s_suppkey:5!null\n" +
			"                     │   ├─ ProcessTable\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: partsupp\n" +
			"                     │   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                     │   └─ IndexedTableAccess(supplier)\n" +
			"                     │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │       └─ Table\n" +
			"                     │           ├─ name: supplier\n" +
			"                     │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ nation.n_name:1!null\n" +
			"                         │   └─ GERMANY (longtext)\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: nation\n" +
			"                                 └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"",
	},
	{
		Query: `
--Q12
select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('MAIL', 'SHIP')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1994-01-01'
	and l_receiptdate < '1994-01-01' + interval '1' year
group by
	l_shipmode
order by
	l_shipmode;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_shipmode:2!null, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end):1!null as high_line_count, sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end):0!null as low_line_count]\n" +
			" └─ Sort(lineitem.l_shipmode:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end):0!null, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end):1!null, lineitem.l_shipmode:2!null, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end):1!null as high_line_count, sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end):0!null as low_line_count]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM(CASE  WHEN AND\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ orders.o_orderpriority:6!null\n" +
			"             │   │       └─ 1-URGENT (longtext)\n" +
			"             │   └─ NOT\n" +
			"             │       └─ Eq\n" +
			"             │           ├─ orders.o_orderpriority:6!null\n" +
			"             │           └─ 2-HIGH (longtext)\n" +
			"             │   THEN 1 (tinyint) ELSE 0 (tinyint) END), SUM(CASE  WHEN Or\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ orders.o_orderpriority:6!null\n" +
			"             │   │   └─ 1-URGENT (longtext)\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ orders.o_orderpriority:6!null\n" +
			"             │       └─ 2-HIGH (longtext)\n" +
			"             │   THEN 1 (tinyint) ELSE 0 (tinyint) END), lineitem.l_shipmode:4!null\n" +
			"             ├─ group: lineitem.l_shipmode:4!null\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ lineitem.l_orderkey:0!null\n" +
			"                 │   └─ orders.o_orderkey:5!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ AND\n" +
			"                 │   │   │   ├─ AND\n" +
			"                 │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   ├─ HashIn\n" +
			"                 │   │   │   │   │   │   ├─ lineitem.l_shipmode:4!null\n" +
			"                 │   │   │   │   │   │   └─ TUPLE(MAIL (longtext), SHIP (longtext))\n" +
			"                 │   │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │   │       ├─ lineitem.l_commitdate:2!null\n" +
			"                 │   │   │   │   │       └─ lineitem.l_receiptdate:3!null\n" +
			"                 │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │       ├─ lineitem.l_shipdate:1!null\n" +
			"                 │   │   │   │       └─ lineitem.l_commitdate:2!null\n" +
			"                 │   │   │   └─ GreaterThanOrEqual\n" +
			"                 │   │   │       ├─ lineitem.l_receiptdate:3!null\n" +
			"                 │   │   │       └─ 1994-01-01 (longtext)\n" +
			"                 │   │   └─ LessThan\n" +
			"                 │   │       ├─ lineitem.l_receiptdate:3!null\n" +
			"                 │   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"                 │   └─ IndexedTableAccess(lineitem)\n" +
			"                 │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: lineitem\n" +
			"                 │           └─ columns: [l_orderkey l_shipdate l_commitdate l_receiptdate l_shipmode]\n" +
			"                 └─ IndexedTableAccess(orders)\n" +
			"                     ├─ index: [orders.O_ORDERKEY]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ Table\n" +
			"                         ├─ name: orders\n" +
			"                         └─ columns: [o_orderkey o_orderpriority]\n" +
			"",
	},
	{
		Query: `
--Q13
select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%special%requests%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [c_orders.c_count:1!null, count(1):0!null as custdist]\n" +
			" └─ Sort(count(1):0!null as custdist DESC nullsFirst, c_orders.c_count:1!null DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, c_orders.c_count:1!null, count(1):0!null as custdist]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), c_orders.c_count:1!null\n" +
			"             ├─ group: c_orders.c_count:1!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: c_orders\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [customer.c_custkey:1!null, count(orders.o_orderkey):0!null as count(o_orderkey)]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ select: COUNT(orders.o_orderkey:1!null), customer.c_custkey:0!null\n" +
			"                         ├─ group: customer.c_custkey:0!null\n" +
			"                         └─ LeftOuterJoin\n" +
			"                             ├─ AND\n" +
			"                             │   ├─ Eq\n" +
			"                             │   │   ├─ customer.c_custkey:0!null\n" +
			"                             │   │   └─ orders.o_custkey:2!null\n" +
			"                             │   └─ NOT\n" +
			"                             │       └─ orders.o_comment LIKE '%special%requests%'\n" +
			"                             ├─ Table\n" +
			"                             │   ├─ name: customer\n" +
			"                             │   └─ columns: [c_custkey]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 └─ columns: [o_orderkey o_custkey o_comment]\n" +
			"",
	},
	{
		Query: `
--Q14
select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= '1995-09-01'
	and l_shipdate < '1995-09-01' + interval '1' month;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [((100 (decimal(5,2)) * sum(case  when part.p_type like 'promo%' then (lineitem.l_extendedprice * (1 - lineitem.l_discount)) else 0 end):1!null) / sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null) as promo_revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), SUM(CASE  WHEN part.p_type LIKE 'PROMO%' THEN (lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null)) ELSE 0 (tinyint) END)\n" +
			"     ├─ group: \n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ lineitem.l_partkey:0!null\n" +
			"         │   └─ part.p_partkey:4!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │   └─ 1995-09-01 (longtext)\n" +
			"         │   │   └─ LessThan\n" +
			"         │   │       ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │       └─ 1995-10-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: lineitem\n" +
			"         │           └─ columns: [l_partkey l_extendedprice l_discount l_shipdate]\n" +
			"         └─ IndexedTableAccess(part)\n" +
			"             ├─ index: [part.P_PARTKEY]\n" +
			"             └─ Table\n" +
			"                 ├─ name: part\n" +
			"                 └─ columns: [p_partkey p_type]\n" +
			"",
	},
	{
		Query: `
--Q15
with revenue0 (supplier_no, total_revenue) as (
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= '1996-01-01'
		and l_shipdate < '1996-01-01' + interval '3' month
	group by
		l_suppkey)
select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_suppkey:0!null, supplier.s_name:1!null, supplier.s_address:2!null, supplier.s_phone:4!null, revenue0.total_revenue:8!null]\n" +
			" └─ Sort(supplier.s_suppkey:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [supplier.S_SUPPKEY:2!null, supplier.S_NAME:3!null, supplier.S_ADDRESS:4!null, supplier.S_NATIONKEY:5!null, supplier.S_PHONE:6!null, supplier.S_ACCTBAL:7!null, supplier.S_COMMENT:8!null, revenue0.supplier_no:0!null, revenue0.total_revenue:1!null]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ supplier.s_suppkey:2!null\n" +
			"             │   └─ revenue0.supplier_no:0!null\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [revenue0.supplier_no:0!null, revenue0.total_revenue:1!null]\n" +
			"             │   └─ HashJoin\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ revenue0.total_revenue:1!null\n" +
			"             │       │   └─ scalarSubq0.max(total_revenue):2!null\n" +
			"             │       ├─ SubqueryAlias\n" +
			"             │       │   ├─ name: revenue0\n" +
			"             │       │   ├─ outerVisibility: false\n" +
			"             │       │   ├─ cacheable: true\n" +
			"             │       │   └─ Project\n" +
			"             │       │       ├─ columns: [lineitem.l_suppkey:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null]\n" +
			"             │       │       └─ GroupBy\n" +
			"             │       │           ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), lineitem.l_suppkey:0!null\n" +
			"             │       │           ├─ group: lineitem.l_suppkey:0!null\n" +
			"             │       │           └─ Filter\n" +
			"             │       │               ├─ AND\n" +
			"             │       │               │   ├─ GreaterThanOrEqual\n" +
			"             │       │               │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"             │       │               │   │   └─ 1996-01-01 (longtext)\n" +
			"             │       │               │   └─ LessThan\n" +
			"             │       │               │       ├─ lineitem.l_shipdate:3!null\n" +
			"             │       │               │       └─ 1996-04-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"             │       │               └─ Table\n" +
			"             │       │                   ├─ name: lineitem\n" +
			"             │       │                   └─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"             │       └─ HashLookup\n" +
			"             │           ├─ left-key: TUPLE(revenue0.total_revenue:1!null)\n" +
			"             │           ├─ right-key: TUPLE(scalarSubq0.max(total_revenue):0!null)\n" +
			"             │           └─ OrderedDistinct\n" +
			"             │               └─ Max1Row\n" +
			"             │                   └─ SubqueryAlias\n" +
			"             │                       ├─ name: scalarSubq0\n" +
			"             │                       ├─ outerVisibility: false\n" +
			"             │                       ├─ cacheable: true\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [max(revenue0.total_revenue):0!null as max(total_revenue)]\n" +
			"             │                           └─ GroupBy\n" +
			"             │                               ├─ select: MAX(revenue0.total_revenue:1!null)\n" +
			"             │                               ├─ group: \n" +
			"             │                               └─ SubqueryAlias\n" +
			"             │                                   ├─ name: revenue0\n" +
			"             │                                   ├─ outerVisibility: false\n" +
			"             │                                   ├─ cacheable: true\n" +
			"             │                                   └─ Project\n" +
			"             │                                       ├─ columns: [lineitem.l_suppkey:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null]\n" +
			"             │                                       └─ GroupBy\n" +
			"             │                                           ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), lineitem.l_suppkey:0!null\n" +
			"             │                                           ├─ group: lineitem.l_suppkey:0!null\n" +
			"             │                                           └─ Filter\n" +
			"             │                                               ├─ AND\n" +
			"             │                                               │   ├─ GreaterThanOrEqual\n" +
			"             │                                               │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"             │                                               │   │   └─ 1996-01-01 (longtext)\n" +
			"             │                                               │   └─ LessThan\n" +
			"             │                                               │       ├─ lineitem.l_shipdate:3!null\n" +
			"             │                                               │       └─ 1996-04-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"             │                                               └─ Table\n" +
			"             │                                                   ├─ name: lineitem\n" +
			"             │                                                   └─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"             └─ IndexedTableAccess(supplier)\n" +
			"                 ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: supplier\n" +
			"                     └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"",
	},
	{
		Query: `
--Q16
select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#45'
	and p_type not like 'MEDIUM POLISHED%'
	and p_size in (49, 14, 23, 45, 19, 3, 36, 9)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [part.p_brand:1!null, part.p_type:2!null, part.p_size:3!null, countdistinct([partsupp.ps_suppkey]):0!null as supplier_cnt]\n" +
			" └─ Sort(countdistinct([partsupp.ps_suppkey]):0!null as supplier_cnt DESC nullsFirst, part.p_brand:1!null ASC nullsFirst, part.p_type:2!null ASC nullsFirst, part.p_size:3!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [countdistinct([partsupp.ps_suppkey]):0!null, part.p_brand:1!null, part.p_type:2!null, part.p_size:3!null, countdistinct([partsupp.ps_suppkey]):0!null as supplier_cnt]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNTDISTINCT([partsupp.ps_suppkey]), part.p_brand:8!null, part.p_type:9!null, part.p_size:10!null\n" +
			"             ├─ group: part.p_brand:8!null, part.p_type:9!null, part.p_size:10!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ part.p_partkey:5!null\n" +
			"                 │   └─ partsupp.ps_partkey:0!null\n" +
			"                 ├─ AntiLookupJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ partsupp.ps_suppkey:1!null\n" +
			"                 │   │   └─ scalarSubq0.s_suppkey:5!null\n" +
			"                 │   ├─ ProcessTable\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: partsupp\n" +
			"                 │   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ scalarSubq0.s_comment LIKE '%Customer%Complaints%'\n" +
			"                 │       └─ TableAlias(scalarSubq0)\n" +
			"                 │           └─ IndexedTableAccess(supplier)\n" +
			"                 │               ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: supplier\n" +
			"                 │                   └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                 └─ Filter\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ AND\n" +
			"                     │   │   ├─ NOT\n" +
			"                     │   │   │   └─ Eq\n" +
			"                     │   │   │       ├─ part.p_brand:3!null\n" +
			"                     │   │   │       └─ Brand#45 (longtext)\n" +
			"                     │   │   └─ NOT\n" +
			"                     │   │       └─ AND\n" +
			"                     │   │           ├─ GreaterThanOrEqual\n" +
			"                     │   │           │   ├─ part.p_type:4!null\n" +
			"                     │   │           │   └─ MEDIUM POLISHED (longtext)\n" +
			"                     │   │           └─ LessThanOrEqual\n" +
			"                     │   │               ├─ part.p_type:4!null\n" +
			"                     │   │               └─ MEDIUM POLISHEDÿ (longtext)\n" +
			"                     │   └─ HashIn\n" +
			"                     │       ├─ part.p_size:5!null\n" +
			"                     │       └─ TUPLE(49 (tinyint), 14 (tinyint), 23 (tinyint), 45 (tinyint), 19 (tinyint), 3 (tinyint), 36 (tinyint), 9 (tinyint))\n" +
			"                     └─ IndexedTableAccess(part)\n" +
			"                         ├─ index: [part.P_PARTKEY]\n" +
			"                         └─ Table\n" +
			"                             ├─ name: part\n" +
			"                             └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"",
	},
	{
		Query: `
--Q17
select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#23'
	and p_container = 'MED BOX'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [(sum(lineitem.l_extendedprice):0!null / 7 (decimal(2,1))) as avg_yearly]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM(lineitem.l_extendedprice:5!null)\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ LessThan\n" +
			"         │   ├─ lineitem.l_quantity:4!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: false\n" +
			"         │       ├─ alias-string: select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [(0.200000 (double) * avg(lineitem.l_quantity):25) as 0.2 * avg(l_quantity)]\n" +
			"         │           └─ GroupBy\n" +
			"         │               ├─ select: AVG(lineitem.l_quantity:26!null)\n" +
			"         │               ├─ group: \n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ lineitem.l_partkey:25!null\n" +
			"         │                   │   └─ part.p_partkey:16!null\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: lineitem\n" +
			"         │                       └─ columns: [l_partkey l_quantity]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ part.p_partkey:16!null\n" +
			"             │   └─ lineitem.l_partkey:1!null\n" +
			"             ├─ ProcessTable\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: lineitem\n" +
			"             │       └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ part.p_brand:3!null\n" +
			"                 │   │   └─ Brand#23 (longtext)\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ part.p_container:6!null\n" +
			"                 │       └─ MED BOX (longtext)\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     └─ Table\n" +
			"                         ├─ name: part\n" +
			"                         └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"",
	},
	{
		Query: `
--Q18
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [customer.c_name:1!null, customer.c_custkey:2!null, orders.o_orderkey:3!null, orders.o_orderdate:4!null, orders.o_totalprice:5!null, sum(lineitem.l_quantity):0!null as sum(l_quantity)]\n" +
			" └─ Sort(orders.o_totalprice:5!null DESC nullsFirst, orders.o_orderdate:4!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(lineitem.l_quantity:21!null), customer.c_name:10!null, customer.c_custkey:9!null, orders.o_orderkey:0!null, orders.o_orderdate:4!null, orders.o_totalprice:3!null\n" +
			"         ├─ group: customer.c_name:10!null, customer.c_custkey:9!null, orders.o_orderkey:0!null, orders.o_orderdate:4!null, orders.o_totalprice:3!null\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ orders.o_orderkey:0!null\n" +
			"             │   └─ lineitem.l_orderkey:17!null\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ customer.c_custkey:9!null\n" +
			"             │   │   └─ orders.o_custkey:1!null\n" +
			"             │   ├─ Project\n" +
			"             │   │   ├─ columns: [orders.o_orderkey:1!null, orders.o_custkey:2!null, orders.O_ORDERSTATUS:3!null, orders.O_TOTALPRICE:4!null, orders.O_ORDERDATE:5!null, orders.O_ORDERPRIORITY:6!null, orders.O_CLERK:7!null, orders.O_SHIPPRIORITY:8!null, orders.O_COMMENT:9!null]\n" +
			"             │   │   └─ LookupJoin\n" +
			"             │   │       ├─ Eq\n" +
			"             │   │       │   ├─ orders.o_orderkey:1!null\n" +
			"             │   │       │   └─ scalarSubq0.l_orderkey:0!null\n" +
			"             │   │       ├─ Distinct\n" +
			"             │   │       │   └─ SubqueryAlias\n" +
			"             │   │       │       ├─ name: scalarSubq0\n" +
			"             │   │       │       ├─ outerVisibility: false\n" +
			"             │   │       │       ├─ cacheable: true\n" +
			"             │   │       │       └─ Project\n" +
			"             │   │       │           ├─ columns: [lineitem.l_orderkey:1!null]\n" +
			"             │   │       │           └─ Having\n" +
			"             │   │       │               ├─ GreaterThan\n" +
			"             │   │       │               │   ├─ sum(lineitem.l_quantity):0!null\n" +
			"             │   │       │               │   └─ 300 (smallint)\n" +
			"             │   │       │               └─ GroupBy\n" +
			"             │   │       │                   ├─ select: SUM(lineitem.l_quantity:4!null), lineitem.l_orderkey:0!null, lineitem.L_QUANTITY:4!null\n" +
			"             │   │       │                   ├─ group: lineitem.l_orderkey:0!null\n" +
			"             │   │       │                   └─ Table\n" +
			"             │   │       │                       ├─ name: lineitem\n" +
			"             │   │       │                       └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"             │   │       └─ IndexedTableAccess(orders)\n" +
			"             │   │           ├─ index: [orders.O_ORDERKEY]\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: orders\n" +
			"             │   │               └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"             │   └─ IndexedTableAccess(customer)\n" +
			"             │       ├─ index: [customer.C_CUSTKEY]\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: customer\n" +
			"             │           └─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_mktsegment c_comment]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(orders.o_orderkey:0!null)\n" +
			"                 ├─ right-key: TUPLE(lineitem.l_orderkey:0!null)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: lineitem\n" +
			"                         └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"",
	},
	{
		Query: `
--Q19
select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:2!null * (1 (tinyint) - lineitem.l_discount:3!null)))\n" +
			"     ├─ group: \n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Or\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │   │   │   │   │   │   │   │   │       └─ Brand#12 (longtext)\n" +
			"         │   │   │   │   │   │   │   │   └─ IN\n" +
			"         │   │   │   │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │   │   │   │   │   │   │   │       └─ right: TUPLE(SM CASE (longtext), SM BOX (longtext), SM PACK (longtext), SM PKG (longtext))\n" +
			"         │   │   │   │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │   │   │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │   │   │   │   │   │       └─ 1 (tinyint)\n" +
			"         │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │   │   │   │   │       └─ 11 (bigint)\n" +
			"         │   │   │   │   │   └─ (part.p_size:8!null BETWEEN 1 (tinyint) AND 5 (tinyint))\n" +
			"         │   │   │   │   └─ IN\n" +
			"         │   │   │   │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │   │   │   │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │   │   │       └─ DELIVER IN PERSON (longtext)\n" +
			"         │   │   └─ AND\n" +
			"         │   │       ├─ AND\n" +
			"         │   │       │   ├─ AND\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │       │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │   │       │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │   │       │   │   │   │   │   │   └─ Eq\n" +
			"         │   │       │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │   │       │   │   │   │   │   │       └─ Brand#23 (longtext)\n" +
			"         │   │       │   │   │   │   │   └─ IN\n" +
			"         │   │       │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │   │       │   │   │   │   │       └─ right: TUPLE(MED BAG (longtext), MED BOX (longtext), MED PKG (longtext), MED PACK (longtext))\n" +
			"         │   │       │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │       │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │       │   │   │   │       └─ 10 (tinyint)\n" +
			"         │   │       │   │   │   └─ LessThanOrEqual\n" +
			"         │   │       │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │       │   │   │       └─ 20 (bigint)\n" +
			"         │   │       │   │   └─ (part.p_size:8!null BETWEEN 1 (tinyint) AND 10 (tinyint))\n" +
			"         │   │       │   └─ IN\n" +
			"         │   │       │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │   │       │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │   │       └─ Eq\n" +
			"         │   │           ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │   │           └─ DELIVER IN PERSON (longtext)\n" +
			"         │   └─ AND\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ AND\n" +
			"         │       │   │   ├─ AND\n" +
			"         │       │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   │   │   ├─ Eq\n" +
			"         │       │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │       │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │       │   │   │   │   │   │   └─ Eq\n" +
			"         │       │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │       │   │   │   │   │   │       └─ Brand#34 (longtext)\n" +
			"         │       │   │   │   │   │   └─ IN\n" +
			"         │       │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │       │   │   │   │   │       └─ right: TUPLE(LG CASE (longtext), LG BOX (longtext), LG PACK (longtext), LG PKG (longtext))\n" +
			"         │       │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │       │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │       │   │   │   │       └─ 20 (bigint)\n" +
			"         │       │   │   │   └─ LessThanOrEqual\n" +
			"         │       │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │       │   │   │       └─ 30 (bigint)\n" +
			"         │       │   │   └─ (part.p_size:8!null BETWEEN 1 (tinyint) AND 15 (tinyint))\n" +
			"         │       │   └─ IN\n" +
			"         │       │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │       │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │       └─ Eq\n" +
			"         │           ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │           └─ DELIVER IN PERSON (longtext)\n" +
			"         ├─ ProcessTable\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: lineitem\n" +
			"         │       └─ columns: [l_partkey l_quantity l_extendedprice l_discount l_shipinstruct l_shipmode]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(part)\n" +
			"             │   ├─ index: [part.P_PARTKEY]\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: part\n" +
			"             │       └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(part)\n" +
			"                 │   ├─ index: [part.P_PARTKEY]\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: part\n" +
			"                 │       └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     └─ Table\n" +
			"                         ├─ name: part\n" +
			"                         └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"",
	},
	{
		Query: `
--Q20
select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'forest%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= '1994-01-01'
					and l_shipdate < '1994-01-01' + interval '1' year
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'CANADA'
order by
	s_name;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_name:1!null, supplier.s_address:2!null]\n" +
			" └─ Sort(supplier.s_name:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [supplier.S_SUPPKEY:4!null, supplier.S_NAME:5!null, supplier.S_ADDRESS:6!null, supplier.S_NATIONKEY:7!null, supplier.S_PHONE:8!null, supplier.S_ACCTBAL:9!null, supplier.S_COMMENT:10!null, nation.N_NATIONKEY:0!null, nation.N_NAME:1!null, nation.N_REGIONKEY:2!null, nation.N_COMMENT:3]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [nation.n_nationkey:8!null, nation.n_name:9!null, nation.N_REGIONKEY:10!null, nation.N_COMMENT:11, supplier.s_suppkey:1!null, supplier.S_NAME:2!null, supplier.S_ADDRESS:3!null, supplier.s_nationkey:4!null, supplier.S_PHONE:5!null, supplier.S_ACCTBAL:6!null, supplier.S_COMMENT:7!null]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ supplier.s_suppkey:1!null\n" +
			"                 │   └─ scalarSubq0.ps_suppkey:0!null\n" +
			"                 ├─ Distinct\n" +
			"                 │   └─ Project\n" +
			"                 │       ├─ columns: [scalarSubq0.ps_suppkey:1!null]\n" +
			"                 │       └─ Filter\n" +
			"                 │           ├─ GreaterThan\n" +
			"                 │           │   ├─ scalarSubq0.ps_availqty:2!null\n" +
			"                 │           │   └─ Subquery\n" +
			"                 │           │       ├─ cacheable: false\n" +
			"                 │           │       ├─ alias-string: select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= '1994-01-01' and l_shipdate < '1994-01-01' + interval '1' year\n" +
			"                 │           │       └─ Project\n" +
			"                 │           │           ├─ columns: [(0.500000 (double) * sum(lineitem.l_quantity):5!null) as 0.5 * sum(l_quantity)]\n" +
			"                 │           │           └─ GroupBy\n" +
			"                 │           │               ├─ select: SUM(lineitem.l_quantity:7!null)\n" +
			"                 │           │               ├─ group: \n" +
			"                 │           │               └─ Filter\n" +
			"                 │           │                   ├─ AND\n" +
			"                 │           │                   │   ├─ AND\n" +
			"                 │           │                   │   │   ├─ AND\n" +
			"                 │           │                   │   │   │   ├─ Eq\n" +
			"                 │           │                   │   │   │   │   ├─ lineitem.l_partkey:5!null\n" +
			"                 │           │                   │   │   │   │   └─ partsupp.ps_partkey:0!null\n" +
			"                 │           │                   │   │   │   └─ Eq\n" +
			"                 │           │                   │   │   │       ├─ lineitem.l_suppkey:6!null\n" +
			"                 │           │                   │   │   │       └─ partsupp.ps_suppkey:1!null\n" +
			"                 │           │                   │   │   └─ GreaterThanOrEqual\n" +
			"                 │           │                   │   │       ├─ lineitem.l_shipdate:8!null\n" +
			"                 │           │                   │   │       └─ 1994-01-01 (longtext)\n" +
			"                 │           │                   │   └─ LessThan\n" +
			"                 │           │                   │       ├─ lineitem.l_shipdate:8!null\n" +
			"                 │           │                   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime(6))\n" +
			"                 │           │                   └─ Table\n" +
			"                 │           │                       ├─ name: lineitem\n" +
			"                 │           │                       └─ columns: [l_partkey l_suppkey l_quantity l_shipdate]\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [scalarSubq0.ps_partkey:1!null, scalarSubq0.ps_suppkey:2!null, scalarSubq0.ps_availqty:3!null, scalarSubq0.PS_SUPPLYCOST:4!null, scalarSubq0.PS_COMMENT:5!null]\n" +
			"                 │               └─ MergeJoin\n" +
			"                 │                   ├─ cmp: Eq\n" +
			"                 │                   │   ├─ scalarSubq1.p_partkey:0!null\n" +
			"                 │                   │   └─ scalarSubq0.ps_partkey:1!null\n" +
			"                 │                   ├─ Distinct\n" +
			"                 │                   │   └─ Project\n" +
			"                 │                   │       ├─ columns: [scalarSubq1.p_partkey:0!null]\n" +
			"                 │                   │       └─ Filter\n" +
			"                 │                   │           ├─ AND\n" +
			"                 │                   │           │   ├─ AND\n" +
			"                 │                   │           │   │   ├─ AND\n" +
			"                 │                   │           │   │   │   ├─ AND\n" +
			"                 │                   │           │   │   │   │   ├─ AND\n" +
			"                 │                   │           │   │   │   │   │   ├─ AND\n" +
			"                 │                   │           │   │   │   │   │   │   ├─ AND\n" +
			"                 │                   │           │   │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │                   │           │   │   │   │   │   │   │   │   ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │   │   │   │   │   │   └─ forest (longtext)\n" +
			"                 │                   │           │   │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                 │                   │           │   │   │   │   │   │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │   │   │   │   │       └─ forestÿ (longtext)\n" +
			"                 │                   │           │   │   │   │   │   │   └─ GreaterThanOrEqual\n" +
			"                 │                   │           │   │   │   │   │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │   │   │   │       └─ forest (longtext)\n" +
			"                 │                   │           │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                 │                   │           │   │   │   │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │   │   │       └─ forestÿ (longtext)\n" +
			"                 │                   │           │   │   │   │   └─ GreaterThanOrEqual\n" +
			"                 │                   │           │   │   │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │   │       └─ forest (longtext)\n" +
			"                 │                   │           │   │   │   └─ LessThanOrEqual\n" +
			"                 │                   │           │   │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │   │       └─ forestÿ (longtext)\n" +
			"                 │                   │           │   │   └─ GreaterThanOrEqual\n" +
			"                 │                   │           │   │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │   │       └─ forest (longtext)\n" +
			"                 │                   │           │   └─ LessThanOrEqual\n" +
			"                 │                   │           │       ├─ scalarSubq1.p_name:1!null\n" +
			"                 │                   │           │       └─ forestÿ (longtext)\n" +
			"                 │                   │           └─ TableAlias(scalarSubq1)\n" +
			"                 │                   │               └─ IndexedTableAccess(part)\n" +
			"                 │                   │                   ├─ index: [part.P_PARTKEY]\n" +
			"                 │                   │                   ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                   │                   └─ Table\n" +
			"                 │                   │                       ├─ name: part\n" +
			"                 │                   │                       └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"                 │                   └─ TableAlias(scalarSubq0)\n" +
			"                 │                       └─ IndexedTableAccess(partsupp)\n" +
			"                 │                           ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                 │                           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │                           └─ Table\n" +
			"                 │                               ├─ name: partsupp\n" +
			"                 │                               └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(scalarSubq0.ps_suppkey:0!null)\n" +
			"                     ├─ right-key: TUPLE(supplier.s_suppkey:0!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ supplier.s_nationkey:4!null\n" +
			"                         │   └─ nation.n_nationkey:8!null\n" +
			"                         ├─ ProcessTable\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: supplier\n" +
			"                         │       └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ nation.n_name:1!null\n" +
			"                             │   └─ CANADA (longtext)\n" +
			"                             └─ IndexedTableAccess(nation)\n" +
			"                                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: nation\n" +
			"                                     └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"",
	},
	{
		Query: `
--Q21
select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'SAUDI ARABIA'
group by
	s_name
order by
	numwait desc,
	s_name;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_name:1!null, count(1):0!null as numwait]\n" +
			" └─ Sort(count(1):0!null as numwait DESC nullsFirst, supplier.s_name:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, supplier.s_name:1!null, count(1):0!null as numwait]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), supplier.s_name:17!null\n" +
			"             ├─ group: supplier.s_name:17!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ supplier.s_nationkey:19!null\n" +
			"                 │   └─ nation.n_nationkey:32!null\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ orders.o_orderkey:23!null\n" +
			"                 │   │   └─ l1.l_orderkey:0!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ supplier.s_suppkey:16!null\n" +
			"                 │   │   │   └─ l1.l_suppkey:2!null\n" +
			"                 │   │   ├─ SemiJoin\n" +
			"                 │   │   │   ├─ AND\n" +
			"                 │   │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   │   ├─ l2.l_orderkey:16!null\n" +
			"                 │   │   │   │   │   └─ l1.l_orderkey:0!null\n" +
			"                 │   │   │   │   └─ NOT\n" +
			"                 │   │   │   │       └─ Eq\n" +
			"                 │   │   │   │           ├─ l2.l_suppkey:18!null\n" +
			"                 │   │   │   │           └─ l1.l_suppkey:2!null\n" +
			"                 │   │   │   ├─ AntiJoin\n" +
			"                 │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   │   │   ├─ l3.l_orderkey:16!null\n" +
			"                 │   │   │   │   │   │   └─ l1.l_orderkey:0!null\n" +
			"                 │   │   │   │   │   └─ NOT\n" +
			"                 │   │   │   │   │       └─ Eq\n" +
			"                 │   │   │   │   │           ├─ l3.l_suppkey:18!null\n" +
			"                 │   │   │   │   │           └─ l1.l_suppkey:2!null\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ GreaterThan\n" +
			"                 │   │   │   │   │   │   ├─ l1.l_receiptdate:12!null\n" +
			"                 │   │   │   │   │   │   └─ l1.l_commitdate:11!null\n" +
			"                 │   │   │   │   │   └─ TableAlias(l1)\n" +
			"                 │   │   │   │   │       └─ ProcessTable\n" +
			"                 │   │   │   │   │           └─ Table\n" +
			"                 │   │   │   │   │               ├─ name: lineitem\n" +
			"                 │   │   │   │   │               └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 │   │   │   │   └─ Filter\n" +
			"                 │   │   │   │       ├─ GreaterThan\n" +
			"                 │   │   │   │       │   ├─ l3.l_receiptdate:12!null\n" +
			"                 │   │   │   │       │   └─ l3.l_commitdate:11!null\n" +
			"                 │   │   │   │       └─ TableAlias(l3)\n" +
			"                 │   │   │   │           └─ Table\n" +
			"                 │   │   │   │               ├─ name: lineitem\n" +
			"                 │   │   │   │               └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 │   │   │   └─ TableAlias(l2)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: lineitem\n" +
			"                 │   │   │           └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 │   │   └─ IndexedTableAccess(supplier)\n" +
			"                 │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: supplier\n" +
			"                 │   │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ orders.o_orderstatus:2!null\n" +
			"                 │       │   └─ F (longtext)\n" +
			"                 │       └─ IndexedTableAccess(orders)\n" +
			"                 │           ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: orders\n" +
			"                 │               └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ nation.n_name:1!null\n" +
			"                     │   └─ SAUDI ARABIA (longtext)\n" +
			"                     └─ IndexedTableAccess(nation)\n" +
			"                         ├─ index: [nation.N_NATIONKEY]\n" +
			"                         └─ Table\n" +
			"                             ├─ name: nation\n" +
			"                             └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"",
	},
	{
		Query: `
--Q22
select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('13', '31', '23', '29', '30', '18', '17')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('13', '31', '23', '29', '30', '18', '17')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [custsale.cntrycode:2!null, count(1):0!null as numcust, sum(custsale.c_acctbal):1!null as totacctbal]\n" +
			" └─ Sort(custsale.cntrycode:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, sum(custsale.c_acctbal):1!null, custsale.cntrycode:2!null, count(1):0!null as numcust, sum(custsale.c_acctbal):1!null as totacctbal]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), SUM(custsale.c_acctbal:1!null), custsale.cntrycode:0!null\n" +
			"             ├─ group: custsale.cntrycode:0!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: custsale\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [SUBSTRING(customer.c_phone, 1, 2) as cntrycode, customer.c_acctbal:5!null]\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [customer.c_custkey:0!null, customer.C_NAME:1!null, customer.C_ADDRESS:2!null, customer.C_NATIONKEY:3!null, customer.c_phone:4!null, customer.c_acctbal:5!null, customer.C_MKTSEGMENT:6!null, customer.C_COMMENT:7!null]\n" +
			"                         └─ Filter\n" +
			"                             ├─ orders.o_custkey:8!null IS NULL\n" +
			"                             └─ LeftOuterHashJoinExcludeNulls\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ orders.o_custkey:8!null\n" +
			"                                 │   └─ customer.c_custkey:0!null\n" +
			"                                 ├─ SemiJoin\n" +
			"                                 │   ├─ GreaterThan\n" +
			"                                 │   │   ├─ customer.c_acctbal:5!null\n" +
			"                                 │   │   └─ scalarSubq0.avg(c_acctbal):8\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ HashIn\n" +
			"                                 │   │   │   ├─ SUBSTRING(customer.c_phone, 1, 2)\n" +
			"                                 │   │   │   └─ TUPLE(13 (longtext), 31 (longtext), 23 (longtext), 29 (longtext), 30 (longtext), 18 (longtext), 17 (longtext))\n" +
			"                                 │   │   └─ Table\n" +
			"                                 │   │       ├─ name: customer\n" +
			"                                 │   │       └─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_mktsegment c_comment]\n" +
			"                                 │   └─ Max1Row\n" +
			"                                 │       └─ SubqueryAlias\n" +
			"                                 │           ├─ name: scalarSubq0\n" +
			"                                 │           ├─ outerVisibility: false\n" +
			"                                 │           ├─ cacheable: true\n" +
			"                                 │           └─ Project\n" +
			"                                 │               ├─ columns: [avg(customer.c_acctbal):0 as avg(c_acctbal)]\n" +
			"                                 │               └─ GroupBy\n" +
			"                                 │                   ├─ select: AVG(customer.c_acctbal:1!null)\n" +
			"                                 │                   ├─ group: \n" +
			"                                 │                   └─ Filter\n" +
			"                                 │                       ├─ AND\n" +
			"                                 │                       │   ├─ GreaterThan\n" +
			"                                 │                       │   │   ├─ customer.c_acctbal:1!null\n" +
			"                                 │                       │   │   └─ 0 (decimal(3,2))\n" +
			"                                 │                       │   └─ HashIn\n" +
			"                                 │                       │       ├─ SUBSTRING(customer.c_phone, 1, 2)\n" +
			"                                 │                       │       └─ TUPLE(13 (longtext), 31 (longtext), 23 (longtext), 29 (longtext), 30 (longtext), 18 (longtext), 17 (longtext))\n" +
			"                                 │                       └─ Table\n" +
			"                                 │                           ├─ name: customer\n" +
			"                                 │                           └─ columns: [c_phone c_acctbal]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(customer.c_custkey:0!null)\n" +
			"                                     ├─ right-key: TUPLE(orders.o_custkey:0!null)\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [orders.o_custkey:1!null]\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: orders\n" +
			"                                             └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"",
	},
}
