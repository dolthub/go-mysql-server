// Code generated by plangen.

// Copyright 2025 Dolthub, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package queries

var TpchPlanTests = []QueryPlanTest{
	{
		Query: `
--(Q1)
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= '1998-12-01' - interval '90' day
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_returnflag:8!null, lineitem.l_linestatus:9!null, sum(lineitem.l_quantity):7!null->sum_qty:0, sum(lineitem.l_extendedprice):6!null->sum_base_price:0, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):5!null->sum_disc_price:0, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))):4!null->sum_charge:0, avg(lineitem.l_quantity):2->avg_qty:0, avg(lineitem.l_extendedprice):1->avg_price:0, avg(lineitem.l_discount):0->avg_disc:0, count(1):3!null->count_order:0]\n" +
			" └─ Sort(lineitem.l_returnflag:8!null ASC nullsFirst, lineitem.l_linestatus:9!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: AVG(lineitem.l_discount:2!null), AVG(lineitem.l_extendedprice:1!null), AVG(lineitem.l_quantity:0!null), COUNT(1 (bigint)), SUM(((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null)) * (1 (tinyint) + lineitem.l_tax:3!null))), SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), SUM(lineitem.l_extendedprice:1!null), SUM(lineitem.l_quantity:0!null), lineitem.l_returnflag:4!null, lineitem.l_linestatus:5!null\n" +
			"         ├─ group: lineitem.l_returnflag:4!null, lineitem.l_linestatus:5!null\n" +
			"         └─ Filter\n" +
			"             ├─ LessThanOrEqual\n" +
			"             │   ├─ lineitem.l_shipdate:6!null\n" +
			"             │   └─ 1998-09-02 00:00:00 +0000 UTC (datetime)\n" +
			"             └─ ProcessTable\n" +
			"                 └─ Table\n" +
			"                     ├─ name: lineitem\n" +
			"                     └─ columns: [l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [lineitem.l_returnflag, lineitem.l_linestatus, sum(lineitem.l_quantity) as sum_qty, sum(lineitem.l_extendedprice) as sum_base_price, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as sum_disc_price, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))) as sum_charge, avg(lineitem.l_quantity) as avg_qty, avg(lineitem.l_extendedprice) as avg_price, avg(lineitem.l_discount) as avg_disc, count(1) as count_order]\n" +
			" └─ Sort(lineitem.l_returnflag ASC, lineitem.l_linestatus ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(AVG(lineitem.l_discount), AVG(lineitem.l_extendedprice), AVG(lineitem.l_quantity), COUNT(1), SUM(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))), SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), SUM(lineitem.l_extendedprice), SUM(lineitem.l_quantity), lineitem.l_returnflag, lineitem.l_linestatus)\n" +
			"         ├─ Grouping(lineitem.l_returnflag, lineitem.l_linestatus)\n" +
			"         └─ Filter\n" +
			"             ├─ (lineitem.l_shipdate <= 1998-09-02 00:00:00 +0000 UTC)\n" +
			"             └─ Table\n" +
			"                 ├─ name: lineitem\n" +
			"                 └─ columns: [l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [lineitem.l_returnflag, lineitem.l_linestatus, sum(lineitem.l_quantity) as sum_qty, sum(lineitem.l_extendedprice) as sum_base_price, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as sum_disc_price, sum(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))) as sum_charge, avg(lineitem.l_quantity) as avg_qty, avg(lineitem.l_extendedprice) as avg_price, avg(lineitem.l_discount) as avg_disc, count(1) as count_order]\n" +
			" └─ Sort(lineitem.l_returnflag ASC, lineitem.l_linestatus ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(AVG(lineitem.l_discount), AVG(lineitem.l_extendedprice), AVG(lineitem.l_quantity), COUNT(1), SUM(((lineitem.l_extendedprice * (1 - lineitem.l_discount)) * (1 + lineitem.l_tax))), SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), SUM(lineitem.l_extendedprice), SUM(lineitem.l_quantity), lineitem.l_returnflag, lineitem.l_linestatus)\n" +
			"         ├─ Grouping(lineitem.l_returnflag, lineitem.l_linestatus)\n" +
			"         └─ Filter\n" +
			"             ├─ (lineitem.l_shipdate <= 1998-09-02 00:00:00 +0000 UTC)\n" +
			"             └─ Table\n" +
			"                 ├─ name: lineitem\n" +
			"                 └─ columns: [l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate]\n" +
			"",
	},
	{
		Query: `
--(Q2)
select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 15
	and p_type like '%BRASS'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_acctbal:19!null, supplier.s_name:15!null, nation.n_name:22!null, part.p_partkey:0!null, part.p_mfgr:2!null, supplier.s_address:16!null, supplier.s_phone:18!null, supplier.s_comment:20!null]\n" +
			" └─ Sort(supplier.s_acctbal:19!null DESC nullsFirst, nation.n_name:22!null ASC nullsFirst, supplier.s_name:15!null ASC nullsFirst, part.p_partkey:0!null ASC nullsFirst)\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ partsupp.ps_supplycost:12!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: false\n" +
			"         │       ├─ alias-string: select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE'\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [min(partsupp.ps_supplycost):28!null->min(ps_supplycost):0]\n" +
			"         │           └─ GroupBy\n" +
			"         │               ├─ select: MIN(partsupp.ps_supplycost:30!null)\n" +
			"         │               ├─ group: \n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ part.p_partkey:0!null\n" +
			"         │                   │   └─ partsupp.ps_partkey:28!null\n" +
			"         │                   └─ LookupJoin\n" +
			"         │                       ├─ LookupJoin\n" +
			"         │                       │   ├─ LookupJoin\n" +
			"         │                       │   │   ├─ Table\n" +
			"         │                       │   │   │   ├─ name: partsupp\n" +
			"         │                       │   │   │   ├─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"         │                       │   │   │   ├─ colSet: (29-33)\n" +
			"         │                       │   │   │   └─ tableId: 6\n" +
			"         │                       │   │   └─ IndexedTableAccess(supplier)\n" +
			"         │                       │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │                       │   │       ├─ keys: [partsupp.ps_suppkey:29!null]\n" +
			"         │                       │   │       ├─ colSet: (34-40)\n" +
			"         │                       │   │       ├─ tableId: 7\n" +
			"         │                       │   │       └─ Table\n" +
			"         │                       │   │           ├─ name: supplier\n" +
			"         │                       │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"         │                       │   └─ IndexedTableAccess(nation)\n" +
			"         │                       │       ├─ index: [nation.N_NATIONKEY]\n" +
			"         │                       │       ├─ keys: [supplier.s_nationkey:32!null]\n" +
			"         │                       │       ├─ colSet: (41-44)\n" +
			"         │                       │       ├─ tableId: 8\n" +
			"         │                       │       └─ Table\n" +
			"         │                       │           ├─ name: nation\n" +
			"         │                       │           └─ columns: [n_nationkey n_regionkey]\n" +
			"         │                       └─ Filter\n" +
			"         │                           ├─ Eq\n" +
			"         │                           │   ├─ region.r_name:29!null\n" +
			"         │                           │   └─ EUROPE (longtext)\n" +
			"         │                           └─ IndexedTableAccess(region)\n" +
			"         │                               ├─ index: [region.R_REGIONKEY]\n" +
			"         │                               ├─ keys: [nation.n_regionkey:34!null]\n" +
			"         │                               ├─ colSet: (45-47)\n" +
			"         │                               ├─ tableId: 9\n" +
			"         │                               └─ Table\n" +
			"         │                                   ├─ name: region\n" +
			"         │                                   └─ columns: [r_regionkey r_name]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ LookupJoin\n" +
			"             │   │   ├─ MergeJoin\n" +
			"             │   │   │   ├─ cmp: Eq\n" +
			"             │   │   │   │   ├─ part.p_partkey:0!null\n" +
			"             │   │   │   │   └─ partsupp.ps_partkey:9!null\n" +
			"             │   │   │   ├─ Filter\n" +
			"             │   │   │   │   ├─ AND\n" +
			"             │   │   │   │   │   ├─ Eq\n" +
			"             │   │   │   │   │   │   ├─ part.p_size:5!null\n" +
			"             │   │   │   │   │   │   └─ 15 (int)\n" +
			"             │   │   │   │   │   └─ part.p_type LIKE '%BRASS'\n" +
			"             │   │   │   │   └─ IndexedTableAccess(part)\n" +
			"             │   │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"             │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │   │       ├─ colSet: (1-9)\n" +
			"             │   │   │   │       ├─ tableId: 1\n" +
			"             │   │   │   │       └─ Table\n" +
			"             │   │   │   │           ├─ name: part\n" +
			"             │   │   │   │           └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"             │   │   │   └─ IndexedTableAccess(partsupp)\n" +
			"             │   │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"             │   │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   │   │       ├─ colSet: (17-21)\n" +
			"             │   │   │       ├─ tableId: 3\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: partsupp\n" +
			"             │   │   │           └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"             │   │   └─ IndexedTableAccess(supplier)\n" +
			"             │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"             │   │       ├─ keys: [partsupp.ps_suppkey:10!null]\n" +
			"             │   │       ├─ colSet: (10-16)\n" +
			"             │   │       ├─ tableId: 2\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: supplier\n" +
			"             │   │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"             │   └─ IndexedTableAccess(nation)\n" +
			"             │       ├─ index: [nation.N_NATIONKEY]\n" +
			"             │       ├─ keys: [supplier.s_nationkey:17!null]\n" +
			"             │       ├─ colSet: (22-25)\n" +
			"             │       ├─ tableId: 4\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: nation\n" +
			"             │           └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ region.r_name:1!null\n" +
			"                 │   └─ EUROPE (longtext)\n" +
			"                 └─ IndexedTableAccess(region)\n" +
			"                     ├─ index: [region.R_REGIONKEY]\n" +
			"                     ├─ keys: [nation.n_regionkey:23!null]\n" +
			"                     ├─ colSet: (26-28)\n" +
			"                     ├─ tableId: 5\n" +
			"                     └─ Table\n" +
			"                         ├─ name: region\n" +
			"                         └─ columns: [r_regionkey r_name r_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [supplier.s_acctbal, supplier.s_name, nation.n_name, part.p_partkey, part.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment]\n" +
			" └─ Sort(supplier.s_acctbal DESC, nation.n_name ASC, supplier.s_name ASC, part.p_partkey ASC)\n" +
			"     └─ Filter\n" +
			"         ├─ (partsupp.ps_supplycost = Subquery(select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE'))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ LookupJoin\n" +
			"             │   │   ├─ MergeJoin\n" +
			"             │   │   │   ├─ cmp: (part.p_partkey = partsupp.ps_partkey)\n" +
			"             │   │   │   ├─ Filter\n" +
			"             │   │   │   │   ├─ ((part.p_size = 15) AND part.p_type LIKE '%BRASS')\n" +
			"             │   │   │   │   └─ IndexedTableAccess(part)\n" +
			"             │   │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"             │   │   │   │       └─ filters: [{[NULL, ∞)}]\n" +
			"             │   │   │   └─ IndexedTableAccess(partsupp)\n" +
			"             │   │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"             │   │   │       └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   │   └─ IndexedTableAccess(supplier)\n" +
			"             │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"             │   │       └─ keys: partsupp.ps_suppkey\n" +
			"             │   └─ IndexedTableAccess(nation)\n" +
			"             │       ├─ index: [nation.N_NATIONKEY]\n" +
			"             │       └─ keys: supplier.s_nationkey\n" +
			"             └─ Filter\n" +
			"                 ├─ (region.r_name = 'EUROPE')\n" +
			"                 └─ IndexedTableAccess(region)\n" +
			"                     ├─ index: [region.R_REGIONKEY]\n" +
			"                     └─ keys: nation.n_regionkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [supplier.s_acctbal, supplier.s_name, nation.n_name, part.p_partkey, part.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment]\n" +
			" └─ Sort(supplier.s_acctbal DESC, nation.n_name ASC, supplier.s_name ASC, part.p_partkey ASC)\n" +
			"     └─ Filter\n" +
			"         ├─ (partsupp.ps_supplycost = Subquery(select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE'))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ LookupJoin\n" +
			"             │   │   ├─ MergeJoin\n" +
			"             │   │   │   ├─ cmp: (part.p_partkey = partsupp.ps_partkey)\n" +
			"             │   │   │   ├─ Filter\n" +
			"             │   │   │   │   ├─ ((part.p_size = 15) AND part.p_type LIKE '%BRASS')\n" +
			"             │   │   │   │   └─ IndexedTableAccess(part)\n" +
			"             │   │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"             │   │   │   │       └─ filters: [{[NULL, ∞)}]\n" +
			"             │   │   │   └─ IndexedTableAccess(partsupp)\n" +
			"             │   │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"             │   │   │       └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   │   └─ IndexedTableAccess(supplier)\n" +
			"             │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"             │   │       └─ keys: partsupp.ps_suppkey\n" +
			"             │   └─ IndexedTableAccess(nation)\n" +
			"             │       ├─ index: [nation.N_NATIONKEY]\n" +
			"             │       └─ keys: supplier.s_nationkey\n" +
			"             └─ Filter\n" +
			"                 ├─ (region.r_name = 'EUROPE')\n" +
			"                 └─ IndexedTableAccess(region)\n" +
			"                     ├─ index: [region.R_REGIONKEY]\n" +
			"                     └─ keys: nation.n_regionkey\n" +
			"",
	},
	{
		Query: `
--Q3
select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'BUILDING'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-15'
	and l_shipdate > '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_orderkey:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0, orders.o_orderdate:2!null, orders.o_shippriority:3!null]\n" +
			" └─ Sort(revenue:4!null DESC nullsFirst, orders.o_orderdate:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, lineitem.l_orderkey:1!null, orders.o_orderdate:2!null, orders.o_shippriority:3!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:5!null * (1 (tinyint) - lineitem.l_discount:6!null))), lineitem.l_orderkey:4!null, orders.o_orderdate:2!null, orders.o_shippriority:3!null\n" +
			"             ├─ group: lineitem.l_orderkey:4!null, orders.o_orderdate:2!null, orders.o_shippriority:3!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ orders.o_orderkey:0!null\n" +
			"                 │   │   └─ lineitem.l_orderkey:4!null\n" +
			"                 │   ├─ Filter\n" +
			"                 │   │   ├─ LessThan\n" +
			"                 │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   └─ 1995-03-15 (longtext)\n" +
			"                 │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │       ├─ colSet: (9-17)\n" +
			"                 │   │       ├─ tableId: 2\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: orders\n" +
			"                 │   │           └─ columns: [o_orderkey o_custkey o_orderdate o_shippriority]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ GreaterThan\n" +
			"                 │       │   ├─ lineitem.l_shipdate:3!null\n" +
			"                 │       │   └─ 1995-03-15 (longtext)\n" +
			"                 │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │           ├─ colSet: (18-33)\n" +
			"                 │           ├─ tableId: 3\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: lineitem\n" +
			"                 │               └─ columns: [l_orderkey l_extendedprice l_discount l_shipdate]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ customer.c_mktsegment:1!null\n" +
			"                     │   └─ BUILDING (longtext)\n" +
			"                     └─ IndexedTableAccess(customer)\n" +
			"                         ├─ index: [customer.C_CUSTKEY]\n" +
			"                         ├─ keys: [orders.o_custkey:1!null]\n" +
			"                         ├─ colSet: (1-8)\n" +
			"                         ├─ tableId: 1\n" +
			"                         └─ Table\n" +
			"                             ├─ name: customer\n" +
			"                             └─ columns: [c_custkey c_mktsegment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [lineitem.l_orderkey, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue, orders.o_orderdate, orders.o_shippriority]\n" +
			" └─ Sort(revenue DESC, orders.o_orderdate ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority)\n" +
			"             ├─ Grouping(lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 │   ├─ Filter\n" +
			"                 │   │   ├─ (orders.o_orderdate < '1995-03-15')\n" +
			"                 │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [o_orderkey o_custkey o_orderdate o_shippriority]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (lineitem.l_shipdate > '1995-03-15')\n" +
			"                 │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │           ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │           └─ columns: [l_orderkey l_extendedprice l_discount l_shipdate]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (customer.c_mktsegment = 'BUILDING')\n" +
			"                     └─ IndexedTableAccess(customer)\n" +
			"                         ├─ index: [customer.C_CUSTKEY]\n" +
			"                         ├─ columns: [c_custkey c_mktsegment]\n" +
			"                         └─ keys: orders.o_custkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [lineitem.l_orderkey, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue, orders.o_orderdate, orders.o_shippriority]\n" +
			" └─ Sort(revenue DESC, orders.o_orderdate ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority)\n" +
			"             ├─ Grouping(lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 │   ├─ Filter\n" +
			"                 │   │   ├─ (orders.o_orderdate < '1995-03-15')\n" +
			"                 │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [o_orderkey o_custkey o_orderdate o_shippriority]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (lineitem.l_shipdate > '1995-03-15')\n" +
			"                 │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │           ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │           └─ columns: [l_orderkey l_extendedprice l_discount l_shipdate]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (customer.c_mktsegment = 'BUILDING')\n" +
			"                     └─ IndexedTableAccess(customer)\n" +
			"                         ├─ index: [customer.C_CUSTKEY]\n" +
			"                         ├─ columns: [c_custkey c_mktsegment]\n" +
			"                         └─ keys: orders.o_custkey\n" +
			"",
	},
	{
		Query: `
--Q4
select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= '1993-07-01'
	and o_orderdate < '1993-07-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [orders.o_orderpriority:1!null, count(1):0!null->order_count:0]\n" +
			" └─ Sort(orders.o_orderpriority:1!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: COUNT(1 (bigint)), orders.o_orderpriority:5!null\n" +
			"         ├─ group: orders.o_orderpriority:5!null\n" +
			"         └─ Project\n" +
			"             ├─ columns: [orders.O_ORDERKEY:0!null, orders.O_CUSTKEY:1!null, orders.O_ORDERSTATUS:2!null, orders.O_TOTALPRICE:3!null, orders.O_ORDERDATE:4!null, orders.O_ORDERPRIORITY:5!null, orders.O_CLERK:6!null, orders.O_SHIPPRIORITY:7!null, orders.O_COMMENT:8!null]\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ orders.o_orderkey:0!null\n" +
			"                 │   └─ lineitem.l_orderkey:9!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   ├─ orders.o_orderdate:4!null\n" +
			"                 │   │   │   └─ 1993-07-01 (longtext)\n" +
			"                 │   │   └─ LessThan\n" +
			"                 │   │       ├─ orders.o_orderdate:4!null\n" +
			"                 │   │       └─ 1993-10-01 00:00:00 +0000 UTC (datetime)\n" +
			"                 │   └─ IndexedTableAccess(orders)\n" +
			"                 │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │       ├─ colSet: (1-9)\n" +
			"                 │       ├─ tableId: 1\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: orders\n" +
			"                 │           └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [lineitem.l_orderkey:0!null]\n" +
			"                     └─ Filter\n" +
			"                         ├─ LessThan\n" +
			"                         │   ├─ lineitem.l_commitdate:11!null\n" +
			"                         │   └─ lineitem.l_receiptdate:12!null\n" +
			"                         └─ IndexedTableAccess(lineitem)\n" +
			"                             ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                             ├─ colSet: (10-25)\n" +
			"                             ├─ tableId: 2\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: lineitem\n" +
			"                                 └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [orders.o_orderpriority, count(1) as order_count]\n" +
			" └─ Sort(orders.o_orderpriority ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(COUNT(1), orders.o_orderpriority)\n" +
			"         ├─ Grouping(orders.o_orderpriority)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [orders.O_ORDERKEY, orders.O_CUSTKEY, orders.O_ORDERSTATUS, orders.O_TOTALPRICE, orders.O_ORDERDATE, orders.O_ORDERPRIORITY, orders.O_CLERK, orders.O_SHIPPRIORITY, orders.O_COMMENT]\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((orders.o_orderdate >= '1993-07-01') AND (orders.o_orderdate < 1993-10-01 00:00:00 +0000 UTC))\n" +
			"                 │   └─ IndexedTableAccess(orders)\n" +
			"                 │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │       └─ filters: [{[NULL, ∞)}]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [lineitem.l_orderkey]\n" +
			"                     └─ Filter\n" +
			"                         ├─ (lineitem.l_commitdate < lineitem.l_receiptdate)\n" +
			"                         └─ IndexedTableAccess(lineitem)\n" +
			"                             ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                             ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                             └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [orders.o_orderpriority, count(1) as order_count]\n" +
			" └─ Sort(orders.o_orderpriority ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(COUNT(1), orders.o_orderpriority)\n" +
			"         ├─ Grouping(orders.o_orderpriority)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [orders.O_ORDERKEY, orders.O_CUSTKEY, orders.O_ORDERSTATUS, orders.O_TOTALPRICE, orders.O_ORDERDATE, orders.O_ORDERPRIORITY, orders.O_CLERK, orders.O_SHIPPRIORITY, orders.O_COMMENT]\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((orders.o_orderdate >= '1993-07-01') AND (orders.o_orderdate < 1993-10-01 00:00:00 +0000 UTC))\n" +
			"                 │   └─ IndexedTableAccess(orders)\n" +
			"                 │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │       └─ filters: [{[NULL, ∞)}]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [lineitem.l_orderkey]\n" +
			"                     └─ Filter\n" +
			"                         ├─ (lineitem.l_commitdate < lineitem.l_receiptdate)\n" +
			"                         └─ IndexedTableAccess(lineitem)\n" +
			"                             ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                             ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                             └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"",
	},
	{
		Query: `
--Q5
select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'ASIA'
	and o_orderdate >= '1994-01-01'
	and o_orderdate < '1994-01-01' + interval '1' year
group by
	n_name
order by
	revenue desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [nation.n_name:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0]\n" +
			" └─ Sort(revenue:2!null DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, nation.n_name:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:12!null * (1 (tinyint) - lineitem.l_discount:13!null))), nation.n_name:6!null\n" +
			"             ├─ group: nation.n_name:6!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ customer.c_nationkey:4!null\n" +
			"                 │   │   └─ supplier.s_nationkey:15!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ supplier.s_nationkey:15!null\n" +
			"                 │       └─ nation.n_nationkey:5!null\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ LookupJoin\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │   │   │   │   └─ 1994-01-01 (longtext)\n" +
			"                 │   │   │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │   │   │       ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │   │   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime)\n" +
			"                 │   │   │   │   │   └─ ProcessTable\n" +
			"                 │   │   │   │   │       └─ Table\n" +
			"                 │   │   │   │   │           ├─ name: orders\n" +
			"                 │   │   │   │   │           └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                 │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │   │   │   │       ├─ keys: [orders.o_custkey:1!null]\n" +
			"                 │   │   │   │       ├─ colSet: (1-8)\n" +
			"                 │   │   │   │       ├─ tableId: 1\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: customer\n" +
			"                 │   │   │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                 │   │   │   └─ IndexedTableAccess(nation)\n" +
			"                 │   │   │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │   │       ├─ keys: [customer.c_nationkey:4!null]\n" +
			"                 │   │   │       ├─ colSet: (41-44)\n" +
			"                 │   │   │       ├─ tableId: 5\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: nation\n" +
			"                 │   │   │           └─ columns: [n_nationkey n_name n_regionkey]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ region.r_name:1!null\n" +
			"                 │   │       │   └─ ASIA (longtext)\n" +
			"                 │   │       └─ IndexedTableAccess(region)\n" +
			"                 │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                 │   │           ├─ keys: [nation.n_regionkey:7!null]\n" +
			"                 │   │           ├─ colSet: (45-47)\n" +
			"                 │   │           ├─ tableId: 6\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: region\n" +
			"                 │   │               └─ columns: [r_regionkey r_name]\n" +
			"                 │   └─ IndexedTableAccess(lineitem)\n" +
			"                 │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │       ├─ keys: [orders.o_orderkey:0!null]\n" +
			"                 │       ├─ colSet: (18-33)\n" +
			"                 │       ├─ tableId: 3\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: lineitem\n" +
			"                 │           └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount]\n" +
			"                 └─ IndexedTableAccess(supplier)\n" +
			"                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     ├─ keys: [lineitem.l_suppkey:11!null]\n" +
			"                     ├─ colSet: (34-40)\n" +
			"                     ├─ tableId: 4\n" +
			"                     └─ Table\n" +
			"                         ├─ name: supplier\n" +
			"                         └─ columns: [s_suppkey s_nationkey]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [nation.n_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			" └─ Sort(revenue DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), nation.n_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), nation.n_name)\n" +
			"             ├─ Grouping(nation.n_name)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ ((customer.c_nationkey = supplier.s_nationkey) AND (supplier.s_nationkey = nation.n_nationkey))\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ LookupJoin\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ ((orders.o_orderdate >= '1994-01-01') AND (orders.o_orderdate < 1995-01-01 00:00:00 +0000 UTC))\n" +
			"                 │   │   │   │   │   └─ Table\n" +
			"                 │   │   │   │   │       ├─ name: orders\n" +
			"                 │   │   │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                 │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │   │   │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                 │   │   │   │       └─ keys: orders.o_custkey\n" +
			"                 │   │   │   └─ IndexedTableAccess(nation)\n" +
			"                 │   │   │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │   │       ├─ columns: [n_nationkey n_name n_regionkey]\n" +
			"                 │   │   │       └─ keys: customer.c_nationkey\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (region.r_name = 'ASIA')\n" +
			"                 │   │       └─ IndexedTableAccess(region)\n" +
			"                 │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                 │   │           ├─ columns: [r_regionkey r_name]\n" +
			"                 │   │           └─ keys: nation.n_regionkey\n" +
			"                 │   └─ IndexedTableAccess(lineitem)\n" +
			"                 │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │       ├─ columns: [l_orderkey l_suppkey l_extendedprice l_discount]\n" +
			"                 │       └─ keys: orders.o_orderkey\n" +
			"                 └─ IndexedTableAccess(supplier)\n" +
			"                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     └─ keys: lineitem.l_suppkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [nation.n_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			" └─ Sort(revenue DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), nation.n_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), nation.n_name)\n" +
			"             ├─ Grouping(nation.n_name)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ ((customer.c_nationkey = supplier.s_nationkey) AND (supplier.s_nationkey = nation.n_nationkey))\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ LookupJoin\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ ((orders.o_orderdate >= '1994-01-01') AND (orders.o_orderdate < 1995-01-01 00:00:00 +0000 UTC))\n" +
			"                 │   │   │   │   │   └─ Table\n" +
			"                 │   │   │   │   │       ├─ name: orders\n" +
			"                 │   │   │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                 │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │   │   │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                 │   │   │   │       └─ keys: orders.o_custkey\n" +
			"                 │   │   │   └─ IndexedTableAccess(nation)\n" +
			"                 │   │   │       ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │   │       ├─ columns: [n_nationkey n_name n_regionkey]\n" +
			"                 │   │   │       └─ keys: customer.c_nationkey\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (region.r_name = 'ASIA')\n" +
			"                 │   │       └─ IndexedTableAccess(region)\n" +
			"                 │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                 │   │           ├─ columns: [r_regionkey r_name]\n" +
			"                 │   │           └─ keys: nation.n_regionkey\n" +
			"                 │   └─ IndexedTableAccess(lineitem)\n" +
			"                 │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │       ├─ columns: [l_orderkey l_suppkey l_extendedprice l_discount]\n" +
			"                 │       └─ keys: orders.o_orderkey\n" +
			"                 └─ IndexedTableAccess(supplier)\n" +
			"                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     └─ keys: lineitem.l_suppkey\n" +
			"",
	},
	{
		Query: `
--Q6
select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= '1994-01-01'
	and l_shipdate < '1994-01-01' + interval '1' year
	and l_discount between .06 - 0.01 and .06 + 0.01
	and l_quantity < 24;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * lineitem.l_discount)):0!null->revenue:0]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:1!null * lineitem.l_discount:2!null))\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │   │   └─ 1994-01-01 (longtext)\n" +
			"         │   │   │   └─ LessThan\n" +
			"         │   │   │       ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime)\n" +
			"         │   │   └─ AND\n" +
			"         │   │       ├─ GreaterThanOrEqual\n" +
			"         │   │       │   ├─ lineitem.l_discount:2!null\n" +
			"         │   │       │   └─ 0.05 (decimal(5,2))\n" +
			"         │   │       └─ LessThanOrEqual\n" +
			"         │   │           ├─ lineitem.l_discount:2!null\n" +
			"         │   │           └─ 0.07 (decimal(5,2))\n" +
			"         │   └─ LessThan\n" +
			"         │       ├─ lineitem.l_quantity:0!null\n" +
			"         │       └─ 24 (tinyint)\n" +
			"         └─ ProcessTable\n" +
			"             └─ Table\n" +
			"                 ├─ name: lineitem\n" +
			"                 └─ columns: [l_quantity l_extendedprice l_discount l_shipdate]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * lineitem.l_discount)) as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * lineitem.l_discount)))\n" +
			"     ├─ Grouping()\n" +
			"     └─ Filter\n" +
			"         ├─ ((((lineitem.l_shipdate >= '1994-01-01') AND (lineitem.l_shipdate < 1995-01-01 00:00:00 +0000 UTC)) AND ((lineitem.l_discount >= 0.05) AND (lineitem.l_discount <= 0.07))) AND (lineitem.l_quantity < 24))\n" +
			"         └─ Table\n" +
			"             ├─ name: lineitem\n" +
			"             └─ columns: [l_quantity l_extendedprice l_discount l_shipdate]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * lineitem.l_discount)) as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * lineitem.l_discount)))\n" +
			"     ├─ Grouping()\n" +
			"     └─ Filter\n" +
			"         ├─ ((((lineitem.l_shipdate >= '1994-01-01') AND (lineitem.l_shipdate < 1995-01-01 00:00:00 +0000 UTC)) AND ((lineitem.l_discount >= 0.05) AND (lineitem.l_discount <= 0.07))) AND (lineitem.l_quantity < 24))\n" +
			"         └─ Table\n" +
			"             ├─ name: lineitem\n" +
			"             └─ columns: [l_quantity l_extendedprice l_discount l_shipdate]\n" +
			"",
	},
	{
		Query: `
--Q7
select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')
			)
			and l_shipdate between '1995-01-01' and '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [shipping.supp_nation:1!null, shipping.cust_nation:2!null, shipping.l_year:3!null, sum(shipping.volume):0!null->revenue:0]\n" +
			" └─ Sort(shipping.supp_nation:1!null ASC nullsFirst, shipping.cust_nation:2!null ASC nullsFirst, shipping.l_year:3!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(shipping.volume:3!null), shipping.supp_nation:0!null, shipping.cust_nation:1!null, shipping.l_year:2!null\n" +
			"         ├─ group: shipping.supp_nation:0!null, shipping.cust_nation:1!null, shipping.l_year:2!null\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: shipping\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             ├─ colSet: (53-56)\n" +
			"             ├─ tableId: 7\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [n1.n_name:12!null->supp_nation:0, n2.n_name:14!null->cust_nation:0, extract('YEAR' from lineitem.l_shipdate)->l_year:0, (lineitem.l_extendedprice:2!null * (1 (tinyint) - lineitem.l_discount:3!null))->volume:0]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Or\n" +
			"                     │   ├─ AND\n" +
			"                     │   │   ├─ Eq\n" +
			"                     │   │   │   ├─ n1.n_name:12!null\n" +
			"                     │   │   │   └─ FRANCE (longtext)\n" +
			"                     │   │   └─ Eq\n" +
			"                     │   │       ├─ n2.n_name:14!null\n" +
			"                     │   │       └─ GERMANY (longtext)\n" +
			"                     │   └─ AND\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ n1.n_name:12!null\n" +
			"                     │       │   └─ GERMANY (longtext)\n" +
			"                     │       └─ Eq\n" +
			"                     │           ├─ n2.n_name:14!null\n" +
			"                     │           └─ FRANCE (longtext)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ LookupJoin\n" +
			"                         │   │   │   ├─ MergeJoin\n" +
			"                         │   │   │   │   ├─ cmp: Eq\n" +
			"                         │   │   │   │   │   ├─ lineitem.l_orderkey:0!null\n" +
			"                         │   │   │   │   │   └─ orders.o_orderkey:5!null\n" +
			"                         │   │   │   │   ├─ Filter\n" +
			"                         │   │   │   │   │   ├─ AND\n" +
			"                         │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                         │   │   │   │   │   │   │   ├─ lineitem.l_shipdate:4!null\n" +
			"                         │   │   │   │   │   │   │   └─ 1995-01-01 (longtext)\n" +
			"                         │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                         │   │   │   │   │   │       ├─ lineitem.l_shipdate:4!null\n" +
			"                         │   │   │   │   │   │       └─ 1996-12-31 (longtext)\n" +
			"                         │   │   │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                         │   │   │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         │   │   │   │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   │   │   │   │       ├─ colSet: (8-23)\n" +
			"                         │   │   │   │   │       ├─ tableId: 2\n" +
			"                         │   │   │   │   │       └─ Table\n" +
			"                         │   │   │   │   │           ├─ name: lineitem\n" +
			"                         │   │   │   │   │           └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"                         │   │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                         │   │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                         │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                         │   │   │   │       ├─ colSet: (24-32)\n" +
			"                         │   │   │   │       ├─ tableId: 3\n" +
			"                         │   │   │   │       └─ Table\n" +
			"                         │   │   │   │           ├─ name: orders\n" +
			"                         │   │   │   │           └─ columns: [o_orderkey o_custkey]\n" +
			"                         │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                         │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                         │   │   │       ├─ keys: [lineitem.l_suppkey:1!null]\n" +
			"                         │   │   │       ├─ colSet: (1-7)\n" +
			"                         │   │   │       ├─ tableId: 1\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: supplier\n" +
			"                         │   │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                         │   │   └─ IndexedTableAccess(customer)\n" +
			"                         │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                         │   │       ├─ keys: [orders.o_custkey:6!null]\n" +
			"                         │   │       ├─ colSet: (33-40)\n" +
			"                         │   │       ├─ tableId: 4\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: customer\n" +
			"                         │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                         │   └─ TableAlias(n1)\n" +
			"                         │       └─ IndexedTableAccess(nation)\n" +
			"                         │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │           ├─ keys: [supplier.s_nationkey:8!null]\n" +
			"                         │           ├─ colSet: (41-44)\n" +
			"                         │           ├─ tableId: 5\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: nation\n" +
			"                         │               └─ columns: [n_nationkey n_name]\n" +
			"                         └─ TableAlias(n2)\n" +
			"                             └─ IndexedTableAccess(nation)\n" +
			"                                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                                 ├─ keys: [customer.c_nationkey:10!null]\n" +
			"                                 ├─ colSet: (45-48)\n" +
			"                                 ├─ tableId: 6\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: nation\n" +
			"                                     └─ columns: [n_nationkey n_name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [shipping.supp_nation, shipping.cust_nation, shipping.l_year, sum(shipping.volume) as revenue]\n" +
			" └─ Sort(shipping.supp_nation ASC, shipping.cust_nation ASC, shipping.l_year ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(shipping.volume), shipping.supp_nation, shipping.cust_nation, shipping.l_year)\n" +
			"         ├─ Grouping(shipping.supp_nation, shipping.cust_nation, shipping.l_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: shipping\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [n1.n_name as supp_nation, n2.n_name as cust_nation, extract('YEAR' from lineitem.l_shipdate) as l_year, (lineitem.l_extendedprice * (1 - lineitem.l_discount)) as volume]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (((n1.n_name = 'FRANCE') AND (n2.n_name = 'GERMANY')) OR ((n1.n_name = 'GERMANY') AND (n2.n_name = 'FRANCE')))\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ LookupJoin\n" +
			"                         │   │   │   ├─ MergeJoin\n" +
			"                         │   │   │   │   ├─ cmp: (lineitem.l_orderkey = orders.o_orderkey)\n" +
			"                         │   │   │   │   ├─ Filter\n" +
			"                         │   │   │   │   │   ├─ ((lineitem.l_shipdate >= '1995-01-01') AND (lineitem.l_shipdate <= '1996-12-31'))\n" +
			"                         │   │   │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                         │   │   │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         │   │   │   │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   │   │   │   │       └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"                         │   │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                         │   │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                         │   │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                         │   │   │   │       └─ columns: [o_orderkey o_custkey]\n" +
			"                         │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                         │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                         │   │   │       ├─ columns: [s_suppkey s_nationkey]\n" +
			"                         │   │   │       └─ keys: lineitem.l_suppkey\n" +
			"                         │   │   └─ IndexedTableAccess(customer)\n" +
			"                         │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                         │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                         │   │       └─ keys: orders.o_custkey\n" +
			"                         │   └─ TableAlias(n1)\n" +
			"                         │       └─ IndexedTableAccess(nation)\n" +
			"                         │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │           ├─ columns: [n_nationkey n_name]\n" +
			"                         │           └─ keys: supplier.s_nationkey\n" +
			"                         └─ TableAlias(n2)\n" +
			"                             └─ IndexedTableAccess(nation)\n" +
			"                                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                                 ├─ columns: [n_nationkey n_name]\n" +
			"                                 └─ keys: customer.c_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [shipping.supp_nation, shipping.cust_nation, shipping.l_year, sum(shipping.volume) as revenue]\n" +
			" └─ Sort(shipping.supp_nation ASC, shipping.cust_nation ASC, shipping.l_year ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(shipping.volume), shipping.supp_nation, shipping.cust_nation, shipping.l_year)\n" +
			"         ├─ Grouping(shipping.supp_nation, shipping.cust_nation, shipping.l_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: shipping\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [n1.n_name as supp_nation, n2.n_name as cust_nation, extract('YEAR' from lineitem.l_shipdate) as l_year, (lineitem.l_extendedprice * (1 - lineitem.l_discount)) as volume]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (((n1.n_name = 'FRANCE') AND (n2.n_name = 'GERMANY')) OR ((n1.n_name = 'GERMANY') AND (n2.n_name = 'FRANCE')))\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ LookupJoin\n" +
			"                         │   ├─ LookupJoin\n" +
			"                         │   │   ├─ LookupJoin\n" +
			"                         │   │   │   ├─ MergeJoin\n" +
			"                         │   │   │   │   ├─ cmp: (lineitem.l_orderkey = orders.o_orderkey)\n" +
			"                         │   │   │   │   ├─ Filter\n" +
			"                         │   │   │   │   │   ├─ ((lineitem.l_shipdate >= '1995-01-01') AND (lineitem.l_shipdate <= '1996-12-31'))\n" +
			"                         │   │   │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                         │   │   │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         │   │   │   │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   │   │   │   │       └─ columns: [l_orderkey l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"                         │   │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                         │   │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                         │   │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                         │   │   │   │       └─ columns: [o_orderkey o_custkey]\n" +
			"                         │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                         │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                         │   │   │       ├─ columns: [s_suppkey s_nationkey]\n" +
			"                         │   │   │       └─ keys: lineitem.l_suppkey\n" +
			"                         │   │   └─ IndexedTableAccess(customer)\n" +
			"                         │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                         │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                         │   │       └─ keys: orders.o_custkey\n" +
			"                         │   └─ TableAlias(n1)\n" +
			"                         │       └─ IndexedTableAccess(nation)\n" +
			"                         │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                         │           ├─ columns: [n_nationkey n_name]\n" +
			"                         │           └─ keys: supplier.s_nationkey\n" +
			"                         └─ TableAlias(n2)\n" +
			"                             └─ IndexedTableAccess(nation)\n" +
			"                                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                                 ├─ columns: [n_nationkey n_name]\n" +
			"                                 └─ keys: customer.c_nationkey\n" +
			"",
	},
	{
		Query: `
--Q8
select
	o_year,
	sum(case
		when nation = 'BRAZIL' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between '1995-01-01' and '1996-12-31'
			and p_type = 'ECONOMY ANODIZED STEEL'
	) as all_nations
group by
	o_year
order by
	o_year;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [all_nations.o_year:2!null, (sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end):0!null / sum(all_nations.volume):1!null)->mkt_share:0]\n" +
			" └─ Sort(all_nations.o_year:2!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(CASE  WHEN Eq\n" +
			"         │   ├─ all_nations.nation:2!null\n" +
			"         │   └─ BRAZIL (longtext)\n" +
			"         │   THEN all_nations.volume:1!null ELSE 0 (tinyint) END), SUM(all_nations.volume:1!null), all_nations.o_year:0!null\n" +
			"         ├─ group: all_nations.o_year:0!null\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: all_nations\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             ├─ colSet: (64-66)\n" +
			"             ├─ tableId: 9\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [extract('YEAR' from orders.o_orderdate)->o_year:0, (lineitem.l_extendedprice:12!null * (1 (tinyint) - lineitem.l_discount:13!null))->volume:0, n2.n_name:19!null->nation:0]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ LookupJoin\n" +
			"                     │   │   ├─ LookupJoin\n" +
			"                     │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   │   ├─ Filter\n" +
			"                     │   │   │   │   │   │   │   ├─ AND\n" +
			"                     │   │   │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                     │   │   │   │   │   │   │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                     │   │   │   │   │   │   │   │   │   └─ 1995-01-01 (longtext)\n" +
			"                     │   │   │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                     │   │   │   │   │   │   │   │       ├─ orders.o_orderdate:2!null\n" +
			"                     │   │   │   │   │   │   │   │       └─ 1996-12-31 (longtext)\n" +
			"                     │   │   │   │   │   │   │   └─ Table\n" +
			"                     │   │   │   │   │   │   │       ├─ name: orders\n" +
			"                     │   │   │   │   │   │   │       ├─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                     │   │   │   │   │   │   │       ├─ colSet: (33-41)\n" +
			"                     │   │   │   │   │   │   │       └─ tableId: 4\n" +
			"                     │   │   │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                     │   │   │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                     │   │   │   │   │   │       ├─ keys: [orders.o_custkey:1!null]\n" +
			"                     │   │   │   │   │   │       ├─ colSet: (42-49)\n" +
			"                     │   │   │   │   │   │       ├─ tableId: 5\n" +
			"                     │   │   │   │   │   │       └─ Table\n" +
			"                     │   │   │   │   │   │           ├─ name: customer\n" +
			"                     │   │   │   │   │   │           └─ columns: [c_custkey c_nationkey]\n" +
			"                     │   │   │   │   │   └─ TableAlias(n1)\n" +
			"                     │   │   │   │   │       └─ IndexedTableAccess(nation)\n" +
			"                     │   │   │   │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                     │   │   │   │   │           ├─ keys: [customer.c_nationkey:4!null]\n" +
			"                     │   │   │   │   │           ├─ colSet: (50-53)\n" +
			"                     │   │   │   │   │           ├─ tableId: 6\n" +
			"                     │   │   │   │   │           └─ Table\n" +
			"                     │   │   │   │   │               ├─ name: nation\n" +
			"                     │   │   │   │   │               └─ columns: [n_nationkey n_regionkey]\n" +
			"                     │   │   │   │   └─ Filter\n" +
			"                     │   │   │   │       ├─ Eq\n" +
			"                     │   │   │   │       │   ├─ region.r_name:1!null\n" +
			"                     │   │   │   │       │   └─ AMERICA (longtext)\n" +
			"                     │   │   │   │       └─ IndexedTableAccess(region)\n" +
			"                     │   │   │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                     │   │   │   │           ├─ keys: [n1.n_regionkey:6!null]\n" +
			"                     │   │   │   │           ├─ colSet: (58-60)\n" +
			"                     │   │   │   │           ├─ tableId: 8\n" +
			"                     │   │   │   │           └─ Table\n" +
			"                     │   │   │   │               ├─ name: region\n" +
			"                     │   │   │   │               └─ columns: [r_regionkey r_name]\n" +
			"                     │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                     │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │   │   │       ├─ keys: [orders.o_orderkey:0!null]\n" +
			"                     │   │   │       ├─ colSet: (17-32)\n" +
			"                     │   │   │       ├─ tableId: 3\n" +
			"                     │   │   │       └─ Table\n" +
			"                     │   │   │           ├─ name: lineitem\n" +
			"                     │   │   │           └─ columns: [l_orderkey l_partkey l_suppkey l_extendedprice l_discount]\n" +
			"                     │   │   └─ IndexedTableAccess(supplier)\n" +
			"                     │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │   │       ├─ keys: [lineitem.l_suppkey:11!null]\n" +
			"                     │   │       ├─ colSet: (10-16)\n" +
			"                     │   │       ├─ tableId: 2\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: supplier\n" +
			"                     │   │           └─ columns: [s_suppkey s_nationkey]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ part.p_type:1!null\n" +
			"                     │       │   └─ ECONOMY ANODIZED STEEL (longtext)\n" +
			"                     │       └─ IndexedTableAccess(part)\n" +
			"                     │           ├─ index: [part.P_PARTKEY]\n" +
			"                     │           ├─ keys: [lineitem.l_partkey:10!null]\n" +
			"                     │           ├─ colSet: (1-9)\n" +
			"                     │           ├─ tableId: 1\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: part\n" +
			"                     │               └─ columns: [p_partkey p_type]\n" +
			"                     └─ TableAlias(n2)\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             ├─ keys: [supplier.s_nationkey:15!null]\n" +
			"                             ├─ colSet: (54-57)\n" +
			"                             ├─ tableId: 7\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: nation\n" +
			"                                 └─ columns: [n_nationkey n_name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [all_nations.o_year, (sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end) / sum(all_nations.volume)) as mkt_share]\n" +
			" └─ Sort(all_nations.o_year ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(CASE  WHEN (all_nations.nation = 'BRAZIL') THEN all_nations.volume ELSE 0 END), SUM(all_nations.volume), all_nations.o_year)\n" +
			"         ├─ Grouping(all_nations.o_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: all_nations\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [extract('YEAR' from orders.o_orderdate) as o_year, (lineitem.l_extendedprice * (1 - lineitem.l_discount)) as volume, n2.n_name as nation]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ LookupJoin\n" +
			"                     │   │   ├─ LookupJoin\n" +
			"                     │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   │   ├─ Filter\n" +
			"                     │   │   │   │   │   │   │   ├─ ((orders.o_orderdate >= '1995-01-01') AND (orders.o_orderdate <= '1996-12-31'))\n" +
			"                     │   │   │   │   │   │   │   └─ Table\n" +
			"                     │   │   │   │   │   │   │       ├─ name: orders\n" +
			"                     │   │   │   │   │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                     │   │   │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                     │   │   │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                     │   │   │   │   │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                     │   │   │   │   │   │       └─ keys: orders.o_custkey\n" +
			"                     │   │   │   │   │   └─ TableAlias(n1)\n" +
			"                     │   │   │   │   │       └─ IndexedTableAccess(nation)\n" +
			"                     │   │   │   │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                     │   │   │   │   │           ├─ columns: [n_nationkey n_regionkey]\n" +
			"                     │   │   │   │   │           └─ keys: customer.c_nationkey\n" +
			"                     │   │   │   │   └─ Filter\n" +
			"                     │   │   │   │       ├─ (region.r_name = 'AMERICA')\n" +
			"                     │   │   │   │       └─ IndexedTableAccess(region)\n" +
			"                     │   │   │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                     │   │   │   │           ├─ columns: [r_regionkey r_name]\n" +
			"                     │   │   │   │           └─ keys: n1.n_regionkey\n" +
			"                     │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                     │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │   │   │       ├─ columns: [l_orderkey l_partkey l_suppkey l_extendedprice l_discount]\n" +
			"                     │   │   │       └─ keys: orders.o_orderkey\n" +
			"                     │   │   └─ IndexedTableAccess(supplier)\n" +
			"                     │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │   │       ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     │   │       └─ keys: lineitem.l_suppkey\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (part.p_type = 'ECONOMY ANODIZED STEEL')\n" +
			"                     │       └─ IndexedTableAccess(part)\n" +
			"                     │           ├─ index: [part.P_PARTKEY]\n" +
			"                     │           ├─ columns: [p_partkey p_type]\n" +
			"                     │           └─ keys: lineitem.l_partkey\n" +
			"                     └─ TableAlias(n2)\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             ├─ columns: [n_nationkey n_name]\n" +
			"                             └─ keys: supplier.s_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [all_nations.o_year, (sum(case  when (all_nations.nation = 'brazil') then all_nations.volume else 0 end) / sum(all_nations.volume)) as mkt_share]\n" +
			" └─ Sort(all_nations.o_year ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(CASE  WHEN (all_nations.nation = 'BRAZIL') THEN all_nations.volume ELSE 0 END), SUM(all_nations.volume), all_nations.o_year)\n" +
			"         ├─ Grouping(all_nations.o_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: all_nations\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [extract('YEAR' from orders.o_orderdate) as o_year, (lineitem.l_extendedprice * (1 - lineitem.l_discount)) as volume, n2.n_name as nation]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ LookupJoin\n" +
			"                     │   │   ├─ LookupJoin\n" +
			"                     │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   ├─ LookupJoin\n" +
			"                     │   │   │   │   │   │   ├─ Filter\n" +
			"                     │   │   │   │   │   │   │   ├─ ((orders.o_orderdate >= '1995-01-01') AND (orders.o_orderdate <= '1996-12-31'))\n" +
			"                     │   │   │   │   │   │   │   └─ Table\n" +
			"                     │   │   │   │   │   │   │       ├─ name: orders\n" +
			"                     │   │   │   │   │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                     │   │   │   │   │   │   └─ IndexedTableAccess(customer)\n" +
			"                     │   │   │   │   │   │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                     │   │   │   │   │   │       ├─ columns: [c_custkey c_nationkey]\n" +
			"                     │   │   │   │   │   │       └─ keys: orders.o_custkey\n" +
			"                     │   │   │   │   │   └─ TableAlias(n1)\n" +
			"                     │   │   │   │   │       └─ IndexedTableAccess(nation)\n" +
			"                     │   │   │   │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                     │   │   │   │   │           ├─ columns: [n_nationkey n_regionkey]\n" +
			"                     │   │   │   │   │           └─ keys: customer.c_nationkey\n" +
			"                     │   │   │   │   └─ Filter\n" +
			"                     │   │   │   │       ├─ (region.r_name = 'AMERICA')\n" +
			"                     │   │   │   │       └─ IndexedTableAccess(region)\n" +
			"                     │   │   │   │           ├─ index: [region.R_REGIONKEY]\n" +
			"                     │   │   │   │           ├─ columns: [r_regionkey r_name]\n" +
			"                     │   │   │   │           └─ keys: n1.n_regionkey\n" +
			"                     │   │   │   └─ IndexedTableAccess(lineitem)\n" +
			"                     │   │   │       ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │   │   │       ├─ columns: [l_orderkey l_partkey l_suppkey l_extendedprice l_discount]\n" +
			"                     │   │   │       └─ keys: orders.o_orderkey\n" +
			"                     │   │   └─ IndexedTableAccess(supplier)\n" +
			"                     │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │   │       ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     │   │       └─ keys: lineitem.l_suppkey\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (part.p_type = 'ECONOMY ANODIZED STEEL')\n" +
			"                     │       └─ IndexedTableAccess(part)\n" +
			"                     │           ├─ index: [part.P_PARTKEY]\n" +
			"                     │           ├─ columns: [p_partkey p_type]\n" +
			"                     │           └─ keys: lineitem.l_partkey\n" +
			"                     └─ TableAlias(n2)\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             ├─ columns: [n_nationkey n_name]\n" +
			"                             └─ keys: supplier.s_nationkey\n" +
			"",
	},
	{
		Query: `
--Q9
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%green%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [profit.nation:1!null, profit.o_year:2!null, sum(profit.amount):0!null->sum_profit:0]\n" +
			" └─ Sort(profit.nation:1!null ASC nullsFirst, profit.o_year:2!null DESC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(profit.amount:2!null), profit.nation:0!null, profit.o_year:1!null\n" +
			"         ├─ group: profit.nation:0!null, profit.o_year:1!null\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: profit\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             ├─ colSet: (54-56)\n" +
			"             ├─ tableId: 7\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [nation.n_name:16!null->nation:0, extract('YEAR' from orders.o_orderdate)->o_year:0, ((lineitem.l_extendedprice:9!null * (1 (tinyint) - lineitem.l_discount:10!null)) - (partsupp.ps_supplycost:4!null * lineitem.l_quantity:8!null))->amount:0]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ HashJoin\n" +
			"                     │   ├─ AND\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ AND\n" +
			"                     │   │   │   │   ├─ Eq\n" +
			"                     │   │   │   │   │   ├─ part.p_partkey:0!null\n" +
			"                     │   │   │   │   │   └─ lineitem.l_partkey:6!null\n" +
			"                     │   │   │   │   └─ Eq\n" +
			"                     │   │   │   │       ├─ partsupp.ps_suppkey:3!null\n" +
			"                     │   │   │   │       └─ lineitem.l_suppkey:7!null\n" +
			"                     │   │   │   └─ Eq\n" +
			"                     │   │   │       ├─ partsupp.ps_partkey:2!null\n" +
			"                     │   │   │       └─ lineitem.l_partkey:6!null\n" +
			"                     │   │   └─ Eq\n" +
			"                     │   │       ├─ supplier.s_suppkey:13!null\n" +
			"                     │   │       └─ partsupp.ps_suppkey:3!null\n" +
			"                     │   ├─ MergeJoin\n" +
			"                     │   │   ├─ cmp: Eq\n" +
			"                     │   │   │   ├─ part.p_partkey:0!null\n" +
			"                     │   │   │   └─ partsupp.ps_partkey:2!null\n" +
			"                     │   │   ├─ Filter\n" +
			"                     │   │   │   ├─ part.p_name LIKE '%green%'\n" +
			"                     │   │   │   └─ IndexedTableAccess(part)\n" +
			"                     │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"                     │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │   │   │       ├─ colSet: (1-9)\n" +
			"                     │   │   │       ├─ tableId: 1\n" +
			"                     │   │   │       └─ Table\n" +
			"                     │   │   │           ├─ name: part\n" +
			"                     │   │   │           └─ columns: [p_partkey p_name]\n" +
			"                     │   │   └─ IndexedTableAccess(partsupp)\n" +
			"                     │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                     │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │   │       ├─ colSet: (33-37)\n" +
			"                     │   │       ├─ tableId: 4\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: partsupp\n" +
			"                     │   │           └─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"                     │   └─ HashLookup\n" +
			"                     │       ├─ left-key: TUPLE(part.p_partkey:0!null, partsupp.ps_suppkey:3!null, partsupp.ps_partkey:2!null, partsupp.ps_suppkey:3!null)\n" +
			"                     │       ├─ right-key: TUPLE(lineitem.l_partkey:1!null, lineitem.l_suppkey:2!null, lineitem.l_partkey:1!null, supplier.s_suppkey:8!null)\n" +
			"                     │       └─ LookupJoin\n" +
			"                     │           ├─ MergeJoin\n" +
			"                     │           │   ├─ cmp: Eq\n" +
			"                     │           │   │   ├─ lineitem.l_orderkey:5!null\n" +
			"                     │           │   │   └─ orders.o_orderkey:11!null\n" +
			"                     │           │   ├─ IndexedTableAccess(lineitem)\n" +
			"                     │           │   │   ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │           │   │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │           │   │   ├─ colSet: (17-32)\n" +
			"                     │           │   │   ├─ tableId: 3\n" +
			"                     │           │   │   └─ Table\n" +
			"                     │           │   │       ├─ name: lineitem\n" +
			"                     │           │   │       └─ columns: [l_orderkey l_partkey l_suppkey l_quantity l_extendedprice l_discount]\n" +
			"                     │           │   └─ IndexedTableAccess(orders)\n" +
			"                     │           │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                     │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │           │       ├─ colSet: (38-46)\n" +
			"                     │           │       ├─ tableId: 5\n" +
			"                     │           │       └─ Table\n" +
			"                     │           │           ├─ name: orders\n" +
			"                     │           │           └─ columns: [o_orderkey o_orderdate]\n" +
			"                     │           └─ IndexedTableAccess(supplier)\n" +
			"                     │               ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │               ├─ keys: [lineitem.l_suppkey:7!null]\n" +
			"                     │               ├─ colSet: (10-16)\n" +
			"                     │               ├─ tableId: 2\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: supplier\n" +
			"                     │                   └─ columns: [s_suppkey s_nationkey]\n" +
			"                     └─ IndexedTableAccess(nation)\n" +
			"                         ├─ index: [nation.N_NATIONKEY]\n" +
			"                         ├─ keys: [supplier.s_nationkey:14!null]\n" +
			"                         ├─ colSet: (47-50)\n" +
			"                         ├─ tableId: 6\n" +
			"                         └─ Table\n" +
			"                             ├─ name: nation\n" +
			"                             └─ columns: [n_nationkey n_name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [profit.nation, profit.o_year, sum(profit.amount) as sum_profit]\n" +
			" └─ Sort(profit.nation ASC, profit.o_year DESC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(profit.amount), profit.nation, profit.o_year)\n" +
			"         ├─ Grouping(profit.nation, profit.o_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: profit\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [nation.n_name as nation, extract('YEAR' from orders.o_orderdate) as o_year, ((lineitem.l_extendedprice * (1 - lineitem.l_discount)) - (partsupp.ps_supplycost * lineitem.l_quantity)) as amount]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ HashJoin\n" +
			"                     │   ├─ ((((part.p_partkey = lineitem.l_partkey) AND (partsupp.ps_suppkey = lineitem.l_suppkey)) AND (partsupp.ps_partkey = lineitem.l_partkey)) AND (supplier.s_suppkey = partsupp.ps_suppkey))\n" +
			"                     │   ├─ MergeJoin\n" +
			"                     │   │   ├─ cmp: (part.p_partkey = partsupp.ps_partkey)\n" +
			"                     │   │   ├─ Filter\n" +
			"                     │   │   │   ├─ part.p_name LIKE '%green%'\n" +
			"                     │   │   │   └─ IndexedTableAccess(part)\n" +
			"                     │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"                     │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                     │   │   │       └─ columns: [p_partkey p_name]\n" +
			"                     │   │   └─ IndexedTableAccess(partsupp)\n" +
			"                     │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                     │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │   │       └─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"                     │   └─ HashLookup\n" +
			"                     │       ├─ left-key: (part.p_partkey, partsupp.ps_suppkey, partsupp.ps_partkey, partsupp.ps_suppkey)\n" +
			"                     │       ├─ right-key: (lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_partkey, supplier.s_suppkey)\n" +
			"                     │       └─ LookupJoin\n" +
			"                     │           ├─ MergeJoin\n" +
			"                     │           │   ├─ cmp: (lineitem.l_orderkey = orders.o_orderkey)\n" +
			"                     │           │   ├─ IndexedTableAccess(lineitem)\n" +
			"                     │           │   │   ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │           │   │   ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │           │   │   └─ columns: [l_orderkey l_partkey l_suppkey l_quantity l_extendedprice l_discount]\n" +
			"                     │           │   └─ IndexedTableAccess(orders)\n" +
			"                     │           │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                     │           │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                     │           │       └─ columns: [o_orderkey o_orderdate]\n" +
			"                     │           └─ IndexedTableAccess(supplier)\n" +
			"                     │               ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │               ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     │               └─ keys: lineitem.l_suppkey\n" +
			"                     └─ IndexedTableAccess(nation)\n" +
			"                         ├─ index: [nation.N_NATIONKEY]\n" +
			"                         ├─ columns: [n_nationkey n_name]\n" +
			"                         └─ keys: supplier.s_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [profit.nation, profit.o_year, sum(profit.amount) as sum_profit]\n" +
			" └─ Sort(profit.nation ASC, profit.o_year DESC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(profit.amount), profit.nation, profit.o_year)\n" +
			"         ├─ Grouping(profit.nation, profit.o_year)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: profit\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [nation.n_name as nation, extract('YEAR' from orders.o_orderdate) as o_year, ((lineitem.l_extendedprice * (1 - lineitem.l_discount)) - (partsupp.ps_supplycost * lineitem.l_quantity)) as amount]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ HashJoin\n" +
			"                     │   ├─ ((((part.p_partkey = lineitem.l_partkey) AND (partsupp.ps_suppkey = lineitem.l_suppkey)) AND (partsupp.ps_partkey = lineitem.l_partkey)) AND (supplier.s_suppkey = partsupp.ps_suppkey))\n" +
			"                     │   ├─ MergeJoin\n" +
			"                     │   │   ├─ cmp: (part.p_partkey = partsupp.ps_partkey)\n" +
			"                     │   │   ├─ Filter\n" +
			"                     │   │   │   ├─ part.p_name LIKE '%green%'\n" +
			"                     │   │   │   └─ IndexedTableAccess(part)\n" +
			"                     │   │   │       ├─ index: [part.P_PARTKEY]\n" +
			"                     │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                     │   │   │       └─ columns: [p_partkey p_name]\n" +
			"                     │   │   └─ IndexedTableAccess(partsupp)\n" +
			"                     │   │       ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                     │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │   │       └─ columns: [ps_partkey ps_suppkey ps_supplycost]\n" +
			"                     │   └─ HashLookup\n" +
			"                     │       ├─ left-key: (part.p_partkey, partsupp.ps_suppkey, partsupp.ps_partkey, partsupp.ps_suppkey)\n" +
			"                     │       ├─ right-key: (lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_partkey, supplier.s_suppkey)\n" +
			"                     │       └─ LookupJoin\n" +
			"                     │           ├─ MergeJoin\n" +
			"                     │           │   ├─ cmp: (lineitem.l_orderkey = orders.o_orderkey)\n" +
			"                     │           │   ├─ IndexedTableAccess(lineitem)\n" +
			"                     │           │   │   ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     │           │   │   ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │           │   │   └─ columns: [l_orderkey l_partkey l_suppkey l_quantity l_extendedprice l_discount]\n" +
			"                     │           │   └─ IndexedTableAccess(orders)\n" +
			"                     │           │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                     │           │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                     │           │       └─ columns: [o_orderkey o_orderdate]\n" +
			"                     │           └─ IndexedTableAccess(supplier)\n" +
			"                     │               ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │               ├─ columns: [s_suppkey s_nationkey]\n" +
			"                     │               └─ keys: lineitem.l_suppkey\n" +
			"                     └─ IndexedTableAccess(nation)\n" +
			"                         ├─ index: [nation.N_NATIONKEY]\n" +
			"                         ├─ columns: [n_nationkey n_name]\n" +
			"                         └─ keys: supplier.s_nationkey\n" +
			"",
	},
	{
		Query: `
--Q10
select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= '1993-10-01'
	and o_orderdate < '1993-10-01' + interval '3' month
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [customer.c_custkey:1!null, customer.c_name:2!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0, customer.c_acctbal:3!null, nation.n_name:4!null, customer.c_address:5!null, customer.c_phone:6!null, customer.c_comment:7!null]\n" +
			" └─ Sort(revenue:8!null DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null, customer.c_custkey:1!null, customer.c_name:2!null, customer.c_acctbal:3!null, nation.n_name:4!null, customer.c_address:5!null, customer.c_phone:6!null, customer.c_comment:7!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: SUM((lineitem.l_extendedprice:4!null * (1 (tinyint) - lineitem.l_discount:5!null))), customer.c_custkey:7!null, customer.c_name:8!null, customer.c_acctbal:12!null, nation.n_name:15!null, customer.c_address:9!null, customer.c_phone:11!null, customer.c_comment:13!null\n" +
			"             ├─ group: customer.c_custkey:7!null, customer.c_name:8!null, customer.c_acctbal:12!null, customer.c_phone:11!null, nation.n_name:15!null, customer.c_address:9!null, customer.c_comment:13!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ MergeJoin\n" +
			"                 │   │   ├─ cmp: Eq\n" +
			"                 │   │   │   ├─ orders.o_orderkey:0!null\n" +
			"                 │   │   │   └─ lineitem.l_orderkey:3!null\n" +
			"                 │   │   ├─ Filter\n" +
			"                 │   │   │   ├─ AND\n" +
			"                 │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │   │   └─ 1993-10-01 (longtext)\n" +
			"                 │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │       ├─ orders.o_orderdate:2!null\n" +
			"                 │   │   │   │       └─ 1994-01-01 00:00:00 +0000 UTC (datetime)\n" +
			"                 │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │   │       ├─ colSet: (9-17)\n" +
			"                 │   │   │       ├─ tableId: 2\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: orders\n" +
			"                 │   │   │           └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ lineitem.l_returnflag:3!null\n" +
			"                 │   │       │   └─ R (longtext)\n" +
			"                 │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │           ├─ colSet: (18-33)\n" +
			"                 │   │           ├─ tableId: 3\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: lineitem\n" +
			"                 │   │               └─ columns: [l_orderkey l_extendedprice l_discount l_returnflag]\n" +
			"                 │   └─ IndexedTableAccess(customer)\n" +
			"                 │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │       ├─ keys: [orders.o_custkey:1!null]\n" +
			"                 │       ├─ colSet: (1-8)\n" +
			"                 │       ├─ tableId: 1\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: customer\n" +
			"                 │           └─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_comment]\n" +
			"                 └─ IndexedTableAccess(nation)\n" +
			"                     ├─ index: [nation.N_NATIONKEY]\n" +
			"                     ├─ keys: [customer.c_nationkey:10!null]\n" +
			"                     ├─ colSet: (34-37)\n" +
			"                     ├─ tableId: 4\n" +
			"                     └─ Table\n" +
			"                         ├─ name: nation\n" +
			"                         └─ columns: [n_nationkey n_name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [customer.c_custkey, customer.c_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment]\n" +
			" └─ Sort(revenue DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), customer.c_custkey, customer.c_name, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), customer.c_custkey, customer.c_name, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment)\n" +
			"             ├─ Grouping(customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ MergeJoin\n" +
			"                 │   │   ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 │   │   ├─ Filter\n" +
			"                 │   │   │   ├─ ((orders.o_orderdate >= '1993-10-01') AND (orders.o_orderdate < 1994-01-01 00:00:00 +0000 UTC))\n" +
			"                 │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lineitem.l_returnflag = 'R')\n" +
			"                 │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │           ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │           └─ columns: [l_orderkey l_extendedprice l_discount l_returnflag]\n" +
			"                 │   └─ IndexedTableAccess(customer)\n" +
			"                 │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │       ├─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_comment]\n" +
			"                 │       └─ keys: orders.o_custkey\n" +
			"                 └─ IndexedTableAccess(nation)\n" +
			"                     ├─ index: [nation.N_NATIONKEY]\n" +
			"                     ├─ columns: [n_nationkey n_name]\n" +
			"                     └─ keys: customer.c_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [customer.c_custkey, customer.c_name, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment]\n" +
			" └─ Sort(revenue DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))), customer.c_custkey, customer.c_name, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), customer.c_custkey, customer.c_name, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment)\n" +
			"             ├─ Grouping(customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ LookupJoin\n" +
			"                 │   ├─ MergeJoin\n" +
			"                 │   │   ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"                 │   │   ├─ Filter\n" +
			"                 │   │   │   ├─ ((orders.o_orderdate >= '1993-10-01') AND (orders.o_orderdate < 1994-01-01 00:00:00 +0000 UTC))\n" +
			"                 │   │   │   └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │       ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │   │       └─ columns: [o_orderkey o_custkey o_orderdate]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lineitem.l_returnflag = 'R')\n" +
			"                 │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │           ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │           └─ columns: [l_orderkey l_extendedprice l_discount l_returnflag]\n" +
			"                 │   └─ IndexedTableAccess(customer)\n" +
			"                 │       ├─ index: [customer.C_CUSTKEY]\n" +
			"                 │       ├─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_comment]\n" +
			"                 │       └─ keys: orders.o_custkey\n" +
			"                 └─ IndexedTableAccess(nation)\n" +
			"                     ├─ index: [nation.N_NATIONKEY]\n" +
			"                     ├─ columns: [n_nationkey n_name]\n" +
			"                     └─ keys: customer.c_nationkey\n" +
			"",
	},
	{
		Query: `
--Q11
select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'GERMANY'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'GERMANY'
		)
order by
	value desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [partsupp.ps_partkey:1!null, sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null->value:0]\n" +
			" └─ Sort(value:2!null DESC nullsFirst)\n" +
			"     └─ Having\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       ├─ alias-string: select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY'\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [(sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null * 0.0001 (decimal(11,10)))->sum(ps_supplycost * ps_availqty) * 0.0001000000:0]\n" +
			"         │           └─ LookupJoin\n" +
			"         │               ├─ LookupJoin\n" +
			"         │               │   ├─ Table\n" +
			"         │               │   │   ├─ name: partsupp\n" +
			"         │               │   │   ├─ columns: [ps_suppkey]\n" +
			"         │               │   │   ├─ colSet: (19-23)\n" +
			"         │               │   │   └─ tableId: 4\n" +
			"         │               │   └─ IndexedTableAccess(supplier)\n" +
			"         │               │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │               │       ├─ keys: [partsupp.ps_suppkey:3!null]\n" +
			"         │               │       ├─ colSet: (24-30)\n" +
			"         │               │       ├─ tableId: 5\n" +
			"         │               │       └─ Table\n" +
			"         │               │           ├─ name: supplier\n" +
			"         │               │           └─ columns: [s_suppkey s_nationkey]\n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ nation.n_name:4!null\n" +
			"         │                   │   └─ GERMANY (longtext)\n" +
			"         │                   └─ IndexedTableAccess(nation)\n" +
			"         │                       ├─ index: [nation.N_NATIONKEY]\n" +
			"         │                       ├─ keys: [supplier.s_nationkey:5!null]\n" +
			"         │                       ├─ colSet: (31-34)\n" +
			"         │                       ├─ tableId: 6\n" +
			"         │                       └─ Table\n" +
			"         │                           ├─ name: nation\n" +
			"         │                           └─ columns: [n_nationkey n_name]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null, partsupp.ps_partkey:1!null, sum((partsupp.ps_supplycost * partsupp.ps_availqty)):0!null->value:0]\n" +
			"             └─ GroupBy\n" +
			"                 ├─ select: SUM((partsupp.ps_supplycost:3!null * partsupp.ps_availqty:2!null)), partsupp.ps_partkey:0!null\n" +
			"                 ├─ group: partsupp.ps_partkey:0!null\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ ProcessTable\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: partsupp\n" +
			"                     │   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                     │   └─ IndexedTableAccess(supplier)\n" +
			"                     │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │       ├─ keys: [partsupp.ps_suppkey:1!null]\n" +
			"                     │       ├─ colSet: (6-12)\n" +
			"                     │       ├─ tableId: 2\n" +
			"                     │       └─ Table\n" +
			"                     │           ├─ name: supplier\n" +
			"                     │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ nation.n_name:1!null\n" +
			"                         │   └─ GERMANY (longtext)\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             ├─ keys: [supplier.s_nationkey:8!null]\n" +
			"                             ├─ colSet: (13-16)\n" +
			"                             ├─ tableId: 3\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: nation\n" +
			"                                 └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [partsupp.ps_partkey, sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value]\n" +
			" └─ Sort(value DESC)\n" +
			"     └─ Having((sum((partsupp.ps_supplycost * partsupp.ps_availqty)) > Subquery(select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY')))\n" +
			"         └─ Project\n" +
			"             ├─ columns: [sum((partsupp.ps_supplycost * partsupp.ps_availqty)), partsupp.ps_partkey, sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value]\n" +
			"             └─ GroupBy\n" +
			"                 ├─ SelectDeps(SUM((partsupp.ps_supplycost * partsupp.ps_availqty)), partsupp.ps_partkey)\n" +
			"                 ├─ Grouping(partsupp.ps_partkey)\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ Table\n" +
			"                     │   │   └─ name: partsupp\n" +
			"                     │   └─ IndexedTableAccess(supplier)\n" +
			"                     │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │       └─ keys: partsupp.ps_suppkey\n" +
			"                     └─ Filter\n" +
			"                         ├─ (nation.n_name = 'GERMANY')\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             └─ keys: supplier.s_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [partsupp.ps_partkey, sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value]\n" +
			" └─ Sort(value DESC)\n" +
			"     └─ Having((sum((partsupp.ps_supplycost * partsupp.ps_availqty)) > Subquery(select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY')))\n" +
			"         └─ Project\n" +
			"             ├─ columns: [sum((partsupp.ps_supplycost * partsupp.ps_availqty)), partsupp.ps_partkey, sum((partsupp.ps_supplycost * partsupp.ps_availqty)) as value]\n" +
			"             └─ GroupBy\n" +
			"                 ├─ SelectDeps(SUM((partsupp.ps_supplycost * partsupp.ps_availqty)), partsupp.ps_partkey)\n" +
			"                 ├─ Grouping(partsupp.ps_partkey)\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ LookupJoin\n" +
			"                     │   ├─ Table\n" +
			"                     │   │   └─ name: partsupp\n" +
			"                     │   └─ IndexedTableAccess(supplier)\n" +
			"                     │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                     │       └─ keys: partsupp.ps_suppkey\n" +
			"                     └─ Filter\n" +
			"                         ├─ (nation.n_name = 'GERMANY')\n" +
			"                         └─ IndexedTableAccess(nation)\n" +
			"                             ├─ index: [nation.N_NATIONKEY]\n" +
			"                             └─ keys: supplier.s_nationkey\n" +
			"",
	},
	{
		Query: `
--Q12
select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('MAIL', 'SHIP')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1994-01-01'
	and l_receiptdate < '1994-01-01' + interval '1' year
group by
	l_shipmode
order by
	l_shipmode;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lineitem.l_shipmode:2!null, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end):1!null->high_line_count:0, sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end):0!null->low_line_count:0]\n" +
			" └─ Sort(lineitem.l_shipmode:2!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(CASE  WHEN AND\n" +
			"         │   ├─ NOT\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ orders.o_orderpriority:1!null\n" +
			"         │   │       └─ 1-URGENT (longtext)\n" +
			"         │   └─ NOT\n" +
			"         │       └─ Eq\n" +
			"         │           ├─ orders.o_orderpriority:1!null\n" +
			"         │           └─ 2-HIGH (longtext)\n" +
			"         │   THEN 1 (tinyint) ELSE 0 (tinyint) END), SUM(CASE  WHEN Or\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ orders.o_orderpriority:1!null\n" +
			"         │   │   └─ 1-URGENT (longtext)\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ orders.o_orderpriority:1!null\n" +
			"         │       └─ 2-HIGH (longtext)\n" +
			"         │   THEN 1 (tinyint) ELSE 0 (tinyint) END), lineitem.l_shipmode:6!null\n" +
			"         ├─ group: lineitem.l_shipmode:6!null\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ orders.o_orderkey:0!null\n" +
			"             │   └─ lineitem.l_orderkey:2!null\n" +
			"             ├─ IndexedTableAccess(orders)\n" +
			"             │   ├─ index: [orders.O_ORDERKEY]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   ├─ colSet: (1-9)\n" +
			"             │   ├─ tableId: 1\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: orders\n" +
			"             │       └─ columns: [o_orderkey o_orderpriority]\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ AND\n" +
			"                 │   │   │   ├─ AND\n" +
			"                 │   │   │   │   ├─ HashIn\n" +
			"                 │   │   │   │   │   ├─ lineitem.l_shipmode:4!null\n" +
			"                 │   │   │   │   │   └─ TUPLE(MAIL (longtext), SHIP (longtext))\n" +
			"                 │   │   │   │   └─ LessThan\n" +
			"                 │   │   │   │       ├─ lineitem.l_commitdate:2!null\n" +
			"                 │   │   │   │       └─ lineitem.l_receiptdate:3!null\n" +
			"                 │   │   │   └─ LessThan\n" +
			"                 │   │   │       ├─ lineitem.l_shipdate:1!null\n" +
			"                 │   │   │       └─ lineitem.l_commitdate:2!null\n" +
			"                 │   │   └─ GreaterThanOrEqual\n" +
			"                 │   │       ├─ lineitem.l_receiptdate:3!null\n" +
			"                 │   │       └─ 1994-01-01 (longtext)\n" +
			"                 │   └─ LessThan\n" +
			"                 │       ├─ lineitem.l_receiptdate:3!null\n" +
			"                 │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime)\n" +
			"                 └─ IndexedTableAccess(lineitem)\n" +
			"                     ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     ├─ colSet: (10-25)\n" +
			"                     ├─ tableId: 2\n" +
			"                     └─ Table\n" +
			"                         ├─ name: lineitem\n" +
			"                         └─ columns: [l_orderkey l_shipdate l_commitdate l_receiptdate l_shipmode]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [lineitem.l_shipmode, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end) as high_line_count, sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end) as low_line_count]\n" +
			" └─ Sort(lineitem.l_shipmode ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(CASE  WHEN ((NOT((orders.o_orderpriority = '1-URGENT'))) AND (NOT((orders.o_orderpriority = '2-HIGH')))) THEN 1 ELSE 0 END), SUM(CASE  WHEN ((orders.o_orderpriority = '1-URGENT') OR (orders.o_orderpriority = '2-HIGH')) THEN 1 ELSE 0 END), lineitem.l_shipmode)\n" +
			"         ├─ Grouping(lineitem.l_shipmode)\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"             ├─ IndexedTableAccess(orders)\n" +
			"             │   ├─ index: [orders.O_ORDERKEY]\n" +
			"             │   ├─ filters: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [o_orderkey o_orderpriority]\n" +
			"             └─ Filter\n" +
			"                 ├─ (((((lineitem.l_shipmode HASH IN ('MAIL', 'SHIP')) AND (lineitem.l_commitdate < lineitem.l_receiptdate)) AND (lineitem.l_shipdate < lineitem.l_commitdate)) AND (lineitem.l_receiptdate >= '1994-01-01')) AND (lineitem.l_receiptdate < 1995-01-01 00:00:00 +0000 UTC))\n" +
			"                 └─ IndexedTableAccess(lineitem)\n" +
			"                     ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [l_orderkey l_shipdate l_commitdate l_receiptdate l_shipmode]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [lineitem.l_shipmode, sum(case  when ((orders.o_orderpriority = '1-urgent') or (orders.o_orderpriority = '2-high')) then 1 else 0 end) as high_line_count, sum(case  when ((not((orders.o_orderpriority = '1-urgent'))) and (not((orders.o_orderpriority = '2-high')))) then 1 else 0 end) as low_line_count]\n" +
			" └─ Sort(lineitem.l_shipmode ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(CASE  WHEN ((NOT((orders.o_orderpriority = '1-URGENT'))) AND (NOT((orders.o_orderpriority = '2-HIGH')))) THEN 1 ELSE 0 END), SUM(CASE  WHEN ((orders.o_orderpriority = '1-URGENT') OR (orders.o_orderpriority = '2-HIGH')) THEN 1 ELSE 0 END), lineitem.l_shipmode)\n" +
			"         ├─ Grouping(lineitem.l_shipmode)\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"             ├─ IndexedTableAccess(orders)\n" +
			"             │   ├─ index: [orders.O_ORDERKEY]\n" +
			"             │   ├─ filters: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [o_orderkey o_orderpriority]\n" +
			"             └─ Filter\n" +
			"                 ├─ (((((lineitem.l_shipmode HASH IN ('MAIL', 'SHIP')) AND (lineitem.l_commitdate < lineitem.l_receiptdate)) AND (lineitem.l_shipdate < lineitem.l_commitdate)) AND (lineitem.l_receiptdate >= '1994-01-01')) AND (lineitem.l_receiptdate < 1995-01-01 00:00:00 +0000 UTC))\n" +
			"                 └─ IndexedTableAccess(lineitem)\n" +
			"                     ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                     ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [l_orderkey l_shipdate l_commitdate l_receiptdate l_shipmode]\n" +
			"",
	},
	{
		Query: `
--Q13
select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%special%requests%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [c_orders.c_count:1!null, count(1):0!null->custdist:0]\n" +
			" └─ Sort(custdist:2!null DESC nullsFirst, c_orders.c_count:1!null DESC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, c_orders.c_count:1!null, count(1):0!null->custdist:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), c_orders.c_count:1!null\n" +
			"             ├─ group: c_orders.c_count:1!null\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: c_orders\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ isLateral: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 ├─ colSet: (19,20)\n" +
			"                 ├─ tableId: 3\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [customer.c_custkey:1!null, count(orders.o_orderkey):0!null->count(o_orderkey):0]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ select: COUNT(orders.o_orderkey:1!null), customer.c_custkey:0!null\n" +
			"                         ├─ group: customer.c_custkey:0!null\n" +
			"                         └─ LeftOuterJoin\n" +
			"                             ├─ AND\n" +
			"                             │   ├─ Eq\n" +
			"                             │   │   ├─ customer.c_custkey:0!null\n" +
			"                             │   │   └─ orders.o_custkey:2!null\n" +
			"                             │   └─ NOT\n" +
			"                             │       └─ orders.o_comment LIKE '%special%requests%'\n" +
			"                             ├─ Table\n" +
			"                             │   ├─ name: customer\n" +
			"                             │   ├─ columns: [c_custkey]\n" +
			"                             │   ├─ colSet: (1-8)\n" +
			"                             │   └─ tableId: 1\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 ├─ columns: [o_orderkey o_custkey o_comment]\n" +
			"                                 ├─ colSet: (9-17)\n" +
			"                                 └─ tableId: 2\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [c_orders.c_count, count(1) as custdist]\n" +
			" └─ Sort(custdist DESC, c_orders.c_count DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1), c_orders.c_count, count(1) as custdist]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNT(1), c_orders.c_count)\n" +
			"             ├─ Grouping(c_orders.c_count)\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: c_orders\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ isLateral: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [customer.c_custkey, count(orders.o_orderkey) as count(o_orderkey)]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ SelectDeps(COUNT(orders.o_orderkey), customer.c_custkey)\n" +
			"                         ├─ Grouping(customer.c_custkey)\n" +
			"                         └─ LeftOuterJoin\n" +
			"                             ├─ ((customer.c_custkey = orders.o_custkey) AND (NOT(orders.o_comment LIKE '%special%requests%')))\n" +
			"                             ├─ Table\n" +
			"                             │   ├─ name: customer\n" +
			"                             │   └─ columns: [c_custkey]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 └─ columns: [o_orderkey o_custkey o_comment]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [c_orders.c_count, count(1) as custdist]\n" +
			" └─ Sort(custdist DESC, c_orders.c_count DESC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1), c_orders.c_count, count(1) as custdist]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNT(1), c_orders.c_count)\n" +
			"             ├─ Grouping(c_orders.c_count)\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: c_orders\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ isLateral: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [customer.c_custkey, count(orders.o_orderkey) as count(o_orderkey)]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ SelectDeps(COUNT(orders.o_orderkey), customer.c_custkey)\n" +
			"                         ├─ Grouping(customer.c_custkey)\n" +
			"                         └─ LeftOuterJoin\n" +
			"                             ├─ ((customer.c_custkey = orders.o_custkey) AND (NOT(orders.o_comment LIKE '%special%requests%')))\n" +
			"                             ├─ Table\n" +
			"                             │   ├─ name: customer\n" +
			"                             │   └─ columns: [c_custkey]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: orders\n" +
			"                                 └─ columns: [o_orderkey o_custkey o_comment]\n" +
			"",
	},
	{
		Query: `
--Q14
select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= '1995-09-01'
	and l_shipdate < '1995-09-01' + interval '1' month;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [((100 (decimal(5,2)) * sum(case  when part.p_type like 'promo%' then (lineitem.l_extendedprice * (1 - lineitem.l_discount)) else 0 end):1!null) / sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null)->promo_revenue:0]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), SUM(CASE  WHEN part.p_type LIKE 'PROMO%' THEN (lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null)) ELSE 0 (tinyint) END)\n" +
			"     ├─ group: \n" +
			"     └─ LookupJoin\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │   │   └─ 1995-09-01 (longtext)\n" +
			"         │   │   └─ LessThan\n" +
			"         │   │       ├─ lineitem.l_shipdate:3!null\n" +
			"         │   │       └─ 1995-10-01 00:00:00 +0000 UTC (datetime)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: lineitem\n" +
			"         │           └─ columns: [l_partkey l_extendedprice l_discount l_shipdate]\n" +
			"         └─ IndexedTableAccess(part)\n" +
			"             ├─ index: [part.P_PARTKEY]\n" +
			"             ├─ keys: [lineitem.l_partkey:0!null]\n" +
			"             ├─ colSet: (17-25)\n" +
			"             ├─ tableId: 2\n" +
			"             └─ Table\n" +
			"                 ├─ name: part\n" +
			"                 └─ columns: [p_partkey p_type]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [((100.00 * sum(case  when part.p_type like 'promo%' then (lineitem.l_extendedprice * (1 - lineitem.l_discount)) else 0 end)) / sum((lineitem.l_extendedprice * (1 - lineitem.l_discount)))) as promo_revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), SUM(CASE  WHEN part.p_type LIKE 'PROMO%' THEN (lineitem.l_extendedprice * (1 - lineitem.l_discount)) ELSE 0 END))\n" +
			"     ├─ Grouping()\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((lineitem.l_shipdate >= '1995-09-01') AND (lineitem.l_shipdate < 1995-10-01 00:00:00 +0000 UTC))\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: lineitem\n" +
			"         │       └─ columns: [l_partkey l_extendedprice l_discount l_shipdate]\n" +
			"         └─ IndexedTableAccess(part)\n" +
			"             ├─ index: [part.P_PARTKEY]\n" +
			"             ├─ columns: [p_partkey p_type]\n" +
			"             └─ keys: lineitem.l_partkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [((100.00 * sum(case  when part.p_type like 'promo%' then (lineitem.l_extendedprice * (1 - lineitem.l_discount)) else 0 end)) / sum((lineitem.l_extendedprice * (1 - lineitem.l_discount)))) as promo_revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), SUM(CASE  WHEN part.p_type LIKE 'PROMO%' THEN (lineitem.l_extendedprice * (1 - lineitem.l_discount)) ELSE 0 END))\n" +
			"     ├─ Grouping()\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((lineitem.l_shipdate >= '1995-09-01') AND (lineitem.l_shipdate < 1995-10-01 00:00:00 +0000 UTC))\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: lineitem\n" +
			"         │       └─ columns: [l_partkey l_extendedprice l_discount l_shipdate]\n" +
			"         └─ IndexedTableAccess(part)\n" +
			"             ├─ index: [part.P_PARTKEY]\n" +
			"             ├─ columns: [p_partkey p_type]\n" +
			"             └─ keys: lineitem.l_partkey\n" +
			"",
	},
	{
		Query: `
--Q15
with revenue0 (supplier_no, total_revenue) as (
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= '1996-01-01'
		and l_shipdate < '1996-01-01' + interval '3' month
	group by
		l_suppkey)
select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_suppkey:2!null, supplier.s_name:3!null, supplier.s_address:4!null, supplier.s_phone:6!null, revenue0.total_revenue:1!null]\n" +
			" └─ Sort(supplier.s_suppkey:2!null ASC nullsFirst)\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ revenue0.total_revenue:1!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       ├─ alias-string: select max(total_revenue) from revenue0\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [max(revenue0.total_revenue):9!null->max(total_revenue):0]\n" +
			"         │           └─ GroupBy\n" +
			"         │               ├─ select: MAX(revenue0.total_revenue:10!null)\n" +
			"         │               ├─ group: \n" +
			"         │               └─ SubqueryAlias\n" +
			"         │                   ├─ name: revenue0\n" +
			"         │                   ├─ outerVisibility: true\n" +
			"         │                   ├─ isLateral: false\n" +
			"         │                   ├─ cacheable: true\n" +
			"         │                   ├─ colSet: (29,30)\n" +
			"         │                   ├─ tableId: 4\n" +
			"         │                   └─ Project\n" +
			"         │                       ├─ columns: [lineitem.l_suppkey:10!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):9!null->sum(l_extendedprice * (1 - l_discount)):0]\n" +
			"         │                       └─ GroupBy\n" +
			"         │                           ├─ select: SUM((lineitem.l_extendedprice:10!null * (1 (tinyint) - lineitem.l_discount:11!null))), lineitem.l_suppkey:9!null\n" +
			"         │                           ├─ group: lineitem.l_suppkey:9!null\n" +
			"         │                           └─ Filter\n" +
			"         │                               ├─ AND\n" +
			"         │                               │   ├─ GreaterThanOrEqual\n" +
			"         │                               │   │   ├─ lineitem.l_shipdate:12!null\n" +
			"         │                               │   │   └─ 1996-01-01 (longtext)\n" +
			"         │                               │   └─ LessThan\n" +
			"         │                               │       ├─ lineitem.l_shipdate:12!null\n" +
			"         │                               │       └─ 1996-04-01 00:00:00 +0000 UTC (datetime)\n" +
			"         │                               └─ Table\n" +
			"         │                                   ├─ name: lineitem\n" +
			"         │                                   ├─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"         │                                   ├─ colSet: (1-16)\n" +
			"         │                                   └─ tableId: 1\n" +
			"         └─ LookupJoin\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: revenue0\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ isLateral: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   ├─ colSet: (27,28)\n" +
			"             │   ├─ tableId: 3\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [lineitem.l_suppkey:1!null, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->sum(l_extendedprice * (1 - l_discount)):0]\n" +
			"             │       └─ GroupBy\n" +
			"             │           ├─ select: SUM((lineitem.l_extendedprice:1!null * (1 (tinyint) - lineitem.l_discount:2!null))), lineitem.l_suppkey:0!null\n" +
			"             │           ├─ group: lineitem.l_suppkey:0!null\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ AND\n" +
			"             │               │   ├─ GreaterThanOrEqual\n" +
			"             │               │   │   ├─ lineitem.l_shipdate:3!null\n" +
			"             │               │   │   └─ 1996-01-01 (longtext)\n" +
			"             │               │   └─ LessThan\n" +
			"             │               │       ├─ lineitem.l_shipdate:3!null\n" +
			"             │               │       └─ 1996-04-01 00:00:00 +0000 UTC (datetime)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: lineitem\n" +
			"             │                   ├─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"             │                   ├─ colSet: (1-16)\n" +
			"             │                   └─ tableId: 1\n" +
			"             └─ IndexedTableAccess(supplier)\n" +
			"                 ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 ├─ keys: [revenue0.supplier_no:0!null]\n" +
			"                 ├─ colSet: (20-26)\n" +
			"                 ├─ tableId: 4\n" +
			"                 └─ Table\n" +
			"                     ├─ name: supplier\n" +
			"                     └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_phone, revenue0.total_revenue]\n" +
			" └─ Sort(supplier.s_suppkey ASC)\n" +
			"     └─ Filter\n" +
			"         ├─ (revenue0.total_revenue = Subquery(select max(total_revenue) from revenue0))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: revenue0\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ isLateral: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [lineitem.l_suppkey, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as sum(l_extendedprice * (1 - l_discount))]\n" +
			"             │       └─ GroupBy\n" +
			"             │           ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_suppkey)\n" +
			"             │           ├─ Grouping(lineitem.l_suppkey)\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ ((lineitem.l_shipdate >= '1996-01-01') AND (lineitem.l_shipdate < 1996-04-01 00:00:00 +0000 UTC))\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: lineitem\n" +
			"             │                   └─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"             └─ IndexedTableAccess(supplier)\n" +
			"                 ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 └─ keys: revenue0.supplier_no\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_phone, revenue0.total_revenue]\n" +
			" └─ Sort(supplier.s_suppkey ASC)\n" +
			"     └─ Filter\n" +
			"         ├─ (revenue0.total_revenue = Subquery(select max(total_revenue) from revenue0))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: revenue0\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ isLateral: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [lineitem.l_suppkey, sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as sum(l_extendedprice * (1 - l_discount))]\n" +
			"             │       └─ GroupBy\n" +
			"             │           ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))), lineitem.l_suppkey)\n" +
			"             │           ├─ Grouping(lineitem.l_suppkey)\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ ((lineitem.l_shipdate >= '1996-01-01') AND (lineitem.l_shipdate < 1996-04-01 00:00:00 +0000 UTC))\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: lineitem\n" +
			"             │                   └─ columns: [l_suppkey l_extendedprice l_discount l_shipdate]\n" +
			"             └─ IndexedTableAccess(supplier)\n" +
			"                 ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 └─ keys: revenue0.supplier_no\n" +
			"",
	},
	{
		Query: `
--Q16
select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#45'
	and p_type not like 'MEDIUM POLISHED%'
	and p_size in (49, 14, 23, 45, 19, 3, 36, 9)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [part.p_brand:1!null, part.p_type:2!null, part.p_size:3!null, countdistinct([partsupp.ps_suppkey]):0!null->supplier_cnt:0]\n" +
			" └─ Sort(supplier_cnt:4!null DESC nullsFirst, part.p_brand:1!null ASC nullsFirst, part.p_type:2!null ASC nullsFirst, part.p_size:3!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [countdistinct([partsupp.ps_suppkey]):0!null, part.p_brand:1!null, part.p_type:2!null, part.p_size:3!null, countdistinct([partsupp.ps_suppkey]):0!null->supplier_cnt:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNTDISTINCT([partsupp.ps_suppkey]), part.p_brand:8!null, part.p_type:9!null, part.p_size:10!null\n" +
			"             ├─ group: part.p_brand:8!null, part.p_type:9!null, part.p_size:10!null\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [partsupp.PS_PARTKEY:0!null, partsupp.PS_SUPPKEY:1!null, partsupp.PS_AVAILQTY:2!null, partsupp.PS_SUPPLYCOST:3!null, partsupp.PS_COMMENT:4!null, part.P_PARTKEY:5!null, part.P_NAME:6!null, part.P_MFGR:7!null, part.P_BRAND:8!null, part.P_TYPE:9!null, part.P_SIZE:10!null, part.P_CONTAINER:11!null, part.P_RETAILPRICE:12!null, part.P_COMMENT:13!null]\n" +
			"                 └─ Filter\n" +
			"                     ├─ supplier.s_suppkey:14!null IS NULL\n" +
			"                     └─ LeftOuterLookupJoin\n" +
			"                         ├─ MergeJoin\n" +
			"                         │   ├─ cmp: Eq\n" +
			"                         │   │   ├─ partsupp.ps_partkey:0!null\n" +
			"                         │   │   └─ part.p_partkey:5!null\n" +
			"                         │   ├─ IndexedTableAccess(partsupp)\n" +
			"                         │   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                         │   │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   │   ├─ colSet: (1-5)\n" +
			"                         │   │   ├─ tableId: 1\n" +
			"                         │   │   └─ Table\n" +
			"                         │   │       ├─ name: partsupp\n" +
			"                         │   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ AND\n" +
			"                         │       │   ├─ AND\n" +
			"                         │       │   │   ├─ NOT\n" +
			"                         │       │   │   │   └─ Eq\n" +
			"                         │       │   │   │       ├─ part.p_brand:3!null\n" +
			"                         │       │   │   │       └─ Brand#45 (longtext)\n" +
			"                         │       │   │   └─ Or\n" +
			"                         │       │   │       ├─ LessThan\n" +
			"                         │       │   │       │   ├─ part.p_type:4!null\n" +
			"                         │       │   │       │   └─ MEDIUM POLISHED (longtext)\n" +
			"                         │       │   │       └─ GreaterThan\n" +
			"                         │       │   │           ├─ part.p_type:4!null\n" +
			"                         │       │   │           └─ MEDIUM POLISHEDÿ (longtext)\n" +
			"                         │       │   └─ HashIn\n" +
			"                         │       │       ├─ part.p_size:5!null\n" +
			"                         │       │       └─ TUPLE(49 (tinyint), 14 (tinyint), 23 (tinyint), 45 (tinyint), 19 (tinyint), 3 (tinyint), 36 (tinyint), 9 (tinyint))\n" +
			"                         │       └─ IndexedTableAccess(part)\n" +
			"                         │           ├─ index: [part.P_PARTKEY]\n" +
			"                         │           ├─ static: [{[NULL, ∞)}]\n" +
			"                         │           ├─ colSet: (6-14)\n" +
			"                         │           ├─ tableId: 2\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: part\n" +
			"                         │               └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [supplier.s_suppkey:0!null]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ supplier.s_comment LIKE '%Customer%Complaints%'\n" +
			"                                 └─ IndexedTableAccess(supplier)\n" +
			"                                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                                     ├─ keys: [partsupp.ps_suppkey:1!null]\n" +
			"                                     ├─ colSet: (15-21)\n" +
			"                                     ├─ tableId: 3\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: supplier\n" +
			"                                         └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [part.p_brand, part.p_type, part.p_size, countdistinct([partsupp.ps_suppkey]) as supplier_cnt]\n" +
			" └─ Sort(supplier_cnt DESC, part.p_brand ASC, part.p_type ASC, part.p_size ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [countdistinct([partsupp.ps_suppkey]), part.p_brand, part.p_type, part.p_size, countdistinct([partsupp.ps_suppkey]) as supplier_cnt]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNTDISTINCT([partsupp.ps_suppkey]), part.p_brand, part.p_type, part.p_size)\n" +
			"             ├─ Grouping(part.p_brand, part.p_type, part.p_size)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [partsupp.PS_PARTKEY, partsupp.PS_SUPPKEY, partsupp.PS_AVAILQTY, partsupp.PS_SUPPLYCOST, partsupp.PS_COMMENT, part.P_PARTKEY, part.P_NAME, part.P_MFGR, part.P_BRAND, part.P_TYPE, part.P_SIZE, part.P_CONTAINER, part.P_RETAILPRICE, part.P_COMMENT]\n" +
			"                 └─ Filter\n" +
			"                     ├─ supplier.s_suppkey IS NULL\n" +
			"                     └─ LeftOuterLookupJoin\n" +
			"                         ├─ MergeJoin\n" +
			"                         │   ├─ cmp: (partsupp.ps_partkey = part.p_partkey)\n" +
			"                         │   ├─ IndexedTableAccess(partsupp)\n" +
			"                         │   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                         │   │   └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (((NOT((part.p_brand = 'Brand#45'))) AND ((part.p_type < 'MEDIUM POLISHED') OR (part.p_type > 'MEDIUM POLISHEDÿ'))) AND (part.p_size HASH IN (49, 14, 23, 45, 19, 3, 36, 9)))\n" +
			"                         │       └─ IndexedTableAccess(part)\n" +
			"                         │           ├─ index: [part.P_PARTKEY]\n" +
			"                         │           └─ filters: [{[NULL, ∞)}]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [supplier.s_suppkey]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ supplier.s_comment LIKE '%Customer%Complaints%'\n" +
			"                                 └─ IndexedTableAccess(supplier)\n" +
			"                                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                                     └─ keys: partsupp.ps_suppkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [part.p_brand, part.p_type, part.p_size, countdistinct([partsupp.ps_suppkey]) as supplier_cnt]\n" +
			" └─ Sort(supplier_cnt DESC, part.p_brand ASC, part.p_type ASC, part.p_size ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [countdistinct([partsupp.ps_suppkey]), part.p_brand, part.p_type, part.p_size, countdistinct([partsupp.ps_suppkey]) as supplier_cnt]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNTDISTINCT([partsupp.ps_suppkey]), part.p_brand, part.p_type, part.p_size)\n" +
			"             ├─ Grouping(part.p_brand, part.p_type, part.p_size)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [partsupp.PS_PARTKEY, partsupp.PS_SUPPKEY, partsupp.PS_AVAILQTY, partsupp.PS_SUPPLYCOST, partsupp.PS_COMMENT, part.P_PARTKEY, part.P_NAME, part.P_MFGR, part.P_BRAND, part.P_TYPE, part.P_SIZE, part.P_CONTAINER, part.P_RETAILPRICE, part.P_COMMENT]\n" +
			"                 └─ Filter\n" +
			"                     ├─ supplier.s_suppkey IS NULL\n" +
			"                     └─ LeftOuterLookupJoin\n" +
			"                         ├─ MergeJoin\n" +
			"                         │   ├─ cmp: (partsupp.ps_partkey = part.p_partkey)\n" +
			"                         │   ├─ IndexedTableAccess(partsupp)\n" +
			"                         │   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"                         │   │   └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (((NOT((part.p_brand = 'Brand#45'))) AND ((part.p_type < 'MEDIUM POLISHED') OR (part.p_type > 'MEDIUM POLISHEDÿ'))) AND (part.p_size HASH IN (49, 14, 23, 45, 19, 3, 36, 9)))\n" +
			"                         │       └─ IndexedTableAccess(part)\n" +
			"                         │           ├─ index: [part.P_PARTKEY]\n" +
			"                         │           └─ filters: [{[NULL, ∞)}]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [supplier.s_suppkey]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ supplier.s_comment LIKE '%Customer%Complaints%'\n" +
			"                                 └─ IndexedTableAccess(supplier)\n" +
			"                                     ├─ index: [supplier.S_SUPPKEY]\n" +
			"                                     └─ keys: partsupp.ps_suppkey\n" +
			"",
	},
	{
		Query: `
--Q17
select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#23'
	and p_container = 'MED BOX'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [(sum(lineitem.l_extendedprice):0!null / 7 (decimal(2,1)))->avg_yearly:0]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM(lineitem.l_extendedprice:5!null)\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ LessThan\n" +
			"         │   ├─ lineitem.l_quantity:4!null\n" +
			"         │   └─ Subquery\n" +
			"         │       ├─ cacheable: false\n" +
			"         │       ├─ alias-string: select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [(0.2 (decimal(2,1)) * avg(lineitem.l_quantity):25)->0.2 * avg(l_quantity):0]\n" +
			"         │           └─ GroupBy\n" +
			"         │               ├─ select: AVG(lineitem.l_quantity:26!null)\n" +
			"         │               ├─ group: \n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ lineitem.l_partkey:25!null\n" +
			"         │                   │   └─ part.p_partkey:16!null\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: lineitem\n" +
			"         │                       ├─ columns: [l_partkey l_quantity]\n" +
			"         │                       ├─ colSet: (26-41)\n" +
			"         │                       └─ tableId: 3\n" +
			"         └─ LookupJoin\n" +
			"             ├─ ProcessTable\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: lineitem\n" +
			"             │       └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ part.p_brand:3!null\n" +
			"                 │   │   └─ Brand#23 (longtext)\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ part.p_container:6!null\n" +
			"                 │       └─ MED BOX (longtext)\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     ├─ keys: [lineitem.l_partkey:1!null]\n" +
			"                     ├─ colSet: (17-25)\n" +
			"                     ├─ tableId: 2\n" +
			"                     └─ Table\n" +
			"                         ├─ name: part\n" +
			"                         └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [(sum(lineitem.l_extendedprice) / 7.0) as avg_yearly]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM(lineitem.l_extendedprice))\n" +
			"     ├─ Grouping()\n" +
			"     └─ Filter\n" +
			"         ├─ (lineitem.l_quantity < Subquery(select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Table\n" +
			"             │   └─ name: lineitem\n" +
			"             └─ Filter\n" +
			"                 ├─ ((part.p_brand = 'Brand#23') AND (part.p_container = 'MED BOX'))\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     └─ keys: lineitem.l_partkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [(sum(lineitem.l_extendedprice) / 7.0) as avg_yearly]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM(lineitem.l_extendedprice))\n" +
			"     ├─ Grouping()\n" +
			"     └─ Filter\n" +
			"         ├─ (lineitem.l_quantity < Subquery(select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey))\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Table\n" +
			"             │   └─ name: lineitem\n" +
			"             └─ Filter\n" +
			"                 ├─ ((part.p_brand = 'Brand#23') AND (part.p_container = 'MED BOX'))\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     └─ keys: lineitem.l_partkey\n" +
			"",
	},
	{
		Query: `
--Q18
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [customer.c_name:1!null, customer.c_custkey:2!null, orders.o_orderkey:3!null, orders.o_orderdate:4!null, orders.o_totalprice:5!null, sum(lineitem.l_quantity):0!null->sum(l_quantity):0]\n" +
			" └─ Sort(orders.o_totalprice:5!null DESC nullsFirst, orders.o_orderdate:4!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(lineitem.l_quantity:21!null), customer.c_name:1!null, customer.c_custkey:0!null, orders.o_orderkey:8!null, orders.o_orderdate:12!null, orders.o_totalprice:11!null\n" +
			"         ├─ group: customer.c_name:1!null, customer.c_custkey:0!null, orders.o_orderkey:8!null, orders.o_orderdate:12!null, orders.o_totalprice:11!null\n" +
			"         └─ SemiJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ orders.o_orderkey:8!null\n" +
			"             │   └─ lineitem_1.l_orderkey:33!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ orders.o_orderkey:8!null\n" +
			"             │   │   └─ lineitem.l_orderkey:17!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ customer.c_custkey:0!null\n" +
			"             │   │   │   └─ orders.o_custkey:9!null\n" +
			"             │   │   ├─ ProcessTable\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: customer\n" +
			"             │   │   │       └─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_mktsegment c_comment]\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: orders\n" +
			"             │   │           └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: lineitem\n" +
			"             │           └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [lineitem_1.l_orderkey:1!null]\n" +
			"                 └─ Having\n" +
			"                     ├─ GreaterThan\n" +
			"                     │   ├─ sum(lineitem.l_quantity):0!null\n" +
			"                     │   └─ 300 (smallint)\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ select: SUM(lineitem_1.l_quantity:4!null), lineitem_1.l_orderkey:0!null\n" +
			"                         ├─ group: lineitem_1.l_orderkey:0!null\n" +
			"                         └─ TableAlias(lineitem_1)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: lineitem\n" +
			"                                 ├─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                                 ├─ colSet: (34-49)\n" +
			"                                 └─ tableId: 4\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice, sum(lineitem.l_quantity) as sum(l_quantity)]\n" +
			" └─ Sort(orders.o_totalprice DESC, orders.o_orderdate ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(lineitem.l_quantity), customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice)\n" +
			"         ├─ Grouping(customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice)\n" +
			"         └─ SemiJoin\n" +
			"             ├─ (orders.o_orderkey = lineitem_1.l_orderkey)\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (customer.c_custkey = orders.o_custkey)\n" +
			"             │   │   ├─ Table\n" +
			"             │   │   │   └─ name: customer\n" +
			"             │   │   └─ Table\n" +
			"             │   │       └─ name: orders\n" +
			"             │   └─ Table\n" +
			"             │       └─ name: lineitem\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [lineitem_1.l_orderkey]\n" +
			"                 └─ Having((sum(lineitem.l_quantity) > 300))\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ SelectDeps(SUM(lineitem_1.l_quantity), lineitem_1.l_orderkey)\n" +
			"                         ├─ Grouping(lineitem_1.l_orderkey)\n" +
			"                         └─ TableAlias(lineitem_1)\n" +
			"                             └─ Table\n" +
			"                                 └─ name: lineitem\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice, sum(lineitem.l_quantity) as sum(l_quantity)]\n" +
			" └─ Sort(orders.o_totalprice DESC, orders.o_orderdate ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(SUM(lineitem.l_quantity), customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice)\n" +
			"         ├─ Grouping(customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice)\n" +
			"         └─ SemiJoin\n" +
			"             ├─ (orders.o_orderkey = lineitem_1.l_orderkey)\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (orders.o_orderkey = lineitem.l_orderkey)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (customer.c_custkey = orders.o_custkey)\n" +
			"             │   │   ├─ Table\n" +
			"             │   │   │   └─ name: customer\n" +
			"             │   │   └─ Table\n" +
			"             │   │       └─ name: orders\n" +
			"             │   └─ Table\n" +
			"             │       └─ name: lineitem\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [lineitem_1.l_orderkey]\n" +
			"                 └─ Having((sum(lineitem.l_quantity) > 300))\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ SelectDeps(SUM(lineitem_1.l_quantity), lineitem_1.l_orderkey)\n" +
			"                         ├─ Grouping(lineitem_1.l_orderkey)\n" +
			"                         └─ TableAlias(lineitem_1)\n" +
			"                             └─ Table\n" +
			"                                 └─ name: lineitem\n" +
			"",
	},
	{
		Query: `
--Q19
select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#12'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#34'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))):0!null->revenue:0]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: SUM((lineitem.l_extendedprice:2!null * (1 (tinyint) - lineitem.l_discount:3!null)))\n" +
			"     ├─ group: \n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Or\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │   │   │   │   │   │   │   │   │       └─ Brand#12 (longtext)\n" +
			"         │   │   │   │   │   │   │   │   └─ IN\n" +
			"         │   │   │   │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │   │   │   │   │   │   │   │       └─ right: TUPLE(SM CASE (longtext), SM BOX (longtext), SM PACK (longtext), SM PKG (longtext))\n" +
			"         │   │   │   │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │   │   │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │   │   │   │   │   │       └─ 1 (tinyint)\n" +
			"         │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │   │   │   │   │       └─ 11 (bigint)\n" +
			"         │   │   │   │   │   └─ AND\n" +
			"         │   │   │   │   │       ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   │       │   ├─ part.p_size:8!null\n" +
			"         │   │   │   │   │       │   └─ 1 (tinyint)\n" +
			"         │   │   │   │   │       └─ LessThanOrEqual\n" +
			"         │   │   │   │   │           ├─ part.p_size:8!null\n" +
			"         │   │   │   │   │           └─ 5 (tinyint)\n" +
			"         │   │   │   │   └─ IN\n" +
			"         │   │   │   │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │   │   │   │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │   │   │       └─ DELIVER IN PERSON (longtext)\n" +
			"         │   │   └─ AND\n" +
			"         │   │       ├─ AND\n" +
			"         │   │       │   ├─ AND\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   │   ├─ AND\n" +
			"         │   │       │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │       │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │   │       │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │   │       │   │   │   │   │   │   └─ Eq\n" +
			"         │   │       │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │   │       │   │   │   │   │   │       └─ Brand#23 (longtext)\n" +
			"         │   │       │   │   │   │   │   └─ IN\n" +
			"         │   │       │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │   │       │   │   │   │   │       └─ right: TUPLE(MED BAG (longtext), MED BOX (longtext), MED PKG (longtext), MED PACK (longtext))\n" +
			"         │   │       │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │       │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │       │   │   │   │       └─ 10 (tinyint)\n" +
			"         │   │       │   │   │   └─ LessThanOrEqual\n" +
			"         │   │       │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │   │       │   │   │       └─ 20 (bigint)\n" +
			"         │   │       │   │   └─ AND\n" +
			"         │   │       │   │       ├─ GreaterThanOrEqual\n" +
			"         │   │       │   │       │   ├─ part.p_size:8!null\n" +
			"         │   │       │   │       │   └─ 1 (tinyint)\n" +
			"         │   │       │   │       └─ LessThanOrEqual\n" +
			"         │   │       │   │           ├─ part.p_size:8!null\n" +
			"         │   │       │   │           └─ 10 (tinyint)\n" +
			"         │   │       │   └─ IN\n" +
			"         │   │       │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │   │       │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │   │       └─ Eq\n" +
			"         │   │           ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │   │           └─ DELIVER IN PERSON (longtext)\n" +
			"         │   └─ AND\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ AND\n" +
			"         │       │   │   ├─ AND\n" +
			"         │       │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   │   ├─ AND\n" +
			"         │       │   │   │   │   │   │   ├─ Eq\n" +
			"         │       │   │   │   │   │   │   │   ├─ part.p_partkey:6!null\n" +
			"         │       │   │   │   │   │   │   │   └─ lineitem.l_partkey:0!null\n" +
			"         │       │   │   │   │   │   │   └─ Eq\n" +
			"         │       │   │   │   │   │   │       ├─ part.p_brand:7!null\n" +
			"         │       │   │   │   │   │   │       └─ Brand#34 (longtext)\n" +
			"         │       │   │   │   │   │   └─ IN\n" +
			"         │       │   │   │   │   │       ├─ left: part.p_container:9!null\n" +
			"         │       │   │   │   │   │       └─ right: TUPLE(LG CASE (longtext), LG BOX (longtext), LG PACK (longtext), LG PKG (longtext))\n" +
			"         │       │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │       │   │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │       │   │   │   │       └─ 20 (tinyint)\n" +
			"         │       │   │   │   └─ LessThanOrEqual\n" +
			"         │       │   │   │       ├─ lineitem.l_quantity:1!null\n" +
			"         │       │   │   │       └─ 30 (bigint)\n" +
			"         │       │   │   └─ AND\n" +
			"         │       │   │       ├─ GreaterThanOrEqual\n" +
			"         │       │   │       │   ├─ part.p_size:8!null\n" +
			"         │       │   │       │   └─ 1 (tinyint)\n" +
			"         │       │   │       └─ LessThanOrEqual\n" +
			"         │       │   │           ├─ part.p_size:8!null\n" +
			"         │       │   │           └─ 15 (tinyint)\n" +
			"         │       │   └─ IN\n" +
			"         │       │       ├─ left: lineitem.l_shipmode:5!null\n" +
			"         │       │       └─ right: TUPLE(AIR (longtext), AIR REG (longtext))\n" +
			"         │       └─ Eq\n" +
			"         │           ├─ lineitem.l_shipinstruct:4!null\n" +
			"         │           └─ DELIVER IN PERSON (longtext)\n" +
			"         ├─ ProcessTable\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: lineitem\n" +
			"         │       └─ columns: [l_partkey l_quantity l_extendedprice l_discount l_shipinstruct l_shipmode]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(part)\n" +
			"             │   ├─ index: [part.P_PARTKEY]\n" +
			"             │   ├─ keys: [lineitem.l_partkey:0!null]\n" +
			"             │   ├─ colSet: (17-25)\n" +
			"             │   ├─ tableId: 2\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: part\n" +
			"             │       └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(part)\n" +
			"                 │   ├─ index: [part.P_PARTKEY]\n" +
			"                 │   ├─ keys: [lineitem.l_partkey:0!null]\n" +
			"                 │   ├─ colSet: (17-25)\n" +
			"                 │   ├─ tableId: 2\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: part\n" +
			"                 │       └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     ├─ keys: [lineitem.l_partkey:0!null]\n" +
			"                     ├─ colSet: (17-25)\n" +
			"                     ├─ tableId: 2\n" +
			"                     └─ Table\n" +
			"                         ├─ name: part\n" +
			"                         └─ columns: [p_partkey p_brand p_size p_container]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))))\n" +
			"     ├─ Grouping()\n" +
			"     └─ LookupJoin\n" +
			"         ├─ ((((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#12')) AND (part.p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG'))) AND (lineitem.l_quantity >= 1)) AND (lineitem.l_quantity <= 11)) AND ((part.p_size >= 1) AND (part.p_size <= 5))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#23')) AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK'))) AND (lineitem.l_quantity >= 10)) AND (lineitem.l_quantity <= 20)) AND ((part.p_size >= 1) AND (part.p_size <= 10))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#34')) AND (part.p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG'))) AND (lineitem.l_quantity >= 20)) AND (lineitem.l_quantity <= 30)) AND ((part.p_size >= 1) AND (part.p_size <= 15))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')))\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: lineitem\n" +
			"         │   └─ columns: [l_partkey l_quantity l_extendedprice l_discount l_shipinstruct l_shipmode]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(part)\n" +
			"             │   ├─ index: [part.P_PARTKEY]\n" +
			"             │   ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"             │   └─ keys: lineitem.l_partkey\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(part)\n" +
			"                 │   ├─ index: [part.P_PARTKEY]\n" +
			"                 │   ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                 │   └─ keys: lineitem.l_partkey\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                     └─ keys: lineitem.l_partkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [sum((lineitem.l_extendedprice * (1 - lineitem.l_discount))) as revenue]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectDeps(SUM((lineitem.l_extendedprice * (1 - lineitem.l_discount))))\n" +
			"     ├─ Grouping()\n" +
			"     └─ LookupJoin\n" +
			"         ├─ ((((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#12')) AND (part.p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG'))) AND (lineitem.l_quantity >= 1)) AND (lineitem.l_quantity <= 11)) AND ((part.p_size >= 1) AND (part.p_size <= 5))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#23')) AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK'))) AND (lineitem.l_quantity >= 10)) AND (lineitem.l_quantity <= 20)) AND ((part.p_size >= 1) AND (part.p_size <= 10))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#34')) AND (part.p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG'))) AND (lineitem.l_quantity >= 20)) AND (lineitem.l_quantity <= 30)) AND ((part.p_size >= 1) AND (part.p_size <= 15))) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG'))) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')))\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: lineitem\n" +
			"         │   └─ columns: [l_partkey l_quantity l_extendedprice l_discount l_shipinstruct l_shipmode]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(part)\n" +
			"             │   ├─ index: [part.P_PARTKEY]\n" +
			"             │   ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"             │   └─ keys: lineitem.l_partkey\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(part)\n" +
			"                 │   ├─ index: [part.P_PARTKEY]\n" +
			"                 │   ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                 │   └─ keys: lineitem.l_partkey\n" +
			"                 └─ IndexedTableAccess(part)\n" +
			"                     ├─ index: [part.P_PARTKEY]\n" +
			"                     ├─ columns: [p_partkey p_brand p_size p_container]\n" +
			"                     └─ keys: lineitem.l_partkey\n" +
			"",
	},
	{
		Query: `
--Q20
select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'forest%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= '1994-01-01'
					and l_shipdate < '1994-01-01' + interval '1' year
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'CANADA'
order by
	s_name;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_name:2!null, supplier.s_address:3!null]\n" +
			" └─ Sort(supplier.s_name:2!null ASC nullsFirst)\n" +
			"     └─ LookupJoin\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ supplier.s_suppkey:1!null\n" +
			"         │   │   └─ partsupp.ps_suppkey:0!null\n" +
			"         │   ├─ Distinct\n" +
			"         │   │   └─ Project\n" +
			"         │   │       ├─ columns: [partsupp.ps_suppkey:1!null]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ GreaterThan\n" +
			"         │   │           │   ├─ partsupp.ps_availqty:2!null\n" +
			"         │   │           │   └─ Subquery\n" +
			"         │   │           │       ├─ cacheable: false\n" +
			"         │   │           │       ├─ alias-string: select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= '1994-01-01' and l_shipdate < '1994-01-01' + interval '1' year\n" +
			"         │   │           │       └─ Project\n" +
			"         │   │           │           ├─ columns: [(0.5 (decimal(2,1)) * sum(lineitem.l_quantity):5!null)->0.5 * sum(l_quantity):0]\n" +
			"         │   │           │           └─ GroupBy\n" +
			"         │   │           │               ├─ select: SUM(lineitem.l_quantity:7!null)\n" +
			"         │   │           │               ├─ group: \n" +
			"         │   │           │               └─ Filter\n" +
			"         │   │           │                   ├─ AND\n" +
			"         │   │           │                   │   ├─ AND\n" +
			"         │   │           │                   │   │   ├─ AND\n" +
			"         │   │           │                   │   │   │   ├─ Eq\n" +
			"         │   │           │                   │   │   │   │   ├─ lineitem.l_partkey:5!null\n" +
			"         │   │           │                   │   │   │   │   └─ partsupp.ps_partkey:0!null\n" +
			"         │   │           │                   │   │   │   └─ Eq\n" +
			"         │   │           │                   │   │   │       ├─ lineitem.l_suppkey:6!null\n" +
			"         │   │           │                   │   │   │       └─ partsupp.ps_suppkey:1!null\n" +
			"         │   │           │                   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │           │                   │   │       ├─ lineitem.l_shipdate:8!null\n" +
			"         │   │           │                   │   │       └─ 1994-01-01 (longtext)\n" +
			"         │   │           │                   │   └─ LessThan\n" +
			"         │   │           │                   │       ├─ lineitem.l_shipdate:8!null\n" +
			"         │   │           │                   │       └─ 1995-01-01 00:00:00 +0000 UTC (datetime)\n" +
			"         │   │           │                   └─ Table\n" +
			"         │   │           │                       ├─ name: lineitem\n" +
			"         │   │           │                       ├─ columns: [l_partkey l_suppkey l_quantity l_shipdate]\n" +
			"         │   │           │                       ├─ colSet: (26-41)\n" +
			"         │   │           │                       └─ tableId: 5\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [partsupp.PS_PARTKEY:0!null, partsupp.PS_SUPPKEY:1!null, partsupp.PS_AVAILQTY:2!null, partsupp.PS_SUPPLYCOST:3!null, partsupp.PS_COMMENT:4!null]\n" +
			"         │   │               └─ MergeJoin\n" +
			"         │   │                   ├─ cmp: Eq\n" +
			"         │   │                   │   ├─ partsupp.ps_partkey:0!null\n" +
			"         │   │                   │   └─ part.p_partkey:5!null\n" +
			"         │   │                   ├─ IndexedTableAccess(partsupp)\n" +
			"         │   │                   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"         │   │                   │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │                   │   ├─ colSet: (12-16)\n" +
			"         │   │                   │   ├─ tableId: 3\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: partsupp\n" +
			"         │   │                   │       └─ columns: [ps_partkey ps_suppkey ps_availqty ps_supplycost ps_comment]\n" +
			"         │   │                   └─ Project\n" +
			"         │   │                       ├─ columns: [part.p_partkey:0!null]\n" +
			"         │   │                       └─ Filter\n" +
			"         │   │                           ├─ AND\n" +
			"         │   │                           │   ├─ AND\n" +
			"         │   │                           │   │   ├─ AND\n" +
			"         │   │                           │   │   │   ├─ AND\n" +
			"         │   │                           │   │   │   │   ├─ AND\n" +
			"         │   │                           │   │   │   │   │   ├─ AND\n" +
			"         │   │                           │   │   │   │   │   │   ├─ AND\n" +
			"         │   │                           │   │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │                           │   │   │   │   │   │   │   │   ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │   │   │   │   │   │   └─ forest (longtext)\n" +
			"         │   │                           │   │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"         │   │                           │   │   │   │   │   │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │   │   │   │   │       └─ forestÿ (longtext)\n" +
			"         │   │                           │   │   │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │                           │   │   │   │   │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │   │   │   │       └─ forest (longtext)\n" +
			"         │   │                           │   │   │   │   │   └─ LessThanOrEqual\n" +
			"         │   │                           │   │   │   │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │   │   │       └─ forestÿ (longtext)\n" +
			"         │   │                           │   │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │                           │   │   │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │   │       └─ forest (longtext)\n" +
			"         │   │                           │   │   │   └─ LessThanOrEqual\n" +
			"         │   │                           │   │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │   │       └─ forestÿ (longtext)\n" +
			"         │   │                           │   │   └─ GreaterThanOrEqual\n" +
			"         │   │                           │   │       ├─ part.p_name:1!null\n" +
			"         │   │                           │   │       └─ forest (longtext)\n" +
			"         │   │                           │   └─ LessThanOrEqual\n" +
			"         │   │                           │       ├─ part.p_name:1!null\n" +
			"         │   │                           │       └─ forestÿ (longtext)\n" +
			"         │   │                           └─ IndexedTableAccess(part)\n" +
			"         │   │                               ├─ index: [part.P_PARTKEY]\n" +
			"         │   │                               ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                               ├─ colSet: (17-25)\n" +
			"         │   │                               ├─ tableId: 4\n" +
			"         │   │                               └─ Table\n" +
			"         │   │                                   ├─ name: part\n" +
			"         │   │                                   └─ columns: [p_partkey p_name p_mfgr p_brand p_type p_size p_container p_retailprice p_comment]\n" +
			"         │   └─ IndexedTableAccess(supplier)\n" +
			"         │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │       ├─ keys: [partsupp.ps_suppkey:0!null]\n" +
			"         │       ├─ colSet: (1-7)\n" +
			"         │       ├─ tableId: 1\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: supplier\n" +
			"         │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nation.n_name:1!null\n" +
			"             │   └─ CANADA (longtext)\n" +
			"             └─ IndexedTableAccess(nation)\n" +
			"                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                 ├─ keys: [supplier.s_nationkey:4!null]\n" +
			"                 ├─ colSet: (8-11)\n" +
			"                 ├─ tableId: 2\n" +
			"                 └─ Table\n" +
			"                     ├─ name: nation\n" +
			"                     └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [supplier.s_name, supplier.s_address]\n" +
			" └─ Sort(supplier.s_name ASC)\n" +
			"     └─ LookupJoin\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ (supplier.s_suppkey = partsupp.ps_suppkey)\n" +
			"         │   ├─ Distinct\n" +
			"         │   │   └─ Project\n" +
			"         │   │       ├─ columns: [partsupp.ps_suppkey]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (partsupp.ps_availqty > Subquery(select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= '1994-01-01' and l_shipdate < '1994-01-01' + interval '1' year))\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [partsupp.PS_PARTKEY, partsupp.PS_SUPPKEY, partsupp.PS_AVAILQTY, partsupp.PS_SUPPLYCOST, partsupp.PS_COMMENT]\n" +
			"         │   │               └─ MergeJoin\n" +
			"         │   │                   ├─ cmp: (partsupp.ps_partkey = part.p_partkey)\n" +
			"         │   │                   ├─ IndexedTableAccess(partsupp)\n" +
			"         │   │                   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"         │   │                   │   └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │                   └─ Project\n" +
			"         │   │                       ├─ columns: [part.p_partkey]\n" +
			"         │   │                       └─ Filter\n" +
			"         │   │                           ├─ ((((((((part.p_name >= 'forest') AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ'))\n" +
			"         │   │                           └─ IndexedTableAccess(part)\n" +
			"         │   │                               ├─ index: [part.P_PARTKEY]\n" +
			"         │   │                               └─ filters: [{[NULL, ∞)}]\n" +
			"         │   └─ IndexedTableAccess(supplier)\n" +
			"         │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │       └─ keys: partsupp.ps_suppkey\n" +
			"         └─ Filter\n" +
			"             ├─ (nation.n_name = 'CANADA')\n" +
			"             └─ IndexedTableAccess(nation)\n" +
			"                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                 └─ keys: supplier.s_nationkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [supplier.s_name, supplier.s_address]\n" +
			" └─ Sort(supplier.s_name ASC)\n" +
			"     └─ LookupJoin\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ (supplier.s_suppkey = partsupp.ps_suppkey)\n" +
			"         │   ├─ Distinct\n" +
			"         │   │   └─ Project\n" +
			"         │   │       ├─ columns: [partsupp.ps_suppkey]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (partsupp.ps_availqty > Subquery(select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= '1994-01-01' and l_shipdate < '1994-01-01' + interval '1' year))\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [partsupp.PS_PARTKEY, partsupp.PS_SUPPKEY, partsupp.PS_AVAILQTY, partsupp.PS_SUPPLYCOST, partsupp.PS_COMMENT]\n" +
			"         │   │               └─ MergeJoin\n" +
			"         │   │                   ├─ cmp: (partsupp.ps_partkey = part.p_partkey)\n" +
			"         │   │                   ├─ IndexedTableAccess(partsupp)\n" +
			"         │   │                   │   ├─ index: [partsupp.PS_PARTKEY,partsupp.PS_SUPPKEY]\n" +
			"         │   │                   │   └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │                   └─ Project\n" +
			"         │   │                       ├─ columns: [part.p_partkey]\n" +
			"         │   │                       └─ Filter\n" +
			"         │   │                           ├─ ((((((((part.p_name >= 'forest') AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ')) AND (part.p_name >= 'forest')) AND (part.p_name <= 'forestÿ'))\n" +
			"         │   │                           └─ IndexedTableAccess(part)\n" +
			"         │   │                               ├─ index: [part.P_PARTKEY]\n" +
			"         │   │                               └─ filters: [{[NULL, ∞)}]\n" +
			"         │   └─ IndexedTableAccess(supplier)\n" +
			"         │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"         │       └─ keys: partsupp.ps_suppkey\n" +
			"         └─ Filter\n" +
			"             ├─ (nation.n_name = 'CANADA')\n" +
			"             └─ IndexedTableAccess(nation)\n" +
			"                 ├─ index: [nation.N_NATIONKEY]\n" +
			"                 └─ keys: supplier.s_nationkey\n" +
			"",
	},
	{
		Query: `
--Q21
select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'SAUDI ARABIA'
group by
	s_name
order by
	numwait desc,
	s_name;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [supplier.s_name:1!null, count(1):0!null->numwait:0]\n" +
			" └─ Sort(numwait:2!null DESC nullsFirst, supplier.s_name:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1):0!null, supplier.s_name:1!null, count(1):0!null->numwait:0]\n" +
			"         └─ GroupBy\n" +
			"             ├─ select: COUNT(1 (bigint)), supplier.s_name:26!null\n" +
			"             ├─ group: supplier.s_name:26!null\n" +
			"             └─ SemiLookupJoin\n" +
			"                 ├─ NOT\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ l2.l_suppkey:38!null\n" +
			"                 │       └─ l1.l_suppkey:2!null\n" +
			"                 ├─ AntiJoinIncludingNulls\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ l3.l_orderkey:36!null\n" +
			"                 │   │   │   └─ l1.l_orderkey:0!null\n" +
			"                 │   │   └─ NOT\n" +
			"                 │   │       └─ Eq\n" +
			"                 │   │           ├─ l3.l_suppkey:38!null\n" +
			"                 │   │           └─ l1.l_suppkey:2!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ MergeJoin\n" +
			"                 │   │   │   │   ├─ cmp: Eq\n" +
			"                 │   │   │   │   │   ├─ l1.l_orderkey:0!null\n" +
			"                 │   │   │   │   │   └─ orders.o_orderkey:16!null\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ GreaterThan\n" +
			"                 │   │   │   │   │   │   ├─ l1.l_receiptdate:12!null\n" +
			"                 │   │   │   │   │   │   └─ l1.l_commitdate:11!null\n" +
			"                 │   │   │   │   │   └─ TableAlias(l1)\n" +
			"                 │   │   │   │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │   │   │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │   │   │   │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │   │   │   │           ├─ colSet: (8-23)\n" +
			"                 │   │   │   │   │           ├─ tableId: 2\n" +
			"                 │   │   │   │   │           └─ Table\n" +
			"                 │   │   │   │   │               ├─ name: lineitem\n" +
			"                 │   │   │   │   │               └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 │   │   │   │   └─ Filter\n" +
			"                 │   │   │   │       ├─ Eq\n" +
			"                 │   │   │   │       │   ├─ orders.o_orderstatus:2!null\n" +
			"                 │   │   │   │       │   └─ F (longtext)\n" +
			"                 │   │   │   │       └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │   │           ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │   │   │           ├─ colSet: (24-32)\n" +
			"                 │   │   │   │           ├─ tableId: 3\n" +
			"                 │   │   │   │           └─ Table\n" +
			"                 │   │   │   │               ├─ name: orders\n" +
			"                 │   │   │   │               └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"                 │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                 │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │   │   │       ├─ keys: [l1.l_suppkey:2!null]\n" +
			"                 │   │   │       ├─ colSet: (1-7)\n" +
			"                 │   │   │       ├─ tableId: 1\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: supplier\n" +
			"                 │   │   │           └─ columns: [s_suppkey s_name s_address s_nationkey s_phone s_acctbal s_comment]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ nation.n_name:1!null\n" +
			"                 │   │       │   └─ SAUDI ARABIA (longtext)\n" +
			"                 │   │       └─ IndexedTableAccess(nation)\n" +
			"                 │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │           ├─ keys: [supplier.s_nationkey:28!null]\n" +
			"                 │   │           ├─ colSet: (33-36)\n" +
			"                 │   │           ├─ tableId: 4\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: nation\n" +
			"                 │   │               └─ columns: [n_nationkey n_name n_regionkey n_comment]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ GreaterThan\n" +
			"                 │       │   ├─ l3.l_receiptdate:12!null\n" +
			"                 │       │   └─ l3.l_commitdate:11!null\n" +
			"                 │       └─ TableAlias(l3)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: lineitem\n" +
			"                 │                   └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 └─ TableAlias(l2)\n" +
			"                     └─ IndexedTableAccess(lineitem)\n" +
			"                         ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         ├─ keys: [l1.l_orderkey:0!null]\n" +
			"                         ├─ colSet: (37-52)\n" +
			"                         ├─ tableId: 5\n" +
			"                         └─ Table\n" +
			"                             ├─ name: lineitem\n" +
			"                             └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [supplier.s_name, count(1) as numwait]\n" +
			" └─ Sort(numwait DESC, supplier.s_name ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1), supplier.s_name, count(1) as numwait]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNT(1), supplier.s_name)\n" +
			"             ├─ Grouping(supplier.s_name)\n" +
			"             └─ SemiLookupJoin\n" +
			"                 ├─ (NOT((l2.l_suppkey = l1.l_suppkey)))\n" +
			"                 ├─ AntiJoinIncludingNulls\n" +
			"                 │   ├─ ((l3.l_orderkey = l1.l_orderkey) AND (NOT((l3.l_suppkey = l1.l_suppkey))))\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ MergeJoin\n" +
			"                 │   │   │   │   ├─ cmp: (l1.l_orderkey = orders.o_orderkey)\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ (l1.l_receiptdate > l1.l_commitdate)\n" +
			"                 │   │   │   │   │   └─ TableAlias(l1)\n" +
			"                 │   │   │   │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │   │   │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │   │   │   │           └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │   │   │   └─ Filter\n" +
			"                 │   │   │   │       ├─ (orders.o_orderstatus = 'F')\n" +
			"                 │   │   │   │       └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │   │           ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │   │           └─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                 │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │   │   │       └─ keys: l1.l_suppkey\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (nation.n_name = 'SAUDI ARABIA')\n" +
			"                 │   │       └─ IndexedTableAccess(nation)\n" +
			"                 │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │           └─ keys: supplier.s_nationkey\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (l3.l_receiptdate > l3.l_commitdate)\n" +
			"                 │       └─ TableAlias(l3)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: lineitem\n" +
			"                 │               └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 └─ TableAlias(l2)\n" +
			"                     └─ IndexedTableAccess(lineitem)\n" +
			"                         ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         ├─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                         └─ keys: l1.l_orderkey\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [supplier.s_name, count(1) as numwait]\n" +
			" └─ Sort(numwait DESC, supplier.s_name ASC)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [count(1), supplier.s_name, count(1) as numwait]\n" +
			"         └─ GroupBy\n" +
			"             ├─ SelectDeps(COUNT(1), supplier.s_name)\n" +
			"             ├─ Grouping(supplier.s_name)\n" +
			"             └─ SemiLookupJoin\n" +
			"                 ├─ (NOT((l2.l_suppkey = l1.l_suppkey)))\n" +
			"                 ├─ AntiJoinIncludingNulls\n" +
			"                 │   ├─ ((l3.l_orderkey = l1.l_orderkey) AND (NOT((l3.l_suppkey = l1.l_suppkey))))\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ LookupJoin\n" +
			"                 │   │   │   ├─ MergeJoin\n" +
			"                 │   │   │   │   ├─ cmp: (l1.l_orderkey = orders.o_orderkey)\n" +
			"                 │   │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   │   ├─ (l1.l_receiptdate > l1.l_commitdate)\n" +
			"                 │   │   │   │   │   └─ TableAlias(l1)\n" +
			"                 │   │   │   │   │       └─ IndexedTableAccess(lineitem)\n" +
			"                 │   │   │   │   │           ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                 │   │   │   │   │           └─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │   │   │   └─ Filter\n" +
			"                 │   │   │   │       ├─ (orders.o_orderstatus = 'F')\n" +
			"                 │   │   │   │       └─ IndexedTableAccess(orders)\n" +
			"                 │   │   │   │           ├─ index: [orders.O_ORDERKEY]\n" +
			"                 │   │   │   │           └─ filters: [{[NULL, ∞)}]\n" +
			"                 │   │   │   └─ IndexedTableAccess(supplier)\n" +
			"                 │   │   │       ├─ index: [supplier.S_SUPPKEY]\n" +
			"                 │   │   │       └─ keys: l1.l_suppkey\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (nation.n_name = 'SAUDI ARABIA')\n" +
			"                 │   │       └─ IndexedTableAccess(nation)\n" +
			"                 │   │           ├─ index: [nation.N_NATIONKEY]\n" +
			"                 │   │           └─ keys: supplier.s_nationkey\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (l3.l_receiptdate > l3.l_commitdate)\n" +
			"                 │       └─ TableAlias(l3)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: lineitem\n" +
			"                 │               └─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                 └─ TableAlias(l2)\n" +
			"                     └─ IndexedTableAccess(lineitem)\n" +
			"                         ├─ index: [lineitem.L_ORDERKEY,lineitem.L_LINENUMBER]\n" +
			"                         ├─ columns: [l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate l_shipinstruct l_shipmode l_comment]\n" +
			"                         └─ keys: l1.l_orderkey\n" +
			"",
	},
	{
		Query: `
--Q22
select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('13', '31', '23', '29', '30', '18', '17')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('13', '31', '23', '29', '30', '18', '17')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [custsale.cntrycode:2!null, count(1):0!null->numcust:0, sum(custsale.c_acctbal):1!null->totacctbal:0]\n" +
			" └─ Sort(custsale.cntrycode:2!null ASC nullsFirst)\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: COUNT(1 (bigint)), SUM(custsale.c_acctbal:1!null), custsale.cntrycode:0!null\n" +
			"         ├─ group: custsale.cntrycode:0!null\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: custsale\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             ├─ colSet: (28,29)\n" +
			"             ├─ tableId: 4\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [SUBSTRING(customer.c_phone, 1, 2)->cntrycode:0, customer.c_acctbal:5!null]\n" +
			"                 └─ Filter\n" +
			"                     ├─ GreaterThan\n" +
			"                     │   ├─ customer.c_acctbal:5!null\n" +
			"                     │   └─ Subquery\n" +
			"                     │       ├─ cacheable: true\n" +
			"                     │       ├─ alias-string: select avg(c_acctbal) from customer where c_acctbal > 0.00 and substr(c_phone, 1, 2) in ('13', '31', '23', '29', '30', '18', '17')\n" +
			"                     │       └─ Project\n" +
			"                     │           ├─ columns: [avg(customer.c_acctbal):8->avg(c_acctbal):0]\n" +
			"                     │           └─ GroupBy\n" +
			"                     │               ├─ select: AVG(customer.c_acctbal:9!null)\n" +
			"                     │               ├─ group: \n" +
			"                     │               └─ Filter\n" +
			"                     │                   ├─ AND\n" +
			"                     │                   │   ├─ GreaterThan\n" +
			"                     │                   │   │   ├─ customer.c_acctbal:9!null\n" +
			"                     │                   │   │   └─ 0 (decimal(15,2))\n" +
			"                     │                   │   └─ HashIn\n" +
			"                     │                   │       ├─ SUBSTRING(customer.c_phone, 1, 2)\n" +
			"                     │                   │       └─ TUPLE(13 (longtext), 31 (longtext), 23 (longtext), 29 (longtext), 30 (longtext), 18 (longtext), 17 (longtext))\n" +
			"                     │                   └─ Table\n" +
			"                     │                       ├─ name: customer\n" +
			"                     │                       ├─ columns: [c_phone c_acctbal]\n" +
			"                     │                       ├─ colSet: (9-16)\n" +
			"                     │                       └─ tableId: 2\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [customer.C_CUSTKEY:0!null, customer.C_NAME:1!null, customer.C_ADDRESS:2!null, customer.C_NATIONKEY:3!null, customer.C_PHONE:4!null, customer.C_ACCTBAL:5!null, customer.C_MKTSEGMENT:6!null, customer.C_COMMENT:7!null]\n" +
			"                         └─ Filter\n" +
			"                             ├─ orders.o_custkey:8!null IS NULL\n" +
			"                             └─ LeftOuterHashJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ orders.o_custkey:8!null\n" +
			"                                 │   └─ customer.c_custkey:0!null\n" +
			"                                 ├─ Filter\n" +
			"                                 │   ├─ HashIn\n" +
			"                                 │   │   ├─ SUBSTRING(customer.c_phone, 1, 2)\n" +
			"                                 │   │   └─ TUPLE(13 (longtext), 31 (longtext), 23 (longtext), 29 (longtext), 30 (longtext), 18 (longtext), 17 (longtext))\n" +
			"                                 │   └─ Table\n" +
			"                                 │       ├─ name: customer\n" +
			"                                 │       ├─ columns: [c_custkey c_name c_address c_nationkey c_phone c_acctbal c_mktsegment c_comment]\n" +
			"                                 │       ├─ colSet: (1-8)\n" +
			"                                 │       └─ tableId: 1\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(customer.c_custkey:0!null)\n" +
			"                                     ├─ right-key: TUPLE(orders.o_custkey:0!null)\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [orders.o_custkey:1!null]\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: orders\n" +
			"                                             ├─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"                                             ├─ colSet: (18-26)\n" +
			"                                             └─ tableId: 3\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [custsale.cntrycode, count(1) as numcust, sum(custsale.c_acctbal) as totacctbal]\n" +
			" └─ Sort(custsale.cntrycode ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(COUNT(1), SUM(custsale.c_acctbal), custsale.cntrycode)\n" +
			"         ├─ Grouping(custsale.cntrycode)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: custsale\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [SUBSTRING(customer.c_phone, 1, 2) as cntrycode, customer.c_acctbal]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (customer.c_acctbal > Subquery(select avg(c_acctbal) from customer where c_acctbal > 0.00 and substr(c_phone, 1, 2) in ('13', '31', '23', '29', '30', '18', '17')))\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [customer.C_CUSTKEY, customer.C_NAME, customer.C_ADDRESS, customer.C_NATIONKEY, customer.C_PHONE, customer.C_ACCTBAL, customer.C_MKTSEGMENT, customer.C_COMMENT]\n" +
			"                         └─ Filter\n" +
			"                             ├─ orders.o_custkey IS NULL\n" +
			"                             └─ LeftOuterHashJoin\n" +
			"                                 ├─ (orders.o_custkey = customer.c_custkey)\n" +
			"                                 ├─ Filter\n" +
			"                                 │   ├─ (SUBSTRING(customer.c_phone, 1, 2) HASH IN ('13', '31', '23', '29', '30', '18', '17'))\n" +
			"                                 │   └─ Table\n" +
			"                                 │       └─ name: customer\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (customer.c_custkey)\n" +
			"                                     ├─ right-key: (orders.o_custkey)\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [orders.o_custkey]\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: orders\n" +
			"                                             └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [custsale.cntrycode, count(1) as numcust, sum(custsale.c_acctbal) as totacctbal]\n" +
			" └─ Sort(custsale.cntrycode ASC)\n" +
			"     └─ GroupBy\n" +
			"         ├─ SelectDeps(COUNT(1), SUM(custsale.c_acctbal), custsale.cntrycode)\n" +
			"         ├─ Grouping(custsale.cntrycode)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: custsale\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ isLateral: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [SUBSTRING(customer.c_phone, 1, 2) as cntrycode, customer.c_acctbal]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (customer.c_acctbal > Subquery(select avg(c_acctbal) from customer where c_acctbal > 0.00 and substr(c_phone, 1, 2) in ('13', '31', '23', '29', '30', '18', '17')))\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [customer.C_CUSTKEY, customer.C_NAME, customer.C_ADDRESS, customer.C_NATIONKEY, customer.C_PHONE, customer.C_ACCTBAL, customer.C_MKTSEGMENT, customer.C_COMMENT]\n" +
			"                         └─ Filter\n" +
			"                             ├─ orders.o_custkey IS NULL\n" +
			"                             └─ LeftOuterHashJoin\n" +
			"                                 ├─ (orders.o_custkey = customer.c_custkey)\n" +
			"                                 ├─ Filter\n" +
			"                                 │   ├─ (SUBSTRING(customer.c_phone, 1, 2) HASH IN ('13', '31', '23', '29', '30', '18', '17'))\n" +
			"                                 │   └─ Table\n" +
			"                                 │       └─ name: customer\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (customer.c_custkey)\n" +
			"                                     ├─ right-key: (orders.o_custkey)\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [orders.o_custkey]\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: orders\n" +
			"                                             └─ columns: [o_orderkey o_custkey o_orderstatus o_totalprice o_orderdate o_orderpriority o_clerk o_shippriority o_comment]\n" +
			"",
	},
}
