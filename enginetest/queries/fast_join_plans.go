// Code generated by plangen.

// Copyright 2025 Dolthub, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package queries

var FastJoinPlanTests = []QueryPlanTest{
	{
		Name:  `Check that extra filter isn't dropped. (NEEDS B=C)`,
		Query: `select * from comp_index_t0 c join comp_index_t0 b on b.v2 = c.pk and c.v2 = 1 join comp_index_t0 a on a.v2 = b.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [c.pk:6!null, c.v1:7, c.v2:8, b.pk:3!null, b.v1:4, b.v2:5, a.pk:0!null, a.v1:1, a.v2:2]\n" +
			" └─ LookupJoin\n" +
			"     ├─ LookupJoin\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ ProcessTable\n" +
			"     │   │       └─ Table\n" +
			"     │   │           ├─ name: comp_index_t0\n" +
			"     │   │           └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ keys: [a.v2:2]\n" +
			"     │           ├─ colSet: (4-6)\n" +
			"     │           ├─ tableId: 2\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               └─ columns: [pk v1 v2]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ c.v2:2\n" +
			"         │   └─ 1 (bigint)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ keys: [b.v2:5]\n" +
			"                 ├─ colSet: (1-3)\n" +
			"                 ├─ tableId: 1\n" +
			"                 └─ Table\n" +
			"                     ├─ name: comp_index_t0\n" +
			"                     └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [c.pk, c.v1, c.v2, b.pk, b.v1, b.v2, a.pk, a.v1, a.v2]\n" +
			" └─ LookupJoin (estimated cost=333.300 rows=101)\n" +
			"     ├─ LookupJoin (estimated cost=333.300 rows=101)\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ Table\n" +
			"     │   │       ├─ name: comp_index_t0\n" +
			"     │   │       └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ columns: [pk v1 v2]\n" +
			"     │           └─ keys: a.v2\n" +
			"     └─ Filter\n" +
			"         ├─ (c.v2 = 1)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: b.v2\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [c.pk, c.v1, c.v2, b.pk, b.v1, b.v2, a.pk, a.v1, a.v2]\n" +
			" └─ LookupJoin (estimated cost=333.300 rows=101) (actual rows=0 loops=1)\n" +
			"     ├─ LookupJoin (estimated cost=333.300 rows=101) (actual rows=101 loops=1)\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ Table\n" +
			"     │   │       ├─ name: comp_index_t0\n" +
			"     │   │       └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ columns: [pk v1 v2]\n" +
			"     │           └─ keys: a.v2\n" +
			"     └─ Filter\n" +
			"         ├─ (c.v2 = 1)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: b.v2\n" +
			"",
	},
	{
		Name:  `Check that extra filter isn't dropped. (NEEDS B=C)`,
		Query: `select * from comp_index_t0 c join comp_index_t0 b join comp_index_t0 a on a.v2 = b.pk and b.v2 = c.pk and c.v2 = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [c.pk:0!null, c.v1:1, c.v2:2, b.pk:6!null, b.v1:7, b.v2:8, a.pk:3!null, a.v1:4, a.v2:5]\n" +
			" └─ CrossJoin\n" +
			"     ├─ Filter\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ c.v2:2\n" +
			"     │   │   └─ 1 (bigint)\n" +
			"     │   └─ TableAlias(c)\n" +
			"     │       └─ ProcessTable\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               └─ columns: [pk v1 v2]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ TableAlias(a)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: comp_index_t0\n" +
			"         │       ├─ columns: [pk v1 v2]\n" +
			"         │       ├─ colSet: (7-9)\n" +
			"         │       └─ tableId: 3\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ keys: [a.v2:5]\n" +
			"                 ├─ colSet: (4-6)\n" +
			"                 ├─ tableId: 2\n" +
			"                 └─ Table\n" +
			"                     ├─ name: comp_index_t0\n" +
			"                     └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [c.pk, c.v1, c.v2, b.pk, b.v1, b.v2, a.pk, a.v1, a.v2]\n" +
			" └─ CrossJoin (estimated cost=8671.850 rows=106)\n" +
			"     ├─ Filter\n" +
			"     │   ├─ (c.v2 = 1)\n" +
			"     │   └─ TableAlias(c)\n" +
			"     │       └─ Table\n" +
			"     │           ├─ name: comp_index_t0\n" +
			"     │           └─ columns: [pk v1 v2]\n" +
			"     └─ LookupJoin (estimated cost=333.300 rows=101)\n" +
			"         ├─ TableAlias(a)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: comp_index_t0\n" +
			"         │       └─ columns: [pk v1 v2]\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: a.v2\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [c.pk, c.v1, c.v2, b.pk, b.v1, b.v2, a.pk, a.v1, a.v2]\n" +
			" └─ CrossJoin (estimated cost=8671.850 rows=106) (actual rows=101 loops=1)\n" +
			"     ├─ Filter\n" +
			"     │   ├─ (c.v2 = 1)\n" +
			"     │   └─ TableAlias(c)\n" +
			"     │       └─ Table\n" +
			"     │           ├─ name: comp_index_t0\n" +
			"     │           └─ columns: [pk v1 v2]\n" +
			"     └─ LookupJoin (estimated cost=333.300 rows=101) (actual rows=101 loops=1)\n" +
			"         ├─ TableAlias(a)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: comp_index_t0\n" +
			"         │       └─ columns: [pk v1 v2]\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: a.v2\n" +
			"",
	},
	{
		Name:  `Check that extra filter isn't dropped, with reverse join order`,
		Query: `select * from comp_index_t0 a join comp_index_t0 b join comp_index_t0 c on a.v2 = b.pk and b.v2 = c.pk and c.v2 = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:3!null, a.v1:4, a.v2:5, b.pk:0!null, b.v1:1, b.v2:2, c.pk:6!null, c.v1:7, c.v2:8]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Filter\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ a.v2:5\n" +
			"     │   │   └─ b.pk:0!null\n" +
			"     │   └─ CrossJoin\n" +
			"     │       ├─ TableAlias(b)\n" +
			"     │       │   └─ ProcessTable\n" +
			"     │       │       └─ Table\n" +
			"     │       │           ├─ name: comp_index_t0\n" +
			"     │       │           └─ columns: [pk v1 v2]\n" +
			"     │       └─ TableAlias(a)\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               ├─ columns: [pk v1 v2]\n" +
			"     │               ├─ colSet: (1-3)\n" +
			"     │               └─ tableId: 1\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ c.v2:2\n" +
			"         │   └─ 1 (bigint)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ keys: [b.v2:2]\n" +
			"                 ├─ colSet: (7-9)\n" +
			"                 ├─ tableId: 3\n" +
			"                 └─ Table\n" +
			"                     ├─ name: comp_index_t0\n" +
			"                     └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [a.pk, a.v1, a.v2, b.pk, b.v1, b.v2, c.pk, c.v1, c.v2]\n" +
			" └─ LookupJoin (estimated cost=353.100 rows=107)\n" +
			"     ├─ Filter\n" +
			"     │   ├─ (a.v2 = b.pk)\n" +
			"     │   └─ CrossJoin (estimated cost=10304.010 rows=126)\n" +
			"     │       ├─ TableAlias(b)\n" +
			"     │       │   └─ Table\n" +
			"     │       │       ├─ name: comp_index_t0\n" +
			"     │       │       └─ columns: [pk v1 v2]\n" +
			"     │       └─ TableAlias(a)\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               └─ columns: [pk v1 v2]\n" +
			"     └─ Filter\n" +
			"         ├─ (c.v2 = 1)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: b.v2\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [a.pk, a.v1, a.v2, b.pk, b.v1, b.v2, c.pk, c.v1, c.v2]\n" +
			" └─ LookupJoin (estimated cost=353.100 rows=107) (actual rows=0 loops=1)\n" +
			"     ├─ Filter\n" +
			"     │   ├─ (a.v2 = b.pk)\n" +
			"     │   └─ CrossJoin (estimated cost=10304.010 rows=126) (actual rows=10201 loops=1)\n" +
			"     │       ├─ TableAlias(b)\n" +
			"     │       │   └─ Table\n" +
			"     │       │       ├─ name: comp_index_t0\n" +
			"     │       │       └─ columns: [pk v1 v2]\n" +
			"     │       └─ TableAlias(a)\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               └─ columns: [pk v1 v2]\n" +
			"     └─ Filter\n" +
			"         ├─ (c.v2 = 1)\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(comp_index_t0)\n" +
			"                 ├─ index: [comp_index_t0.pk]\n" +
			"                 ├─ columns: [pk v1 v2]\n" +
			"                 └─ keys: b.v2\n" +
			"",
	},
	{
		Name:  `Check that extra filter isn't dropped, with reverse join order`,
		Query: `select * from comp_index_t0 a join comp_index_t0 b on a.v2 = b.pk join comp_index_t0 c on b.v2 = c.pk and c.v2 = 1`,
		ExpectedPlan: "LookupJoin\n" +
			" ├─ LookupJoin\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ ProcessTable\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: comp_index_t0\n" +
			" │   │           └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ keys: [a.v2:2]\n" +
			" │           ├─ colSet: (4-6)\n" +
			" │           ├─ tableId: 2\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ Filter\n" +
			"     ├─ Eq\n" +
			"     │   ├─ c.v2:2\n" +
			"     │   └─ 1 (bigint)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ keys: [b.v2:5]\n" +
			"             ├─ colSet: (7-9)\n" +
			"             ├─ tableId: 3\n" +
			"             └─ Table\n" +
			"                 ├─ name: comp_index_t0\n" +
			"                 └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "LookupJoin (estimated cost=333.300 rows=101)\n" +
			" ├─ LookupJoin (estimated cost=333.300 rows=101)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ columns: [pk v1 v2]\n" +
			" │           └─ keys: a.v2\n" +
			" └─ Filter\n" +
			"     ├─ (c.v2 = 1)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ columns: [pk v1 v2]\n" +
			"             └─ keys: b.v2\n" +
			"",
		ExpectedAnalysis: "LookupJoin (estimated cost=333.300 rows=101) (actual rows=0 loops=1)\n" +
			" ├─ LookupJoin (estimated cost=333.300 rows=101) (actual rows=101 loops=1)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ columns: [pk v1 v2]\n" +
			" │           └─ keys: a.v2\n" +
			" └─ Filter\n" +
			"     ├─ (c.v2 = 1)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ columns: [pk v1 v2]\n" +
			"             └─ keys: b.v2\n" +
			"",
	},
	{
		Name:  `Test cross join`,
		Query: `select * from comp_index_t0 c cross join comp_index_t0 b join comp_index_t0 a on b.v1 = c.pk and c.v2 = 1`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ Filter\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ b.v1:4\n" +
			" │   │   └─ c.pk:0!null\n" +
			" │   └─ CrossJoin\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ Eq\n" +
			" │       │   │   ├─ c.v2:2\n" +
			" │       │   │   └─ 1 (bigint)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ ProcessTable\n" +
			" │       │           └─ Table\n" +
			" │       │               ├─ name: comp_index_t0\n" +
			" │       │               └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               ├─ columns: [pk v1 v2]\n" +
			" │               ├─ colSet: (4-6)\n" +
			" │               └─ tableId: 2\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         ├─ colSet: (7-9)\n" +
			"         └─ tableId: 3\n" +
			"",
		ExpectedEstimates: "InnerJoin (estimated cost=9181.900 rows=112)\n" +
			" ├─ Filter\n" +
			" │   ├─ (b.v1 = c.pk)\n" +
			" │   └─ CrossJoin (estimated cost=8671.850 rows=106)\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ (c.v2 = 1)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ Table\n" +
			" │       │           ├─ name: comp_index_t0\n" +
			" │       │           └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedAnalysis: "InnerJoin (estimated cost=9181.900 rows=112) (actual rows=0 loops=1)\n" +
			" ├─ Filter\n" +
			" │   ├─ (b.v1 = c.pk)\n" +
			" │   └─ CrossJoin (estimated cost=8671.850 rows=106) (actual rows=101 loops=1)\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ (c.v2 = 1)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ Table\n" +
			" │       │           ├─ name: comp_index_t0\n" +
			" │       │           └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Name:  `Test inner join with no lookup filter`,
		Query: `select * from comp_index_t0 c join comp_index_t0 b join comp_index_t0 a on b.v1 = c.pk and c.v2 = 1`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ Filter\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ b.v1:4\n" +
			" │   │   └─ c.pk:0!null\n" +
			" │   └─ CrossJoin\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ Eq\n" +
			" │       │   │   ├─ c.v2:2\n" +
			" │       │   │   └─ 1 (bigint)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ ProcessTable\n" +
			" │       │           └─ Table\n" +
			" │       │               ├─ name: comp_index_t0\n" +
			" │       │               └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               ├─ columns: [pk v1 v2]\n" +
			" │               ├─ colSet: (4-6)\n" +
			" │               └─ tableId: 2\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         ├─ colSet: (7-9)\n" +
			"         └─ tableId: 3\n" +
			"",
		ExpectedEstimates: "InnerJoin (estimated cost=9181.900 rows=112)\n" +
			" ├─ Filter\n" +
			" │   ├─ (b.v1 = c.pk)\n" +
			" │   └─ CrossJoin (estimated cost=8671.850 rows=106)\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ (c.v2 = 1)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ Table\n" +
			" │       │           ├─ name: comp_index_t0\n" +
			" │       │           └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedAnalysis: "InnerJoin (estimated cost=9181.900 rows=112) (actual rows=0 loops=1)\n" +
			" ├─ Filter\n" +
			" │   ├─ (b.v1 = c.pk)\n" +
			" │   └─ CrossJoin (estimated cost=8671.850 rows=106) (actual rows=101 loops=1)\n" +
			" │       ├─ Filter\n" +
			" │       │   ├─ (c.v2 = 1)\n" +
			" │       │   └─ TableAlias(c)\n" +
			" │       │       └─ Table\n" +
			" │       │           ├─ name: comp_index_t0\n" +
			" │       │           └─ columns: [pk v1 v2]\n" +
			" │       └─ TableAlias(b)\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(a)\n" +
			"     └─ Table\n" +
			"         ├─ name: comp_index_t0\n" +
			"         └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Name:  `Test Left Joins`,
		Query: `select * from comp_index_t0 a left join comp_index_t0 b left join comp_index_t0 c on b.v1 = c.pk on a.v1 = b.pk and c.v2 = 1`,
		ExpectedPlan: "HashJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ b.v1:4\n" +
			" │   └─ c.pk:6!null\n" +
			" ├─ MergeJoin\n" +
			" │   ├─ cmp: Eq\n" +
			" │   │   ├─ a.v1:1\n" +
			" │   │   └─ b.pk:3!null\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			" │   │       ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			" │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			" │   │       ├─ colSet: (1-3)\n" +
			" │   │       ├─ tableId: 1\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: comp_index_t0\n" +
			" │   │           └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ static: [{[NULL, ∞)}]\n" +
			" │           ├─ colSet: (4-6)\n" +
			" │           ├─ tableId: 2\n" +
			" │           └─ Table\n" +
			" │               ├─ name: comp_index_t0\n" +
			" │               └─ columns: [pk v1 v2]\n" +
			" └─ HashLookup\n" +
			"     ├─ left-key: TUPLE(b.v1:4)\n" +
			"     ├─ right-key: TUPLE(c.pk:0!null)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ ProcessTable\n" +
			"             └─ Table\n" +
			"                 ├─ name: comp_index_t0\n" +
			"                 └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "HashJoin (estimated cost=406.270 rows=126)\n" +
			" ├─ (b.v1 = c.pk)\n" +
			" ├─ MergeJoin (estimated cost=205.030 rows=101)\n" +
			" │   ├─ cmp: (a.v1 = b.pk)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			" │   │       ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			" │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ filters: [{[NULL, ∞)}]\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ HashLookup\n" +
			"     ├─ left-key: (b.v1)\n" +
			"     ├─ right-key: (c.pk)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ Table\n" +
			"             ├─ name: comp_index_t0\n" +
			"             └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedAnalysis: "HashJoin (estimated cost=406.270 rows=126) (actual rows=101 loops=1)\n" +
			" ├─ (b.v1 = c.pk)\n" +
			" ├─ MergeJoin (estimated cost=205.030 rows=101) (actual rows=101 loops=1)\n" +
			" │   ├─ cmp: (a.v1 = b.pk)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			" │   │       ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			" │   │       ├─ filters: [{[NULL, ∞), [NULL, ∞)}]\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ IndexedTableAccess(comp_index_t0)\n" +
			" │           ├─ index: [comp_index_t0.pk]\n" +
			" │           ├─ filters: [{[NULL, ∞)}]\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ HashLookup\n" +
			"     ├─ left-key: (b.v1)\n" +
			"     ├─ right-key: (c.pk)\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ Table\n" +
			"             ├─ name: comp_index_t0\n" +
			"             └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Name:  `Test Multi Column Index 1`,
		Query: `select * from comp_index_t0 a join comp_index_t0 b join comp_index_t0 c on b.v1 = c.v1 and b.v2 = c.v2 and c.v2 = a.pk`,
		ExpectedPlan: "LookupJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ c.v2:8\n" +
			" │   └─ a.pk:0!null\n" +
			" ├─ CrossJoin\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ ProcessTable\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: comp_index_t0\n" +
			" │   │           └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           ├─ columns: [pk v1 v2]\n" +
			" │           ├─ colSet: (4-6)\n" +
			" │           └─ tableId: 2\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			"         ├─ keys: [b.v1:4 b.v2:5]\n" +
			"         ├─ colSet: (7-9)\n" +
			"         ├─ tableId: 3\n" +
			"         └─ Table\n" +
			"             ├─ name: comp_index_t0\n" +
			"             └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "LookupJoin (estimated cost=429.600 rows=126)\n" +
			" ├─ (c.v2 = a.pk)\n" +
			" ├─ CrossJoin (estimated cost=10304.010 rows=126)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         └─ keys: b.v1, b.v2\n" +
			"",
		ExpectedAnalysis: "LookupJoin (estimated cost=429.600 rows=126) (actual rows=101 loops=1)\n" +
			" ├─ (c.v2 = a.pk)\n" +
			" ├─ CrossJoin (estimated cost=10304.010 rows=126) (actual rows=10201 loops=1)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.v1,comp_index_t0.v2]\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         └─ keys: b.v1, b.v2\n" +
			"",
	},
	{
		Name:  `Test Multi Column Index 2`,
		Query: `select * from comp_index_t0 a join comp_index_t0 b join comp_index_t0 c on  a.v2 = c.pk and b.v1 = c.v1 and b.v2 = c.v2`,
		ExpectedPlan: "LookupJoin\n" +
			" ├─ AND\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ b.v1:4\n" +
			" │   │   └─ c.v1:7\n" +
			" │   └─ Eq\n" +
			" │       ├─ b.v2:5\n" +
			" │       └─ c.v2:8\n" +
			" ├─ CrossJoin\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ ProcessTable\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: comp_index_t0\n" +
			" │   │           └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           ├─ columns: [pk v1 v2]\n" +
			" │           ├─ colSet: (4-6)\n" +
			" │           └─ tableId: 2\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.pk]\n" +
			"         ├─ keys: [a.v2:2]\n" +
			"         ├─ colSet: (7-9)\n" +
			"         ├─ tableId: 3\n" +
			"         └─ Table\n" +
			"             ├─ name: comp_index_t0\n" +
			"             └─ columns: [pk v1 v2]\n" +
			"",
		ExpectedEstimates: "LookupJoin (estimated cost=415.800 rows=126)\n" +
			" ├─ ((b.v1 = c.v1) AND (b.v2 = c.v2))\n" +
			" ├─ CrossJoin (estimated cost=10304.010 rows=126)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.pk]\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         └─ keys: a.v2\n" +
			"",
		ExpectedAnalysis: "LookupJoin (estimated cost=415.800 rows=126) (actual rows=101 loops=1)\n" +
			" ├─ ((b.v1 = c.v1) AND (b.v2 = c.v2))\n" +
			" ├─ CrossJoin (estimated cost=10304.010 rows=126) (actual rows=10201 loops=1)\n" +
			" │   ├─ TableAlias(a)\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: comp_index_t0\n" +
			" │   │       └─ columns: [pk v1 v2]\n" +
			" │   └─ TableAlias(b)\n" +
			" │       └─ Table\n" +
			" │           ├─ name: comp_index_t0\n" +
			" │           └─ columns: [pk v1 v2]\n" +
			" └─ TableAlias(c)\n" +
			"     └─ IndexedTableAccess(comp_index_t0)\n" +
			"         ├─ index: [comp_index_t0.pk]\n" +
			"         ├─ columns: [pk v1 v2]\n" +
			"         └─ keys: a.v2\n" +
			"",
	},
	{
		Name:  `Test Natural Join`,
		Query: `select * from comp_index_t0 a natural join comp_index_t0 b join comp_index_t0 c on  a.v2 = c.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.v1:1, a.v2:2]\n" +
			" └─ LookupJoin\n" +
			"     ├─ MergeJoin\n" +
			"     │   ├─ cmp: Eq\n" +
			"     │   │   ├─ a.pk:0!null\n" +
			"     │   │   └─ b.pk:3!null\n" +
			"     │   ├─ sel: AND\n" +
			"     │   │   ├─ Eq\n" +
			"     │   │   │   ├─ a.v1:1\n" +
			"     │   │   │   └─ b.v1:4\n" +
			"     │   │   └─ Eq\n" +
			"     │   │       ├─ a.v2:2\n" +
			"     │   │       └─ b.v2:5\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │   │       ├─ index: [comp_index_t0.pk]\n" +
			"     │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │   │       ├─ colSet: (1-3)\n" +
			"     │   │       ├─ tableId: 1\n" +
			"     │   │       └─ Table\n" +
			"     │   │           ├─ name: comp_index_t0\n" +
			"     │   │           └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           ├─ colSet: (4-6)\n" +
			"     │           ├─ tableId: 2\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: comp_index_t0\n" +
			"     │               └─ columns: [pk v1 v2]\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ keys: [a.v2:2]\n" +
			"             ├─ colSet: (7-9)\n" +
			"             ├─ tableId: 3\n" +
			"             └─ Table\n" +
			"                 ├─ name: comp_index_t0\n" +
			"                 └─ columns: [pk]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [a.pk, a.v1, a.v2]\n" +
			" └─ LookupJoin (estimated cost=333.300 rows=101)\n" +
			"     ├─ MergeJoin (estimated cost=205.030 rows=101)\n" +
			"     │   ├─ cmp: (a.pk = b.pk)\n" +
			"     │   ├─ sel: ((a.v1 = b.v1) AND (a.v2 = b.v2))\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │   │       ├─ index: [comp_index_t0.pk]\n" +
			"     │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"     │   │       └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ filters: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [pk v1 v2]\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ columns: [pk]\n" +
			"             └─ keys: a.v2\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [a.pk, a.v1, a.v2]\n" +
			" └─ LookupJoin (estimated cost=333.300 rows=101) (actual rows=101 loops=1)\n" +
			"     ├─ MergeJoin (estimated cost=205.030 rows=101) (actual rows=101 loops=1)\n" +
			"     │   ├─ cmp: (a.pk = b.pk)\n" +
			"     │   ├─ sel: ((a.v1 = b.v1) AND (a.v2 = b.v2))\n" +
			"     │   ├─ TableAlias(a)\n" +
			"     │   │   └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │   │       ├─ index: [comp_index_t0.pk]\n" +
			"     │   │       ├─ filters: [{[NULL, ∞)}]\n" +
			"     │   │       └─ columns: [pk v1 v2]\n" +
			"     │   └─ TableAlias(b)\n" +
			"     │       └─ IndexedTableAccess(comp_index_t0)\n" +
			"     │           ├─ index: [comp_index_t0.pk]\n" +
			"     │           ├─ filters: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [pk v1 v2]\n" +
			"     └─ TableAlias(c)\n" +
			"         └─ IndexedTableAccess(comp_index_t0)\n" +
			"             ├─ index: [comp_index_t0.pk]\n" +
			"             ├─ columns: [pk]\n" +
			"             └─ keys: a.v2\n" +
			"",
	},
}
