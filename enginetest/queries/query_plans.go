// Copyright 2020-2021 Dolthub, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package queries

type QueryPlanTest struct {
	Query        string
	ExpectedPlan string
}

// PlanTests is a test of generating the right query plans for different queries in the presence of indexes and
// other features. These tests are fragile because they rely on string representations of query plans, but they're much
// easier to construct this way. To regenerate these plans after analyzer changes, use the TestWriteQueryPlans function
// in testgen_test.go.
var PlanTests = []QueryPlanTest{
	{
		Query: `select * from MYTABLE where I = 2 and s = 'first row'`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ mytable.s:1!null\n" +
			" │   └─ first row (longtext)\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.s,mytable.i]\n" +
			"     ├─ static: [{[first row, first row], [2, 2]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(scalarSubq0,xy) */ count(*) from xy where y in (select distinct v from uv);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Project\n" +
			"         ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xy.y:2\n" +
			"             │   └─ scalarSubq0.v:0\n" +
			"             ├─ Distinct\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [scalarSubq0.v:1]\n" +
			"             │       └─ TableAlias(scalarSubq0)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: uv\n" +
			"             │               └─ columns: [u v]\n" +
			"             └─ IndexedTableAccess(xy)\n" +
			"                 ├─ index: [xy.y]\n" +
			"                 └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(scalarSubq0,xy) */ count(*) from xy where y in (select distinct u from uv);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Project\n" +
			"         ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xy.y:2\n" +
			"             │   └─ scalarSubq0.u:0!null\n" +
			"             ├─ OrderedDistinct\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [scalarSubq0.u:0!null]\n" +
			"             │       └─ TableAlias(scalarSubq0)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: uv\n" +
			"             │               └─ columns: [u v]\n" +
			"             └─ IndexedTableAccess(xy)\n" +
			"                 ├─ index: [xy.y]\n" +
			"                 └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select count(*) from mytable`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(mytable) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select count(*) as cnt from mytable`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [cnt:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [count(1):0!null, count(1):0!null as cnt]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [mytable.COUNT(1):0!null as COUNT(1)]\n" +
			"         └─ table_count(mytable) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select count(*) from keyless`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Table\n" +
			"         ├─ name: keyless\n" +
			"         └─ columns: []\n" +
			"",
	},
	{
		Query: `select count(*) from xy`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(xy) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select count(1) from mytable`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(mytable) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select count(1) from xy`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(xy) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select count(1) from xy, uv`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (tinyint))\n" +
			"     ├─ group: \n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: xy\n" +
			"         │   └─ columns: []\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ Table\n" +
			"                 ├─ name: uv\n" +
			"                 └─ columns: []\n" +
			"",
	},
	{
		Query: `select * from (select count(*) from xy) dt`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: dt\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Project\n" +
			"     ├─ columns: [count(1):0!null as count(*)]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [xy.COUNT(1):0!null as COUNT(1)]\n" +
			"         └─ table_count(xy) as COUNT(1)\n" +
			"",
	},
	{
		Query: `select (select count(*) from xy), (select count(*) from uv)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [count(1):1!null as count(*)]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [xy.COUNT(1):1!null as COUNT(1)]\n" +
			" │           └─ table_count(xy) as COUNT(1)\n" +
			" │   as (select count(*) from xy), Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [count(1):1!null as count(*)]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [uv.COUNT(1):1!null as COUNT(1)]\n" +
			" │           └─ table_count(uv) as COUNT(1)\n" +
			" │   as (select count(*) from uv)]\n" +
			" └─ Table\n" +
			"     ├─ name: \n" +
			"     └─ columns: []\n" +
			"",
	},
	{
		Query: `select (select count(*) from xy), (select count(*) from uv), count(*) from ab`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [count(1):1!null as count(*)]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [xy.COUNT(1):1!null as COUNT(1)]\n" +
			" │           └─ table_count(xy) as COUNT(1)\n" +
			" │   as (select count(*) from xy), Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [count(1):1!null as count(*)]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [uv.COUNT(1):1!null as COUNT(1)]\n" +
			" │           └─ table_count(uv) as COUNT(1)\n" +
			" │   as (select count(*) from uv), count(1):0!null as count(*)]\n" +
			" └─ Project\n" +
			"     ├─ columns: [ab.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(ab) as COUNT(1)\n" +
			"",
	},
	{
		Query: `
SELECT COUNT(DISTINCT (s_i_id))
FROM order_line1, stock1
WHERE
  ol_w_id = 5 AND
  ol_d_id = 2 AND
  ol_o_id < 3001 AND
  ol_o_id >= 2981 AND
  s_w_id= 5 AND
  s_i_id=ol_i_id AND
  s_quantity < 15;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [countdistinct([stock1.s_i_id]):0!null as COUNT(DISTINCT (s_i_id))]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNTDISTINCT([stock1.s_i_id])\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ LessThan\n" +
			"         │   ├─ stock1.s_quantity:6\n" +
			"         │   └─ 15 (tinyint)\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ stock1.s_i_id:4!null\n" +
			"             │   └─ order_line1.ol_i_id:3\n" +
			"             ├─ IndexedTableAccess(order_line1)\n" +
			"             │   ├─ index: [order_line1.ol_w_id,order_line1.ol_d_id,order_line1.ol_o_id,order_line1.ol_number]\n" +
			"             │   ├─ static: [{[5, 5], [2, 2], [2981, 3001), [NULL, ∞)}]\n" +
			"             │   └─ columns: [ol_o_id ol_d_id ol_w_id ol_i_id]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(order_line1.ol_i_id:3)\n" +
			"                 ├─ right-key: TUPLE(stock1.s_i_id:0!null)\n" +
			"                 └─ Filter\n" +
			"                     ├─ LessThan\n" +
			"                     │   ├─ stock1.s_quantity:2\n" +
			"                     │   └─ 15 (tinyint)\n" +
			"                     └─ IndexedTableAccess(stock1)\n" +
			"                         ├─ index: [stock1.s_w_id,stock1.s_i_id]\n" +
			"                         ├─ static: [{[5, 5], [NULL, ∞)}]\n" +
			"                         └─ columns: [s_i_id s_w_id s_quantity]\n" +
			"",
	},
	{
		Query: `
SELECT c_discount, c_last, c_credit, w_tax
FROM customer1, warehouse1
WHERE
  w_id = 1 AND
  c_w_id = w_id AND
  c_d_id = 2 AND
  c_id = 2327;
`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [customer1.c_discount:15, customer1.c_last:5, customer1.c_credit:13, warehouse1.w_tax:28]\n" +
			" └─ Project\n" +
			"     ├─ columns: [customer1.c_id:9!null, customer1.c_d_id:10!null, customer1.c_w_id:11!null, customer1.c_first:12, customer1.c_middle:13, customer1.c_last:14, customer1.c_street_1:15, customer1.c_street_2:16, customer1.c_city:17, customer1.c_state:18, customer1.c_zip:19, customer1.c_phone:20, customer1.c_since:21, customer1.c_credit:22, customer1.c_credit_lim:23, customer1.c_discount:24, customer1.c_balance:25, customer1.c_ytd_payment:26, customer1.c_payment_cnt:27, customer1.c_delivery_cnt:28, customer1.c_data:29, warehouse1.w_id:0!null, warehouse1.w_name:1, warehouse1.w_street_1:2, warehouse1.w_street_2:3, warehouse1.w_city:4, warehouse1.w_state:5, warehouse1.w_zip:6, warehouse1.w_tax:7, warehouse1.w_ytd:8]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ customer1.c_w_id:11!null\n" +
			"         │   └─ warehouse1.w_id:0!null\n" +
			"         ├─ IndexedTableAccess(warehouse1)\n" +
			"         │   ├─ index: [warehouse1.w_id]\n" +
			"         │   ├─ static: [{[1, 1]}]\n" +
			"         │   └─ columns: [w_id w_name w_street_1 w_street_2 w_city w_state w_zip w_tax w_ytd]\n" +
			"         └─ Filter\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ customer1.c_d_id:1!null\n" +
			"             │   │   └─ 2 (tinyint)\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ customer1.c_id:0!null\n" +
			"             │       └─ 2327 (smallint)\n" +
			"             └─ IndexedTableAccess(customer1)\n" +
			"                 ├─ index: [customer1.c_w_id,customer1.c_d_id,customer1.c_id]\n" +
			"                 └─ columns: [c_id c_d_id c_w_id c_first c_middle c_last c_street_1 c_street_2 c_city c_state c_zip c_phone c_since c_credit c_credit_lim c_discount c_balance c_ytd_payment c_payment_cnt c_delivery_cnt c_data]\n" +
			"",
	},
	{
		Query: `
select /*+ LOOKUP_JOIN(style, dimension) LOOKUP_JOIN(dimension, color) */ style.assetId
from asset style
join asset dimension
  on style.assetId = dimension.assetId
join asset color
  on style.assetId = color.assetId
where
  dimension.val = 'wide' and
  style.val = 'curve' and
  color.val = 'blue' and
  dimension.name = 'dimension' and
  style.name = 'style' and
  color.name = 'color' and
  dimension.orgId = 'org1' and
  style.orgId = 'org1' and
  color.orgId = 'org1';
`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [style.assetid:2]\n" +
			" └─ Project\n" +
			"     ├─ columns: [style.id:10!null, style.orgid:11, style.assetid:12, style.name:13, style.val:14, dimension.id:5!null, dimension.orgid:6, dimension.assetid:7, dimension.name:8, dimension.val:9, color.id:0!null, color.orgid:1, color.assetid:2, color.name:3, color.val:4]\n" +
			"     └─ Filter\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ dimension.val:9\n" +
			"         │   │   │   │   │   │   └─ wide (longtext)\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ color.val:4\n" +
			"         │   │   │   │   │       └─ blue (longtext)\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ dimension.name:8\n" +
			"         │   │   │   │       └─ dimension (longtext)\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ color.name:3\n" +
			"         │   │   │       └─ color (longtext)\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ dimension.orgid:6\n" +
			"         │   │       └─ org1 (longtext)\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ color.orgid:1\n" +
			"         │       └─ org1 (longtext)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ style.assetid:12\n" +
			"             │   │   └─ dimension.assetid:7\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ style.assetid:12\n" +
			"             │       └─ color.assetid:2\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ dimension.assetid:7\n" +
			"             │   │   └─ color.assetid:2\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ AND\n" +
			"             │   │   │   ├─ AND\n" +
			"             │   │   │   │   ├─ Eq\n" +
			"             │   │   │   │   │   ├─ color.val:4\n" +
			"             │   │   │   │   │   └─ blue (longtext)\n" +
			"             │   │   │   │   └─ Eq\n" +
			"             │   │   │   │       ├─ color.name:3\n" +
			"             │   │   │   │       └─ color (longtext)\n" +
			"             │   │   │   └─ Eq\n" +
			"             │   │   │       ├─ color.orgid:1\n" +
			"             │   │   │       └─ org1 (longtext)\n" +
			"             │   │   └─ TableAlias(color)\n" +
			"             │   │       └─ IndexedTableAccess(asset)\n" +
			"             │   │           ├─ index: [asset.orgId,asset.name,asset.val]\n" +
			"             │   │           ├─ static: [{[org1, org1], [color, color], [blue, blue]}]\n" +
			"             │   │           └─ columns: [id orgid assetid name val]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ AND\n" +
			"             │       │   ├─ AND\n" +
			"             │       │   │   ├─ Eq\n" +
			"             │       │   │   │   ├─ dimension.val:4\n" +
			"             │       │   │   │   └─ wide (longtext)\n" +
			"             │       │   │   └─ Eq\n" +
			"             │       │   │       ├─ dimension.name:3\n" +
			"             │       │   │       └─ dimension (longtext)\n" +
			"             │       │   └─ Eq\n" +
			"             │       │       ├─ dimension.orgid:1\n" +
			"             │       │       └─ org1 (longtext)\n" +
			"             │       └─ TableAlias(dimension)\n" +
			"             │           └─ IndexedTableAccess(asset)\n" +
			"             │               ├─ index: [asset.orgId,asset.name,asset.assetId]\n" +
			"             │               └─ columns: [id orgid assetid name val]\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ style.val:4\n" +
			"                 │   │   │   └─ curve (longtext)\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ style.name:3\n" +
			"                 │   │       └─ style (longtext)\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ style.orgid:1\n" +
			"                 │       └─ org1 (longtext)\n" +
			"                 └─ TableAlias(style)\n" +
			"                     └─ IndexedTableAccess(asset)\n" +
			"                         ├─ index: [asset.orgId,asset.name,asset.assetId]\n" +
			"                         └─ columns: [id orgid assetid name val]\n" +
			"",
	},
	{
		Query: `select * from mytable alias where i = 1 and s = 'first row'`,
		ExpectedPlan: "Filter\n" +
			" ├─ AND\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ alias.i:0!null\n" +
			" │   │   └─ 1 (tinyint)\n" +
			" │   └─ Eq\n" +
			" │       ├─ alias.s:1!null\n" +
			" │       └─ first row (longtext)\n" +
			" └─ TableAlias(alias)\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.s,mytable.i]\n" +
			"         ├─ static: [{[first row, first row], [1, 1]}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT col1->'$.key1' from (SELECT JSON_OBJECT('key1', 1, 'key2', 'abc')) as dt(col1);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [json_extract(dt.col1, '$.key1') as col1->'$.key1']\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: dt\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [json_object('key1',1,'key2','abc') as JSON_OBJECT('key1', 1, 'key2', 'abc')]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `SELECT col1->>'$.key1' from (SELECT JSON_OBJECT('key1', 1, 'key2', 'abc')) as dt(col1);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [json_unquote(json_extract(dt.col1, '$.key1')) as col1->>'$.key1']\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: dt\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [json_object('key1',1,'key2','abc') as JSON_OBJECT('key1', 1, 'key2', 'abc')]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `
			WITH RECURSIVE included_parts(sub_part, part, quantity) AS (
				SELECT sub_part, part, quantity FROM parts WHERE part = (select part from parts where part = 'pie' and sub_part = 'crust')
			  UNION ALL
				SELECT p.sub_part, p.part, p.quantity
				FROM included_parts AS pr, parts AS p
				WHERE p.part = pr.sub_part
			)
			SELECT sub_part, sum(quantity) as total_quantity
			FROM included_parts
			GROUP BY sub_part`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [included_parts.sub_part:1!null, total_quantity:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [sum(included_parts.quantity):0!null, included_parts.sub_part:1!null, sum(included_parts.quantity):0!null as total_quantity]\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(included_parts.quantity:2!null), included_parts.sub_part:0!null\n" +
			"         ├─ group: included_parts.sub_part:0!null\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: included_parts\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ RecursiveCTE\n" +
			"                 └─ Union all\n" +
			"                     ├─ Project\n" +
			"                     │   ├─ columns: [parts.sub_part:1!null, parts.part:0!null, parts.quantity:2!null]\n" +
			"                     │   └─ Project\n" +
			"                     │       ├─ columns: [parts.part:1!null, parts.sub_part:2!null, parts.quantity:3!null]\n" +
			"                     │       └─ LookupJoin\n" +
			"                     │           ├─ Eq\n" +
			"                     │           │   ├─ parts.part:1!null\n" +
			"                     │           │   └─ scalarSubq0.part:0!null\n" +
			"                     │           ├─ OrderedDistinct\n" +
			"                     │           │   └─ Project\n" +
			"                     │           │       ├─ columns: [scalarSubq0.part:0!null]\n" +
			"                     │           │       └─ Max1Row\n" +
			"                     │           │           └─ Filter\n" +
			"                     │           │               ├─ AND\n" +
			"                     │           │               │   ├─ Eq\n" +
			"                     │           │               │   │   ├─ scalarSubq0.part:0!null\n" +
			"                     │           │               │   │   └─ pie (longtext)\n" +
			"                     │           │               │   └─ Eq\n" +
			"                     │           │               │       ├─ scalarSubq0.sub_part:1!null\n" +
			"                     │           │               │       └─ crust (longtext)\n" +
			"                     │           │               └─ TableAlias(scalarSubq0)\n" +
			"                     │           │                   └─ Table\n" +
			"                     │           │                       ├─ name: parts\n" +
			"                     │           │                       └─ columns: [part sub_part quantity]\n" +
			"                     │           └─ IndexedTableAccess(parts)\n" +
			"                     │               ├─ index: [parts.part,parts.sub_part]\n" +
			"                     │               └─ columns: [part sub_part quantity]\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [p.sub_part:4!null, p.part:3!null, p.quantity:5!null]\n" +
			"                         └─ HashJoin\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ p.part:3!null\n" +
			"                             │   └─ pr.sub_part:0!null\n" +
			"                             ├─ TableAlias(pr)\n" +
			"                             │   └─ RecursiveTable(included_parts)\n" +
			"                             └─ HashLookup\n" +
			"                                 ├─ left-key: TUPLE(pr.sub_part:0!null)\n" +
			"                                 ├─ right-key: TUPLE(p.part:0!null)\n" +
			"                                 └─ TableAlias(p)\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: parts\n" +
			"                                         └─ columns: [part sub_part quantity]\n" +
			"",
	},
	{
		Query: `
Select x
from (select * from xy) sq1
union all
select u
from (select * from uv) sq2
limit 1
offset 2;`,
		ExpectedPlan: "Union all\n" +
			" ├─ limit: 1\n" +
			" ├─ offset: 2\n" +
			" ├─ Project\n" +
			" │   ├─ columns: [sq1.x:0!null]\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: sq1\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Table\n" +
			" │           ├─ name: xy\n" +
			" │           └─ columns: [x y]\n" +
			" └─ Project\n" +
			"     ├─ columns: [sq2.u:0!null]\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: sq2\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Table\n" +
			"             ├─ name: uv\n" +
			"             └─ columns: [u v]\n" +
			"",
	},
	{
		Query: `
Select * from (
  With recursive cte(s) as (select 1 union select x from xy join cte on x = s)
  Select * from cte
  Union
  Select x from xy where x in (select * from cte where x = 1)
 ) dt;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: dt\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Union distinct\n" +
			"     ├─ Project\n" +
			"     │   ├─ columns: [cte.s:0!null as s]\n" +
			"     │   └─ SubqueryAlias\n" +
			"     │       ├─ name: cte\n" +
			"     │       ├─ outerVisibility: false\n" +
			"     │       ├─ cacheable: true\n" +
			"     │       └─ RecursiveCTE\n" +
			"     │           └─ Union distinct\n" +
			"     │               ├─ Project\n" +
			"     │               │   ├─ columns: [1 (tinyint)]\n" +
			"     │               │   └─ Table\n" +
			"     │               │       ├─ name: \n" +
			"     │               │       └─ columns: []\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [xy.x:0!null]\n" +
			"     │                   └─ Project\n" +
			"     │                       ├─ columns: [xy.x:1!null, xy.y:2, cte.s:0!null]\n" +
			"     │                       └─ LookupJoin\n" +
			"     │                           ├─ Eq\n" +
			"     │                           │   ├─ xy.x:1!null\n" +
			"     │                           │   └─ cte.s:0!null\n" +
			"     │                           ├─ RecursiveTable(cte)\n" +
			"     │                           └─ IndexedTableAccess(xy)\n" +
			"     │                               ├─ index: [xy.x]\n" +
			"     │                               └─ columns: [x y]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [convert\n" +
			"         │   ├─ type: signed\n" +
			"         │   └─ xy.x:0!null\n" +
			"         │   as x]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [xy.x:0!null]\n" +
			"             └─ Filter\n" +
			"                 ├─ InSubquery\n" +
			"                 │   ├─ left: xy.x:0!null\n" +
			"                 │   └─ right: Subquery\n" +
			"                 │       ├─ cacheable: false\n" +
			"                 │       └─ Filter\n" +
			"                 │           ├─ Eq\n" +
			"                 │           │   ├─ xy.x:0!null\n" +
			"                 │           │   └─ 1 (tinyint)\n" +
			"                 │           └─ SubqueryAlias\n" +
			"                 │               ├─ name: cte\n" +
			"                 │               ├─ outerVisibility: true\n" +
			"                 │               ├─ cacheable: true\n" +
			"                 │               └─ RecursiveCTE\n" +
			"                 │                   └─ Union distinct\n" +
			"                 │                       ├─ Project\n" +
			"                 │                       │   ├─ columns: [1 (tinyint)]\n" +
			"                 │                       │   └─ Table\n" +
			"                 │                       │       ├─ name: \n" +
			"                 │                       │       └─ columns: []\n" +
			"                 │                       └─ Project\n" +
			"                 │                           ├─ columns: [xy.x:2!null]\n" +
			"                 │                           └─ Project\n" +
			"                 │                               ├─ columns: [xy.x:3!null, xy.y:4, cte.s:2!null]\n" +
			"                 │                               └─ LookupJoin\n" +
			"                 │                                   ├─ Eq\n" +
			"                 │                                   │   ├─ xy.x:3!null\n" +
			"                 │                                   │   └─ cte.s:2!null\n" +
			"                 │                                   ├─ RecursiveTable(cte)\n" +
			"                 │                                   └─ IndexedTableAccess(xy)\n" +
			"                 │                                       ├─ index: [xy.x]\n" +
			"                 │                                       └─ columns: [x y]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: xy\n" +
			"                     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `
Select * from (
  With recursive cte(s) as (select 1 union select x from xy join cte on x = s)
  Select * from cte
  Union
  Select x from xy where x in (select * from cte)
 ) dt;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: dt\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Union distinct\n" +
			"     ├─ Project\n" +
			"     │   ├─ columns: [cte.s:0!null as s]\n" +
			"     │   └─ SubqueryAlias\n" +
			"     │       ├─ name: cte\n" +
			"     │       ├─ outerVisibility: false\n" +
			"     │       ├─ cacheable: true\n" +
			"     │       └─ RecursiveCTE\n" +
			"     │           └─ Union distinct\n" +
			"     │               ├─ Project\n" +
			"     │               │   ├─ columns: [1 (tinyint)]\n" +
			"     │               │   └─ Table\n" +
			"     │               │       ├─ name: \n" +
			"     │               │       └─ columns: []\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [xy.x:0!null]\n" +
			"     │                   └─ Project\n" +
			"     │                       ├─ columns: [xy.x:1!null, xy.y:2, cte.s:0!null]\n" +
			"     │                       └─ LookupJoin\n" +
			"     │                           ├─ Eq\n" +
			"     │                           │   ├─ xy.x:1!null\n" +
			"     │                           │   └─ cte.s:0!null\n" +
			"     │                           ├─ RecursiveTable(cte)\n" +
			"     │                           └─ IndexedTableAccess(xy)\n" +
			"     │                               ├─ index: [xy.x]\n" +
			"     │                               └─ columns: [x y]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [convert\n" +
			"         │   ├─ type: signed\n" +
			"         │   └─ xy.x:0!null\n" +
			"         │   as x]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [xy.x:0!null]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			"                 └─ LookupJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ xy.x:1!null\n" +
			"                     │   └─ scalarSubq0.s:0!null\n" +
			"                     ├─ Distinct\n" +
			"                     │   └─ SubqueryAlias\n" +
			"                     │       ├─ name: scalarSubq0\n" +
			"                     │       ├─ outerVisibility: false\n" +
			"                     │       ├─ cacheable: true\n" +
			"                     │       └─ SubqueryAlias\n" +
			"                     │           ├─ name: cte\n" +
			"                     │           ├─ outerVisibility: true\n" +
			"                     │           ├─ cacheable: true\n" +
			"                     │           └─ RecursiveCTE\n" +
			"                     │               └─ Union distinct\n" +
			"                     │                   ├─ Project\n" +
			"                     │                   │   ├─ columns: [1 (tinyint)]\n" +
			"                     │                   │   └─ Table\n" +
			"                     │                   │       ├─ name: \n" +
			"                     │                   │       └─ columns: []\n" +
			"                     │                   └─ Project\n" +
			"                     │                       ├─ columns: [xy.x:0!null]\n" +
			"                     │                       └─ Project\n" +
			"                     │                           ├─ columns: [xy.x:1!null, xy.y:2, cte.s:0!null]\n" +
			"                     │                           └─ LookupJoin\n" +
			"                     │                               ├─ Eq\n" +
			"                     │                               │   ├─ xy.x:1!null\n" +
			"                     │                               │   └─ cte.s:0!null\n" +
			"                     │                               ├─ RecursiveTable(cte)\n" +
			"                     │                               └─ IndexedTableAccess(xy)\n" +
			"                     │                                   ├─ index: [xy.x]\n" +
			"                     │                                   └─ columns: [x y]\n" +
			"                     └─ IndexedTableAccess(xy)\n" +
			"                         ├─ index: [xy.x]\n" +
			"                         └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select /*+ RIGHT_SEMI_LOOKUP_JOIN(xy,scalarSubq0) */ * from xy where x in (select a from ab);`,
		ExpectedPlan: "SemiLookupJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ xy.x:0!null\n" +
			" │   └─ scalarSubq0.a:2!null\n" +
			" ├─ Table\n" +
			" │   ├─ name: xy\n" +
			" │   ├─ columns: [x y]\n" +
			" │   └─ comment: /*+ RIGHT_SEMI_LOOKUP_JOIN(xy,scalarSubq0) */\n" +
			" └─ TableAlias(scalarSubq0)\n" +
			"     └─ IndexedTableAccess(ab)\n" +
			"         ├─ index: [ab.a]\n" +
			"         └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select /*+ RIGHT_SEMI_LOOKUP_JOIN(xy,ab) MERGE_JOIN(ab,uv) JOIN_ORDER(ab,uv,xy) */ * from xy where EXISTS (select 1 from ab join uv on a = u where x = a);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ xy.x:1!null\n" +
			"     │   └─ ab.a:0!null\n" +
			"     ├─ OrderedDistinct\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [ab.a:0!null]\n" +
			"     │       └─ MergeJoin\n" +
			"     │           ├─ cmp: Eq\n" +
			"     │           │   ├─ ab.a:0!null\n" +
			"     │           │   └─ uv.u:2!null\n" +
			"     │           ├─ IndexedTableAccess(ab)\n" +
			"     │           │   ├─ index: [ab.a]\n" +
			"     │           │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │           │   └─ columns: [a b]\n" +
			"     │           └─ IndexedTableAccess(uv)\n" +
			"     │               ├─ index: [uv.u]\n" +
			"     │               ├─ static: [{[NULL, ∞)}]\n" +
			"     │               └─ columns: [u v]\n" +
			"     └─ IndexedTableAccess(xy)\n" +
			"         ├─ index: [xy.x]\n" +
			"         └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from uv where not exists (select * from xy where not exists (select * from xy where not(u = 1)))`,
		ExpectedPlan: "AntiJoin\n" +
			" ├─ NOT\n" +
			" │   └─ AND\n" +
			" │       ├─ EXISTS Subquery\n" +
			" │       │   ├─ cacheable: true\n" +
			" │       │   └─ Table\n" +
			" │       │       ├─ name: xy\n" +
			" │       │       └─ columns: [x y]\n" +
			" │       └─ NOT\n" +
			" │           └─ Eq\n" +
			" │               ├─ uv.u:0!null\n" +
			" │               └─ 1 (tinyint)\n" +
			" ├─ Table\n" +
			" │   ├─ name: uv\n" +
			" │   └─ columns: [u v]\n" +
			" └─ Table\n" +
			"     ├─ name: xy\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select x from xy where x in (
	select (select u from uv where u = sq.p)
    from (select p from pq) sq);
`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ xy.x:1!null\n" +
			"         │   └─ scalarSubq0.(select u from uv where u = sq.p):0\n" +
			"         ├─ Distinct\n" +
			"         │   └─ SubqueryAlias\n" +
			"         │       ├─ name: scalarSubq0\n" +
			"         │       ├─ outerVisibility: false\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [Subquery\n" +
			"         │           │   ├─ cacheable: false\n" +
			"         │           │   └─ Project\n" +
			"         │           │       ├─ columns: [uv.u:1!null]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ Eq\n" +
			"         │           │           │   ├─ uv.u:1!null\n" +
			"         │           │           │   └─ sq.p:0!null\n" +
			"         │           │           └─ IndexedTableAccess(uv)\n" +
			"         │           │               ├─ index: [uv.u]\n" +
			"         │           │               └─ columns: [u v]\n" +
			"         │           │   as (select u from uv where u = sq.p)]\n" +
			"         │           └─ SubqueryAlias\n" +
			"         │               ├─ name: sq\n" +
			"         │               ├─ outerVisibility: true\n" +
			"         │               ├─ cacheable: true\n" +
			"         │               └─ Project\n" +
			"         │                   ├─ columns: [pq.p:0!null]\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: pq\n" +
			"         │                       └─ columns: [p q]\n" +
			"         └─ IndexedTableAccess(xy)\n" +
			"             ├─ index: [xy.x]\n" +
			"             └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `SELECT mytable.s FROM mytable WHERE mytable.i = (SELECT othertable.i2 FROM othertable WHERE othertable.s2 = 'second')`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:1!null, mytable.s:2!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ mytable.i:1!null\n" +
			"         │   └─ scalarSubq0.i2:0!null\n" +
			"         ├─ OrderedDistinct\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [scalarSubq0.i2:1!null]\n" +
			"         │       └─ Max1Row\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ Eq\n" +
			"         │               │   ├─ scalarSubq0.s2:0!null\n" +
			"         │               │   └─ second (longtext)\n" +
			"         │               └─ TableAlias(scalarSubq0)\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: othertable\n" +
			"         │                       └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT mytable.s FROM mytable WHERE mytable.i IN (SELECT othertable.i2 FROM othertable) ORDER BY mytable.i ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.s:1!null]\n" +
			" └─ Sort(mytable.i:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [mytable.i:1!null, mytable.s:2!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ scalarSubq0.i2:0!null\n" +
			"             │   └─ mytable.i:1!null\n" +
			"             ├─ OrderedDistinct\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [scalarSubq0.i2:1!null]\n" +
			"             │       └─ TableAlias(scalarSubq0)\n" +
			"             │           └─ IndexedTableAccess(othertable)\n" +
			"             │               ├─ index: [othertable.i2]\n" +
			"             │               ├─ static: [{[NULL, ∞)}]\n" +
			"             │               └─ columns: [s2 i2]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(rs, xy) */ * from rs left join xy on y = s order by 1, 3`,
		ExpectedPlan: "Sort(rs.r:0!null ASC nullsFirst, xy.x:2!null ASC nullsFirst)\n" +
			" └─ Project\n" +
			"     ├─ columns: [rs.r:0!null, rs.s:1, xy.x:2!null, xy.y:3]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ rs.s:1\n" +
			"         │   └─ xy.y:3\n" +
			"         ├─ IndexedTableAccess(rs)\n" +
			"         │   ├─ index: [rs.s]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [r s]\n" +
			"         └─ IndexedTableAccess(xy)\n" +
			"             ├─ index: [xy.y]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from uv join (select /*+ JOIN_ORDER(ab, xy) */ * from ab join xy on y = a) r on u = r.a`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [uv.u:4!null, uv.v:5, r.a:0!null, r.b:1, r.x:2!null, r.y:3]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ uv.u:4!null\n" +
			"     │   └─ r.a:0!null\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: r\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ MergeJoin\n" +
			"     │       ├─ cmp: Eq\n" +
			"     │       │   ├─ ab.a:0!null\n" +
			"     │       │   └─ xy.y:3\n" +
			"     │       ├─ IndexedTableAccess(ab)\n" +
			"     │       │   ├─ index: [ab.a]\n" +
			"     │       │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │       │   └─ columns: [a b]\n" +
			"     │       └─ IndexedTableAccess(xy)\n" +
			"     │           ├─ index: [xy.y]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [x y]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(r.a:0!null)\n" +
			"         ├─ right-key: TUPLE(uv.u:0!null)\n" +
			"         └─ Table\n" +
			"             ├─ name: uv\n" +
			"             └─ columns: [u v]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(ab, xy) */ * from ab join xy on y = a`,
		ExpectedPlan: "MergeJoin\n" +
			" ├─ cmp: Eq\n" +
			" │   ├─ ab.a:0!null\n" +
			" │   └─ xy.y:3\n" +
			" ├─ IndexedTableAccess(ab)\n" +
			" │   ├─ index: [ab.a]\n" +
			" │   ├─ static: [{[NULL, ∞)}]\n" +
			" │   └─ columns: [a b]\n" +
			" └─ IndexedTableAccess(xy)\n" +
			"     ├─ index: [xy.y]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(rs, xy) */ * from rs join xy on y = s order by 1, 3`,
		ExpectedPlan: "Sort(rs.r:0!null ASC nullsFirst, xy.x:2!null ASC nullsFirst)\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ rs.s:1\n" +
			"     │   └─ xy.y:3\n" +
			"     ├─ IndexedTableAccess(rs)\n" +
			"     │   ├─ index: [rs.s]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [r s]\n" +
			"     └─ IndexedTableAccess(xy)\n" +
			"         ├─ index: [xy.y]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(rs, xy) */ * from rs join xy on y = s`,
		ExpectedPlan: "MergeJoin\n" +
			" ├─ cmp: Eq\n" +
			" │   ├─ rs.s:1\n" +
			" │   └─ xy.y:3\n" +
			" ├─ IndexedTableAccess(rs)\n" +
			" │   ├─ index: [rs.s]\n" +
			" │   ├─ static: [{[NULL, ∞)}]\n" +
			" │   └─ columns: [r s]\n" +
			" └─ IndexedTableAccess(xy)\n" +
			"     ├─ index: [xy.y]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(rs, xy) */ * from rs join xy on y+10 = s`,
		ExpectedPlan: "MergeJoin\n" +
			" ├─ cmp: Eq\n" +
			" │   ├─ rs.s:1\n" +
			" │   └─ (xy.y:3 + 10 (tinyint))\n" +
			" ├─ IndexedTableAccess(rs)\n" +
			" │   ├─ index: [rs.s]\n" +
			" │   ├─ static: [{[NULL, ∞)}]\n" +
			" │   └─ columns: [r s]\n" +
			" └─ IndexedTableAccess(xy)\n" +
			"     ├─ index: [xy.y]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER(rs, xy) */ * from rs join xy on 10 = s+y`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ 10 (tinyint)\n" +
			" │   └─ (rs.s:1 + xy.y:3)\n" +
			" ├─ Table\n" +
			" │   ├─ name: rs\n" +
			" │   └─ columns: [r s]\n" +
			" └─ Table\n" +
			"     ├─ name: xy\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from ab where a in (select x from xy where x in (select u from uv where u = a));`,
		ExpectedPlan: "Filter\n" +
			" ├─ InSubquery\n" +
			" │   ├─ left: ab.a:0!null\n" +
			" │   └─ right: Subquery\n" +
			" │       ├─ cacheable: false\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [xy.x:2!null]\n" +
			" │           └─ Filter\n" +
			" │               ├─ InSubquery\n" +
			" │               │   ├─ left: xy.x:2!null\n" +
			" │               │   └─ right: Subquery\n" +
			" │               │       ├─ cacheable: false\n" +
			" │               │       └─ Project\n" +
			" │               │           ├─ columns: [uv.u:4!null]\n" +
			" │               │           └─ Filter\n" +
			" │               │               ├─ Eq\n" +
			" │               │               │   ├─ uv.u:4!null\n" +
			" │               │               │   └─ ab.a:0!null\n" +
			" │               │               └─ IndexedTableAccess(uv)\n" +
			" │               │                   ├─ index: [uv.u]\n" +
			" │               │                   └─ columns: [u v]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: xy\n" +
			" │                   └─ columns: [x y]\n" +
			" └─ Table\n" +
			"     ├─ name: ab\n" +
			"     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from ab where a in (select y from xy where y in (select v from uv where v = a));`,
		ExpectedPlan: "Filter\n" +
			" ├─ InSubquery\n" +
			" │   ├─ left: ab.a:0!null\n" +
			" │   └─ right: Subquery\n" +
			" │       ├─ cacheable: false\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [xy.y:3]\n" +
			" │           └─ Filter\n" +
			" │               ├─ InSubquery\n" +
			" │               │   ├─ left: xy.y:3\n" +
			" │               │   └─ right: Subquery\n" +
			" │               │       ├─ cacheable: false\n" +
			" │               │       └─ Project\n" +
			" │               │           ├─ columns: [uv.v:5]\n" +
			" │               │           └─ Filter\n" +
			" │               │               ├─ Eq\n" +
			" │               │               │   ├─ uv.v:5\n" +
			" │               │               │   └─ ab.a:0!null\n" +
			" │               │               └─ Table\n" +
			" │               │                   ├─ name: uv\n" +
			" │               │                   └─ columns: [u v]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: xy\n" +
			" │                   └─ columns: [x y]\n" +
			" └─ Table\n" +
			"     ├─ name: ab\n" +
			"     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from ab where b in (select y from xy where y in (select v from uv where v = b));`,
		ExpectedPlan: "Filter\n" +
			" ├─ InSubquery\n" +
			" │   ├─ left: ab.b:1\n" +
			" │   └─ right: Subquery\n" +
			" │       ├─ cacheable: false\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [xy.y:3]\n" +
			" │           └─ Filter\n" +
			" │               ├─ InSubquery\n" +
			" │               │   ├─ left: xy.y:3\n" +
			" │               │   └─ right: Subquery\n" +
			" │               │       ├─ cacheable: false\n" +
			" │               │       └─ Project\n" +
			" │               │           ├─ columns: [uv.v:5]\n" +
			" │               │           └─ Filter\n" +
			" │               │               ├─ Eq\n" +
			" │               │               │   ├─ uv.v:5\n" +
			" │               │               │   └─ ab.b:1\n" +
			" │               │               └─ Table\n" +
			" │               │                   ├─ name: uv\n" +
			" │               │                   └─ columns: [u v]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: xy\n" +
			" │                   └─ columns: [x y]\n" +
			" └─ Table\n" +
			"     ├─ name: ab\n" +
			"     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select ab.* from ab join pq on a = p where b = (select y from xy where y in (select v from uv where v = b)) order by a;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ab.a:0!null, ab.b:1]\n" +
			" └─ Sort(ab.a:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [ab.a:2!null, ab.b:3, pq.p:0!null, pq.q:1]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ab.b:3\n" +
			"             │   └─ Subquery\n" +
			"             │       ├─ cacheable: false\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [xy.y:5]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ InSubquery\n" +
			"             │               │   ├─ left: xy.y:5\n" +
			"             │               │   └─ right: Subquery\n" +
			"             │               │       ├─ cacheable: false\n" +
			"             │               │       └─ Project\n" +
			"             │               │           ├─ columns: [uv.v:7]\n" +
			"             │               │           └─ Filter\n" +
			"             │               │               ├─ Eq\n" +
			"             │               │               │   ├─ uv.v:7\n" +
			"             │               │               │   └─ ab.b:3\n" +
			"             │               │               └─ Table\n" +
			"             │               │                   ├─ name: uv\n" +
			"             │               │                   └─ columns: [u v]\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: xy\n" +
			"             │                   └─ columns: [x y]\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ab.a:2!null\n" +
			"                 │   └─ pq.p:0!null\n" +
			"                 ├─ Table\n" +
			"                 │   ├─ name: pq\n" +
			"                 │   └─ columns: [p q]\n" +
			"                 └─ IndexedTableAccess(ab)\n" +
			"                     ├─ index: [ab.a]\n" +
			"                     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select y, (select 1 from uv where y = 1 and u = x) is_one from xy join uv on x = v order by y;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.y:1, is_one:4]\n" +
			" └─ Sort(xy.y:1 ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [xy.x:2!null, xy.y:3, uv.u:0!null, uv.v:1, Subquery\n" +
			"         │   ├─ cacheable: false\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [1 (tinyint)]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ xy.y:3\n" +
			"         │           │   │   └─ 1 (tinyint)\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ uv.u:4!null\n" +
			"         │           │       └─ xy.x:2!null\n" +
			"         │           └─ IndexedTableAccess(uv)\n" +
			"         │               ├─ index: [uv.u]\n" +
			"         │               └─ columns: [u v]\n" +
			"         │   as is_one]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xy.x:2!null\n" +
			"             │   └─ uv.v:1\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: uv\n" +
			"             │   └─ columns: [u v]\n" +
			"             └─ IndexedTableAccess(xy)\n" +
			"                 ├─ index: [xy.x]\n" +
			"                 └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from (select y, (select 1 where y = 1) is_one from xy join uv on x = v) sq order by y`,
		ExpectedPlan: "Sort(sq.y:0 ASC nullsFirst)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [xy.y:1, is_one:4]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [xy.x:2!null, xy.y:3, uv.u:0!null, uv.v:1, Subquery\n" +
			"             │   ├─ cacheable: false\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [1 (tinyint)]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ xy.y:3\n" +
			"             │           │   └─ 1 (tinyint)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: \n" +
			"             │               └─ columns: []\n" +
			"             │   as is_one]\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ xy.x:2!null\n" +
			"                 │   └─ uv.v:1\n" +
			"                 ├─ Table\n" +
			"                 │   ├─ name: uv\n" +
			"                 │   └─ columns: [u v]\n" +
			"                 └─ IndexedTableAccess(xy)\n" +
			"                     ├─ index: [xy.x]\n" +
			"                     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select y,(select 1 where y = 1) is_one from xy join uv on x = v;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.y:1, is_one:4]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:2!null, xy.y:3, uv.u:0!null, uv.v:1, Subquery\n" +
			"     │   ├─ cacheable: false\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [1 (tinyint)]\n" +
			"     │       └─ Filter\n" +
			"     │           ├─ Eq\n" +
			"     │           │   ├─ xy.y:3\n" +
			"     │           │   └─ 1 (tinyint)\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: \n" +
			"     │               └─ columns: []\n" +
			"     │   as is_one]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ xy.x:2!null\n" +
			"         │   └─ uv.v:1\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: uv\n" +
			"         │   └─ columns: [u v]\n" +
			"         └─ IndexedTableAccess(xy)\n" +
			"             ├─ index: [xy.x]\n" +
			"             └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `SELECT a FROM (select i,s FROM mytable) mt (a,b) order by 1;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mt.a:0!null]\n" +
			" └─ Sort(mt.a:0!null ASC nullsFirst)\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: mt\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `
			WITH RECURSIVE bus_dst as (
				SELECT origin as dst FROM bus_routes WHERE origin='New York'
				UNION
				SELECT bus_routes.dst FROM bus_routes JOIN bus_dst ON concat(bus_dst.dst, 'aa') = concat(bus_routes.origin, 'aa')
			)
			SELECT * FROM bus_dst
			ORDER BY dst`,
		ExpectedPlan: "Sort(bus_dst.dst:0!null ASC nullsFirst)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: bus_dst\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ RecursiveCTE\n" +
			"         └─ Union distinct\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [dst:2!null]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [bus_routes.origin:0!null, bus_routes.dst:1!null, bus_routes.origin:0!null as dst]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ bus_routes.origin:0!null\n" +
			"             │           │   └─ New York (longtext)\n" +
			"             │           └─ IndexedTableAccess(bus_routes)\n" +
			"             │               ├─ index: [bus_routes.origin,bus_routes.dst]\n" +
			"             │               ├─ static: [{[New York, New York], [NULL, ∞)}]\n" +
			"             │               └─ columns: [origin dst]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [bus_routes.dst:1!null]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [bus_routes.origin:1!null, bus_routes.dst:2!null, bus_dst.dst:0!null]\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ concat(bus_dst.dst:0!null,aa (longtext))\n" +
			"                         │   └─ concat(bus_routes.origin:1!null,aa (longtext))\n" +
			"                         ├─ RecursiveTable(bus_dst)\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(concat(bus_dst.dst:0!null,aa (longtext)))\n" +
			"                             ├─ right-key: TUPLE(concat(bus_routes.origin:0!null,aa (longtext)))\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: bus_routes\n" +
			"                                 └─ columns: [origin dst]\n" +
			"",
	},
	{
		Query: `with cte2 as (select u,v from uv join ab on u = b where u in (2,3)), cte1 as (select u, v from cte2 join ab on cte2.u = b) select * from xy where (x) not in (select u from cte1) order by 1`,
		ExpectedPlan: "Sort(xy.x:0!null ASC nullsFirst)\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:0!null, xy.y:1]\n" +
			"     └─ Filter\n" +
			"         ├─ scalarSubq0.u:2!null IS NULL\n" +
			"         └─ LeftOuterHashJoinExcludeNulls\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xy.x:0!null\n" +
			"             │   └─ scalarSubq0.u:2!null\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: xy\n" +
			"             │   └─ columns: [x y]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(xy.x:0!null)\n" +
			"                 ├─ right-key: TUPLE(scalarSubq0.u:0!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: scalarSubq0\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [cte1.u:0!null]\n" +
			"                         └─ SubqueryAlias\n" +
			"                             ├─ name: cte1\n" +
			"                             ├─ outerVisibility: true\n" +
			"                             ├─ cacheable: true\n" +
			"                             └─ Project\n" +
			"                                 ├─ columns: [cte2.u:0!null, cte2.v:1]\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [cte2.u:2!null, cte2.v:3, ab.a:0!null, ab.b:1]\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ Eq\n" +
			"                                         │   ├─ cte2.u:2!null\n" +
			"                                         │   └─ ab.b:1\n" +
			"                                         ├─ Table\n" +
			"                                         │   ├─ name: ab\n" +
			"                                         │   └─ columns: [a b]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: TUPLE(ab.b:1)\n" +
			"                                             ├─ right-key: TUPLE(cte2.u:0!null)\n" +
			"                                             └─ SubqueryAlias\n" +
			"                                                 ├─ name: cte2\n" +
			"                                                 ├─ outerVisibility: false\n" +
			"                                                 ├─ cacheable: true\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [uv.u:0!null, uv.v:1]\n" +
			"                                                     └─ Project\n" +
			"                                                         ├─ columns: [uv.u:2!null, uv.v:3, ab.a:0!null, ab.b:1]\n" +
			"                                                         └─ HashJoin\n" +
			"                                                             ├─ Eq\n" +
			"                                                             │   ├─ uv.u:2!null\n" +
			"                                                             │   └─ ab.b:1\n" +
			"                                                             ├─ Table\n" +
			"                                                             │   ├─ name: ab\n" +
			"                                                             │   └─ columns: [a b]\n" +
			"                                                             └─ HashLookup\n" +
			"                                                                 ├─ left-key: TUPLE(ab.b:1)\n" +
			"                                                                 ├─ right-key: TUPLE(uv.u:0!null)\n" +
			"                                                                 └─ Filter\n" +
			"                                                                     ├─ HashIn\n" +
			"                                                                     │   ├─ uv.u:0!null\n" +
			"                                                                     │   └─ TUPLE(2 (tinyint), 3 (tinyint))\n" +
			"                                                                     └─ IndexedTableAccess(uv)\n" +
			"                                                                         ├─ index: [uv.u]\n" +
			"                                                                         ├─ static: [{[2, 2]}, {[3, 3]}]\n" +
			"                                                                         └─ columns: [u v]\n" +
			"",
	},
	{
		Query: `select i+0.0/(lag(i) over (order by s)) from mytable order by 1;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [(mytable.i:1!null + (0 (decimal(2,1)) / lag(mytable.i, 1) over ( order by mytable.s asc):0)) as i+0.0/(lag(i) over (order by s))]\n" +
			" └─ Sort((mytable.i:1!null + (0 (decimal(2,1)) / lag(mytable.i, 1) over ( order by mytable.s asc):0)) as i+0.0/(lag(i) over (order by s)) ASC nullsFirst)\n" +
			"     └─ Window\n" +
			"         ├─ lag(mytable.i, 1) over ( order by mytable.s ASC)\n" +
			"         ├─ mytable.i:0!null\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select f64/f32, f32/(lag(i) over (order by f64)) from floattable order by 1,2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [(floattable.f64:1!null / floattable.f32:2!null) as f64/f32, (floattable.f32:2!null / lag(floattable.i, 1) over ( order by floattable.f64 asc):0) as f32/(lag(i) over (order by f64))]\n" +
			" └─ Sort((floattable.f64:1!null / floattable.f32:2!null) as f64/f32 ASC nullsFirst, (floattable.f32:2!null / lag(floattable.i, 1) over ( order by floattable.f64 asc):0) as f32/(lag(i) over (order by f64)) ASC nullsFirst)\n" +
			"     └─ Window\n" +
			"         ├─ lag(floattable.i, 1) over ( order by floattable.f64 ASC)\n" +
			"         ├─ floattable.f64:2!null\n" +
			"         ├─ floattable.f32:1!null\n" +
			"         └─ Table\n" +
			"             ├─ name: floattable\n" +
			"             └─ columns: [i f32 f64]\n" +
			"",
	},
	{
		Query: `select x from xy join uv on y = v join ab on y = b and u = -1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:4!null, xy.y:5, uv.u:2!null, uv.v:3, ab.a:0!null, ab.b:1]\n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ xy.y:5\n" +
			"         │   │   └─ ab.b:1\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ uv.v:3\n" +
			"         │       └─ ab.b:1\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: ab\n" +
			"         │   └─ columns: [a b]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ab.b:1, ab.b:1)\n" +
			"             ├─ right-key: TUPLE(xy.y:3, uv.v:1)\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ xy.y:5\n" +
			"                 │   └─ uv.v:3\n" +
			"                 ├─ IndexedTableAccess(uv)\n" +
			"                 │   ├─ index: [uv.u]\n" +
			"                 │   ├─ static: [{[-1, -1]}]\n" +
			"                 │   └─ columns: [u v]\n" +
			"                 └─ IndexedTableAccess(xy)\n" +
			"                     ├─ index: [xy.y]\n" +
			"                     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from (select a,v from ab join uv on a=u) av join (select x,q from xy join pq on x = p) xq on av.v = xq.x`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [av.a:2!null, av.v:3, xq.x:0!null, xq.q:1]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ av.v:3\n" +
			"     │   └─ xq.x:0!null\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: xq\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [xy.x:0!null, pq.q:3]\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [xy.x:2!null, xy.y:3, pq.p:0!null, pq.q:1]\n" +
			"     │           └─ LookupJoin\n" +
			"     │               ├─ Eq\n" +
			"     │               │   ├─ xy.x:2!null\n" +
			"     │               │   └─ pq.p:0!null\n" +
			"     │               ├─ Table\n" +
			"     │               │   ├─ name: pq\n" +
			"     │               │   └─ columns: [p q]\n" +
			"     │               └─ IndexedTableAccess(xy)\n" +
			"     │                   ├─ index: [xy.x]\n" +
			"     │                   └─ columns: [x y]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(xq.x:0!null)\n" +
			"         ├─ right-key: TUPLE(av.v:1)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: av\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [ab.a:0!null, uv.v:3]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [ab.a:2!null, ab.b:3, uv.u:0!null, uv.v:1]\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ ab.a:2!null\n" +
			"                         │   └─ uv.u:0!null\n" +
			"                         ├─ Table\n" +
			"                         │   ├─ name: uv\n" +
			"                         │   └─ columns: [u v]\n" +
			"                         └─ IndexedTableAccess(ab)\n" +
			"                             ├─ index: [ab.a]\n" +
			"                             └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from mytable t1 natural join mytable t2 join othertable t3 on t2.i = t3.i2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:2!null, t1.s:3!null, t3.s2:0!null, t3.i2:1!null]\n" +
			" └─ LookupJoin\n" +
			"     ├─ AND\n" +
			"     │   ├─ AND\n" +
			"     │   │   ├─ Eq\n" +
			"     │   │   │   ├─ t1.i:2!null\n" +
			"     │   │   │   └─ t2.i:4!null\n" +
			"     │   │   └─ Eq\n" +
			"     │   │       ├─ t1.s:3!null\n" +
			"     │   │       └─ t2.s:5!null\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ t2.i:4!null\n" +
			"     │       └─ t3.i2:1!null\n" +
			"     ├─ MergeJoin\n" +
			"     │   ├─ cmp: Eq\n" +
			"     │   │   ├─ t3.i2:1!null\n" +
			"     │   │   └─ t1.i:2!null\n" +
			"     │   ├─ TableAlias(t3)\n" +
			"     │   │   └─ IndexedTableAccess(othertable)\n" +
			"     │   │       ├─ index: [othertable.i2]\n" +
			"     │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │   │       └─ columns: [s2 i2]\n" +
			"     │   └─ TableAlias(t1)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(t2)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.s,mytable.i]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select x, a from xy inner join ab on a+1 = x OR a+2 = x OR a+3 = x `,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:0!null, ab.a:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:2!null, xy.y:3, ab.a:0!null, ab.b:1]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Or\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ (ab.a:0!null + 1 (tinyint))\n" +
			"         │   │   │   └─ xy.x:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ (ab.a:0!null + 2 (tinyint))\n" +
			"         │   │       └─ xy.x:2!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ (ab.a:0!null + 3 (tinyint))\n" +
			"         │       └─ xy.x:2!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: ab\n" +
			"         │   └─ columns: [a b]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(xy)\n" +
			"             │   ├─ index: [xy.x]\n" +
			"             │   └─ columns: [x y]\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(xy)\n" +
			"                 │   ├─ index: [xy.x]\n" +
			"                 │   └─ columns: [x y]\n" +
			"                 └─ IndexedTableAccess(xy)\n" +
			"                     ├─ index: [xy.x]\n" +
			"                     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select x, 1 in (select a from ab where exists (select * from uv where a = u)) s from xy`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:0!null, s:2]\n" +
			" └─ Project\n" +
			"     ├─ columns: [xy.x:0!null, xy.y:1, InSubquery\n" +
			"     │   ├─ left: 1 (tinyint)\n" +
			"     │   └─ right: Subquery\n" +
			"     │       ├─ cacheable: true\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [ab.a:2!null]\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [ab.a:3!null, ab.b:4]\n" +
			"     │               └─ LookupJoin\n" +
			"     │                   ├─ Eq\n" +
			"     │                   │   ├─ ab.a:3!null\n" +
			"     │                   │   └─ uv.u:2!null\n" +
			"     │                   ├─ OrderedDistinct\n" +
			"     │                   │   └─ Project\n" +
			"     │                   │       ├─ columns: [uv.u:2!null]\n" +
			"     │                   │       └─ Table\n" +
			"     │                   │           ├─ name: uv\n" +
			"     │                   │           └─ columns: [u v]\n" +
			"     │                   └─ IndexedTableAccess(ab)\n" +
			"     │                       ├─ index: [ab.a]\n" +
			"     │                       └─ columns: [a b]\n" +
			"     │   as s]\n" +
			"     └─ Table\n" +
			"         ├─ name: xy\n" +
			"         └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `with cte (a,b) as (select * from ab) select * from cte`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: cte\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Table\n" +
			"     ├─ name: ab\n" +
			"     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from ab where exists (select * from uv where a = 1)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ab.a:0!null, ab.b:1]\n" +
			" └─ CrossHashJoin\n" +
			"     ├─ IndexedTableAccess(ab)\n" +
			"     │   ├─ index: [ab.a]\n" +
			"     │   ├─ static: [{[1, 1]}]\n" +
			"     │   └─ columns: [a b]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE()\n" +
			"         ├─ right-key: TUPLE()\n" +
			"         └─ Limit(1)\n" +
			"             └─ Table\n" +
			"                 ├─ name: uv\n" +
			"                 └─ columns: [u v]\n" +
			"",
	},
	{
		Query: `select * from ab where exists (select * from ab where a = 1)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ab.a:0!null, ab.b:1]\n" +
			" └─ CrossHashJoin\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: ab\n" +
			"     │   └─ columns: [a b]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE()\n" +
			"         ├─ right-key: TUPLE()\n" +
			"         └─ Limit(1)\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ab_1.a:0!null\n" +
			"                 │   └─ 1 (tinyint)\n" +
			"                 └─ TableAlias(ab_1)\n" +
			"                     └─ IndexedTableAccess(ab)\n" +
			"                         ├─ index: [ab.a]\n" +
			"                         ├─ static: [{[1, 1]}]\n" +
			"                         └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from ab s where exists (select * from ab where a = 1 or s.a = 1)`,
		ExpectedPlan: "SemiJoin\n" +
			" ├─ Or\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ ab.a:2!null\n" +
			" │   │   └─ 1 (tinyint)\n" +
			" │   └─ Eq\n" +
			" │       ├─ s.a:0!null\n" +
			" │       └─ 1 (tinyint)\n" +
			" ├─ TableAlias(s)\n" +
			" │   └─ Table\n" +
			" │       ├─ name: ab\n" +
			" │       └─ columns: [a b]\n" +
			" └─ Table\n" +
			"     ├─ name: ab\n" +
			"     └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from uv where exists (select 1, count(a) from ab where u = a group by a)`,
		ExpectedPlan: "SemiLookupJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ uv.u:0!null\n" +
			" │   └─ ab.a:2!null\n" +
			" ├─ Table\n" +
			" │   ├─ name: uv\n" +
			" │   └─ columns: [u v]\n" +
			" └─ IndexedTableAccess(ab)\n" +
			"     ├─ index: [ab.a]\n" +
			"     └─ columns: [a]\n" +
			"",
	},
	{
		Query: `SELECT count(*), i, concat(i, i), 123, 'abc', concat('abc', 'def') FROM emptytable;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*), emptytable.i:1!null, concat(emptytable.i:1!null,emptytable.i:1!null) as concat(i, i), 123 (tinyint), abc (longtext) as abc, concat(abc (longtext),def (longtext)) as concat('abc', 'def')]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint)), emptytable.i:0!null\n" +
			"     ├─ group: \n" +
			"     └─ Table\n" +
			"         ├─ name: emptytable\n" +
			"         └─ columns: [i]\n" +
			"",
	},
	{
		Query: `SELECT count(*), i, concat(i, i), 123, 'abc', concat('abc', 'def') FROM mytable where false;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*), mytable.i:1!null, concat(mytable.i:1!null,mytable.i:1!null) as concat(i, i), 123 (tinyint), abc (longtext) as abc, concat(abc (longtext),def (longtext)) as concat('abc', 'def')]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint)), mytable.i:0!null\n" +
			"     ├─ group: \n" +
			"     └─ EmptyTable\n" +
			"",
	},
	{
		Query: `select count(*) cnt from ab where exists (select * from xy where x = a) group by a`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [cnt:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [count(1):0!null, count(1):0!null as cnt]\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: COUNT(1 (bigint))\n" +
			"         ├─ group: ab.a:0!null\n" +
			"         └─ SemiLookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xy.x:2!null\n" +
			"             │   └─ ab.a:0!null\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: ab\n" +
			"             │   └─ columns: [a b]\n" +
			"             └─ IndexedTableAccess(xy)\n" +
			"                 ├─ index: [xy.x]\n" +
			"                 └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `SELECT pk, u, v FROM one_pk JOIN (SELECT count(*) AS u, 123 AS v FROM emptytable) uv WHERE pk = u;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, uv.u:6!null, uv.v:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:2!null, one_pk.c1:3, one_pk.c2:4, one_pk.c3:5, one_pk.c4:6, one_pk.c5:7, uv.u:0!null, uv.v:1!null]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ one_pk.pk:2!null\n" +
			"         │   └─ uv.u:0!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: uv\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [u:1!null, v:2!null]\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [count(1):0!null, count(1):0!null as u, 123 (tinyint) as v]\n" +
			"         │           └─ Project\n" +
			"         │               ├─ columns: [emptytable.COUNT(1):0!null as COUNT(1)]\n" +
			"         │               └─ table_count(emptytable) as COUNT(1)\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(uv.u:0!null)\n" +
			"             ├─ right-key: TUPLE(one_pk.pk:0!null)\n" +
			"             └─ Table\n" +
			"                 ├─ name: one_pk\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk, u, v FROM one_pk JOIN (SELECT count(*) AS u, 123 AS v FROM mytable WHERE false) uv WHERE pk = u;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, uv.u:6!null, uv.v:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:2!null, one_pk.c1:3, one_pk.c2:4, one_pk.c3:5, one_pk.c4:6, one_pk.c5:7, uv.u:0!null, uv.v:1!null]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ one_pk.pk:2!null\n" +
			"         │   └─ uv.u:0!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: uv\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [u:1!null, v:2!null]\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [count(1):0!null, count(1):0!null as u, 123 (tinyint) as v]\n" +
			"         │           └─ GroupBy\n" +
			"         │               ├─ select: COUNT(1 (bigint))\n" +
			"         │               ├─ group: \n" +
			"         │               └─ EmptyTable\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(uv.u:0!null)\n" +
			"             ├─ right-key: TUPLE(one_pk.pk:0!null)\n" +
			"             └─ Table\n" +
			"                 ├─ name: one_pk\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk WHERE (pk, 123) IN (SELECT count(*) AS u, 123 AS v FROM emptytable);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ SemiJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ TUPLE(one_pk.pk:0!null, 123 (tinyint))\n" +
			"     │   └─ TUPLE(scalarSubq0.u:6!null, scalarSubq0.v:7!null)\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: one_pk\n" +
			"     │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: scalarSubq0\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Project\n" +
			"             ├─ columns: [u:1!null, v:2!null]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [count(1):0!null, count(1):0!null as u, 123 (tinyint) as v]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [emptytable.COUNT(1):0!null as COUNT(1)]\n" +
			"                     └─ table_count(emptytable) as COUNT(1)\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk WHERE (pk, 123) IN (SELECT count(*) AS u, 123 AS v FROM mytable WHERE false);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ SemiJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ TUPLE(one_pk.pk:0!null, 123 (tinyint))\n" +
			"     │   └─ TUPLE(scalarSubq0.u:6!null, scalarSubq0.v:7!null)\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: one_pk\n" +
			"     │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: scalarSubq0\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Project\n" +
			"             ├─ columns: [u:1!null, v:2!null]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [count(1):0!null, count(1):0!null as u, 123 (tinyint) as v]\n" +
			"                 └─ GroupBy\n" +
			"                     ├─ select: COUNT(1 (bigint))\n" +
			"                     ├─ group: \n" +
			"                     └─ EmptyTable\n" +
			"",
	},
	{
		Query: `SELECT i FROM mytable WHERE EXISTS (SELECT * FROM (SELECT count(*) as u, 123 as v FROM emptytable) uv);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ Limit(1)\n" +
			"         │   └─ SubqueryAlias\n" +
			"         │       ├─ name: uv\n" +
			"         │       ├─ outerVisibility: true\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [u:1!null, v:2!null]\n" +
			"         │           └─ Project\n" +
			"         │               ├─ columns: [count(1):0!null, count(1):0!null as u, 123 (tinyint) as v]\n" +
			"         │               └─ Project\n" +
			"         │                   ├─ columns: [emptytable.COUNT(1):0!null as COUNT(1)]\n" +
			"         │                   └─ table_count(emptytable) as COUNT(1)\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ Table\n" +
			"                 ├─ name: mytable\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT count(*), (SELECT i FROM mytable WHERE i = 1 group by i);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*), Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ GroupBy\n" +
			" │       ├─ select: mytable.i:1!null\n" +
			" │       ├─ group: mytable.i:1!null\n" +
			" │       └─ IndexedTableAccess(mytable)\n" +
			" │           ├─ index: [mytable.i]\n" +
			" │           ├─ static: [{[1, 1]}]\n" +
			" │           └─ columns: [i]\n" +
			" │   as (SELECT i FROM mytable WHERE i = 1 group by i)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Table\n" +
			"         ├─ name: \n" +
			"         └─ columns: []\n" +
			"",
	},
	{
		Query: `with cte(a,b) as (select * from ab) select * from xy where exists (select * from cte where a = x)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [xy.x:1!null, xy.y:2]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ cte.a:0!null\n" +
			"     │   └─ xy.x:1!null\n" +
			"     ├─ Distinct\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [cte.a:0!null]\n" +
			"     │       └─ SubqueryAlias\n" +
			"     │           ├─ name: cte\n" +
			"     │           ├─ outerVisibility: true\n" +
			"     │           ├─ cacheable: true\n" +
			"     │           └─ Table\n" +
			"     │               ├─ name: ab\n" +
			"     │               └─ columns: [a b]\n" +
			"     └─ IndexedTableAccess(xy)\n" +
			"         ├─ index: [xy.x]\n" +
			"         └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `select * from xy where exists (select * from ab where a = x) order by x`,
		ExpectedPlan: "Sort(xy.x:0!null ASC nullsFirst)\n" +
			" └─ SemiLookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ ab.a:2!null\n" +
			"     │   └─ xy.x:0!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: xy\n" +
			"     │   └─ columns: [x y]\n" +
			"     └─ IndexedTableAccess(ab)\n" +
			"         ├─ index: [ab.a]\n" +
			"         └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `select * from xy where exists (select * from ab where a = x order by a limit 2) order by x limit 5`,
		ExpectedPlan: "Limit(5)\n" +
			" └─ TopN(Limit: [5 (tinyint)]; xy.x:0!null ASC nullsFirst)\n" +
			"     └─ SemiLookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ ab.a:2!null\n" +
			"         │   └─ xy.x:0!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: xy\n" +
			"         │   └─ columns: [x y]\n" +
			"         └─ IndexedTableAccess(ab)\n" +
			"             ├─ index: [ab.a]\n" +
			"             └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `
select * from
(
  select * from ab
  left join uv on a = u
  where exists (select * from pq where u = p)
) alias2
inner join xy on a = x;`,
		ExpectedPlan: "LookupJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ alias2.a:0!null\n" +
			" │   └─ xy.x:4!null\n" +
			" ├─ SubqueryAlias\n" +
			" │   ├─ name: alias2\n" +
			" │   ├─ outerVisibility: false\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [ab.a:0!null, ab.b:1, uv.u:2!null, uv.v:3]\n" +
			" │       └─ HashJoin\n" +
			" │           ├─ Eq\n" +
			" │           │   ├─ uv.u:2!null\n" +
			" │           │   └─ pq.p:4!null\n" +
			" │           ├─ LeftOuterMergeJoin\n" +
			" │           │   ├─ cmp: Eq\n" +
			" │           │   │   ├─ ab.a:0!null\n" +
			" │           │   │   └─ uv.u:2!null\n" +
			" │           │   ├─ IndexedTableAccess(ab)\n" +
			" │           │   │   ├─ index: [ab.a]\n" +
			" │           │   │   ├─ static: [{[NULL, ∞)}]\n" +
			" │           │   │   └─ columns: [a b]\n" +
			" │           │   └─ IndexedTableAccess(uv)\n" +
			" │           │       ├─ index: [uv.u]\n" +
			" │           │       ├─ static: [{[NULL, ∞)}]\n" +
			" │           │       └─ columns: [u v]\n" +
			" │           └─ HashLookup\n" +
			" │               ├─ left-key: TUPLE(uv.u:2!null)\n" +
			" │               ├─ right-key: TUPLE(pq.p:0!null)\n" +
			" │               └─ OrderedDistinct\n" +
			" │                   └─ Project\n" +
			" │                       ├─ columns: [pq.p:0!null]\n" +
			" │                       └─ Table\n" +
			" │                           ├─ name: pq\n" +
			" │                           └─ columns: [p q]\n" +
			" └─ IndexedTableAccess(xy)\n" +
			"     ├─ index: [xy.x]\n" +
			"     └─ columns: [x y]\n" +
			"",
	},
	{
		Query: `
select * from ab
where exists
(
  select * from uv
  left join pq on u = p
  where a = u
);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ab.a:1!null, ab.b:2]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ ab.a:1!null\n" +
			"     │   └─ uv.u:0!null\n" +
			"     ├─ OrderedDistinct\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [uv.u:0!null]\n" +
			"     │       └─ LeftOuterMergeJoin\n" +
			"     │           ├─ cmp: Eq\n" +
			"     │           │   ├─ uv.u:0!null\n" +
			"     │           │   └─ pq.p:2!null\n" +
			"     │           ├─ IndexedTableAccess(uv)\n" +
			"     │           │   ├─ index: [uv.u]\n" +
			"     │           │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │           │   └─ columns: [u v]\n" +
			"     │           └─ IndexedTableAccess(pq)\n" +
			"     │               ├─ index: [pq.p]\n" +
			"     │               ├─ static: [{[NULL, ∞)}]\n" +
			"     │               └─ columns: [p q]\n" +
			"     └─ IndexedTableAccess(ab)\n" +
			"         ├─ index: [ab.a]\n" +
			"         └─ columns: [a b]\n" +
			"",
	},
	{
		Query: `
select * from
(
  select * from ab
  where not exists (select * from uv where a = u)
) alias1
where exists (select * from pq where a = p)
`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [alias1.a:0!null, alias1.b:1]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ alias1.a:0!null\n" +
			"     │   └─ pq.p:2!null\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: alias1\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [ab.a:0!null, ab.b:1]\n" +
			"     │       └─ Filter\n" +
			"     │           ├─ uv.u:2!null IS NULL\n" +
			"     │           └─ LeftOuterMergeJoin\n" +
			"     │               ├─ cmp: Eq\n" +
			"     │               │   ├─ ab.a:0!null\n" +
			"     │               │   └─ uv.u:2!null\n" +
			"     │               ├─ IndexedTableAccess(ab)\n" +
			"     │               │   ├─ index: [ab.a]\n" +
			"     │               │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │               │   └─ columns: [a b]\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [uv.u:0!null]\n" +
			"     │                   └─ IndexedTableAccess(uv)\n" +
			"     │                       ├─ index: [uv.u]\n" +
			"     │                       ├─ static: [{[NULL, ∞)}]\n" +
			"     │                       └─ columns: [u v]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(alias1.a:0!null)\n" +
			"         ├─ right-key: TUPLE(pq.p:0!null)\n" +
			"         └─ OrderedDistinct\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [pq.p:0!null]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: pq\n" +
			"                     └─ columns: [p q]\n" +
			"",
	},
	{
		Query: `
select * from ab
inner join uv on a = u
full join pq on a = p
`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ab.a:2!null, ab.b:3, uv.u:0!null, uv.v:1, pq.p:4!null, pq.q:5]\n" +
			" └─ FullOuterJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ ab.a:2!null\n" +
			"     │   └─ pq.p:4!null\n" +
			"     ├─ LookupJoin\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ ab.a:2!null\n" +
			"     │   │   └─ uv.u:0!null\n" +
			"     │   ├─ Table\n" +
			"     │   │   ├─ name: uv\n" +
			"     │   │   └─ columns: [u v]\n" +
			"     │   └─ IndexedTableAccess(ab)\n" +
			"     │       ├─ index: [ab.a]\n" +
			"     │       └─ columns: [a b]\n" +
			"     └─ Table\n" +
			"         ├─ name: pq\n" +
			"         └─ columns: [p q]\n" +
			"",
	},
	{
		Query: `
select * from
(
  select * from ab
  inner join xy on true
) alias1
inner join uv on true
inner join pq on true
`,
		ExpectedPlan: "CrossHashJoin\n" +
			" ├─ CrossHashJoin\n" +
			" │   ├─ SubqueryAlias\n" +
			" │   │   ├─ name: alias1\n" +
			" │   │   ├─ outerVisibility: false\n" +
			" │   │   ├─ cacheable: true\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [ab.a:2!null, ab.b:3, xy.x:0!null, xy.y:1]\n" +
			" │   │       └─ CrossHashJoin\n" +
			" │   │           ├─ Table\n" +
			" │   │           │   ├─ name: xy\n" +
			" │   │           │   └─ columns: [x y]\n" +
			" │   │           └─ HashLookup\n" +
			" │   │               ├─ left-key: TUPLE()\n" +
			" │   │               ├─ right-key: TUPLE()\n" +
			" │   │               └─ Table\n" +
			" │   │                   ├─ name: ab\n" +
			" │   │                   └─ columns: [a b]\n" +
			" │   └─ HashLookup\n" +
			" │       ├─ left-key: TUPLE()\n" +
			" │       ├─ right-key: TUPLE()\n" +
			" │       └─ Table\n" +
			" │           ├─ name: uv\n" +
			" │           └─ columns: [u v]\n" +
			" └─ HashLookup\n" +
			"     ├─ left-key: TUPLE()\n" +
			"     ├─ right-key: TUPLE()\n" +
			"     └─ Table\n" +
			"         ├─ name: pq\n" +
			"         └─ columns: [p q]\n" +
			"",
	},
	{
		Query: `
	select * from
	(
	 select * from ab
	 where not exists (select * from xy where a = x)
	) alias1
	left join pq on alias1.a = p
	where exists (select * from uv where a = u)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [alias1.a:0!null, alias1.b:1, pq.p:2!null, pq.q:3]\n" +
			" └─ LeftOuterHashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ alias1.a:0!null\n" +
			"     │   └─ pq.p:2!null\n" +
			"     ├─ Project\n" +
			"     │   ├─ columns: [alias1.a:0!null, alias1.b:1]\n" +
			"     │   └─ HashJoin\n" +
			"     │       ├─ Eq\n" +
			"     │       │   ├─ alias1.a:0!null\n" +
			"     │       │   └─ uv.u:2!null\n" +
			"     │       ├─ SubqueryAlias\n" +
			"     │       │   ├─ name: alias1\n" +
			"     │       │   ├─ outerVisibility: false\n" +
			"     │       │   ├─ cacheable: true\n" +
			"     │       │   └─ AntiLookupJoin\n" +
			"     │       │       ├─ Eq\n" +
			"     │       │       │   ├─ ab.a:0!null\n" +
			"     │       │       │   └─ xy.x:2!null\n" +
			"     │       │       ├─ Table\n" +
			"     │       │       │   ├─ name: ab\n" +
			"     │       │       │   └─ columns: [a b]\n" +
			"     │       │       └─ IndexedTableAccess(xy)\n" +
			"     │       │           ├─ index: [xy.x]\n" +
			"     │       │           └─ columns: [x y]\n" +
			"     │       └─ HashLookup\n" +
			"     │           ├─ left-key: TUPLE(alias1.a:0!null)\n" +
			"     │           ├─ right-key: TUPLE(uv.u:0!null)\n" +
			"     │           └─ OrderedDistinct\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [uv.u:0!null]\n" +
			"     │                   └─ Table\n" +
			"     │                       ├─ name: uv\n" +
			"     │                       └─ columns: [u v]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(alias1.a:0!null)\n" +
			"         ├─ right-key: TUPLE(pq.p:0!null)\n" +
			"         └─ Table\n" +
			"             ├─ name: pq\n" +
			"             └─ columns: [p q]\n" +
			"",
	},
	{
		Query: `select i from mytable a where exists (select 1 from mytable b where a.i = b.i)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:1!null, a.s:2!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ b.i:0!null\n" +
			"         │   └─ a.i:1!null\n" +
			"         ├─ OrderedDistinct\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [b.i:0!null]\n" +
			"         │       └─ TableAlias(b)\n" +
			"         │           └─ IndexedTableAccess(mytable)\n" +
			"         │               ├─ index: [mytable.i]\n" +
			"         │               ├─ static: [{[NULL, ∞)}]\n" +
			"         │               └─ columns: [i s]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select i from mytable a where not exists (select 1 from mytable b where a.i = b.i)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ b.i:2!null IS NULL\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ a.i:0!null\n" +
			"             │   └─ b.i:2!null\n" +
			"             ├─ TableAlias(a)\n" +
			"             │   └─ IndexedTableAccess(mytable)\n" +
			"             │       ├─ index: [mytable.i]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [i s]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [b.i:0!null]\n" +
			"                 └─ TableAlias(b)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select i from mytable full join othertable on mytable.i = othertable.i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:0!null, mytable.s:1!null, othertable.s2:2!null, othertable.i2:3!null]\n" +
			"     └─ FullOuterJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ othertable.i2:3!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: mytable\n" +
			"         │   └─ columns: [i s]\n" +
			"         └─ Table\n" +
			"             ├─ name: othertable\n" +
			"             └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT mytable.i FROM mytable INNER JOIN othertable ON (mytable.i = othertable.i2) LEFT JOIN othertable T4 ON (mytable.i = T4.i2) ORDER BY othertable.i2, T4.s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null]\n" +
			" └─ Sort(othertable.i2:3!null ASC nullsFirst, t4.s2:4!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null, t4.s2:4!null, t4.i2:5!null]\n" +
			"         └─ LeftOuterLookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ mytable.i:2!null\n" +
			"             │   └─ t4.i2:5!null\n" +
			"             ├─ MergeJoin\n" +
			"             │   ├─ cmp: Eq\n" +
			"             │   │   ├─ othertable.i2:1!null\n" +
			"             │   │   └─ mytable.i:2!null\n" +
			"             │   ├─ IndexedTableAccess(othertable)\n" +
			"             │   │   ├─ index: [othertable.i2]\n" +
			"             │   │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   └─ columns: [s2 i2]\n" +
			"             │   └─ IndexedTableAccess(mytable)\n" +
			"             │       ├─ index: [mytable.i]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [i s]\n" +
			"             └─ TableAlias(t4)\n" +
			"                 └─ IndexedTableAccess(othertable)\n" +
			"                     ├─ index: [othertable.i2]\n" +
			"                     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk ORDER BY pk`,
		ExpectedPlan: "IndexedTableAccess(one_pk)\n" +
			" ├─ index: [one_pk.pk]\n" +
			" ├─ static: [{[NULL, ∞)}]\n" +
			" └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM two_pk ORDER BY pk1, pk2`,
		ExpectedPlan: "IndexedTableAccess(two_pk)\n" +
			" ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			" ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			" └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM two_pk ORDER BY pk1`,
		ExpectedPlan: "IndexedTableAccess(two_pk)\n" +
			" ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			" ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			" └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk1 AS one, pk2 AS two FROM two_pk ORDER BY pk1, pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one:7!null, two:8!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null, two_pk.pk1:0!null as one, two_pk.pk2:1!null as two]\n" +
			"     └─ IndexedTableAccess(two_pk)\n" +
			"         ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk1 AS one, pk2 AS two FROM two_pk ORDER BY one, two`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one:7!null, two:8!null]\n" +
			" └─ Sort(two_pk.pk1:0!null as one ASC nullsFirst, two_pk.pk2:1!null as two ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null, two_pk.pk1:0!null as one, two_pk.pk2:1!null as two]\n" +
			"         └─ Table\n" +
			"             ├─ name: two_pk\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT t1.i FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [t1.i:2!null, t1.s:3!null, t2.i:0!null, t2.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ t2.i:0!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t1.i:2!null\n" +
			"             │   └─ (t2.i:0!null + 1 (tinyint))\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.i:0!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ TableAlias(t2)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           ├─ static: [{[1, 1]}]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ t1.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(t1)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select row_number() over (order by i desc), mytable.i as i2
				from mytable join othertable on i = i2 order by 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [row_number() over ( order by mytable.i desc):0!null as row_number() over (order by i desc), i2:2!null]\n" +
			" └─ Sort(row_number() over ( order by mytable.i desc):0!null as row_number() over (order by i desc) ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [row_number() over ( order by mytable.i desc):0!null, mytable.i:1!null, mytable.i:1!null as i2]\n" +
			"         └─ Window\n" +
			"             ├─ row_number() over ( order by mytable.i DESC)\n" +
			"             ├─ mytable.i:1!null\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ othertable.i2:0!null\n" +
			"                 │   └─ mytable.i:1!null\n" +
			"                 ├─ IndexedTableAccess(othertable)\n" +
			"                 │   ├─ index: [othertable.i2]\n" +
			"                 │   ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   └─ columns: [i2]\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [i]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk_two_idx WHERE v1 < 2 AND v2 IS NOT NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ one_pk_two_idx.v2:2 IS NULL\n" +
			" └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"     ├─ index: [one_pk_two_idx.v1,one_pk_two_idx.v2]\n" +
			"     ├─ static: [{(NULL, 2), (NULL, ∞)}]\n" +
			"     └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk_two_idx WHERE v1 IN (1, 2) AND v2 <= 2`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ one_pk_two_idx.v1:1\n" +
			" │   └─ TUPLE(1 (tinyint), 2 (tinyint))\n" +
			" └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"     ├─ index: [one_pk_two_idx.v1,one_pk_two_idx.v2]\n" +
			"     ├─ static: [{[1, 1], (NULL, 2]}, {[2, 2], (NULL, 2]}]\n" +
			"     └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk_three_idx WHERE v1 > 2 AND v2 = 3`,
		ExpectedPlan: "IndexedTableAccess(one_pk_three_idx)\n" +
			" ├─ index: [one_pk_three_idx.v1,one_pk_three_idx.v2,one_pk_three_idx.v3]\n" +
			" ├─ static: [{(2, ∞), [3, 3], [NULL, ∞)}]\n" +
			" └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk_three_idx WHERE v1 > 2 AND v3 = 3`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ one_pk_three_idx.v3:3\n" +
			" │   └─ 3 (tinyint)\n" +
			" └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"     ├─ index: [one_pk_three_idx.v1,one_pk_three_idx.v2,one_pk_three_idx.v3]\n" +
			"     ├─ static: [{(2, ∞), [NULL, ∞), [NULL, ∞)}]\n" +
			"     └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `select row_number() over (order by i desc), mytable.i as i2
				from mytable join othertable on i = i2
				where mytable.i = 2
				order by 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [row_number() over ( order by mytable.i desc):0!null as row_number() over (order by i desc), i2:2!null]\n" +
			" └─ Sort(row_number() over ( order by mytable.i desc):0!null as row_number() over (order by i desc) ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [row_number() over ( order by mytable.i desc):0!null, mytable.i:1!null, mytable.i:1!null as i2]\n" +
			"         └─ Window\n" +
			"             ├─ row_number() over ( order by mytable.i DESC)\n" +
			"             ├─ mytable.i:0!null\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ mytable.i:0!null\n" +
			"                 │   └─ othertable.i2:1!null\n" +
			"                 ├─ IndexedTableAccess(mytable)\n" +
			"                 │   ├─ index: [mytable.i]\n" +
			"                 │   ├─ static: [{[2, 2]}]\n" +
			"                 │   └─ columns: [i]\n" +
			"                 └─ IndexedTableAccess(othertable)\n" +
			"                     ├─ index: [othertable.i2]\n" +
			"                     └─ columns: [i2]\n" +
			"",
	},
	{
		Query: `INSERT INTO mytable(i,s) SELECT t1.i, 'hello' FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Insert(i, s)\n" +
			"     ├─ InsertDestination\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [i:0!null, s:1!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [t1.i:0!null, hello (longtext)]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [t1.i:2!null, t1.s:3!null, t2.i:0!null, t2.s:1!null]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ t2.i:0!null\n" +
			"                     │   └─ 1 (tinyint)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ t1.i:2!null\n" +
			"                         │   └─ (t2.i:0!null + 1 (tinyint))\n" +
			"                         ├─ Filter\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ t2.i:0!null\n" +
			"                         │   │   └─ 1 (tinyint)\n" +
			"                         │   └─ TableAlias(t2)\n" +
			"                         │       └─ IndexedTableAccess(mytable)\n" +
			"                         │           ├─ index: [mytable.i]\n" +
			"                         │           ├─ static: [{[1, 1]}]\n" +
			"                         │           └─ columns: [i s]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ t1.i:0!null\n" +
			"                             │   └─ 2 (tinyint)\n" +
			"                             └─ TableAlias(t1)\n" +
			"                                 └─ IndexedTableAccess(mytable)\n" +
			"                                     ├─ index: [mytable.i]\n" +
			"                                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(t1, t2) */ t1.i FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:0!null]\n" +
			" └─ Filter\n" +
			"     ├─ Eq\n" +
			"     │   ├─ t2.i:2!null\n" +
			"     │   └─ 1 (tinyint)\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ t1.i:0!null\n" +
			"         │   └─ (t2.i:2!null + 1 (tinyint))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t1.i:0!null\n" +
			"         │   │   └─ 2 (tinyint)\n" +
			"         │   └─ TableAlias(t1)\n" +
			"         │       └─ IndexedTableAccess(mytable)\n" +
			"         │           ├─ index: [mytable.i]\n" +
			"         │           ├─ static: [{[2, 2]}]\n" +
			"         │           └─ columns: [i s]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t2.i:0!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ TableAlias(t2)\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(t1, mytable) */ t1.i FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [t1.i:2!null, t1.s:3!null, t2.i:0!null, t2.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ t2.i:0!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t1.i:2!null\n" +
			"             │   └─ (t2.i:0!null + 1 (tinyint))\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.i:0!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ TableAlias(t2)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           ├─ static: [{[1, 1]}]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ t1.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(t1)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(t1, t2, t3) */ t1.i FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [t1.i:2!null, t1.s:3!null, t2.i:0!null, t2.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ t2.i:0!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t1.i:2!null\n" +
			"             │   └─ (t2.i:0!null + 1 (tinyint))\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.i:0!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ TableAlias(t2)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           ├─ static: [{[1, 1]}]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ t1.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(t1)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT t1.i FROM mytable t1 JOIN mytable t2 on t1.i = t2.i + 1 where t1.i = 2 and t2.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [t1.i:2!null, t1.s:3!null, t2.i:0!null, t2.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ t2.i:0!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t1.i:2!null\n" +
			"             │   └─ (t2.i:0!null + 1 (tinyint))\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.i:0!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ TableAlias(t2)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           ├─ static: [{[1, 1]}]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ t1.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(t1)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.i2]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2 OR s = s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mytable.i:2!null\n" +
			"         │   │   └─ othertable.i2:1!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mytable.s:3!null\n" +
			"         │       └─ othertable.s2:0!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: othertable\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(mytable)\n" +
			"             │   ├─ index: [mytable.s,mytable.i]\n" +
			"             │   └─ columns: [i s]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ot ON i = i2 OR s = s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, ot.i2:3!null, ot.s2:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, ot.s2:0!null, ot.i2:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mytable.i:2!null\n" +
			"         │   │   └─ ot.i2:1!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mytable.s:3!null\n" +
			"         │       └─ ot.s2:0!null\n" +
			"         ├─ TableAlias(ot)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: othertable\n" +
			"         │       └─ columns: [s2 i2]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(mytable)\n" +
			"             │   ├─ index: [mytable.s,mytable.i]\n" +
			"             │   └─ columns: [i s]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2 OR SUBSTRING_INDEX(s, ' ', 1) = s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Or\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ mytable.i:0!null\n" +
			"     │   │   └─ othertable.i2:3!null\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ SUBSTRING_INDEX(mytable.s, ' ', 1)\n" +
			"     │       └─ othertable.s2:2!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: mytable\n" +
			"     │   └─ columns: [i s]\n" +
			"     └─ Concat\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.s2]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(othertable)\n" +
			"             ├─ index: [othertable.i2]\n" +
			"             └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2 OR SUBSTRING_INDEX(s, ' ', 1) = s2 OR SUBSTRING_INDEX(s, ' ', 2) = s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Or\n" +
			"     │   ├─ Or\n" +
			"     │   │   ├─ Eq\n" +
			"     │   │   │   ├─ mytable.i:0!null\n" +
			"     │   │   │   └─ othertable.i2:3!null\n" +
			"     │   │   └─ Eq\n" +
			"     │   │       ├─ SUBSTRING_INDEX(mytable.s, ' ', 1)\n" +
			"     │   │       └─ othertable.s2:2!null\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ SUBSTRING_INDEX(mytable.s, ' ', 2)\n" +
			"     │       └─ othertable.s2:2!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: mytable\n" +
			"     │   └─ columns: [i s]\n" +
			"     └─ Concat\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.s2]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ Concat\n" +
			"             ├─ IndexedTableAccess(othertable)\n" +
			"             │   ├─ index: [othertable.i2]\n" +
			"             │   └─ columns: [s2 i2]\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.s2]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2 UNION SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Project\n" +
			" │   ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" │       └─ MergeJoin\n" +
			" │           ├─ cmp: Eq\n" +
			" │           │   ├─ othertable.i2:1!null\n" +
			" │           │   └─ mytable.i:2!null\n" +
			" │           ├─ IndexedTableAccess(othertable)\n" +
			" │           │   ├─ index: [othertable.i2]\n" +
			" │           │   ├─ static: [{[NULL, ∞)}]\n" +
			" │           │   └─ columns: [s2 i2]\n" +
			" │           └─ IndexedTableAccess(mytable)\n" +
			" │               ├─ index: [mytable.i]\n" +
			" │               ├─ static: [{[NULL, ∞)}]\n" +
			" │               └─ columns: [i s]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ othertable.i2:1!null\n" +
			"             │   └─ mytable.i:2!null\n" +
			"             ├─ IndexedTableAccess(othertable)\n" +
			"             │   ├─ index: [othertable.i2]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [s2 i2]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT sub.i, sub.i2, sub.s2, ot.i2, ot.s2 FROM (SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2) sub INNER JOIN othertable ot ON sub.i = ot.i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sub.i:0!null, sub.i2:1!null, sub.s2:2!null, ot.i2:4!null, ot.s2:3!null]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ sub.i:0!null\n" +
			"     │   └─ ot.i2:4!null\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: sub\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     │           └─ MergeJoin\n" +
			"     │               ├─ cmp: Eq\n" +
			"     │               │   ├─ othertable.i2:1!null\n" +
			"     │               │   └─ mytable.i:2!null\n" +
			"     │               ├─ IndexedTableAccess(othertable)\n" +
			"     │               │   ├─ index: [othertable.i2]\n" +
			"     │               │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │               │   └─ columns: [s2 i2]\n" +
			"     │               └─ IndexedTableAccess(mytable)\n" +
			"     │                   ├─ index: [mytable.i]\n" +
			"     │                   ├─ static: [{[NULL, ∞)}]\n" +
			"     │                   └─ columns: [i s]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(sub.i:0!null)\n" +
			"         ├─ right-key: TUPLE(ot.i2:1!null)\n" +
			"         └─ TableAlias(ot)\n" +
			"             └─ Table\n" +
			"                 ├─ name: othertable\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT sub.i, sub.i2, sub.s2, ot.i2, ot.s2 FROM othertable ot INNER JOIN (SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2) sub ON sub.i = ot.i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sub.i:2!null, sub.i2:3!null, sub.s2:4!null, ot.i2:1!null, ot.s2:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [ot.s2:3!null, ot.i2:4!null, sub.i:0!null, sub.i2:1!null, sub.s2:2!null]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ sub.i:0!null\n" +
			"         │   └─ ot.i2:4!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: sub\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"         │           └─ MergeJoin\n" +
			"         │               ├─ cmp: Eq\n" +
			"         │               │   ├─ othertable.i2:1!null\n" +
			"         │               │   └─ mytable.i:2!null\n" +
			"         │               ├─ IndexedTableAccess(othertable)\n" +
			"         │               │   ├─ index: [othertable.i2]\n" +
			"         │               │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │   └─ columns: [s2 i2]\n" +
			"         │               └─ IndexedTableAccess(mytable)\n" +
			"         │                   ├─ index: [mytable.i]\n" +
			"         │                   ├─ static: [{[NULL, ∞)}]\n" +
			"         │                   └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(sub.i:0!null)\n" +
			"             ├─ right-key: TUPLE(ot.i2:1!null)\n" +
			"             └─ TableAlias(ot)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: othertable\n" +
			"                     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT sub.i, sub.i2, sub.s2, ot.i2, ot.s2 FROM othertable ot LEFT JOIN (SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2 WHERE CONVERT(s2, signed) <> 0) sub ON sub.i = ot.i2 WHERE ot.i2 > 0`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sub.i:2!null, sub.i2:3!null, sub.s2:4!null, ot.i2:1!null, ot.s2:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [ot.s2:0!null, ot.i2:1!null, sub.i:2!null, sub.i2:3!null, sub.s2:4!null]\n" +
			"     └─ LeftOuterJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ sub.i:2!null\n" +
			"         │   └─ ot.i2:1!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ ot.i2:1!null\n" +
			"         │   │   └─ 0 (tinyint)\n" +
			"         │   └─ TableAlias(ot)\n" +
			"         │       └─ IndexedTableAccess(othertable)\n" +
			"         │           ├─ index: [othertable.i2]\n" +
			"         │           ├─ static: [{(0, ∞)}]\n" +
			"         │           └─ columns: [s2 i2]\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: sub\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"                     └─ Filter\n" +
			"                         ├─ NOT\n" +
			"                         │   └─ Eq\n" +
			"                         │       ├─ convert\n" +
			"                         │       │   ├─ type: signed\n" +
			"                         │       │   └─ othertable.s2:0!null\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         └─ MergeJoin\n" +
			"                             ├─ cmp: Eq\n" +
			"                             │   ├─ othertable.i2:1!null\n" +
			"                             │   └─ mytable.i:2!null\n" +
			"                             ├─ Filter\n" +
			"                             │   ├─ NOT\n" +
			"                             │   │   └─ Eq\n" +
			"                             │   │       ├─ convert\n" +
			"                             │   │       │   ├─ type: signed\n" +
			"                             │   │       │   └─ othertable.s2:0!null\n" +
			"                             │   │       └─ 0 (tinyint)\n" +
			"                             │   └─ IndexedTableAccess(othertable)\n" +
			"                             │       ├─ index: [othertable.i2]\n" +
			"                             │       ├─ static: [{[NULL, ∞)}]\n" +
			"                             │       └─ columns: [s2 i2]\n" +
			"                             └─ IndexedTableAccess(mytable)\n" +
			"                                 ├─ index: [mytable.i]\n" +
			"                                 ├─ static: [{[NULL, ∞)}]\n" +
			"                                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER( i, k, j ) */  * from one_pk i join one_pk k on i.pk = k.pk join (select pk, rand() r from one_pk) j on i.pk = j.pk`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ i.pk:0!null\n" +
			" │   └─ j.pk:12!null\n" +
			" ├─ MergeJoin\n" +
			" │   ├─ cmp: Eq\n" +
			" │   │   ├─ i.pk:0!null\n" +
			" │   │   └─ k.pk:6!null\n" +
			" │   ├─ TableAlias(i)\n" +
			" │   │   └─ IndexedTableAccess(one_pk)\n" +
			" │   │       ├─ index: [one_pk.pk]\n" +
			" │   │       ├─ static: [{[NULL, ∞)}]\n" +
			" │   │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			" │   └─ TableAlias(k)\n" +
			" │       └─ IndexedTableAccess(one_pk)\n" +
			" │           ├─ index: [one_pk.pk]\n" +
			" │           ├─ static: [{[NULL, ∞)}]\n" +
			" │           └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: j\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: false\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, r:6!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, rand() as r]\n" +
			"             └─ Table\n" +
			"                 ├─ name: one_pk\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `select /*+ JOIN_ORDER( i, k, j ) */  * from one_pk i join one_pk k on i.pk = k.pk join (select pk, rand() r from one_pk) j on i.pk = j.pk`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ i.pk:0!null\n" +
			" │   └─ j.pk:12!null\n" +
			" ├─ MergeJoin\n" +
			" │   ├─ cmp: Eq\n" +
			" │   │   ├─ i.pk:0!null\n" +
			" │   │   └─ k.pk:6!null\n" +
			" │   ├─ TableAlias(i)\n" +
			" │   │   └─ IndexedTableAccess(one_pk)\n" +
			" │   │       ├─ index: [one_pk.pk]\n" +
			" │   │       ├─ static: [{[NULL, ∞)}]\n" +
			" │   │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			" │   └─ TableAlias(k)\n" +
			" │       └─ IndexedTableAccess(one_pk)\n" +
			" │           ├─ index: [one_pk.pk]\n" +
			" │           ├─ static: [{[NULL, ∞)}]\n" +
			" │           └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: j\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: false\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, r:6!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, rand() as r]\n" +
			"             └─ Table\n" +
			"                 ├─ name: one_pk\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `INSERT INTO mytable SELECT sub.i + 10, ot.s2 FROM othertable ot INNER JOIN (SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i = i2) sub ON sub.i = ot.i2`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Insert(i, s)\n" +
			"     ├─ InsertDestination\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [i:0!null, s:1!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [(sub.i:2!null + 10 (tinyint)), ot.s2:0!null]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [ot.s2:3!null, ot.i2:4!null, sub.i:0!null, sub.i2:1!null, sub.s2:2!null]\n" +
			"                 └─ HashJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ sub.i:0!null\n" +
			"                     │   └─ ot.i2:4!null\n" +
			"                     ├─ SubqueryAlias\n" +
			"                     │   ├─ name: sub\n" +
			"                     │   ├─ outerVisibility: false\n" +
			"                     │   ├─ cacheable: true\n" +
			"                     │   └─ Project\n" +
			"                     │       ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			"                     │       └─ Project\n" +
			"                     │           ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"                     │           └─ MergeJoin\n" +
			"                     │               ├─ cmp: Eq\n" +
			"                     │               │   ├─ othertable.i2:1!null\n" +
			"                     │               │   └─ mytable.i:2!null\n" +
			"                     │               ├─ IndexedTableAccess(othertable)\n" +
			"                     │               │   ├─ index: [othertable.i2]\n" +
			"                     │               │   ├─ static: [{[NULL, ∞)}]\n" +
			"                     │               │   └─ columns: [s2 i2]\n" +
			"                     │               └─ IndexedTableAccess(mytable)\n" +
			"                     │                   ├─ index: [mytable.i]\n" +
			"                     │                   ├─ static: [{[NULL, ∞)}]\n" +
			"                     │                   └─ columns: [i s]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE(sub.i:0!null)\n" +
			"                         ├─ right-key: TUPLE(ot.i2:1!null)\n" +
			"                         └─ TableAlias(ot)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: othertable\n" +
			"                                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT mytable.i, selfjoin.i FROM mytable INNER JOIN mytable selfjoin ON mytable.i = selfjoin.i WHERE selfjoin.i IN (SELECT 1 FROM DUAL)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, selfjoin.i:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, selfjoin.i:0!null, selfjoin.s:1!null]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [selfjoin.i:1!null, selfjoin.s:2!null, mytable.i:3!null, mytable.s:4!null]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ selfjoin.i:1!null\n" +
			"             │   └─ scalarSubq0.1:0!null\n" +
			"             ├─ Distinct\n" +
			"             │   └─ SubqueryAlias\n" +
			"             │       ├─ name: scalarSubq0\n" +
			"             │       ├─ outerVisibility: false\n" +
			"             │       ├─ cacheable: true\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [1 (tinyint)]\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: \n" +
			"             │               └─ columns: []\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(scalarSubq0.1:0!null)\n" +
			"                 ├─ right-key: TUPLE(selfjoin.i:0!null)\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ selfjoin.i:1!null\n" +
			"                     │   └─ mytable.i:3!null\n" +
			"                     ├─ TableAlias(selfjoin)\n" +
			"                     │   └─ IndexedTableAccess(mytable)\n" +
			"                     │       ├─ index: [mytable.i]\n" +
			"                     │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │       └─ columns: [i s]\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM mytable INNER JOIN othertable ON i = i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.i2]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM othertable JOIN mytable ON i = i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, othertable.i2:1!null, othertable.s2:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null, mytable.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ othertable.i2:3!null\n" +
			"         ├─ IndexedTableAccess(mytable)\n" +
			"         │   ├─ index: [mytable.i]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [i s]\n" +
			"         └─ IndexedTableAccess(othertable)\n" +
			"             ├─ index: [othertable.i2]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM othertable JOIN mytable ON i = i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:0!null, othertable.i2:1!null, mytable.i:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null, mytable.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ othertable.i2:3!null\n" +
			"         ├─ IndexedTableAccess(mytable)\n" +
			"         │   ├─ index: [mytable.i]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [i s]\n" +
			"         └─ IndexedTableAccess(othertable)\n" +
			"             ├─ index: [othertable.i2]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM othertable JOIN mytable ON i = i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:0!null, othertable.i2:1!null, mytable.i:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null, mytable.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ othertable.i2:3!null\n" +
			"         ├─ IndexedTableAccess(mytable)\n" +
			"         │   ├─ index: [mytable.i]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [i s]\n" +
			"         └─ IndexedTableAccess(othertable)\n" +
			"             ├─ index: [othertable.i2]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM othertable JOIN mytable ON i = i2 LIMIT 1`,
		ExpectedPlan: "Limit(1)\n" +
			" └─ Project\n" +
			"     ├─ columns: [othertable.s2:0!null, othertable.i2:1!null, mytable.i:2!null]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null, mytable.s:1!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ mytable.i:0!null\n" +
			"             │   └─ othertable.i2:3!null\n" +
			"             ├─ IndexedTableAccess(mytable)\n" +
			"             │   ├─ index: [mytable.i]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [i s]\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.i2]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable INNER JOIN othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.i2]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM mytable INNER JOIN othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ IndexedTableAccess(othertable)\n" +
			"         │   ├─ index: [othertable.i2]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM MYTABLE JOIN OTHERTABLE ON i = i2 AND NOT (s2 <=> s)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ othertable.i2:1!null\n" +
			"     │   └─ mytable.i:2!null\n" +
			"     ├─ sel: NOT\n" +
			"     │   └─ (othertable.s2:0!null <=> mytable.s:3!null)\n" +
			"     ├─ IndexedTableAccess(othertable)\n" +
			"     │   ├─ index: [othertable.i2]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM MYTABLE JOIN OTHERTABLE ON i = i2 AND NOT (s2 = s)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ othertable.i2:1!null\n" +
			"     │   └─ mytable.i:2!null\n" +
			"     ├─ sel: NOT\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ othertable.s2:0!null\n" +
			"     │       └─ mytable.s:3!null\n" +
			"     ├─ IndexedTableAccess(othertable)\n" +
			"     │   ├─ index: [othertable.i2]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM MYTABLE JOIN OTHERTABLE ON i = i2 AND CONCAT(s, s2) IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ othertable.i2:1!null\n" +
			"     │   └─ mytable.i:2!null\n" +
			"     ├─ sel: NOT\n" +
			"     │   └─ concat(mytable.s:3!null,othertable.s2:0!null) IS NULL\n" +
			"     ├─ IndexedTableAccess(othertable)\n" +
			"     │   ├─ index: [othertable.i2]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM MYTABLE JOIN OTHERTABLE ON i = i2 AND s > s2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ othertable.i2:1!null\n" +
			"     │   └─ mytable.i:2!null\n" +
			"     ├─ sel: GreaterThan\n" +
			"     │   ├─ mytable.s:3!null\n" +
			"     │   └─ othertable.s2:0!null\n" +
			"     ├─ IndexedTableAccess(othertable)\n" +
			"     │   ├─ index: [othertable.i2]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM MYTABLE JOIN OTHERTABLE ON i = i2 AND NOT(s > s2)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ othertable.i2:1!null\n" +
			"     │   └─ mytable.i:2!null\n" +
			"     ├─ sel: NOT\n" +
			"     │   └─ GreaterThan\n" +
			"     │       ├─ mytable.s:3!null\n" +
			"     │       └─ othertable.s2:0!null\n" +
			"     ├─ IndexedTableAccess(othertable)\n" +
			"     │   ├─ index: [othertable.i2]\n" +
			"     │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │   └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(mytable, othertable) */ s2, i2, i FROM mytable INNER JOIN (SELECT * FROM othertable) othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ othertable.i2:3!null\n" +
			"     │   └─ mytable.i:0!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: mytable\n" +
			"     │   └─ columns: [i s]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(mytable.i:0!null)\n" +
			"         ├─ right-key: TUPLE(othertable.i2:1!null)\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: othertable\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Table\n" +
			"                 ├─ name: othertable\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM mytable LEFT JOIN (SELECT * FROM othertable) othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:0!null, mytable.s:1!null, othertable.s2:2!null, othertable.i2:3!null]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ othertable.i2:3!null\n" +
			"         │   └─ mytable.i:0!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: mytable\n" +
			"         │   └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mytable.i:0!null)\n" +
			"             ├─ right-key: TUPLE(othertable.i2:1!null)\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: othertable\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Table\n" +
			"                     ├─ name: othertable\n" +
			"                     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM (SELECT * FROM mytable) mytable RIGHT JOIN (SELECT * FROM othertable) othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: othertable\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: othertable\n" +
			"         │       └─ columns: [s2 i2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(othertable.i2:1!null)\n" +
			"             ├─ right-key: TUPLE(mytable.i:0!null)\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: mytable\n" +
			"                 ├─ outerVisibility: false\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Table\n" +
			"                     ├─ name: mytable\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a WHERE a.s is not null`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ a.s:1!null IS NULL\n" +
			" └─ TableAlias(a)\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.s]\n" +
			"         ├─ static: [{(NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a inner join mytable b on (a.i = b.s) WHERE a.s is not null`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.s:3!null\n" +
			"     ├─ Filter\n" +
			"     │   ├─ NOT\n" +
			"     │   │   └─ a.s:1!null IS NULL\n" +
			"     │   └─ TableAlias(a)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.s,mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(b, a) */ a.* FROM mytable a inner join mytable b on (a.i = b.s) WHERE a.s is not null`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ b.s:1!null\n" +
			"         │   └─ a.i:2!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ IndexedTableAccess(mytable)\n" +
			"         │       ├─ index: [mytable.s,mytable.i]\n" +
			"         │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ Filter\n" +
			"             ├─ NOT\n" +
			"             │   └─ a.s:1!null IS NULL\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a inner join mytable b on (a.i = b.s) WHERE a.s not in ('1', '2', '3', '4')`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.s:3!null\n" +
			"     ├─ Filter\n" +
			"     │   ├─ NOT\n" +
			"     │   │   └─ HashIn\n" +
			"     │   │       ├─ a.s:1!null\n" +
			"     │   │       └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext), 4 (longtext))\n" +
			"     │   └─ TableAlias(a)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.s,mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a inner join mytable b on (a.i = b.s) WHERE a.i in (1, 2, 3, 4)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.s:3!null\n" +
			"     ├─ Filter\n" +
			"     │   ├─ HashIn\n" +
			"     │   │   ├─ a.i:0!null\n" +
			"     │   │   └─ TUPLE(1 (tinyint), 2 (tinyint), 3 (tinyint), 4 (tinyint))\n" +
			"     │   └─ TableAlias(a)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.s,mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (1, 2, 3, 4)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ mytable.i:0!null\n" +
			" │   └─ TUPLE(1 (tinyint), 2 (tinyint), 3 (tinyint), 4 (tinyint))\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.i]\n" +
			"     ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}, {[4, 4]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (1, 1)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ mytable.i:0!null\n" +
			" │   └─ TUPLE(1 (tinyint), 1 (tinyint))\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.i]\n" +
			"     ├─ static: [{[1, 1]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (CAST(NULL AS SIGNED), 2, 3, 4)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ mytable.i:0!null\n" +
			" │   └─ TUPLE(NULL (bigint), 2 (tinyint), 3 (tinyint), 4 (tinyint))\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.i]\n" +
			"     ├─ static: [{[2, 2]}, {[3, 3]}, {[4, 4]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (1+2)`,
		ExpectedPlan: "IndexedTableAccess(mytable)\n" +
			" ├─ index: [mytable.i]\n" +
			" ├─ static: [{[3, 3]}]\n" +
			" └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where upper(s) IN ('FIRST ROW', 'SECOND ROW')`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ upper(mytable.s)\n" +
			" │   └─ TUPLE(FIRST ROW (longtext), SECOND ROW (longtext))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where cast(i as CHAR) IN ('a', 'b')`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ convert\n" +
			" │   │   ├─ type: char\n" +
			" │   │   └─ mytable.i:0!null\n" +
			" │   └─ TUPLE(a (longtext), b (longtext))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where cast(i as CHAR) IN ('1', '2')`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ convert\n" +
			" │   │   ├─ type: char\n" +
			" │   │   └─ mytable.i:0!null\n" +
			" │   └─ TUPLE(1 (longtext), 2 (longtext))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where (i > 2) IN (true)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ GreaterThan\n" +
			" │   │   ├─ mytable.i:0!null\n" +
			" │   │   └─ 2 (tinyint)\n" +
			" │   └─ TUPLE(true (tinyint))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where (i + 6) IN (7, 8)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ (mytable.i:0!null + 6 (tinyint))\n" +
			" │   └─ TUPLE(7 (tinyint), 8 (tinyint))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where (i + 40) IN (7, 8)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ (mytable.i:0!null + 40 (tinyint))\n" +
			" │   └─ TUPLE(7 (tinyint), 8 (tinyint))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where (i = 1 | false) IN (true)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ mytable.i:0!null\n" +
			" │   │   └─ 1 (bigint)\n" +
			" │   └─ TUPLE(true (tinyint))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where (i = 1 & false) IN (true)`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ Eq\n" +
			" │   │   ├─ mytable.i:0!null\n" +
			" │   │   └─ 0 (bigint)\n" +
			" │   └─ TUPLE(true (tinyint))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (2*i)`,
		ExpectedPlan: "Filter\n" +
			" ├─ IN\n" +
			" │   ├─ left: mytable.i:0!null\n" +
			" │   └─ right: TUPLE((2 (tinyint) * mytable.i:0!null))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable WHERE i in (i)`,
		ExpectedPlan: "Filter\n" +
			" ├─ IN\n" +
			" │   ├─ left: mytable.i:0!null\n" +
			" │   └─ right: TUPLE(mytable.i:0!null)\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable WHERE 4 IN (i + 2)`,
		ExpectedPlan: "Filter\n" +
			" ├─ IN\n" +
			" │   ├─ left: 4 (tinyint)\n" +
			" │   └─ right: TUPLE((mytable.i:0!null + 2 (tinyint)))\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable WHERE s IN (cast('first row' AS CHAR))`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ mytable.s:1!null\n" +
			" │   └─ TUPLE(first row (longtext))\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.s]\n" +
			"     ├─ static: [{[first row, first row]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable WHERE s IN (lower('SECOND ROW'), 'FIRST ROW')`,
		ExpectedPlan: "Filter\n" +
			" ├─ HashIn\n" +
			" │   ├─ mytable.s:1!null\n" +
			" │   └─ TUPLE(second row (longtext), FIRST ROW (longtext))\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.s]\n" +
			"     ├─ static: [{[FIRST ROW, FIRST ROW]}, {[second row, second row]}]\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from mytable where true IN (i > 3)`,
		ExpectedPlan: "Filter\n" +
			" ├─ IN\n" +
			" │   ├─ left: true (tinyint)\n" +
			" │   └─ right: TUPLE(GreaterThan\n" +
			" │       ├─ mytable.i:0!null\n" +
			" │       └─ 3 (tinyint)\n" +
			" │      )\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.i = b.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ b.i:0!null\n" +
			"         │   └─ a.i:2!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ IndexedTableAccess(mytable)\n" +
			"         │       ├─ index: [mytable.i]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.s = b.i OR a.i = 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.s:3!null\n" +
			"         │   │   └─ b.i:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ a.i:2!null\n" +
			"         │       └─ 1 (tinyint)\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(mytable)\n" +
			"                 │   ├─ index: [mytable.i]\n" +
			"                 │   └─ columns: [i s]\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.s,mytable.i]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where NOT(a.i = b.s OR a.s = b.i)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ NOT\n" +
			"     │   └─ Or\n" +
			"     │       ├─ Eq\n" +
			"     │       │   ├─ a.i:0!null\n" +
			"     │       │   └─ b.s:3!null\n" +
			"     │       └─ Eq\n" +
			"     │           ├─ a.s:1!null\n" +
			"     │           └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.i = b.s OR a.s = b.i IS FALSE`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ Or\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ a.i:0!null\n" +
			"     │   │   └─ b.s:3!null\n" +
			"     │   └─ (a.s = b.i) IS FALSE\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.i >= b.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ GreaterThanOrEqual\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.i = a.s`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ a.i:0!null\n" +
			"                 │   └─ a.s:1!null\n" +
			"                 └─ TableAlias(a)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: mytable\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b where a.i in (2, 432, 7)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ a.i:0!null\n" +
			"                 │   └─ TUPLE(2 (tinyint), 432 (smallint), 7 (tinyint))\n" +
			"                 └─ TableAlias(a)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         ├─ static: [{[2, 2]}, {[7, 7]}, {[432, 432]}]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b, mytable c, mytable d where a.i = b.i AND b.i = c.i AND c.i = d.i AND c.i = 2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null, c.i:6!null, c.s:7!null, d.i:4!null, d.s:5!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ c.i:6!null\n" +
			"         │   └─ 2 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ b.i:0!null\n" +
			"             │   │   │   └─ c.i:6!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ c.i:6!null\n" +
			"             │   │       └─ d.i:4!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ a.i:2!null\n" +
			"             │       └─ c.i:6!null\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ a.i:2!null\n" +
			"             │   │   │   └─ d.i:4!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ b.i:0!null\n" +
			"             │   │       └─ d.i:4!null\n" +
			"             │   ├─ MergeJoin\n" +
			"             │   │   ├─ cmp: Eq\n" +
			"             │   │   │   ├─ b.i:0!null\n" +
			"             │   │   │   └─ a.i:2!null\n" +
			"             │   │   ├─ TableAlias(b)\n" +
			"             │   │   │   └─ IndexedTableAccess(mytable)\n" +
			"             │   │   │       ├─ index: [mytable.i]\n" +
			"             │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │       └─ columns: [i s]\n" +
			"             │   │   └─ TableAlias(a)\n" +
			"             │   │       └─ IndexedTableAccess(mytable)\n" +
			"             │   │           ├─ index: [mytable.i]\n" +
			"             │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           └─ columns: [i s]\n" +
			"             │   └─ TableAlias(d)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ c.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(c)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b, mytable c, mytable d where a.i = b.i AND b.i = c.i AND (c.i = d.s OR c.i = 2)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:4!null, a.s:5!null, b.i:6!null, b.s:7!null, c.i:2!null, c.s:3!null, d.i:0!null, d.s:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:4!null\n" +
			"         │   │   └─ b.i:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.i:6!null\n" +
			"         │       └─ c.i:2!null\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:4!null\n" +
			"         │   │   └─ c.i:2!null\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ Or\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ c.i:2!null\n" +
			"         │   │   │   │   └─ d.s:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ c.i:2!null\n" +
			"         │   │   │       └─ 2 (tinyint)\n" +
			"         │   │   ├─ TableAlias(d)\n" +
			"         │   │   │   └─ Table\n" +
			"         │   │   │       ├─ name: mytable\n" +
			"         │   │   │       └─ columns: [i s]\n" +
			"         │   │   └─ TableAlias(c)\n" +
			"         │   │       └─ Concat\n" +
			"         │   │           ├─ IndexedTableAccess(mytable)\n" +
			"         │   │           │   ├─ index: [mytable.i]\n" +
			"         │   │           │   └─ columns: [i s]\n" +
			"         │   │           └─ IndexedTableAccess(mytable)\n" +
			"         │   │               ├─ index: [mytable.i]\n" +
			"         │   │               └─ columns: [i s]\n" +
			"         │   └─ TableAlias(a)\n" +
			"         │       └─ IndexedTableAccess(mytable)\n" +
			"         │           ├─ index: [mytable.i]\n" +
			"         │           └─ columns: [i s]\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a, mytable b, mytable c, mytable d where a.i = b.i AND b.i = c.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:4!null, a.s:5!null, b.i:6!null, b.s:7!null, c.i:2!null, c.s:3!null, d.i:0!null, d.s:1!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ TableAlias(d)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ a.i:4!null\n" +
			"                 │   │   └─ b.i:6!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ b.i:6!null\n" +
			"                 │       └─ c.i:2!null\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ c.i:2!null\n" +
			"                 │   │   └─ a.i:4!null\n" +
			"                 │   ├─ TableAlias(c)\n" +
			"                 │   │   └─ IndexedTableAccess(mytable)\n" +
			"                 │   │       ├─ index: [mytable.i]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [i s]\n" +
			"                 │   └─ TableAlias(a)\n" +
			"                 │       └─ IndexedTableAccess(mytable)\n" +
			"                 │           ├─ index: [mytable.i]\n" +
			"                 │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │           └─ columns: [i s]\n" +
			"                 └─ TableAlias(b)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where a.i = b.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ b.i:0!null\n" +
			"         │   └─ a.i:2!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ IndexedTableAccess(mytable)\n" +
			"         │       ├─ index: [mytable.i]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where a.i = b.i OR a.i = b.s`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Or\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:2!null\n" +
			"         │   │   └─ b.i:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ a.i:2!null\n" +
			"         │       └─ b.s:1!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ Concat\n" +
			"                 ├─ IndexedTableAccess(mytable)\n" +
			"                 │   ├─ index: [mytable.i]\n" +
			"                 │   └─ columns: [i s]\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where NOT(a.i = b.s OR a.s = b.i)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ NOT\n" +
			"     │   └─ Or\n" +
			"     │       ├─ Eq\n" +
			"     │       │   ├─ a.i:0!null\n" +
			"     │       │   └─ b.s:3!null\n" +
			"     │       └─ Eq\n" +
			"     │           ├─ a.s:1!null\n" +
			"     │           └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where a.i = b.s OR a.s = b.i IS FALSE`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ Or\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ a.i:0!null\n" +
			"     │   │   └─ b.s:3!null\n" +
			"     │   └─ (a.s = b.i) IS FALSE\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where a.i >= b.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ GreaterThanOrEqual\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b where a.i = a.i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ a.i:0!null\n" +
			"                 │   └─ a.i:0!null\n" +
			"                 └─ TableAlias(a)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: mytable\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b CROSS JOIN mytable c CROSS JOIN mytable d where a.i = b.i AND b.i = c.i AND c.i = d.i AND c.i = 2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null, c.i:6!null, c.s:7!null, d.i:4!null, d.s:5!null]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ c.i:6!null\n" +
			"         │   └─ 2 (tinyint)\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ b.i:0!null\n" +
			"             │   │   │   └─ c.i:6!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ c.i:6!null\n" +
			"             │   │       └─ d.i:4!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ a.i:2!null\n" +
			"             │       └─ c.i:6!null\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ a.i:2!null\n" +
			"             │   │   │   └─ d.i:4!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ b.i:0!null\n" +
			"             │   │       └─ d.i:4!null\n" +
			"             │   ├─ MergeJoin\n" +
			"             │   │   ├─ cmp: Eq\n" +
			"             │   │   │   ├─ b.i:0!null\n" +
			"             │   │   │   └─ a.i:2!null\n" +
			"             │   │   ├─ TableAlias(b)\n" +
			"             │   │   │   └─ IndexedTableAccess(mytable)\n" +
			"             │   │   │       ├─ index: [mytable.i]\n" +
			"             │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │       └─ columns: [i s]\n" +
			"             │   │   └─ TableAlias(a)\n" +
			"             │   │       └─ IndexedTableAccess(mytable)\n" +
			"             │   │           ├─ index: [mytable.i]\n" +
			"             │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           └─ columns: [i s]\n" +
			"             │   └─ TableAlias(d)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ c.i:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ TableAlias(c)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b CROSS JOIN mytable c CROSS JOIN mytable d where a.i = b.i AND b.i = c.i AND (c.i = d.s OR c.i = 2)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:4!null, a.s:5!null, b.i:6!null, b.s:7!null, c.i:2!null, c.s:3!null, d.i:0!null, d.s:1!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:4!null\n" +
			"         │   │   └─ b.i:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.i:6!null\n" +
			"         │       └─ c.i:2!null\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:4!null\n" +
			"         │   │   └─ c.i:2!null\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ Or\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ c.i:2!null\n" +
			"         │   │   │   │   └─ d.s:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ c.i:2!null\n" +
			"         │   │   │       └─ 2 (tinyint)\n" +
			"         │   │   ├─ TableAlias(d)\n" +
			"         │   │   │   └─ Table\n" +
			"         │   │   │       ├─ name: mytable\n" +
			"         │   │   │       └─ columns: [i s]\n" +
			"         │   │   └─ TableAlias(c)\n" +
			"         │   │       └─ Concat\n" +
			"         │   │           ├─ IndexedTableAccess(mytable)\n" +
			"         │   │           │   ├─ index: [mytable.i]\n" +
			"         │   │           │   └─ columns: [i s]\n" +
			"         │   │           └─ IndexedTableAccess(mytable)\n" +
			"         │   │               ├─ index: [mytable.i]\n" +
			"         │   │               └─ columns: [i s]\n" +
			"         │   └─ TableAlias(a)\n" +
			"         │       └─ IndexedTableAccess(mytable)\n" +
			"         │           ├─ index: [mytable.i]\n" +
			"         │           └─ columns: [i s]\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a CROSS JOIN mytable b CROSS JOIN mytable c CROSS JOIN mytable d where a.i = b.i AND b.s = c.s`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:6!null, a.s:7!null, b.i:4!null, b.s:5!null, c.i:2!null, c.s:3!null, d.i:0!null, d.s:1!null]\n" +
			"     └─ CrossHashJoin\n" +
			"         ├─ TableAlias(d)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE()\n" +
			"             ├─ right-key: TUPLE()\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ a.i:6!null\n" +
			"                 │   └─ b.i:4!null\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ c.s:3!null\n" +
			"                 │   │   └─ b.s:5!null\n" +
			"                 │   ├─ TableAlias(c)\n" +
			"                 │   │   └─ IndexedTableAccess(mytable)\n" +
			"                 │   │       ├─ index: [mytable.s,mytable.i]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [i s]\n" +
			"                 │   └─ TableAlias(b)\n" +
			"                 │       └─ IndexedTableAccess(mytable)\n" +
			"                 │           ├─ index: [mytable.s,mytable.i]\n" +
			"                 │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │           └─ columns: [i s]\n" +
			"                 └─ TableAlias(a)\n" +
			"                     └─ IndexedTableAccess(mytable)\n" +
			"                         ├─ index: [mytable.i]\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM mytable a inner join mytable b on (a.i = b.s) WHERE a.i BETWEEN 10 AND 20`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.s:3!null\n" +
			"     ├─ Filter\n" +
			"     │   ├─ (a.i:0!null BETWEEN 10 (tinyint) AND 20 (tinyint))\n" +
			"     │   └─ TableAlias(a)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.s,mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT lefttable.i, righttable.s
			FROM (SELECT * FROM mytable) lefttable
			JOIN (SELECT * FROM mytable) righttable
			ON lefttable.i = righttable.i AND righttable.s = lefttable.s
			ORDER BY lefttable.i ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [lefttable.i:0!null, righttable.s:3!null]\n" +
			" └─ Sort(lefttable.i:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [lefttable.i:2!null, lefttable.s:3!null, righttable.i:0!null, righttable.s:1!null]\n" +
			"         └─ HashJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ lefttable.i:2!null\n" +
			"             │   │   └─ righttable.i:0!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ righttable.s:1!null\n" +
			"             │       └─ lefttable.s:3!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: righttable\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: mytable\n" +
			"             │       └─ columns: [i s]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(righttable.i:0!null, righttable.s:1!null)\n" +
			"                 ├─ right-key: TUPLE(lefttable.i:0!null, lefttable.s:1!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: lefttable\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Table\n" +
			"                         ├─ name: mytable\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM mytable RIGHT JOIN (SELECT * FROM othertable) othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: othertable\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: othertable\n" +
			"         │       └─ columns: [s2 i2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(othertable.i2:1!null)\n" +
			"             ├─ right-key: TUPLE(mytable.i:0!null)\n" +
			"             └─ Table\n" +
			"                 ├─ name: mytable\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT s2, i2, i FROM mytable INNER JOIN (SELECT * FROM othertable) othertable ON i2 = i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: othertable\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: othertable\n" +
			"         │       └─ columns: [s2 i2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(othertable.i2:1!null)\n" +
			"             ├─ right-key: TUPLE(mytable.i:0!null)\n" +
			"             └─ Table\n" +
			"                 ├─ name: mytable\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT * FROM othertable) othertable_alias WHERE s2 = 'a'`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: othertable_alias\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ Eq\n" +
			"     │   ├─ othertable.s2:0!null\n" +
			"     │   └─ a (longtext)\n" +
			"     └─ IndexedTableAccess(othertable)\n" +
			"         ├─ index: [othertable.s2]\n" +
			"         ├─ static: [{[a, a]}]\n" +
			"         └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM othertable) othertable_one) othertable_two) othertable_three WHERE s2 = 'a'`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: othertable_three\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: othertable_two\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: othertable_one\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ othertable.s2:0!null\n" +
			"             │   └─ a (longtext)\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.s2]\n" +
			"                 ├─ static: [{[a, a]}]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT othertable.s2, othertable.i2, mytable.i FROM mytable INNER JOIN (SELECT * FROM othertable) othertable ON othertable.i2 = mytable.i WHERE othertable.s2 > 'a'`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [othertable.s2:2!null, othertable.i2:3!null, mytable.i:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ othertable.i2:1!null\n" +
			"         │   └─ mytable.i:2!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: othertable\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ GreaterThan\n" +
			"         │       │   ├─ othertable.s2:0!null\n" +
			"         │       │   └─ a (longtext)\n" +
			"         │       └─ IndexedTableAccess(othertable)\n" +
			"         │           ├─ index: [othertable.s2]\n" +
			"         │           ├─ static: [{(a, ∞)}]\n" +
			"         │           └─ columns: [s2 i2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(othertable.i2:1!null)\n" +
			"             ├─ right-key: TUPLE(mytable.i:0!null)\n" +
			"             └─ Table\n" +
			"                 ├─ name: mytable\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT mytable.i, mytable.s FROM mytable WHERE mytable.i = (SELECT i2 FROM othertable LIMIT 1)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:1!null, mytable.s:2!null]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ mytable.i:1!null\n" +
			"     │   └─ scalarSubq0.i2:0!null\n" +
			"     ├─ OrderedDistinct\n" +
			"     │   └─ Max1Row\n" +
			"     │       └─ SubqueryAlias\n" +
			"     │           ├─ name: scalarSubq0\n" +
			"     │           ├─ outerVisibility: false\n" +
			"     │           ├─ cacheable: true\n" +
			"     │           └─ Limit(1)\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [othertable.i2:1!null]\n" +
			"     │                   └─ Table\n" +
			"     │                       ├─ name: othertable\n" +
			"     │                       └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT mytable.i, mytable.s FROM mytable WHERE mytable.i IN (SELECT i2 FROM othertable)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:1!null, mytable.s:2!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ scalarSubq0.i2:0!null\n" +
			"     │   └─ mytable.i:1!null\n" +
			"     ├─ OrderedDistinct\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [scalarSubq0.i2:1!null]\n" +
			"     │       └─ TableAlias(scalarSubq0)\n" +
			"     │           └─ IndexedTableAccess(othertable)\n" +
			"     │               ├─ index: [othertable.i2]\n" +
			"     │               ├─ static: [{[NULL, ∞)}]\n" +
			"     │               └─ columns: [s2 i2]\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT mytable.i, mytable.s FROM mytable WHERE mytable.i IN (SELECT i2 FROM othertable WHERE mytable.i = othertable.i2)`,
		ExpectedPlan: "Filter\n" +
			" ├─ InSubquery\n" +
			" │   ├─ left: mytable.i:0!null\n" +
			" │   └─ right: Subquery\n" +
			" │       ├─ cacheable: false\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [othertable.i2:3!null]\n" +
			" │           └─ Filter\n" +
			" │               ├─ Eq\n" +
			" │               │   ├─ mytable.i:0!null\n" +
			" │               │   └─ othertable.i2:3!null\n" +
			" │               └─ IndexedTableAccess(othertable)\n" +
			" │                   ├─ index: [othertable.i2]\n" +
			" │                   └─ columns: [s2 i2]\n" +
			" └─ Table\n" +
			"     ├─ name: mytable\n" +
			"     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM mytable mt INNER JOIN othertable ot ON mt.i = ot.i2 AND mt.i > 2`,
		ExpectedPlan: "MergeJoin\n" +
			" ├─ cmp: Eq\n" +
			" │   ├─ mt.i:0!null\n" +
			" │   └─ ot.i2:3!null\n" +
			" ├─ Filter\n" +
			" │   ├─ GreaterThan\n" +
			" │   │   ├─ mt.i:0!null\n" +
			" │   │   └─ 2 (tinyint)\n" +
			" │   └─ TableAlias(mt)\n" +
			" │       └─ IndexedTableAccess(mytable)\n" +
			" │           ├─ index: [mytable.i]\n" +
			" │           ├─ static: [{[NULL, ∞)}]\n" +
			" │           └─ columns: [i s]\n" +
			" └─ TableAlias(ot)\n" +
			"     └─ IndexedTableAccess(othertable)\n" +
			"         ├─ index: [othertable.i2]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(mt, o) */ * FROM mytable mt INNER JOIN one_pk o ON mt.i = o.pk AND mt.s = o.c2`,
		ExpectedPlan: "MergeJoin\n" +
			" ├─ cmp: Eq\n" +
			" │   ├─ mt.i:0!null\n" +
			" │   └─ o.pk:2!null\n" +
			" ├─ sel: Eq\n" +
			" │   ├─ mt.s:1!null\n" +
			" │   └─ o.c2:4\n" +
			" ├─ TableAlias(mt)\n" +
			" │   └─ IndexedTableAccess(mytable)\n" +
			" │       ├─ index: [mytable.i]\n" +
			" │       ├─ static: [{[NULL, ∞)}]\n" +
			" │       └─ columns: [i s]\n" +
			" └─ TableAlias(o)\n" +
			"     └─ IndexedTableAccess(one_pk)\n" +
			"         ├─ index: [one_pk.pk]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT i, i2, s2 FROM mytable RIGHT JOIN othertable ON i = i2 - 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, othertable.i2:3!null, othertable.s2:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mytable.i:2!null, mytable.s:3!null, othertable.s2:0!null, othertable.i2:1!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ mytable.i:2!null\n" +
			"         │   └─ (othertable.i2:1!null - 1 (tinyint))\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: othertable\n" +
			"         │   └─ columns: [s2 i2]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM tabletest, mytable mt INNER JOIN othertable ot ON mt.i = ot.i2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [tabletest.i:0!null, tabletest.s:1!null, mt.i:4!null, mt.s:5!null, ot.s2:2!null, ot.i2:3!null]\n" +
			" └─ CrossHashJoin\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: tabletest\n" +
			"     │   └─ columns: [i s]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE()\n" +
			"         ├─ right-key: TUPLE()\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ ot.i2:3!null\n" +
			"             │   └─ mt.i:4!null\n" +
			"             ├─ TableAlias(ot)\n" +
			"             │   └─ IndexedTableAccess(othertable)\n" +
			"             │       ├─ index: [othertable.i2]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [s2 i2]\n" +
			"             └─ TableAlias(mt)\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT t1.timestamp FROM reservedWordsTable t1 JOIN reservedWordsTable t2 ON t1.TIMESTAMP = t2.tImEstamp`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.timestamp:0!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ t1.timestamp:0!null\n" +
			"     │   └─ t2.timestamp:4!null\n" +
			"     ├─ TableAlias(t1)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: reservedWordsTable\n" +
			"     │       └─ columns: [timestamp and or select]\n" +
			"     └─ TableAlias(t2)\n" +
			"         └─ Table\n" +
			"             ├─ name: reservedWordsTable\n" +
			"             └─ columns: [timestamp and or select]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ two_pk.pk1:0!null\n" +
			"         │   └─ one_pk.pk:7!null\n" +
			"         ├─ sel: Eq\n" +
			"         │   ├─ one_pk.pk:7!null\n" +
			"         │   └─ two_pk.pk2:1!null\n" +
			"         ├─ IndexedTableAccess(two_pk)\n" +
			"         │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2 OR one_pk.c2 = two_pk.c3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ InnerJoin\n" +
			"     ├─ Or\n" +
			"     │   ├─ AND\n" +
			"     │   │   ├─ Eq\n" +
			"     │   │   │   ├─ one_pk.pk:0!null\n" +
			"     │   │   │   └─ two_pk.pk1:6!null\n" +
			"     │   │   └─ Eq\n" +
			"     │   │       ├─ one_pk.pk:0!null\n" +
			"     │   │       └─ two_pk.pk2:7!null\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ one_pk.c2:2\n" +
			"     │       └─ two_pk.c3:10!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: one_pk\n" +
			"     │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"     └─ Table\n" +
			"         ├─ name: two_pk\n" +
			"         └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk opk JOIN two_pk tpk ON opk.pk=tpk.pk1 AND opk.pk=tpk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.pk:0!null, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ tpk.pk1:0!null\n" +
			"         │   └─ opk.pk:7!null\n" +
			"         ├─ sel: Eq\n" +
			"         │   ├─ opk.pk:7!null\n" +
			"         │   └─ tpk.pk2:1!null\n" +
			"         ├─ TableAlias(tpk)\n" +
			"         │   └─ IndexedTableAccess(two_pk)\n" +
			"         │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(opk)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ two_pk.pk1:0!null\n" +
			"         │   └─ one_pk.pk:7!null\n" +
			"         ├─ sel: Eq\n" +
			"         │   ├─ one_pk.pk:7!null\n" +
			"         │   └─ two_pk.pk2:1!null\n" +
			"         ├─ IndexedTableAccess(two_pk)\n" +
			"         │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON one_pk.pk <=> two_pk.pk1 AND one_pk.pk = two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ (one_pk.pk:0!null <=> two_pk.pk1:6!null)\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ one_pk.pk:0!null\n" +
			"         │       └─ two_pk.pk2:7!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: one_pk\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(two_pk)\n" +
			"             ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON one_pk.pk = two_pk.pk1 AND one_pk.pk <=> two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ two_pk.pk1:6!null\n" +
			"         ├─ sel: (one_pk.pk:0!null <=> two_pk.pk2:7!null)\n" +
			"         ├─ IndexedTableAccess(one_pk)\n" +
			"         │   ├─ index: [one_pk.pk]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(two_pk)\n" +
			"             ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON one_pk.pk <=> two_pk.pk1 AND one_pk.pk <=> two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ (one_pk.pk:0!null <=> two_pk.pk1:6!null)\n" +
			"         │   └─ (one_pk.pk:0!null <=> two_pk.pk2:7!null)\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: one_pk\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(two_pk)\n" +
			"             ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk RIGHT JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ two_pk.pk1:0!null\n" +
			"         │   └─ one_pk.pk:7!null\n" +
			"         ├─ sel: Eq\n" +
			"         │   ├─ one_pk.pk:7!null\n" +
			"         │   └─ two_pk.pk2:1!null\n" +
			"         ├─ IndexedTableAccess(two_pk)\n" +
			"         │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT * FROM othertable) othertable_alias WHERE othertable_alias.i2 = 1`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: othertable_alias\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ IndexedTableAccess(othertable)\n" +
			"     ├─ index: [othertable.i2]\n" +
			"     ├─ static: [{[1, 1]}]\n" +
			"     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT * FROM othertable WHERE i2 = 1) othertable_alias WHERE othertable_alias.i2 = 1`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: othertable_alias\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ IndexedTableAccess(othertable)\n" +
			"     ├─ index: [othertable.i2]\n" +
			"     ├─ static: [{[1, 1]}]\n" +
			"     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table ORDER BY date_col ASC`,
		ExpectedPlan: "Sort(datetime_table.date_col:1 ASC nullsFirst)\n" +
			" └─ Table\n" +
			"     ├─ name: datetime_table\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table ORDER BY date_col ASC LIMIT 100`,
		ExpectedPlan: "Limit(100)\n" +
			" └─ TopN(Limit: [100 (tinyint)]; datetime_table.date_col:1 ASC nullsFirst)\n" +
			"     └─ Table\n" +
			"         ├─ name: datetime_table\n" +
			"         └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table ORDER BY date_col ASC LIMIT 100 OFFSET 100`,
		ExpectedPlan: "Limit(100)\n" +
			" └─ Offset(100)\n" +
			"     └─ TopN(Limit: [(100 + 100)]; datetime_table.date_col ASC)\n" +
			"         └─ Table\n" +
			"             ├─ name: datetime_table\n" +
			"             └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where date_col = '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ datetime_table.date_col:1\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.date_col]\n" +
			"     ├─ static: [{[2020-01-01, 2020-01-01]}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where date_col > '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ GreaterThan\n" +
			" │   ├─ datetime_table.date_col:1\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.date_col]\n" +
			"     ├─ static: [{(2020-01-01, ∞)}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where datetime_col = '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ datetime_table.datetime_col:2\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.datetime_col]\n" +
			"     ├─ static: [{[2020-01-01, 2020-01-01]}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where datetime_col > '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ GreaterThan\n" +
			" │   ├─ datetime_table.datetime_col:2\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.datetime_col]\n" +
			"     ├─ static: [{(2020-01-01, ∞)}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where timestamp_col = '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ datetime_table.timestamp_col:3\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.timestamp_col]\n" +
			"     ├─ static: [{[2020-01-01, 2020-01-01]}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table where timestamp_col > '2020-01-01'`,
		ExpectedPlan: "Filter\n" +
			" ├─ GreaterThan\n" +
			" │   ├─ datetime_table.timestamp_col:3\n" +
			" │   └─ 2020-01-01 (longtext)\n" +
			" └─ IndexedTableAccess(datetime_table)\n" +
			"     ├─ index: [datetime_table.timestamp_col]\n" +
			"     ├─ static: [{(2020-01-01, ∞)}]\n" +
			"     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table dt1 join datetime_table dt2 on dt1.timestamp_col = dt2.timestamp_col`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ dt2.timestamp_col:3\n" +
			"     │   └─ dt1.timestamp_col:8\n" +
			"     ├─ TableAlias(dt2)\n" +
			"     │   └─ IndexedTableAccess(datetime_table)\n" +
			"     │       ├─ index: [datetime_table.timestamp_col]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"     └─ TableAlias(dt1)\n" +
			"         └─ IndexedTableAccess(datetime_table)\n" +
			"             ├─ index: [datetime_table.timestamp_col]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table dt1 join datetime_table dt2 on dt1.date_col = dt2.timestamp_col`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ dt2.timestamp_col:3\n" +
			"     │   └─ dt1.date_col:6\n" +
			"     ├─ TableAlias(dt2)\n" +
			"     │   └─ IndexedTableAccess(datetime_table)\n" +
			"     │       ├─ index: [datetime_table.timestamp_col]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"     └─ TableAlias(dt1)\n" +
			"         └─ IndexedTableAccess(datetime_table)\n" +
			"             ├─ index: [datetime_table.date_col]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT * FROM datetime_table dt1 join datetime_table dt2 on dt1.datetime_col = dt2.timestamp_col`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ dt2.timestamp_col:3\n" +
			"     │   └─ dt1.datetime_col:7\n" +
			"     ├─ TableAlias(dt2)\n" +
			"     │   └─ IndexedTableAccess(datetime_table)\n" +
			"     │       ├─ index: [datetime_table.timestamp_col]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"     └─ TableAlias(dt1)\n" +
			"         └─ IndexedTableAccess(datetime_table)\n" +
			"             ├─ index: [datetime_table.datetime_col]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT dt1.i FROM datetime_table dt1
			join datetime_table dt2 on dt1.date_col = date(date_sub(dt2.timestamp_col, interval 2 day))
			order by 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [dt1.i:0!null]\n" +
			" └─ Sort(dt1.i:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ dt1.date_col:6\n" +
			"             │   └─ DATE(date_sub(dt2.timestamp_col,INTERVAL 2 DAY))\n" +
			"             ├─ TableAlias(dt2)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: datetime_table\n" +
			"             │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"             └─ TableAlias(dt1)\n" +
			"                 └─ IndexedTableAccess(datetime_table)\n" +
			"                     ├─ index: [datetime_table.date_col]\n" +
			"                     └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT dt1.i FROM datetime_table dt1
			join datetime_table dt2 on dt1.date_col = date(date_sub(dt2.timestamp_col, interval 2 day))
			order by 1 limit 3 offset 0`,
		ExpectedPlan: "Limit(3)\n" +
			" └─ Project\n" +
			"     ├─ columns: [dt1.i:0!null]\n" +
			"     └─ Sort(dt1.i:0!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ dt1.date_col:6\n" +
			"                 │   └─ DATE(date_sub(dt2.timestamp_col,INTERVAL 2 DAY))\n" +
			"                 ├─ TableAlias(dt2)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: datetime_table\n" +
			"                 │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"                 └─ TableAlias(dt1)\n" +
			"                     └─ IndexedTableAccess(datetime_table)\n" +
			"                         ├─ index: [datetime_table.date_col]\n" +
			"                         └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT dt1.i FROM datetime_table dt1
			join datetime_table dt2 on dt1.date_col = date(date_sub(dt2.timestamp_col, interval 2 day))
			order by 1 limit 3`,
		ExpectedPlan: "Limit(3)\n" +
			" └─ Project\n" +
			"     ├─ columns: [dt1.i:0!null]\n" +
			"     └─ Sort(dt1.i:0!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [dt1.i:5!null, dt1.date_col:6, dt1.datetime_col:7, dt1.timestamp_col:8, dt1.time_col:9, dt2.i:0!null, dt2.date_col:1, dt2.datetime_col:2, dt2.timestamp_col:3, dt2.time_col:4]\n" +
			"             └─ LookupJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ dt1.date_col:6\n" +
			"                 │   └─ DATE(date_sub(dt2.timestamp_col,INTERVAL 2 DAY))\n" +
			"                 ├─ TableAlias(dt2)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: datetime_table\n" +
			"                 │       └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"                 └─ TableAlias(dt1)\n" +
			"                     └─ IndexedTableAccess(datetime_table)\n" +
			"                         ├─ index: [datetime_table.date_col]\n" +
			"                         └─ columns: [i date_col datetime_col timestamp_col time_col]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk
						JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, tpk.pk1:13!null, tpk.pk2:14!null, tpk.c1:15!null, tpk.c2:16!null, tpk.c3:17!null, tpk.c4:18!null, tpk.c5:19!null, tpk2.pk1:0!null, tpk2.pk2:1!null, tpk2.c1:2!null, tpk2.c2:3!null, tpk2.c3:4!null, tpk2.c4:5!null, tpk2.c5:6!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   │   │   │   │   └─ tpk.pk1:13!null\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ one_pk.pk:7!null\n" +
			"         │   │   │   │   │       └─ tpk.pk2:14!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ tpk2.pk1:0!null\n" +
			"         │   │   │   │       └─ tpk.pk2:14!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ tpk2.pk2:1!null\n" +
			"         │   │   │       └─ tpk.pk1:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ tpk.pk1:13!null\n" +
			"         │   │       └─ tpk2.pk1:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk.pk2:14!null\n" +
			"         │       └─ tpk2.pk2:1!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ tpk2.pk1:0!null\n" +
			"         │   │   └─ one_pk.pk:7!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   └─ tpk2.pk2:1!null\n" +
			"         │   ├─ TableAlias(tpk2)\n" +
			"         │   │   └─ IndexedTableAccess(two_pk)\n" +
			"         │   │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT /* JOIN_ORDER(tpk, one_pk, tpk2) */
						pk FROM one_pk
						JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, tpk.pk1:13!null, tpk.pk2:14!null, tpk.c1:15!null, tpk.c2:16!null, tpk.c3:17!null, tpk.c4:18!null, tpk.c5:19!null, tpk2.pk1:0!null, tpk2.pk2:1!null, tpk2.c1:2!null, tpk2.c2:3!null, tpk2.c3:4!null, tpk2.c4:5!null, tpk2.c5:6!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   │   │   │   │   └─ tpk.pk1:13!null\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ one_pk.pk:7!null\n" +
			"         │   │   │   │   │       └─ tpk.pk2:14!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ tpk2.pk1:0!null\n" +
			"         │   │   │   │       └─ tpk.pk2:14!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ tpk2.pk2:1!null\n" +
			"         │   │   │       └─ tpk.pk1:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ tpk.pk1:13!null\n" +
			"         │   │       └─ tpk2.pk1:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk.pk2:14!null\n" +
			"         │       └─ tpk2.pk2:1!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ tpk2.pk1:0!null\n" +
			"         │   │   └─ one_pk.pk:7!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   └─ tpk2.pk2:1!null\n" +
			"         │   ├─ TableAlias(tpk2)\n" +
			"         │   │   └─ IndexedTableAccess(two_pk)\n" +
			"         │   │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT /* JOIN_ORDER(tpk, one_pk, tpk2) */
						pk FROM one_pk
						JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						LEFT JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null, tpk2.pk1:13!null, tpk2.pk2:14!null, tpk2.c1:15!null, tpk2.c2:16!null, tpk2.c3:17!null, tpk2.c4:18!null, tpk2.c5:19!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tpk2.pk1:13!null\n" +
			"         │   │   └─ tpk.pk2:1!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk2.pk2:14!null\n" +
			"         │       └─ tpk.pk1:0!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ tpk.pk1:0!null\n" +
			"         │   │   └─ one_pk.pk:7!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   └─ tpk.pk2:1!null\n" +
			"         │   ├─ TableAlias(tpk)\n" +
			"         │   │   └─ IndexedTableAccess(two_pk)\n" +
			"         │   │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk2)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,tpk.pk1,tpk2.pk1,tpk.pk2,tpk2.pk2 FROM one_pk
						JOIN two_pk tpk ON pk=tpk.pk1 AND pk-1=tpk.pk2
						JOIN two_pk tpk2 ON pk-1=TPK2.pk1 AND pk=tpk2.pk2
						ORDER BY 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, tpk.pk1:6!null, tpk2.pk1:13!null, tpk.pk2:7!null, tpk2.pk2:14!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null, tpk2.pk1:13!null, tpk2.pk2:14!null, tpk2.c1:15!null, tpk2.c2:16!null, tpk2.c3:17!null, tpk2.c4:18!null, tpk2.c5:19!null]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ (one_pk.pk:7!null - 1 (tinyint))\n" +
			"             │   │   └─ tpk2.pk1:13!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ one_pk.pk:7!null\n" +
			"             │       └─ tpk2.pk2:14!null\n" +
			"             ├─ MergeJoin\n" +
			"             │   ├─ cmp: Eq\n" +
			"             │   │   ├─ tpk.pk1:0!null\n" +
			"             │   │   └─ one_pk.pk:7!null\n" +
			"             │   ├─ sel: Eq\n" +
			"             │   │   ├─ (one_pk.pk:7!null - 1 (tinyint))\n" +
			"             │   │   └─ tpk.pk2:1!null\n" +
			"             │   ├─ TableAlias(tpk)\n" +
			"             │   │   └─ IndexedTableAccess(two_pk)\n" +
			"             │   │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             │   └─ IndexedTableAccess(one_pk)\n" +
			"             │       ├─ index: [one_pk.pk]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(tpk2)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk
						LEFT JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						LEFT JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, tpk.pk1:6!null, tpk.pk2:7!null, tpk.c1:8!null, tpk.c2:9!null, tpk.c3:10!null, tpk.c4:11!null, tpk.c5:12!null, tpk2.pk1:13!null, tpk2.pk2:14!null, tpk2.c1:15!null, tpk2.c2:16!null, tpk2.c3:17!null, tpk2.c4:18!null, tpk2.c5:19!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tpk2.pk1:13!null\n" +
			"         │   │   └─ tpk.pk2:7!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk2.pk2:14!null\n" +
			"         │       └─ tpk.pk1:6!null\n" +
			"         ├─ LeftOuterMergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ one_pk.pk:0!null\n" +
			"         │   │   └─ tpk.pk1:6!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:0!null\n" +
			"         │   │   └─ tpk.pk2:7!null\n" +
			"         │   ├─ IndexedTableAccess(one_pk)\n" +
			"         │   │   ├─ index: [one_pk.pk]\n" +
			"         │   │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │   └─ TableAlias(tpk)\n" +
			"         │       └─ IndexedTableAccess(two_pk)\n" +
			"         │           ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk2)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk
						LEFT JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, tpk.pk1:6!null, tpk.pk2:7!null, tpk.c1:8!null, tpk.c2:9!null, tpk.c3:10!null, tpk.c4:11!null, tpk.c5:12!null, tpk2.pk1:13!null, tpk2.pk2:14!null, tpk2.c1:15!null, tpk2.c2:16!null, tpk2.c3:17!null, tpk2.c4:18!null, tpk2.c5:19!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tpk2.pk1:13!null\n" +
			"         │   │   └─ tpk.pk2:7!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk2.pk2:14!null\n" +
			"         │       └─ tpk.pk1:6!null\n" +
			"         ├─ LeftOuterMergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ one_pk.pk:0!null\n" +
			"         │   │   └─ tpk.pk1:6!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:0!null\n" +
			"         │   │   └─ tpk.pk2:7!null\n" +
			"         │   ├─ IndexedTableAccess(one_pk)\n" +
			"         │   │   ├─ index: [one_pk.pk]\n" +
			"         │   │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │   └─ TableAlias(tpk)\n" +
			"         │       └─ IndexedTableAccess(two_pk)\n" +
			"         │           ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk2)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk
						JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						LEFT JOIN two_pk tpk2 ON tpk2.pk1=TPK.pk2 AND TPK2.pk2=tpk.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null, tpk2.pk1:13!null, tpk2.pk2:14!null, tpk2.c1:15!null, tpk2.c2:16!null, tpk2.c3:17!null, tpk2.c4:18!null, tpk2.c5:19!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tpk2.pk1:13!null\n" +
			"         │   │   └─ tpk.pk2:1!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk2.pk2:14!null\n" +
			"         │       └─ tpk.pk1:0!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ tpk.pk1:0!null\n" +
			"         │   │   └─ one_pk.pk:7!null\n" +
			"         │   ├─ sel: Eq\n" +
			"         │   │   ├─ one_pk.pk:7!null\n" +
			"         │   │   └─ tpk.pk2:1!null\n" +
			"         │   ├─ TableAlias(tpk)\n" +
			"         │   │   └─ IndexedTableAccess(two_pk)\n" +
			"         │   │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(tpk2)\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk FROM one_pk
						RIGHT JOIN two_pk tpk ON one_pk.pk=tpk.pk1 AND one_pk.pk=tpk.pk2
						RIGHT JOIN two_pk tpk2 ON tpk.pk1=TPk2.pk2 AND tpk.pk2=TPK2.pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:14!null, one_pk.c1:15, one_pk.c2:16, one_pk.c3:17, one_pk.c4:18, one_pk.c5:19, tpk.pk1:7!null, tpk.pk2:8!null, tpk.c1:9!null, tpk.c2:10!null, tpk.c3:11!null, tpk.c4:12!null, tpk.c5:13!null, tpk2.pk1:0!null, tpk2.pk2:1!null, tpk2.c1:2!null, tpk2.c2:3!null, tpk2.c3:4!null, tpk2.c4:5!null, tpk2.c5:6!null]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tpk.pk1:7!null\n" +
			"         │   │   └─ tpk2.pk2:1!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ tpk.pk2:8!null\n" +
			"         │       └─ tpk2.pk1:0!null\n" +
			"         ├─ TableAlias(tpk2)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: two_pk\n" +
			"         │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(tpk2.pk2:1!null, tpk2.pk1:0!null)\n" +
			"             ├─ right-key: TUPLE(tpk.pk1:0!null, tpk.pk2:1!null)\n" +
			"             └─ LeftOuterMergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ tpk.pk1:7!null\n" +
			"                 │   └─ one_pk.pk:14!null\n" +
			"                 ├─ sel: Eq\n" +
			"                 │   ├─ one_pk.pk:14!null\n" +
			"                 │   └─ tpk.pk2:8!null\n" +
			"                 ├─ TableAlias(tpk)\n" +
			"                 │   └─ IndexedTableAccess(two_pk)\n" +
			"                 │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT i,pk1,pk2 FROM mytable JOIN two_pk ON i-1=pk1 AND i-2=pk2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:0!null, two_pk.pk1:2!null, two_pk.pk2:3!null]\n" +
			" └─ LookupJoin\n" +
			"     ├─ AND\n" +
			"     │   ├─ Eq\n" +
			"     │   │   ├─ (mytable.i:0!null - 1 (tinyint))\n" +
			"     │   │   └─ two_pk.pk1:2!null\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ (mytable.i:0!null - 2 (tinyint))\n" +
			"     │       └─ two_pk.pk2:3!null\n" +
			"     ├─ Table\n" +
			"     │   ├─ name: mytable\n" +
			"     │   └─ columns: [i s]\n" +
			"     └─ IndexedTableAccess(two_pk)\n" +
			"         ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON pk=pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ two_pk.pk1:6!null\n" +
			"         ├─ IndexedTableAccess(one_pk)\n" +
			"         │   ├─ index: [one_pk.pk]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(two_pk)\n" +
			"             ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ niltable.i:6!null\n" +
			"         ├─ IndexedTableAccess(one_pk)\n" +
			"         │   ├─ index: [one_pk.pk]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(niltable)\n" +
			"             ├─ index: [niltable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ niltable.i:0!null\n" +
			"         │   └─ one_pk.pk:4!null\n" +
			"         ├─ IndexedTableAccess(niltable)\n" +
			"         │   ├─ index: [niltable.i]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [i i2 b f]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,nt.i,nt2.i FROM one_pk
						RIGHT JOIN niltable nt ON pk=nt.i
						RIGHT JOIN niltable nt2 ON pk=nt2.i + 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, nt.i:6!null, nt2.i:10!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:8!null, one_pk.c1:9, one_pk.c2:10, one_pk.c3:11, one_pk.c4:12, one_pk.c5:13, nt.i:4!null, nt.i2:5, nt.b:6, nt.f:7, nt2.i:0!null, nt2.i2:1, nt2.b:2, nt2.f:3]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ one_pk.pk:8!null\n" +
			"         │   └─ (nt2.i:0!null + 1 (tinyint))\n" +
			"         ├─ TableAlias(nt2)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: niltable\n" +
			"         │       └─ columns: [i i2 b f]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE((nt2.i:0!null + 1 (tinyint)))\n" +
			"             ├─ right-key: TUPLE(one_pk.pk:4!null)\n" +
			"             └─ LeftOuterMergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ nt.i:4!null\n" +
			"                 │   └─ one_pk.pk:8!null\n" +
			"                 ├─ TableAlias(nt)\n" +
			"                 │   └─ IndexedTableAccess(niltable)\n" +
			"                 │       ├─ index: [niltable.i]\n" +
			"                 │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │       └─ columns: [i i2 b f]\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i AND f IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ niltable.i:6!null\n" +
			"         ├─ sel: NOT\n" +
			"         │   └─ niltable.f:9 IS NULL\n" +
			"         ├─ IndexedTableAccess(one_pk)\n" +
			"         │   ├─ index: [one_pk.pk]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(niltable)\n" +
			"             ├─ index: [niltable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i and pk > 0`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ niltable.i:0!null\n" +
			"         │   └─ one_pk.pk:4!null\n" +
			"         ├─ sel: GreaterThan\n" +
			"         │   ├─ one_pk.pk:4!null\n" +
			"         │   └─ 0 (tinyint)\n" +
			"         ├─ IndexedTableAccess(niltable)\n" +
			"         │   ├─ index: [niltable.i]\n" +
			"         │   ├─ static: [{[NULL, ∞)}]\n" +
			"         │   └─ columns: [i i2 b f]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE f IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ niltable.f:9 IS NULL\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ niltable.i:6!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE i2 > 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ niltable.i2:7\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ niltable.i:6!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE i > 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ niltable.i:6!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ niltable.i:6!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE c1 > 10`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ niltable.i:6!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ one_pk.c1:1\n" +
			"         │   │   └─ 10 (tinyint)\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(niltable)\n" +
			"             ├─ index: [niltable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i WHERE f IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ niltable.i:0!null\n" +
			"         │   └─ one_pk.pk:4!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ NOT\n" +
			"         │   │   └─ niltable.f:3 IS NULL\n" +
			"         │   └─ IndexedTableAccess(niltable)\n" +
			"         │       ├─ index: [niltable.i]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [i i2 b f]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE pk > 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"     └─ LeftOuterMergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ one_pk.pk:0!null\n" +
			"         │   └─ niltable.i:6!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ one_pk.pk:0!null\n" +
			"         │   │   └─ 1 (tinyint)\n" +
			"         │   └─ IndexedTableAccess(one_pk)\n" +
			"         │       ├─ index: [one_pk.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(niltable)\n" +
			"             ├─ index: [niltable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT l.i, r.i2 FROM niltable l INNER JOIN niltable r ON l.i2 <=> r.i2 ORDER BY 1 ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [l.i:0!null, r.i2:5]\n" +
			" └─ Sort(l.i:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [l.i:4!null, l.i2:5, l.b:6, l.f:7, r.i:0!null, r.i2:1, r.b:2, r.f:3]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ (l.i2:5 <=> r.i2:1)\n" +
			"             ├─ TableAlias(r)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: niltable\n" +
			"             │       └─ columns: [i i2 b f]\n" +
			"             └─ TableAlias(l)\n" +
			"                 └─ IndexedTableAccess(niltable)\n" +
			"                     ├─ index: [niltable.i2]\n" +
			"                     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i WHERE pk > 0`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ one_pk.pk:4!null\n" +
			"         │   └─ 0 (tinyint)\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ niltable.i:0!null\n" +
			"             │   └─ one_pk.pk:4!null\n" +
			"             ├─ IndexedTableAccess(niltable)\n" +
			"             │   ├─ index: [niltable.i]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [i i2 b f]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON pk=pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ two_pk.pk1:0!null\n" +
			"         │   └─ one_pk.pk:7!null\n" +
			"         ├─ IndexedTableAccess(two_pk)\n" +
			"         │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT /*+ JOIN_ORDER(two_pk, one_pk) */ pk,pk1,pk2 FROM one_pk JOIN two_pk ON pk=pk1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ two_pk.pk1:0!null\n" +
			"         │   └─ one_pk.pk:7!null\n" +
			"         ├─ IndexedTableAccess(two_pk)\n" +
			"         │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ IndexedTableAccess(one_pk)\n" +
			"             ├─ index: [one_pk.pk]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a JOIN two_pk b ON a.pk1=b.pk1 AND a.pk2=b.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ b.pk1:0!null\n" +
			"             │   └─ a.pk1:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ a.pk2:8!null\n" +
			"             │   └─ b.pk2:1!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a JOIN two_pk b ON a.pk1=b.pk2 AND a.pk2=b.pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ a.pk1:7!null\n" +
			"             │   │   └─ b.pk2:1!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ a.pk2:8!null\n" +
			"             │       └─ b.pk1:0!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: two_pk\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a JOIN two_pk b ON b.pk1=a.pk1 AND a.pk2=b.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ b.pk1:0!null\n" +
			"             │   └─ a.pk1:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ a.pk2:8!null\n" +
			"             │   └─ b.pk2:1!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a JOIN two_pk b ON a.pk1+1=b.pk1 AND a.pk2+1=b.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ b.pk1:0!null\n" +
			"             │   └─ (a.pk1:7!null + 1 (tinyint))\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ (a.pk2:8!null + 1 (tinyint))\n" +
			"             │   └─ b.pk2:1!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a, two_pk b WHERE a.pk1=b.pk1 AND a.pk2=b.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ b.pk1:0!null\n" +
			"             │   └─ a.pk1:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ a.pk2:8!null\n" +
			"             │   └─ b.pk2:1!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.pk1,a.pk2,b.pk1,b.pk2 FROM two_pk a, two_pk b WHERE a.pk1=b.pk2 AND a.pk2=b.pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk1:0!null, a.pk2:1!null, b.pk1:7!null, b.pk2:8!null]\n" +
			" └─ Sort(a.pk1:0!null ASC nullsFirst, a.pk2:1!null ASC nullsFirst, b.pk1:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.pk1:7!null, a.pk2:8!null, a.c1:9!null, a.c2:10!null, a.c3:11!null, a.c4:12!null, a.c5:13!null, b.pk1:0!null, b.pk2:1!null, b.c1:2!null, b.c2:3!null, b.c3:4!null, b.c4:5!null, b.c5:6!null]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ a.pk1:7!null\n" +
			"             │   │   └─ b.pk2:1!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ a.pk2:8!null\n" +
			"             │       └─ b.pk1:0!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: two_pk\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(two_pk)\n" +
			"                     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT one_pk.c5,pk1,pk2 FROM one_pk JOIN two_pk ON pk=pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.c5:5 ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ two_pk.pk1:0!null\n" +
			"             │   └─ one_pk.pk:7!null\n" +
			"             ├─ IndexedTableAccess(two_pk)\n" +
			"             │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT opk.c5,pk1,pk2 FROM one_pk opk JOIN two_pk tpk ON opk.pk=tpk.pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.c5:5, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Sort(opk.c5:5 ASC nullsFirst, tpk.pk1:6!null ASC nullsFirst, tpk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ tpk.pk1:0!null\n" +
			"             │   └─ opk.pk:7!null\n" +
			"             ├─ TableAlias(tpk)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(opk)\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT opk.c5,pk1,pk2 FROM one_pk opk JOIN two_pk tpk ON pk=pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.c5:5, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Sort(opk.c5:5 ASC nullsFirst, tpk.pk1:6!null ASC nullsFirst, tpk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ tpk.pk1:0!null\n" +
			"             │   └─ opk.pk:7!null\n" +
			"             ├─ TableAlias(tpk)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(opk)\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT opk.c5,pk1,pk2 FROM one_pk opk, two_pk tpk WHERE pk=pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.c5:5, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Sort(opk.c5:5 ASC nullsFirst, tpk.pk1:6!null ASC nullsFirst, tpk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ tpk.pk1:0!null\n" +
			"             │   └─ opk.pk:7!null\n" +
			"             ├─ TableAlias(tpk)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(opk)\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT one_pk.c5,pk1,pk2 FROM one_pk,two_pk WHERE pk=pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.c5:5 ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ two_pk.pk1:0!null\n" +
			"             │   └─ one_pk.pk:7!null\n" +
			"             ├─ IndexedTableAccess(two_pk)\n" +
			"             │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM niltable WHERE i2 = NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ niltable.i2:1\n" +
			" │   └─ NULL (null)\n" +
			" └─ IndexedTableAccess(niltable)\n" +
			"     ├─ index: [niltable.i2]\n" +
			"     ├─ static: [{(∞, ∞)}]\n" +
			"     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT * FROM niltable WHERE i2 <> NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ Eq\n" +
			" │       ├─ niltable.i2:1\n" +
			" │       └─ NULL (null)\n" +
			" └─ IndexedTableAccess(niltable)\n" +
			"     ├─ index: [niltable.i2]\n" +
			"     ├─ static: [{(∞, ∞)}]\n" +
			"     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT * FROM niltable WHERE i2 > NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ GreaterThan\n" +
			" │   ├─ niltable.i2:1\n" +
			" │   └─ NULL (null)\n" +
			" └─ IndexedTableAccess(niltable)\n" +
			"     ├─ index: [niltable.i2]\n" +
			"     ├─ static: [{(∞, ∞)}]\n" +
			"     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT * FROM niltable WHERE i2 <=> NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ (niltable.i2:1 <=> NULL (null))\n" +
			" └─ IndexedTableAccess(niltable)\n" +
			"     ├─ index: [niltable.i2]\n" +
			"     ├─ static: [{[NULL, NULL]}]\n" +
			"     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i ORDER BY 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ niltable.i:6!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE f IS NOT NULL ORDER BY 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"         └─ Filter\n" +
			"             ├─ NOT\n" +
			"             │   └─ niltable.f:9 IS NULL\n" +
			"             └─ LeftOuterMergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ one_pk.pk:0!null\n" +
			"                 │   └─ niltable.i:6!null\n" +
			"                 ├─ IndexedTableAccess(one_pk)\n" +
			"                 │   ├─ index: [one_pk.pk]\n" +
			"                 │   ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"                 └─ IndexedTableAccess(niltable)\n" +
			"                     ├─ index: [niltable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk LEFT JOIN niltable ON pk=i WHERE pk > 1 ORDER BY 1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, niltable.i:6!null, niltable.i2:7, niltable.b:8, niltable.f:9]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ niltable.i:6!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ GreaterThan\n" +
			"             │   │   ├─ one_pk.pk:0!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ IndexedTableAccess(one_pk)\n" +
			"             │       ├─ index: [one_pk.pk]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i ORDER BY 2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(niltable.i:6!null ASC nullsFirst, niltable.f:9 ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ niltable.i:0!null\n" +
			"             │   └─ one_pk.pk:4!null\n" +
			"             ├─ IndexedTableAccess(niltable)\n" +
			"             │   ├─ index: [niltable.i]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [i i2 b f]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i WHERE f IS NOT NULL ORDER BY 2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(niltable.i:6!null ASC nullsFirst, niltable.f:9 ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ niltable.i:0!null\n" +
			"             │   └─ one_pk.pk:4!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ niltable.f:3 IS NULL\n" +
			"             │   └─ IndexedTableAccess(niltable)\n" +
			"             │       ├─ index: [niltable.i]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [i i2 b f]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i WHERE pk > 0 ORDER BY 2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(niltable.i:6!null ASC nullsFirst, niltable.f:9 ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"         └─ Filter\n" +
			"             ├─ GreaterThan\n" +
			"             │   ├─ one_pk.pk:4!null\n" +
			"             │   └─ 0 (tinyint)\n" +
			"             └─ LeftOuterMergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ niltable.i:0!null\n" +
			"                 │   └─ one_pk.pk:4!null\n" +
			"                 ├─ IndexedTableAccess(niltable)\n" +
			"                 │   ├─ index: [niltable.i]\n" +
			"                 │   ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   └─ columns: [i i2 b f]\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i and pk > 0 ORDER BY 2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, niltable.i:6!null, niltable.f:9]\n" +
			" └─ Sort(niltable.i:6!null ASC nullsFirst, niltable.f:9 ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:4!null, one_pk.c1:5, one_pk.c2:6, one_pk.c3:7, one_pk.c4:8, one_pk.c5:9, niltable.i:0!null, niltable.i2:1, niltable.b:2, niltable.f:3]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ niltable.i:0!null\n" +
			"             │   └─ one_pk.pk:4!null\n" +
			"             ├─ sel: GreaterThan\n" +
			"             │   ├─ one_pk.pk:4!null\n" +
			"             │   └─ 0 (tinyint)\n" +
			"             ├─ IndexedTableAccess(niltable)\n" +
			"             │   ├─ index: [niltable.i]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [i i2 b f]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ two_pk.pk1:0!null\n" +
			"             │   └─ one_pk.pk:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ one_pk.pk:7!null\n" +
			"             │   └─ two_pk.pk2:1!null\n" +
			"             ├─ IndexedTableAccess(two_pk)\n" +
			"             │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ON pk1-pk>0 AND pk2<1`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Filter\n" +
			"     ├─ LessThan\n" +
			"     │   ├─ two_pk.pk2:7!null\n" +
			"     │   └─ 1 (tinyint)\n" +
			"     └─ InnerJoin\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ (two_pk.pk1:6!null - one_pk.pk:0!null)\n" +
			"         │   └─ 0 (tinyint)\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: one_pk\n" +
			"         │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ Filter\n" +
			"             ├─ LessThan\n" +
			"             │   ├─ two_pk.pk2:1!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ Table\n" +
			"                 ├─ name: two_pk\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk JOIN two_pk ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ CrossHashJoin\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: two_pk\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE()\n" +
			"                 ├─ right-key: TUPLE()\n" +
			"                 └─ Table\n" +
			"                     ├─ name: one_pk\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ two_pk.pk1:6!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ two_pk.pk2:7!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk LEFT JOIN two_pk ON pk=pk1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:0!null, one_pk.c1:1, one_pk.c2:2, one_pk.c3:3, one_pk.c4:4, one_pk.c5:5, two_pk.pk1:6!null, two_pk.pk2:7!null, two_pk.c1:8!null, two_pk.c2:9!null, two_pk.c3:10!null, two_pk.c4:11!null, two_pk.c5:12!null]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ one_pk.pk:0!null\n" +
			"             │   └─ two_pk.pk1:6!null\n" +
			"             ├─ IndexedTableAccess(one_pk)\n" +
			"             │   ├─ index: [one_pk.pk]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(two_pk)\n" +
			"                 ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk RIGHT JOIN two_pk ON one_pk.pk=two_pk.pk1 AND one_pk.pk=two_pk.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ two_pk.pk1:0!null\n" +
			"             │   └─ one_pk.pk:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ one_pk.pk:7!null\n" +
			"             │   └─ two_pk.pk2:1!null\n" +
			"             ├─ IndexedTableAccess(two_pk)\n" +
			"             │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk opk JOIN two_pk tpk ON opk.pk=tpk.pk1 AND opk.pk=tpk.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.pk:0!null, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Sort(opk.pk:0!null ASC nullsFirst, tpk.pk1:6!null ASC nullsFirst, tpk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ tpk.pk1:0!null\n" +
			"             │   └─ opk.pk:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ opk.pk:7!null\n" +
			"             │   └─ tpk.pk2:1!null\n" +
			"             ├─ TableAlias(tpk)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(opk)\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk opk JOIN two_pk tpk ON pk=tpk.pk1 AND pk=tpk.pk2 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [opk.pk:0!null, tpk.pk1:6!null, tpk.pk2:7!null]\n" +
			" └─ Sort(opk.pk:0!null ASC nullsFirst, tpk.pk1:6!null ASC nullsFirst, tpk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [opk.pk:7!null, opk.c1:8, opk.c2:9, opk.c3:10, opk.c4:11, opk.c5:12, tpk.pk1:0!null, tpk.pk2:1!null, tpk.c1:2!null, tpk.c2:3!null, tpk.c3:4!null, tpk.c4:5!null, tpk.c5:6!null]\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ tpk.pk1:0!null\n" +
			"             │   └─ opk.pk:7!null\n" +
			"             ├─ sel: Eq\n" +
			"             │   ├─ opk.pk:7!null\n" +
			"             │   └─ tpk.pk2:1!null\n" +
			"             ├─ TableAlias(tpk)\n" +
			"             │   └─ IndexedTableAccess(two_pk)\n" +
			"             │       ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             │       ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"             │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ TableAlias(opk)\n" +
			"                 └─ IndexedTableAccess(one_pk)\n" +
			"                     ├─ index: [one_pk.pk]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk,two_pk WHERE one_pk.c1=two_pk.c1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ one_pk.c1:8\n" +
			"             │   └─ two_pk.c1:2!null\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: two_pk\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(two_pk.c1:2!null)\n" +
			"                 ├─ right-key: TUPLE(one_pk.c1:1)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: one_pk\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2,one_pk.c1 AS foo, two_pk.c1 AS bar FROM one_pk JOIN two_pk ON one_pk.c1=two_pk.c1 ORDER BY 1,2,3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null, foo:13, bar:14!null]\n" +
			" └─ Sort(one_pk.pk:0!null ASC nullsFirst, two_pk.pk1:6!null ASC nullsFirst, two_pk.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null, one_pk.c1:8 as foo, two_pk.c1:2!null as bar]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ one_pk.c1:8\n" +
			"             │   └─ two_pk.c1:2!null\n" +
			"             ├─ Table\n" +
			"             │   ├─ name: two_pk\n" +
			"             │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(two_pk.c1:2!null)\n" +
			"                 ├─ right-key: TUPLE(one_pk.c1:1)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: one_pk\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2,one_pk.c1 AS foo,two_pk.c1 AS bar FROM one_pk JOIN two_pk ON one_pk.c1=two_pk.c1 WHERE one_pk.c1=10`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [one_pk.pk:0!null, two_pk.pk1:6!null, two_pk.pk2:7!null, foo:13, bar:14!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null, one_pk.c1:8 as foo, two_pk.c1:2!null as bar]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ one_pk.c1:8\n" +
			"         │   └─ two_pk.c1:2!null\n" +
			"         ├─ Table\n" +
			"         │   ├─ name: two_pk\n" +
			"         │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(two_pk.c1:2!null)\n" +
			"             ├─ right-key: TUPLE(one_pk.c1:1)\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ one_pk.c1:1\n" +
			"                 │   └─ 10 (tinyint)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: one_pk\n" +
			"                     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk2 FROM one_pk t1, two_pk t2 WHERE pk=1 AND pk2=1 ORDER BY 1,2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.pk:0!null, t2.pk2:7!null]\n" +
			" └─ Sort(t1.pk:0!null ASC nullsFirst, t2.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [t1.pk:7!null, t1.c1:8, t1.c2:9, t1.c3:10, t1.c4:11, t1.c5:12, t2.pk1:0!null, t2.pk2:1!null, t2.c1:2!null, t2.c2:3!null, t2.c3:4!null, t2.c4:5!null, t2.c5:6!null]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t2.pk2:1!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ t2.pk2:1!null\n" +
			"                 │   │   └─ 1 (tinyint)\n" +
			"                 │   └─ TableAlias(t2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: two_pk\n" +
			"                 │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ t1.pk:0!null\n" +
			"                         │   └─ 1 (tinyint)\n" +
			"                         └─ TableAlias(t1)\n" +
			"                             └─ IndexedTableAccess(one_pk)\n" +
			"                                 ├─ index: [one_pk.pk]\n" +
			"                                 ├─ static: [{[1, 1]}]\n" +
			"                                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk t1, two_pk t2 WHERE pk=1 AND pk2=1 AND pk1=1 ORDER BY 1,2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.pk:0!null, t2.pk1:6!null, t2.pk2:7!null]\n" +
			" └─ Sort(t1.pk:0!null ASC nullsFirst, t2.pk1:6!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [t1.pk:7!null, t1.c1:8, t1.c2:9, t1.c3:10, t1.c4:11, t1.c5:12, t2.pk1:0!null, t2.pk2:1!null, t2.c1:2!null, t2.c2:3!null, t2.c3:4!null, t2.c4:5!null, t2.c5:6!null]\n" +
			"         └─ Filter\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.pk2:1!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ t2.pk1:0!null\n" +
			"             │       └─ 1 (tinyint)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ t2.pk2:1!null\n" +
			"                 │   │   │   └─ 1 (tinyint)\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ t2.pk1:0!null\n" +
			"                 │   │       └─ 1 (tinyint)\n" +
			"                 │   └─ TableAlias(t2)\n" +
			"                 │       └─ IndexedTableAccess(two_pk)\n" +
			"                 │           ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 │           ├─ static: [{[1, 1], [1, 1]}]\n" +
			"                 │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ t1.pk:0!null\n" +
			"                         │   └─ 1 (tinyint)\n" +
			"                         └─ TableAlias(t1)\n" +
			"                             └─ IndexedTableAccess(one_pk)\n" +
			"                                 ├─ index: [one_pk.pk]\n" +
			"                                 ├─ static: [{[1, 1]}]\n" +
			"                                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT i FROM mytable mt
		WHERE (SELECT i FROM mytable where i = mt.i and i > 2) IS NOT NULL
		AND (SELECT i2 FROM othertable where i2 = i) IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mt.i:0!null]\n" +
			" └─ Filter\n" +
			"     ├─ AND\n" +
			"     │   ├─ NOT\n" +
			"     │   │   └─ Subquery\n" +
			"     │   │       ├─ cacheable: false\n" +
			"     │   │       └─ Project\n" +
			"     │   │           ├─ columns: [mytable.i:2!null]\n" +
			"     │   │           └─ Filter\n" +
			"     │   │               ├─ Eq\n" +
			"     │   │               │   ├─ mytable.i:2!null\n" +
			"     │   │               │   └─ mt.i:0!null\n" +
			"     │   │               └─ IndexedTableAccess(mytable)\n" +
			"     │   │                   ├─ index: [mytable.i]\n" +
			"     │   │                   ├─ static: [{(2, ∞)}]\n" +
			"     │   │                   └─ columns: [i s]\n" +
			"     │   │       IS NULL\n" +
			"     │   └─ NOT\n" +
			"     │       └─ Subquery\n" +
			"     │           ├─ cacheable: false\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [othertable.i2:3!null]\n" +
			"     │               └─ Filter\n" +
			"     │                   ├─ Eq\n" +
			"     │                   │   ├─ othertable.i2:3!null\n" +
			"     │                   │   └─ mt.i:0!null\n" +
			"     │                   └─ IndexedTableAccess(othertable)\n" +
			"     │                       ├─ index: [othertable.i2]\n" +
			"     │                       └─ columns: [s2 i2]\n" +
			"     │           IS NULL\n" +
			"     └─ TableAlias(mt)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM mytable mt
		WHERE (SELECT i FROM mytable where i = mt.i) IS NOT NULL
		AND (SELECT i2 FROM othertable where i2 = i and i > 2) IS NOT NULL`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mt.i:0!null]\n" +
			" └─ Filter\n" +
			"     ├─ AND\n" +
			"     │   ├─ NOT\n" +
			"     │   │   └─ Subquery\n" +
			"     │   │       ├─ cacheable: false\n" +
			"     │   │       └─ Project\n" +
			"     │   │           ├─ columns: [mytable.i:2!null]\n" +
			"     │   │           └─ Filter\n" +
			"     │   │               ├─ Eq\n" +
			"     │   │               │   ├─ mytable.i:2!null\n" +
			"     │   │               │   └─ mt.i:0!null\n" +
			"     │   │               └─ IndexedTableAccess(mytable)\n" +
			"     │   │                   ├─ index: [mytable.i]\n" +
			"     │   │                   └─ columns: [i s]\n" +
			"     │   │       IS NULL\n" +
			"     │   └─ NOT\n" +
			"     │       └─ Subquery\n" +
			"     │           ├─ cacheable: false\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [othertable.i2:3!null]\n" +
			"     │               └─ Filter\n" +
			"     │                   ├─ AND\n" +
			"     │                   │   ├─ Eq\n" +
			"     │                   │   │   ├─ othertable.i2:3!null\n" +
			"     │                   │   │   └─ mt.i:0!null\n" +
			"     │                   │   └─ GreaterThan\n" +
			"     │                   │       ├─ mt.i:0!null\n" +
			"     │                   │       └─ 2 (tinyint)\n" +
			"     │                   └─ IndexedTableAccess(othertable)\n" +
			"     │                       ├─ index: [othertable.i2]\n" +
			"     │                       └─ columns: [s2 i2]\n" +
			"     │           IS NULL\n" +
			"     └─ TableAlias(mt)\n" +
			"         └─ Table\n" +
			"             ├─ name: mytable\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT pk,pk2, (SELECT pk from one_pk where pk = 1 limit 1) FROM one_pk t1, two_pk t2 WHERE pk=1 AND pk2=1 ORDER BY 1,2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.pk:0!null, t2.pk2:7!null, Subquery\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Limit(1)\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [one_pk.pk:13!null]\n" +
			" │           └─ IndexedTableAccess(one_pk)\n" +
			" │               ├─ index: [one_pk.pk]\n" +
			" │               ├─ static: [{[1, 1]}]\n" +
			" │               └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			" │   as (SELECT pk from one_pk where pk = 1 limit 1)]\n" +
			" └─ Sort(t1.pk:0!null ASC nullsFirst, t2.pk2:7!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [t1.pk:7!null, t1.c1:8, t1.c2:9, t1.c3:10, t1.c4:11, t1.c5:12, t2.pk1:0!null, t2.pk2:1!null, t2.c1:2!null, t2.c2:3!null, t2.c3:4!null, t2.c4:5!null, t2.c5:6!null]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ t2.pk2:1!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ t2.pk2:1!null\n" +
			"                 │   │   └─ 1 (tinyint)\n" +
			"                 │   └─ TableAlias(t2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: two_pk\n" +
			"                 │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ t1.pk:0!null\n" +
			"                         │   └─ 1 (tinyint)\n" +
			"                         └─ TableAlias(t1)\n" +
			"                             └─ IndexedTableAccess(one_pk)\n" +
			"                                 ├─ index: [one_pk.pk]\n" +
			"                                 ├─ static: [{[1, 1]}]\n" +
			"                                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT ROW_NUMBER() OVER (ORDER BY s2 ASC) idx, i2, s2 FROM othertable WHERE s2 <> 'second' ORDER BY i2 ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [idx:3!null, othertable.i2:1!null, othertable.s2:2!null]\n" +
			" └─ Sort(othertable.i2:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [row_number() over ( order by othertable.s2 asc):0!null, othertable.i2:1!null, othertable.s2:2!null, row_number() over ( order by othertable.s2 asc):0!null as idx]\n" +
			"         └─ Window\n" +
			"             ├─ row_number() over ( order by othertable.s2 ASC)\n" +
			"             ├─ othertable.i2:1!null\n" +
			"             ├─ othertable.s2:0!null\n" +
			"             └─ Filter\n" +
			"                 ├─ NOT\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ othertable.s2:0!null\n" +
			"                 │       └─ second (longtext)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: othertable\n" +
			"                     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT ROW_NUMBER() OVER (ORDER BY s2 ASC) idx, i2, s2 FROM othertable ORDER BY i2 ASC) a WHERE s2 <> 'second'`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: a\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ NOT\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ othertable.s2:2!null\n" +
			"     │       └─ second (longtext)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [idx:3!null, othertable.i2:1!null, othertable.s2:2!null]\n" +
			"         └─ Sort(othertable.i2:1!null ASC nullsFirst)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [row_number() over ( order by othertable.s2 asc):0!null, othertable.i2:1!null, othertable.s2:2!null, row_number() over ( order by othertable.s2 asc):0!null as idx]\n" +
			"                 └─ Window\n" +
			"                     ├─ row_number() over ( order by othertable.s2 ASC)\n" +
			"                     ├─ othertable.i2:1!null\n" +
			"                     ├─ othertable.s2:0!null\n" +
			"                     └─ Table\n" +
			"                         ├─ name: othertable\n" +
			"                         └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT ROW_NUMBER() OVER (ORDER BY s2 ASC) idx, i2, s2 FROM othertable WHERE i2 < 2 OR i2 > 2 ORDER BY i2 ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [idx:3!null, othertable.i2:1!null, othertable.s2:2!null]\n" +
			" └─ Sort(othertable.i2:1!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [row_number() over ( order by othertable.s2 asc):0!null, othertable.i2:1!null, othertable.s2:2!null, row_number() over ( order by othertable.s2 asc):0!null as idx]\n" +
			"         └─ Window\n" +
			"             ├─ row_number() over ( order by othertable.s2 ASC)\n" +
			"             ├─ othertable.i2:1!null\n" +
			"             ├─ othertable.s2:0!null\n" +
			"             └─ Filter\n" +
			"                 ├─ Or\n" +
			"                 │   ├─ LessThan\n" +
			"                 │   │   ├─ othertable.i2:1!null\n" +
			"                 │   │   └─ 2 (tinyint)\n" +
			"                 │   └─ GreaterThan\n" +
			"                 │       ├─ othertable.i2:1!null\n" +
			"                 │       └─ 2 (tinyint)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: othertable\n" +
			"                     └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT ROW_NUMBER() OVER (ORDER BY s2 ASC) idx, i2, s2 FROM othertable ORDER BY i2 ASC) a WHERE i2 < 2 OR i2 > 2`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: a\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ Or\n" +
			"     │   ├─ LessThan\n" +
			"     │   │   ├─ othertable.i2:1!null\n" +
			"     │   │   └─ 2 (tinyint)\n" +
			"     │   └─ GreaterThan\n" +
			"     │       ├─ othertable.i2:1!null\n" +
			"     │       └─ 2 (tinyint)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [idx:3!null, othertable.i2:1!null, othertable.s2:2!null]\n" +
			"         └─ Sort(othertable.i2:1!null ASC nullsFirst)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [row_number() over ( order by othertable.s2 asc):0!null, othertable.i2:1!null, othertable.s2:2!null, row_number() over ( order by othertable.s2 asc):0!null as idx]\n" +
			"                 └─ Window\n" +
			"                     ├─ row_number() over ( order by othertable.s2 ASC)\n" +
			"                     ├─ othertable.i2:1!null\n" +
			"                     ├─ othertable.s2:0!null\n" +
			"                     └─ Table\n" +
			"                         ├─ name: othertable\n" +
			"                         └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `SELECT t, n, lag(t, 1, t+1) over (partition by n) FROM bigtable`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [bigtable.t:1!null, bigtable.n:2, lag(bigtable.t, 1, (bigtable.t + 1)) over ( partition by bigtable.n rows between unbounded preceding and unbounded following):0 as lag(t, 1, t+1) over (partition by n)]\n" +
			" └─ Window\n" +
			"     ├─ lag(bigtable.t, 1, (bigtable.t + 1)) over ( partition by bigtable.n ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n" +
			"     ├─ bigtable.t:0!null\n" +
			"     ├─ bigtable.n:1\n" +
			"     └─ Table\n" +
			"         ├─ name: bigtable\n" +
			"         └─ columns: [t n]\n" +
			"",
	},
	{
		Query: `select i, row_number() over (w3) from mytable window w1 as (w2), w2 as (), w3 as (w1)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:1!null, row_number() over ( rows between unbounded preceding and unbounded following):0!null as row_number() over (w3)]\n" +
			" └─ Window\n" +
			"     ├─ row_number() over ( ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n" +
			"     ├─ mytable.i:0!null\n" +
			"     └─ Table\n" +
			"         ├─ name: mytable\n" +
			"         └─ columns: [i]\n" +
			"",
	},
	{
		Query: `select i, row_number() over (w1 partition by s) from mytable window w1 as (order by i asc)`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.i:1!null, row_number() over ( partition by mytable.s order by mytable.i asc rows between unbounded preceding and unbounded following):0!null as row_number() over (w1 partition by s)]\n" +
			" └─ Window\n" +
			"     ├─ row_number() over ( partition by mytable.s order by mytable.i ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n" +
			"     ├─ mytable.i:0!null\n" +
			"     └─ Table\n" +
			"         ├─ name: mytable\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `DELETE FROM two_pk WHERE c1 > 1`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ two_pk.c1:2!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ Table\n" +
			"             ├─ name: two_pk\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `DELETE FROM two_pk WHERE pk1 = 1 AND pk2 = 2`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ IndexedTableAccess(two_pk)\n" +
			"         ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"         ├─ static: [{[1, 1], [2, 2]}]\n" +
			"         └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `UPDATE two_pk SET c1 = 1 WHERE c1 > 1`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Update\n" +
			"     └─ UpdateSource(SET two_pk.c1:2!null = 1 (tinyint))\n" +
			"         └─ Filter\n" +
			"             ├─ GreaterThan\n" +
			"             │   ├─ two_pk.c1:2!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ Table\n" +
			"                 ├─ name: two_pk\n" +
			"                 └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `UPDATE two_pk SET c1 = 1 WHERE pk1 = 1 AND pk2 = 2`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Update\n" +
			"     └─ UpdateSource(SET two_pk.c1:2!null = 1 (tinyint))\n" +
			"         └─ IndexedTableAccess(two_pk)\n" +
			"             ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"             ├─ static: [{[1, 1], [2, 2]}]\n" +
			"             └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `UPDATE /*+ JOIN_ORDER(two_pk, one_pk) */ one_pk JOIN two_pk on one_pk.pk = two_pk.pk1 SET two_pk.c1 = two_pk.c1 + 1`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Update\n" +
			"     └─ Update Join\n" +
			"         └─ UpdateSource(SET two_pk.c1:8!null = (two_pk.c1:8!null + 1 (tinyint)))\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, two_pk.pk1:0!null, two_pk.pk2:1!null, two_pk.c1:2!null, two_pk.c2:3!null, two_pk.c3:4!null, two_pk.c4:5!null, two_pk.c5:6!null]\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ two_pk.pk1:0!null\n" +
			"                     │   └─ one_pk.pk:7!null\n" +
			"                     ├─ IndexedTableAccess(two_pk)\n" +
			"                     │   ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                     │   ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                     │   └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                     └─ IndexedTableAccess(one_pk)\n" +
			"                         ├─ index: [one_pk.pk]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `UPDATE one_pk INNER JOIN (SELECT * FROM two_pk) as t2 on one_pk.pk = t2.pk1 SET one_pk.c1 = one_pk.c1 + 1, one_pk.c2 = one_pk.c2 + 1`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Update\n" +
			"     └─ Update Join\n" +
			"         └─ UpdateSource(SET one_pk.c1:1 = (one_pk.c1:1 + 1 (tinyint)),SET one_pk.c2:2 = (one_pk.c2:2 + 1 (tinyint)))\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [one_pk.pk:7!null, one_pk.c1:8, one_pk.c2:9, one_pk.c3:10, one_pk.c4:11, one_pk.c5:12, t2.pk1:0!null, t2.pk2:1!null, t2.c1:2!null, t2.c2:3!null, t2.c3:4!null, t2.c4:5!null, t2.c5:6!null]\n" +
			"                 └─ HashJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ one_pk.pk:7!null\n" +
			"                     │   └─ t2.pk1:0!null\n" +
			"                     ├─ SubqueryAlias\n" +
			"                     │   ├─ name: t2\n" +
			"                     │   ├─ outerVisibility: false\n" +
			"                     │   ├─ cacheable: true\n" +
			"                     │   └─ Table\n" +
			"                     │       ├─ name: two_pk\n" +
			"                     │       └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE(t2.pk1:0!null)\n" +
			"                         ├─ right-key: TUPLE(one_pk.pk:0!null)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: one_pk\n" +
			"                             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM invert_pk as a, invert_pk as b WHERE a.y = b.z`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.x:0!null, a.y:1!null, a.z:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.x:3!null, a.y:4!null, a.z:5!null, b.x:0!null, b.y:1!null, b.z:2!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ a.y:4!null\n" +
			"         │   └─ b.z:2!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: invert_pk\n" +
			"         │       └─ columns: [x y z]\n" +
			"         └─ TableAlias(a)\n" +
			"             └─ IndexedTableAccess(invert_pk)\n" +
			"                 ├─ index: [invert_pk.y,invert_pk.z,invert_pk.x]\n" +
			"                 └─ columns: [x y z]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM invert_pk as a, invert_pk as b WHERE a.y = b.z AND a.z = 2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.x:0!null, a.y:1!null, a.z:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.x:3!null, a.y:4!null, a.z:5!null, b.x:0!null, b.y:1!null, b.z:2!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ a.y:4!null\n" +
			"         │   └─ b.z:2!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: invert_pk\n" +
			"         │       └─ columns: [x y z]\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ a.z:2!null\n" +
			"             │   └─ 2 (tinyint)\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(invert_pk)\n" +
			"                     ├─ index: [invert_pk.y,invert_pk.z,invert_pk.x]\n" +
			"                     └─ columns: [x y z]\n" +
			"",
	},
	{
		Query: `SELECT * FROM invert_pk WHERE y = 0`,
		ExpectedPlan: "IndexedTableAccess(invert_pk)\n" +
			" ├─ index: [invert_pk.y,invert_pk.z,invert_pk.x]\n" +
			" ├─ static: [{[0, 0], [NULL, ∞), [NULL, ∞)}]\n" +
			" └─ columns: [x y z]\n" +
			"",
	},
	{
		Query: `SELECT * FROM invert_pk WHERE y >= 0`,
		ExpectedPlan: "IndexedTableAccess(invert_pk)\n" +
			" ├─ index: [invert_pk.y,invert_pk.z,invert_pk.x]\n" +
			" ├─ static: [{[0, ∞), [NULL, ∞), [NULL, ∞)}]\n" +
			" └─ columns: [x y z]\n" +
			"",
	},
	{
		Query: `SELECT * FROM invert_pk WHERE y >= 0 AND z < 1`,
		ExpectedPlan: "IndexedTableAccess(invert_pk)\n" +
			" ├─ index: [invert_pk.y,invert_pk.z,invert_pk.x]\n" +
			" ├─ static: [{[0, ∞), (NULL, 1), [NULL, ∞)}]\n" +
			" └─ columns: [x y z]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk WHERE pk IN (1)`,
		ExpectedPlan: "IndexedTableAccess(one_pk)\n" +
			" ├─ index: [one_pk.pk]\n" +
			" ├─ static: [{[1, 1]}]\n" +
			" └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM one_pk a CROSS JOIN one_pk c LEFT JOIN one_pk b ON b.pk = c.pk and b.pk = a.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:6!null, a.c1:7, a.c2:8, a.c3:9, a.c4:10, a.c5:11, c.pk:0!null, c.c1:1, c.c2:2, c.c3:3, c.c4:4, c.c5:5, b.pk:12!null, b.c1:13, b.c2:14, b.c3:15, b.c4:16, b.c5:17]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ b.pk:12!null\n" +
			"         │   │   └─ c.pk:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.pk:12!null\n" +
			"         │       └─ a.pk:6!null\n" +
			"         ├─ CrossHashJoin\n" +
			"         │   ├─ TableAlias(c)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: one_pk\n" +
			"         │   │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE()\n" +
			"         │       ├─ right-key: TUPLE()\n" +
			"         │       └─ TableAlias(a)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: one_pk\n" +
			"         │               └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM one_pk a CROSS JOIN one_pk c RIGHT JOIN one_pk b ON b.pk = c.pk and b.pk = a.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:12!null, a.c1:13, a.c2:14, a.c3:15, a.c4:16, a.c5:17, c.pk:6!null, c.c1:7, c.c2:8, c.c3:9, c.c4:10, c.c5:11, b.pk:0!null, b.c1:1, b.c2:2, b.c3:3, b.c4:4, b.c5:5]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ b.pk:0!null\n" +
			"         │   │   └─ c.pk:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.pk:0!null\n" +
			"         │       └─ a.pk:12!null\n" +
			"         ├─ TableAlias(b)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: one_pk\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(b.pk:0!null, b.pk:0!null)\n" +
			"             ├─ right-key: TUPLE(c.pk:0!null, a.pk:6!null)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ TableAlias(c)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: one_pk\n" +
			"                 │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ TableAlias(a)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: one_pk\n" +
			"                             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM one_pk a CROSS JOIN one_pk c INNER JOIN one_pk b ON b.pk = c.pk and b.pk = a.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:6!null, a.c1:7, a.c2:8, a.c3:9, a.c4:10, a.c5:11, c.pk:12!null, c.c1:13, c.c2:14, c.c3:15, c.c4:16, c.c5:17, b.pk:0!null, b.c1:1, b.c2:2, b.c3:3, b.c4:4, b.c5:5]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.pk:0!null\n" +
			"         │   └─ c.pk:12!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ b.pk:0!null\n" +
			"         │   │   └─ a.pk:6!null\n" +
			"         │   ├─ TableAlias(b)\n" +
			"         │   │   └─ IndexedTableAccess(one_pk)\n" +
			"         │   │       ├─ index: [one_pk.pk]\n" +
			"         │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │   └─ TableAlias(a)\n" +
			"         │       └─ IndexedTableAccess(one_pk)\n" +
			"         │           ├─ index: [one_pk.pk]\n" +
			"         │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │           └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(c)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM one_pk a CROSS JOIN one_pk b INNER JOIN one_pk c ON b.pk = c.pk LEFT JOIN one_pk d ON c.pk = d.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5, b.pk:12!null, b.c1:13, b.c2:14, b.c3:15, b.c4:16, b.c5:17, c.pk:6!null, c.c1:7, c.c2:8, c.c3:9, c.c4:10, c.c5:11, d.pk:18!null, d.c1:19, d.c2:20, d.c3:21, d.c4:22, d.c5:23]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ c.pk:6!null\n" +
			"         │   └─ d.pk:18!null\n" +
			"         ├─ CrossHashJoin\n" +
			"         │   ├─ TableAlias(a)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: one_pk\n" +
			"         │   │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE()\n" +
			"         │       ├─ right-key: TUPLE()\n" +
			"         │       └─ MergeJoin\n" +
			"         │           ├─ cmp: Eq\n" +
			"         │           │   ├─ c.pk:6!null\n" +
			"         │           │   └─ b.pk:12!null\n" +
			"         │           ├─ TableAlias(c)\n" +
			"         │           │   └─ IndexedTableAccess(one_pk)\n" +
			"         │           │       ├─ index: [one_pk.pk]\n" +
			"         │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │           │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         │           └─ TableAlias(b)\n" +
			"         │               └─ IndexedTableAccess(one_pk)\n" +
			"         │                   ├─ index: [one_pk.pk]\n" +
			"         │                   ├─ static: [{[NULL, ∞)}]\n" +
			"         │                   └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ TableAlias(d)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT a.* FROM one_pk a CROSS JOIN one_pk c INNER JOIN (select * from one_pk) b ON b.pk = c.pk`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.c1:1, a.c2:2, a.c3:3, a.c4:4, a.c5:5]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:12!null, a.c1:13, a.c2:14, a.c3:15, a.c4:16, a.c5:17, c.pk:6!null, c.c1:7, c.c2:8, c.c3:9, c.c4:10, c.c5:11, b.pk:0!null, b.c1:1, b.c2:2, b.c3:3, b.c4:4, b.c5:5]\n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.pk:0!null\n" +
			"         │   └─ c.pk:6!null\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: b\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: one_pk\n" +
			"         │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(b.pk:0!null)\n" +
			"             ├─ right-key: TUPLE(c.pk:0!null)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ TableAlias(c)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: one_pk\n" +
			"                 │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ TableAlias(a)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: one_pk\n" +
			"                             └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM tabletest join mytable mt INNER JOIN othertable ot ON tabletest.i = ot.i2 order by 1,3,6`,
		ExpectedPlan: "Sort(tabletest.i:0!null ASC nullsFirst, mt.i:2!null ASC nullsFirst, ot.i2:5!null ASC nullsFirst)\n" +
			" └─ Project\n" +
			"     ├─ columns: [tabletest.i:2!null, tabletest.s:3!null, mt.i:0!null, mt.s:1!null, ot.s2:4!null, ot.i2:5!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ tabletest.i:2!null\n" +
			"         │   └─ ot.i2:5!null\n" +
			"         ├─ CrossHashJoin\n" +
			"         │   ├─ TableAlias(mt)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: mytable\n" +
			"         │   │       └─ columns: [i s]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE()\n" +
			"         │       ├─ right-key: TUPLE()\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: tabletest\n" +
			"         │           └─ columns: [i s]\n" +
			"         └─ TableAlias(ot)\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.i2]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `select a.pk, c.v2 from one_pk_three_idx a cross join one_pk_three_idx b right join one_pk_three_idx c on b.pk = c.v1 where b.pk = 0 and c.v2 = 0;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, c.v2:10]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:8!null, a.v1:9, a.v2:10, a.v3:11, b.pk:4!null, b.v1:5, b.v2:6, b.v3:7, c.pk:0!null, c.v1:1, c.v2:2, c.v3:3]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.pk:4!null\n" +
			"         │   └─ 0 (tinyint)\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ b.pk:4!null\n" +
			"             │   └─ c.v1:1\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ c.v2:2\n" +
			"             │   │   └─ 0 (tinyint)\n" +
			"             │   └─ TableAlias(c)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: one_pk_three_idx\n" +
			"             │           └─ columns: [pk v1 v2 v3]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(c.v1:1)\n" +
			"                 ├─ right-key: TUPLE(b.pk:0!null)\n" +
			"                 └─ CrossHashJoin\n" +
			"                     ├─ TableAlias(b)\n" +
			"                     │   └─ Table\n" +
			"                     │       ├─ name: one_pk_three_idx\n" +
			"                     │       └─ columns: [pk v1 v2 v3]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE()\n" +
			"                         ├─ right-key: TUPLE()\n" +
			"                         └─ TableAlias(a)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: one_pk_three_idx\n" +
			"                                 └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `select a.pk, c.v2 from one_pk_three_idx a cross join one_pk_three_idx b left join one_pk_three_idx c on b.pk = c.v1 where b.pk = 0 and a.v2 = 1;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, c.v2:10]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:4!null, a.v1:5, a.v2:6, a.v3:7, b.pk:0!null, b.v1:1, b.v2:2, b.v3:3, c.pk:8!null, c.v1:9, c.v2:10, c.v3:11]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.pk:0!null\n" +
			"         │   └─ 0 (tinyint)\n" +
			"         └─ LeftOuterLookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ b.pk:0!null\n" +
			"             │   └─ c.v1:9\n" +
			"             ├─ CrossHashJoin\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ b.pk:0!null\n" +
			"             │   │   │   └─ 0 (tinyint)\n" +
			"             │   │   └─ TableAlias(b)\n" +
			"             │   │       └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"             │   │           ├─ index: [one_pk_three_idx.pk]\n" +
			"             │   │           ├─ static: [{[0, 0]}]\n" +
			"             │   │           └─ columns: [pk v1 v2 v3]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE()\n" +
			"             │       ├─ right-key: TUPLE()\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ a.v2:2\n" +
			"             │           │   └─ 1 (tinyint)\n" +
			"             │           └─ TableAlias(a)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: one_pk_three_idx\n" +
			"             │                   └─ columns: [pk v1 v2 v3]\n" +
			"             └─ TableAlias(c)\n" +
			"                 └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"                     ├─ index: [one_pk_three_idx.v1,one_pk_three_idx.v2,one_pk_three_idx.v3]\n" +
			"                     └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `with a as (select a.i, a.s from mytable a CROSS JOIN mytable b) select * from a RIGHT JOIN mytable c on a.i+1 = c.i-1;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:2!null, a.s:3!null, c.i:0!null, c.s:1!null]\n" +
			" └─ LeftOuterHashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ (a.i:2!null + 1 (tinyint))\n" +
			"     │   └─ (c.i:0!null - 1 (tinyint))\n" +
			"     ├─ TableAlias(c)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE((c.i:0!null - 1 (tinyint)))\n" +
			"         ├─ right-key: TUPLE((a.i:0!null + 1 (tinyint)))\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: a\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"                     └─ CrossHashJoin\n" +
			"                         ├─ TableAlias(b)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: mytable\n" +
			"                         │       └─ columns: [i s]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE()\n" +
			"                             ├─ right-key: TUPLE()\n" +
			"                             └─ TableAlias(a)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: mytable\n" +
			"                                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select a.* from mytable a RIGHT JOIN mytable b on a.i = b.i+1 LEFT JOIN mytable c on a.i = c.i-1 RIGHT JOIN mytable d on b.i = d.i;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:4!null, a.s:5!null, b.i:2!null, b.s:3!null, c.i:6!null, c.s:7!null, d.i:0!null, d.s:1!null]\n" +
			"     └─ LeftOuterJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.i:2!null\n" +
			"         │   └─ d.i:0!null\n" +
			"         ├─ TableAlias(d)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: mytable\n" +
			"         │       └─ columns: [i s]\n" +
			"         └─ LeftOuterJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ a.i:4!null\n" +
			"             │   └─ (c.i:6!null - 1 (tinyint))\n" +
			"             ├─ LeftOuterMergeJoin\n" +
			"             │   ├─ cmp: Eq\n" +
			"             │   │   ├─ (b.i:2!null + 1 (tinyint))\n" +
			"             │   │   └─ a.i:4!null\n" +
			"             │   ├─ TableAlias(b)\n" +
			"             │   │   └─ IndexedTableAccess(mytable)\n" +
			"             │   │       ├─ index: [mytable.i]\n" +
			"             │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │       └─ columns: [i s]\n" +
			"             │   └─ TableAlias(a)\n" +
			"             │       └─ IndexedTableAccess(mytable)\n" +
			"             │           ├─ index: [mytable.i]\n" +
			"             │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           └─ columns: [i s]\n" +
			"             └─ TableAlias(c)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: mytable\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select a.*,b.* from mytable a RIGHT JOIN othertable b on a.i = b.i2+1 LEFT JOIN mytable c on a.i = c.i-1 LEFT JOIN othertable d on b.i2 = d.i2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null, b.s2:2!null, b.i2:3!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.s2:0!null, b.i2:1!null, c.i:4!null, c.s:5!null, d.s2:6!null, d.i2:7!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.i2:1!null\n" +
			"         │   └─ d.i2:7!null\n" +
			"         ├─ LeftOuterJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:2!null\n" +
			"         │   │   └─ (c.i:4!null - 1 (tinyint))\n" +
			"         │   ├─ LeftOuterMergeJoin\n" +
			"         │   │   ├─ cmp: Eq\n" +
			"         │   │   │   ├─ (b.i2:1!null + 1 (tinyint))\n" +
			"         │   │   │   └─ a.i:2!null\n" +
			"         │   │   ├─ TableAlias(b)\n" +
			"         │   │   │   └─ IndexedTableAccess(othertable)\n" +
			"         │   │   │       ├─ index: [othertable.i2]\n" +
			"         │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │   │       └─ columns: [s2 i2]\n" +
			"         │   │   └─ TableAlias(a)\n" +
			"         │   │       └─ IndexedTableAccess(mytable)\n" +
			"         │   │           ├─ index: [mytable.i]\n" +
			"         │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │           └─ columns: [i s]\n" +
			"         │   └─ TableAlias(c)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: mytable\n" +
			"         │           └─ columns: [i s]\n" +
			"         └─ TableAlias(d)\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.i2]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `select a.*,b.* from mytable a RIGHT JOIN othertable b on a.i = b.i2+1 RIGHT JOIN mytable c on a.i = c.i-1 LEFT JOIN othertable d on b.i2 = d.i2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null, b.s2:2!null, b.i2:3!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:4!null, a.s:5!null, b.s2:2!null, b.i2:3!null, c.i:0!null, c.s:1!null, d.s2:6!null, d.i2:7!null]\n" +
			"     └─ LeftOuterLookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ b.i2:3!null\n" +
			"         │   └─ d.i2:7!null\n" +
			"         ├─ LeftOuterJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.i:4!null\n" +
			"         │   │   └─ (c.i:0!null - 1 (tinyint))\n" +
			"         │   ├─ TableAlias(c)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: mytable\n" +
			"         │   │       └─ columns: [i s]\n" +
			"         │   └─ LeftOuterMergeJoin\n" +
			"         │       ├─ cmp: Eq\n" +
			"         │       │   ├─ (b.i2:3!null + 1 (tinyint))\n" +
			"         │       │   └─ a.i:4!null\n" +
			"         │       ├─ TableAlias(b)\n" +
			"         │       │   └─ IndexedTableAccess(othertable)\n" +
			"         │       │       ├─ index: [othertable.i2]\n" +
			"         │       │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       │       └─ columns: [s2 i2]\n" +
			"         │       └─ TableAlias(a)\n" +
			"         │           └─ IndexedTableAccess(mytable)\n" +
			"         │               ├─ index: [mytable.i]\n" +
			"         │               ├─ static: [{[NULL, ∞)}]\n" +
			"         │               └─ columns: [i s]\n" +
			"         └─ TableAlias(d)\n" +
			"             └─ IndexedTableAccess(othertable)\n" +
			"                 ├─ index: [othertable.i2]\n" +
			"                 └─ columns: [s2 i2]\n" +
			"",
	},
	{
		Query: `select i.pk, j.v3 from one_pk_two_idx i JOIN one_pk_three_idx j on i.v1 = j.pk;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i.pk:0!null, j.v3:6]\n" +
			" └─ Project\n" +
			"     ├─ columns: [i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ j.pk:0!null\n" +
			"         │   └─ i.v1:5\n" +
			"         ├─ TableAlias(j)\n" +
			"         │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk v1 v2 v3]\n" +
			"         └─ TableAlias(i)\n" +
			"             └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"                 ├─ index: [one_pk_two_idx.v1]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `select i.pk, j.v3, k.c1 from one_pk_two_idx i JOIN one_pk_three_idx j on i.v1 = j.pk JOIN one_pk k on j.v3 = k.pk;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i.pk:0!null, j.v3:6, k.c1:8]\n" +
			" └─ Project\n" +
			"     ├─ columns: [i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3, k.pk:7!null, k.c1:8, k.c2:9, k.c3:10, k.c4:11, k.c5:12]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ j.v3:3\n" +
			"         │   └─ k.pk:7!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ j.pk:0!null\n" +
			"         │   │   └─ i.v1:5\n" +
			"         │   ├─ TableAlias(j)\n" +
			"         │   │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │   │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk v1 v2 v3]\n" +
			"         │   └─ TableAlias(i)\n" +
			"         │       └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"         │           ├─ index: [one_pk_two_idx.v1]\n" +
			"         │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │           └─ columns: [pk v1 v2]\n" +
			"         └─ TableAlias(k)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `select i.pk, j.v3 from (one_pk_two_idx i JOIN one_pk_three_idx j on((i.v1 = j.pk)));`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i.pk:0!null, j.v3:6]\n" +
			" └─ Project\n" +
			"     ├─ columns: [i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3]\n" +
			"     └─ MergeJoin\n" +
			"         ├─ cmp: Eq\n" +
			"         │   ├─ j.pk:0!null\n" +
			"         │   └─ i.v1:5\n" +
			"         ├─ TableAlias(j)\n" +
			"         │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │       └─ columns: [pk v1 v2 v3]\n" +
			"         └─ TableAlias(i)\n" +
			"             └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"                 ├─ index: [one_pk_two_idx.v1]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `select i.pk, j.v3, k.c1 from ((one_pk_two_idx i JOIN one_pk_three_idx j on ((i.v1 = j.pk))) JOIN one_pk k on((j.v3 = k.pk)));`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i.pk:0!null, j.v3:6, k.c1:8]\n" +
			" └─ Project\n" +
			"     ├─ columns: [i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3, k.pk:7!null, k.c1:8, k.c2:9, k.c3:10, k.c4:11, k.c5:12]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ j.v3:3\n" +
			"         │   └─ k.pk:7!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ j.pk:0!null\n" +
			"         │   │   └─ i.v1:5\n" +
			"         │   ├─ TableAlias(j)\n" +
			"         │   │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │   │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk v1 v2 v3]\n" +
			"         │   └─ TableAlias(i)\n" +
			"         │       └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"         │           ├─ index: [one_pk_two_idx.v1]\n" +
			"         │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │           └─ columns: [pk v1 v2]\n" +
			"         └─ TableAlias(k)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `select i.pk, j.v3, k.c1 from (one_pk_two_idx i JOIN one_pk_three_idx j on ((i.v1 = j.pk)) JOIN one_pk k on((j.v3 = k.pk)))`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i.pk:0!null, j.v3:6, k.c1:8]\n" +
			" └─ Project\n" +
			"     ├─ columns: [i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3, k.pk:7!null, k.c1:8, k.c2:9, k.c3:10, k.c4:11, k.c5:12]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ j.v3:3\n" +
			"         │   └─ k.pk:7!null\n" +
			"         ├─ MergeJoin\n" +
			"         │   ├─ cmp: Eq\n" +
			"         │   │   ├─ j.pk:0!null\n" +
			"         │   │   └─ i.v1:5\n" +
			"         │   ├─ TableAlias(j)\n" +
			"         │   │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │   │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       └─ columns: [pk v1 v2 v3]\n" +
			"         │   └─ TableAlias(i)\n" +
			"         │       └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"         │           ├─ index: [one_pk_two_idx.v1]\n" +
			"         │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │           └─ columns: [pk v1 v2]\n" +
			"         └─ TableAlias(k)\n" +
			"             └─ IndexedTableAccess(one_pk)\n" +
			"                 ├─ index: [one_pk.pk]\n" +
			"                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `select a.* from one_pk_two_idx a RIGHT JOIN (one_pk_two_idx i JOIN one_pk_three_idx j on i.v1 = j.pk) on a.pk = i.v1 LEFT JOIN (one_pk_two_idx k JOIN one_pk_three_idx l on k.v1 = l.pk) on a.pk = l.v2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.v1:1, a.v2:2]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:7!null, a.v1:8, a.v2:9, i.pk:4!null, i.v1:5, i.v2:6, j.pk:0!null, j.v1:1, j.v2:2, j.v3:3, k.pk:14!null, k.v1:15, k.v2:16, l.pk:10!null, l.v1:11, l.v2:12, l.v3:13]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ a.pk:7!null\n" +
			"         │   └─ l.v2:12\n" +
			"         ├─ LeftOuterHashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ a.pk:7!null\n" +
			"         │   │   └─ i.v1:5\n" +
			"         │   ├─ MergeJoin\n" +
			"         │   │   ├─ cmp: Eq\n" +
			"         │   │   │   ├─ j.pk:0!null\n" +
			"         │   │   │   └─ i.v1:5\n" +
			"         │   │   ├─ TableAlias(j)\n" +
			"         │   │   │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"         │   │   │       ├─ index: [one_pk_three_idx.pk]\n" +
			"         │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │   │       └─ columns: [pk v1 v2 v3]\n" +
			"         │   │   └─ TableAlias(i)\n" +
			"         │   │       └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"         │   │           ├─ index: [one_pk_two_idx.v1]\n" +
			"         │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │           └─ columns: [pk v1 v2]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(i.v1:5)\n" +
			"         │       ├─ right-key: TUPLE(a.pk:0!null)\n" +
			"         │       └─ TableAlias(a)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: one_pk_two_idx\n" +
			"         │               └─ columns: [pk v1 v2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(a.pk:7!null)\n" +
			"             ├─ right-key: TUPLE(l.v2:2)\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ l.pk:10!null\n" +
			"                 │   └─ k.v1:15\n" +
			"                 ├─ TableAlias(l)\n" +
			"                 │   └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"                 │       ├─ index: [one_pk_three_idx.pk]\n" +
			"                 │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │       └─ columns: [pk v1 v2 v3]\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"                         ├─ index: [one_pk_two_idx.v1]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `select a.* from one_pk_two_idx a LEFT JOIN (one_pk_two_idx i JOIN one_pk_three_idx j on i.pk = j.v3) on a.pk = i.pk RIGHT JOIN (one_pk_two_idx k JOIN one_pk_three_idx l on k.v2 = l.v3) on a.v1 = l.v2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:0!null, a.v1:1, a.v2:2]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.pk:7!null, a.v1:8, a.v2:9, i.pk:14!null, i.v1:15, i.v2:16, j.pk:10!null, j.v1:11, j.v2:12, j.v3:13, k.pk:4!null, k.v1:5, k.v2:6, l.pk:0!null, l.v1:1, l.v2:2, l.v3:3]\n" +
			"     └─ LeftOuterHashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ a.v1:8\n" +
			"         │   └─ l.v2:2\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ k.v2:6\n" +
			"         │   │   └─ l.v3:3\n" +
			"         │   ├─ TableAlias(l)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: one_pk_three_idx\n" +
			"         │   │       └─ columns: [pk v1 v2 v3]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(l.v3:3)\n" +
			"         │       ├─ right-key: TUPLE(k.v2:2)\n" +
			"         │       └─ TableAlias(k)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: one_pk_two_idx\n" +
			"         │               └─ columns: [pk v1 v2]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(l.v2:2)\n" +
			"             ├─ right-key: TUPLE(a.v1:1)\n" +
			"             └─ LeftOuterHashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ a.pk:7!null\n" +
			"                 │   └─ i.pk:14!null\n" +
			"                 ├─ TableAlias(a)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: one_pk_two_idx\n" +
			"                 │       └─ columns: [pk v1 v2]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(a.pk:7!null)\n" +
			"                     ├─ right-key: TUPLE(i.pk:4!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ i.pk:14!null\n" +
			"                         │   └─ j.v3:13\n" +
			"                         ├─ TableAlias(j)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: one_pk_three_idx\n" +
			"                         │       └─ columns: [pk v1 v2 v3]\n" +
			"                         └─ TableAlias(i)\n" +
			"                             └─ IndexedTableAccess(one_pk_two_idx)\n" +
			"                                 ├─ index: [one_pk_two_idx.pk]\n" +
			"                                 └─ columns: [pk v1 v2]\n" +
			"",
	},
	{
		Query: `select a.* from mytable a join mytable b on a.i = b.i and a.i > 2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ Filter\n" +
			"     │   ├─ GreaterThan\n" +
			"     │   │   ├─ a.i:0!null\n" +
			"     │   │   └─ 2 (tinyint)\n" +
			"     │   └─ TableAlias(a)\n" +
			"     │       └─ IndexedTableAccess(mytable)\n" +
			"     │           ├─ index: [mytable.i]\n" +
			"     │           ├─ static: [{[NULL, ∞)}]\n" +
			"     │           └─ columns: [i s]\n" +
			"     └─ TableAlias(b)\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{[NULL, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `select a.* from mytable a join mytable b on a.i = b.i and now() >= coalesce(NULL, NULL, now())`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.i:0!null, a.s:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [a.i:2!null, a.s:3!null, b.i:0!null, b.s:1!null]\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThanOrEqual\n" +
			"         │   ├─ NOW()\n" +
			"         │   └─ coalesce(NULL,NULL,NOW())\n" +
			"         └─ MergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ b.i:0!null\n" +
			"             │   └─ a.i:2!null\n" +
			"             ├─ TableAlias(b)\n" +
			"             │   └─ IndexedTableAccess(mytable)\n" +
			"             │       ├─ index: [mytable.i]\n" +
			"             │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │       └─ columns: [i s]\n" +
			"             └─ TableAlias(a)\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * from one_pk_three_idx where pk < 1 and v1 = 1 and v2 = 1`,
		ExpectedPlan: "Filter\n" +
			" ├─ LessThan\n" +
			" │   ├─ one_pk_three_idx.pk:0!null\n" +
			" │   └─ 1 (tinyint)\n" +
			" └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"     ├─ index: [one_pk_three_idx.v1,one_pk_three_idx.v2,one_pk_three_idx.v3]\n" +
			"     ├─ static: [{[1, 1], [1, 1], [NULL, ∞)}]\n" +
			"     └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `SELECT * from one_pk_three_idx where pk = 1 and v1 = 1 and v2 = 1`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ one_pk_three_idx.pk:0!null\n" +
			" │   └─ 1 (tinyint)\n" +
			" └─ IndexedTableAccess(one_pk_three_idx)\n" +
			"     ├─ index: [one_pk_three_idx.v1,one_pk_three_idx.v2,one_pk_three_idx.v3]\n" +
			"     ├─ static: [{[1, 1], [1, 1], [NULL, ∞)}]\n" +
			"     └─ columns: [pk v1 v2 v3]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable  b on a.i = b.i and b <=> NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ (b.b:4 <=> NULL (null))\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ IndexedTableAccess(mytable)\n" +
			"     │       ├─ index: [mytable.i]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Filter\n" +
			"         ├─ (b.b:2 <=> NULL (null))\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable  b on a.i = b.i and b IS NOT NULL`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ b.b:4 IS NULL\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ IndexedTableAccess(mytable)\n" +
			"     │       ├─ index: [mytable.i]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ b.b:2 IS NULL\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable  b on a.i = b.i and b != 0`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ Eq\n" +
			" │       ├─ b.b:4\n" +
			" │       └─ 0 (tinyint)\n" +
			" └─ MergeJoin\n" +
			"     ├─ cmp: Eq\n" +
			"     │   ├─ a.i:0!null\n" +
			"     │   └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ IndexedTableAccess(mytable)\n" +
			"     │       ├─ index: [mytable.i]\n" +
			"     │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.b:2\n" +
			"         │       └─ 0 (tinyint)\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ IndexedTableAccess(niltable)\n" +
			"                 ├─ index: [niltable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable  b on a.i = b.i and s IS NOT NULL`,
		ExpectedPlan: "LookupJoin\n" +
			" ├─ Eq\n" +
			" │   ├─ a.i:0!null\n" +
			" │   └─ b.i:2!null\n" +
			" ├─ Filter\n" +
			" │   ├─ NOT\n" +
			" │   │   └─ a.s:1!null IS NULL\n" +
			" │   └─ TableAlias(a)\n" +
			" │       └─ IndexedTableAccess(mytable)\n" +
			" │           ├─ index: [mytable.s]\n" +
			" │           ├─ static: [{(NULL, ∞)}]\n" +
			" │           └─ columns: [i s]\n" +
			" └─ TableAlias(b)\n" +
			"     └─ IndexedTableAccess(niltable)\n" +
			"         ├─ index: [niltable.i]\n" +
			"         └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable  b on a.i <> b.i and b != 0;`,
		ExpectedPlan: "Filter\n" +
			" ├─ NOT\n" +
			" │   └─ Eq\n" +
			" │       ├─ b.b:4\n" +
			" │       └─ 0 (tinyint)\n" +
			" └─ InnerJoin\n" +
			"     ├─ NOT\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ a.i:0!null\n" +
			"     │       └─ b.i:2!null\n" +
			"     ├─ TableAlias(a)\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: mytable\n" +
			"     │       └─ columns: [i s]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ b.b:2\n" +
			"         │       └─ 0 (tinyint)\n" +
			"         └─ TableAlias(b)\n" +
			"             └─ Table\n" +
			"                 ├─ name: niltable\n" +
			"                 └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: `select * from mytable a join niltable b on a.i <> b.i;`,
		ExpectedPlan: "InnerJoin\n" +
			" ├─ NOT\n" +
			" │   └─ Eq\n" +
			" │       ├─ a.i:0!null\n" +
			" │       └─ b.i:2!null\n" +
			" ├─ TableAlias(a)\n" +
			" │   └─ Table\n" +
			" │       ├─ name: mytable\n" +
			" │       └─ columns: [i s]\n" +
			" └─ TableAlias(b)\n" +
			"     └─ Table\n" +
			"         ├─ name: niltable\n" +
			"         └─ columns: [i i2 b f]\n" +
			"",
	},
	{
		Query: "with recursive a as (select 1 union select 2) select * from (select 1 where 1 in (select * from a)) as `temp`",
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: temp\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Project\n" +
			"     ├─ columns: [1 (tinyint)]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1:1!null]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ 1 (tinyint)\n" +
			"             │   └─ scalarSubq0.1:0!null\n" +
			"             ├─ Distinct\n" +
			"             │   └─ SubqueryAlias\n" +
			"             │       ├─ name: scalarSubq0\n" +
			"             │       ├─ outerVisibility: false\n" +
			"             │       ├─ cacheable: true\n" +
			"             │       └─ SubqueryAlias\n" +
			"             │           ├─ name: a\n" +
			"             │           ├─ outerVisibility: true\n" +
			"             │           ├─ cacheable: true\n" +
			"             │           └─ Union distinct\n" +
			"             │               ├─ Project\n" +
			"             │               │   ├─ columns: [1 (tinyint)]\n" +
			"             │               │   └─ Table\n" +
			"             │               │       ├─ name: \n" +
			"             │               │       └─ columns: []\n" +
			"             │               └─ Project\n" +
			"             │                   ├─ columns: [2 (tinyint)]\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: \n" +
			"             │                       └─ columns: []\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(scalarSubq0.1:0!null)\n" +
			"                 ├─ right-key: TUPLE(1 (tinyint))\n" +
			"                 └─ Table\n" +
			"                     ├─ name: \n" +
			"                     └─ columns: []\n" +
			"",
	},
	{
		Query: `SELECT pk,pk1,pk2 FROM one_pk t1, two_pk t2 WHERE pk=1 AND pk2=1 AND pk1=1 ORDER BY 1,2`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [t1.pk:0!null, t2.pk1:6!null, t2.pk2:7!null]\n" +
			" └─ Sort(t1.pk:0!null ASC nullsFirst, t2.pk1:6!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [t1.pk:7!null, t1.c1:8, t1.c2:9, t1.c3:10, t1.c4:11, t1.c5:12, t2.pk1:0!null, t2.pk2:1!null, t2.c1:2!null, t2.c2:3!null, t2.c3:4!null, t2.c4:5!null, t2.c5:6!null]\n" +
			"         └─ Filter\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t2.pk2:1!null\n" +
			"             │   │   └─ 1 (tinyint)\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ t2.pk1:0!null\n" +
			"             │       └─ 1 (tinyint)\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ t2.pk2:1!null\n" +
			"                 │   │   │   └─ 1 (tinyint)\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ t2.pk1:0!null\n" +
			"                 │   │       └─ 1 (tinyint)\n" +
			"                 │   └─ TableAlias(t2)\n" +
			"                 │       └─ IndexedTableAccess(two_pk)\n" +
			"                 │           ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"                 │           ├─ static: [{[1, 1], [1, 1]}]\n" +
			"                 │           └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ t1.pk:0!null\n" +
			"                         │   └─ 1 (tinyint)\n" +
			"                         └─ TableAlias(t1)\n" +
			"                             └─ IndexedTableAccess(one_pk)\n" +
			"                                 ├─ index: [one_pk.pk]\n" +
			"                                 ├─ static: [{[1, 1]}]\n" +
			"                                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `with recursive a as (select 1 union select 2) select * from a union select * from a limit 1;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ limit: 1\n" +
			" ├─ SubqueryAlias\n" +
			" │   ├─ name: a\n" +
			" │   ├─ outerVisibility: false\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Union distinct\n" +
			" │       ├─ Project\n" +
			" │       │   ├─ columns: [1 (tinyint)]\n" +
			" │       │   └─ Table\n" +
			" │       │       ├─ name: \n" +
			" │       │       └─ columns: []\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Union distinct\n" +
			"         ├─ Project\n" +
			"         │   ├─ columns: [1 (tinyint)]\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: \n" +
			"         │       └─ columns: []\n" +
			"         └─ Project\n" +
			"             ├─ columns: [2 (tinyint)]\n" +
			"             └─ Table\n" +
			"                 ├─ name: \n" +
			"                 └─ columns: []\n" +
			"",
	},
	{
		Query: `with recursive a(x) as (select 1 union select 2) select * from a having x > 1 union select * from a having x > 1;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Having\n" +
			" │   ├─ GreaterThan\n" +
			" │   │   ├─ a.x:0!null\n" +
			" │   │   └─ 1 (tinyint)\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: a\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Union distinct\n" +
			" │           ├─ Project\n" +
			" │           │   ├─ columns: [1 (tinyint)]\n" +
			" │           │   └─ Table\n" +
			" │           │       ├─ name: \n" +
			" │           │       └─ columns: []\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [2 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ Having\n" +
			"     ├─ GreaterThan\n" +
			"     │   ├─ a.x:0!null\n" +
			"     │   └─ 1 (tinyint)\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: a\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Union distinct\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [1 (tinyint)]\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: \n" +
			"             │       └─ columns: []\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [2 (tinyint)]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: \n" +
			"                     └─ columns: []\n" +
			"",
	},
	{
		Query: `with recursive a(x) as (select 1 union select 2) select * from a where x > 1 union select * from a where x > 1;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ SubqueryAlias\n" +
			" │   ├─ name: a\n" +
			" │   ├─ outerVisibility: false\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Filter\n" +
			" │       ├─ GreaterThan\n" +
			" │       │   ├─ 1:0!null\n" +
			" │       │   └─ 1 (tinyint)\n" +
			" │       └─ Union distinct\n" +
			" │           ├─ Project\n" +
			" │           │   ├─ columns: [1 (tinyint)]\n" +
			" │           │   └─ Table\n" +
			" │           │       ├─ name: \n" +
			" │           │       └─ columns: []\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [2 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Filter\n" +
			"         ├─ GreaterThan\n" +
			"         │   ├─ 1:0!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ Union distinct\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [1 (tinyint)]\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: \n" +
			"             │       └─ columns: []\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [2 (tinyint)]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: \n" +
			"                     └─ columns: []\n" +
			"",
	},
	{
		Query: `with recursive a(x) as (select 1 union select 2) select * from a union select * from a group by x;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ SubqueryAlias\n" +
			" │   ├─ name: a\n" +
			" │   ├─ outerVisibility: false\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Union distinct\n" +
			" │       ├─ Project\n" +
			" │       │   ├─ columns: [1 (tinyint)]\n" +
			" │       │   └─ Table\n" +
			" │       │       ├─ name: \n" +
			" │       │       └─ columns: []\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ GroupBy\n" +
			"     ├─ select: a.x:0!null\n" +
			"     ├─ group: a.x:0!null\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: a\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Union distinct\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [1 (tinyint)]\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: \n" +
			"             │       └─ columns: []\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [2 (tinyint)]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: \n" +
			"                     └─ columns: []\n" +
			"",
	},
	{
		Query: `with recursive a(x) as (select 1 union select 2) select * from a union select * from a order by x desc;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ sortFields: a.x:0!null\n" +
			" ├─ SubqueryAlias\n" +
			" │   ├─ name: a\n" +
			" │   ├─ outerVisibility: false\n" +
			" │   ├─ cacheable: true\n" +
			" │   └─ Union distinct\n" +
			" │       ├─ Project\n" +
			" │       │   ├─ columns: [1 (tinyint)]\n" +
			" │       │   └─ Table\n" +
			" │       │       ├─ name: \n" +
			" │       │       └─ columns: []\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Union distinct\n" +
			"         ├─ Project\n" +
			"         │   ├─ columns: [1 (tinyint)]\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: \n" +
			"         │       └─ columns: []\n" +
			"         └─ Project\n" +
			"             ├─ columns: [2 (tinyint)]\n" +
			"             └─ Table\n" +
			"                 ├─ name: \n" +
			"                 └─ columns: []\n" +
			"",
	},
	{
		Query: `WITH recursive n(i) as (SELECT 1 UNION ALL SELECT i + 1 FROM n WHERE i+1 <= 10 LIMIT 5) SELECT count(i) FROM n;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(n.i):0!null as count(i)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(n.i:0!null)\n" +
			"     ├─ group: \n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: n\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ RecursiveCTE\n" +
			"             └─ Union all\n" +
			"                 ├─ limit: 5\n" +
			"                 ├─ Project\n" +
			"                 │   ├─ columns: [1 (tinyint)]\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: \n" +
			"                 │       └─ columns: []\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [(n.i:0!null + 1 (tinyint))]\n" +
			"                     └─ Filter\n" +
			"                         ├─ LessThanOrEqual\n" +
			"                         │   ├─ (n.i:0!null + 1 (tinyint))\n" +
			"                         │   └─ 10 (tinyint)\n" +
			"                         └─ RecursiveTable(n)\n" +
			"",
	},
	{
		Query: `WITH recursive n(i) as (SELECT 1 UNION ALL SELECT i + 1 FROM n GROUP BY i HAVING i+1 <= 10) SELECT count(i) FROM n;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(n.i):0!null as count(i)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(n.i:0!null)\n" +
			"     ├─ group: \n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: n\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ RecursiveCTE\n" +
			"             └─ Union all\n" +
			"                 ├─ Project\n" +
			"                 │   ├─ columns: [1 (tinyint)]\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: \n" +
			"                 │       └─ columns: []\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [(n.i:0!null + 1 (tinyint))]\n" +
			"                     └─ Having\n" +
			"                         ├─ LessThanOrEqual\n" +
			"                         │   ├─ (n.i:0!null + 1 (tinyint))\n" +
			"                         │   └─ 10 (tinyint)\n" +
			"                         └─ GroupBy\n" +
			"                             ├─ select: n.i:0!null\n" +
			"                             ├─ group: n.i:0!null\n" +
			"                             └─ RecursiveTable(n)\n" +
			"",
	},
	{
		Query: `WITH recursive n(i) as (SELECT 1 UNION ALL SELECT i + 1 FROM n WHERE i+1 <= 10 LIMIT 1) SELECT count(i) FROM n;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(n.i):0!null as count(i)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(n.i:0!null)\n" +
			"     ├─ group: \n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: n\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ RecursiveCTE\n" +
			"             └─ Union all\n" +
			"                 ├─ limit: 1\n" +
			"                 ├─ Project\n" +
			"                 │   ├─ columns: [1 (tinyint)]\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: \n" +
			"                 │       └─ columns: []\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [(n.i:0!null + 1 (tinyint))]\n" +
			"                     └─ Filter\n" +
			"                         ├─ LessThanOrEqual\n" +
			"                         │   ├─ (n.i:0!null + 1 (tinyint))\n" +
			"                         │   └─ 10 (tinyint)\n" +
			"                         └─ RecursiveTable(n)\n" +
			"",
	},
	{
		Query: "with recursive a as (select 1 union select 2) select * from (select 1 where 1 in (select * from a)) as `temp`",
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: temp\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Project\n" +
			"     ├─ columns: [1 (tinyint)]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1:1!null]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ 1 (tinyint)\n" +
			"             │   └─ scalarSubq0.1:0!null\n" +
			"             ├─ Distinct\n" +
			"             │   └─ SubqueryAlias\n" +
			"             │       ├─ name: scalarSubq0\n" +
			"             │       ├─ outerVisibility: false\n" +
			"             │       ├─ cacheable: true\n" +
			"             │       └─ SubqueryAlias\n" +
			"             │           ├─ name: a\n" +
			"             │           ├─ outerVisibility: true\n" +
			"             │           ├─ cacheable: true\n" +
			"             │           └─ Union distinct\n" +
			"             │               ├─ Project\n" +
			"             │               │   ├─ columns: [1 (tinyint)]\n" +
			"             │               │   └─ Table\n" +
			"             │               │       ├─ name: \n" +
			"             │               │       └─ columns: []\n" +
			"             │               └─ Project\n" +
			"             │                   ├─ columns: [2 (tinyint)]\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: \n" +
			"             │                       └─ columns: []\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(scalarSubq0.1:0!null)\n" +
			"                 ├─ right-key: TUPLE(1 (tinyint))\n" +
			"                 └─ Table\n" +
			"                     ├─ name: \n" +
			"                     └─ columns: []\n" +
			"",
	},
	{
		Query: `select 1 union select * from (select 2 union select 3) a union select 4;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Union distinct\n" +
			" │   ├─ Project\n" +
			" │   │   ├─ columns: [1 (tinyint)]\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: \n" +
			" │   │       └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: a\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Union distinct\n" +
			" │           ├─ Project\n" +
			" │           │   ├─ columns: [2 (tinyint)]\n" +
			" │           │   └─ Table\n" +
			" │           │       ├─ name: \n" +
			" │           │       └─ columns: []\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [3 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ Project\n" +
			"     ├─ columns: [4 (tinyint)]\n" +
			"     └─ Table\n" +
			"         ├─ name: \n" +
			"         └─ columns: []\n" +
			"",
	},
	{
		Query: `select 1 union select * from (select 2 union select 3) a union select 4;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Union distinct\n" +
			" │   ├─ Project\n" +
			" │   │   ├─ columns: [1 (tinyint)]\n" +
			" │   │   └─ Table\n" +
			" │   │       ├─ name: \n" +
			" │   │       └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: a\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Union distinct\n" +
			" │           ├─ Project\n" +
			" │           │   ├─ columns: [2 (tinyint)]\n" +
			" │           │   └─ Table\n" +
			" │           │       ├─ name: \n" +
			" │           │       └─ columns: []\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [3 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ Project\n" +
			"     ├─ columns: [4 (tinyint)]\n" +
			"     └─ Table\n" +
			"         ├─ name: \n" +
			"         └─ columns: []\n" +
			"",
	},
	{
		Query: `With recursive a(x) as (select 1 union select 4 union select * from (select 2 union select 3) b union select x+1 from a where x < 10) select count(*) from a;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as count(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: a\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ RecursiveCTE\n" +
			"             └─ Union distinct\n" +
			"                 ├─ Union distinct\n" +
			"                 │   ├─ Union distinct\n" +
			"                 │   │   ├─ Project\n" +
			"                 │   │   │   ├─ columns: [1 (tinyint)]\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: \n" +
			"                 │   │   │       └─ columns: []\n" +
			"                 │   │   └─ Project\n" +
			"                 │   │       ├─ columns: [4 (tinyint)]\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: \n" +
			"                 │   │           └─ columns: []\n" +
			"                 │   └─ SubqueryAlias\n" +
			"                 │       ├─ name: b\n" +
			"                 │       ├─ outerVisibility: false\n" +
			"                 │       ├─ cacheable: true\n" +
			"                 │       └─ Union distinct\n" +
			"                 │           ├─ Project\n" +
			"                 │           │   ├─ columns: [2 (tinyint)]\n" +
			"                 │           │   └─ Table\n" +
			"                 │           │       ├─ name: \n" +
			"                 │           │       └─ columns: []\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [3 (tinyint)]\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: \n" +
			"                 │                   └─ columns: []\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [(a.x:0!null + 1 (tinyint))]\n" +
			"                     └─ Filter\n" +
			"                         ├─ LessThan\n" +
			"                         │   ├─ a.x:0!null\n" +
			"                         │   └─ 10 (tinyint)\n" +
			"                         └─ RecursiveTable(a)\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1), b(i) as (select 2) select j from a union (select i from b order by 1 desc) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Union distinct\n" +
			" │   ├─ SubqueryAlias\n" +
			" │   │   ├─ name: a\n" +
			" │   │   ├─ outerVisibility: false\n" +
			" │   │   ├─ cacheable: true\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [1 (tinyint)]\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: \n" +
			" │   │           └─ columns: []\n" +
			" │   └─ Sort(b.i:0!null DESC nullsFirst)\n" +
			" │       └─ SubqueryAlias\n" +
			" │           ├─ name: b\n" +
			" │           ├─ outerVisibility: false\n" +
			" │           ├─ cacheable: true\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [2 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1 (tinyint)]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1), b(i) as (select 2) (select t1.j as k from a t1 join a t2 on t1.j = t2.j union select i from b order by k desc limit 1) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ sortFields: k:0!null\n" +
			" ├─ limit: 1\n" +
			" ├─ Union distinct\n" +
			" │   ├─ Project\n" +
			" │   │   ├─ columns: [k:2!null]\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [t1.j:1!null, t2.j:0!null, t1.j:1!null as k]\n" +
			" │   │       └─ HashJoin\n" +
			" │   │           ├─ Eq\n" +
			" │   │           │   ├─ t1.j:1!null\n" +
			" │   │           │   └─ t2.j:0!null\n" +
			" │   │           ├─ SubqueryAlias\n" +
			" │   │           │   ├─ name: t2\n" +
			" │   │           │   ├─ outerVisibility: false\n" +
			" │   │           │   ├─ cacheable: true\n" +
			" │   │           │   └─ Project\n" +
			" │   │           │       ├─ columns: [1 (tinyint)]\n" +
			" │   │           │       └─ Table\n" +
			" │   │           │           ├─ name: \n" +
			" │   │           │           └─ columns: []\n" +
			" │   │           └─ HashLookup\n" +
			" │   │               ├─ left-key: TUPLE(t2.j:0!null)\n" +
			" │   │               ├─ right-key: TUPLE(t1.j:0!null)\n" +
			" │   │               └─ SubqueryAlias\n" +
			" │   │                   ├─ name: t1\n" +
			" │   │                   ├─ outerVisibility: false\n" +
			" │   │                   ├─ cacheable: true\n" +
			" │   │                   └─ Project\n" +
			" │   │                       ├─ columns: [1 (tinyint)]\n" +
			" │   │                       └─ Table\n" +
			" │   │                           ├─ name: \n" +
			" │   │                           └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: b\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1 (tinyint)]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1 union select 2 union select 3), b(i) as (select 2 union select 3) (select t1.j as k from a t1 join a t2 on t1.j = t2.j union select i from b order by k desc limit 2) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ sortFields: k:0!null\n" +
			" ├─ limit: 2\n" +
			" ├─ Union distinct\n" +
			" │   ├─ Project\n" +
			" │   │   ├─ columns: [k:2!null]\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [t1.j:1!null, t2.j:0!null, t1.j:1!null as k]\n" +
			" │   │       └─ HashJoin\n" +
			" │   │           ├─ Eq\n" +
			" │   │           │   ├─ t1.j:1!null\n" +
			" │   │           │   └─ t2.j:0!null\n" +
			" │   │           ├─ SubqueryAlias\n" +
			" │   │           │   ├─ name: t2\n" +
			" │   │           │   ├─ outerVisibility: false\n" +
			" │   │           │   ├─ cacheable: true\n" +
			" │   │           │   └─ Union distinct\n" +
			" │   │           │       ├─ Union distinct\n" +
			" │   │           │       │   ├─ Project\n" +
			" │   │           │       │   │   ├─ columns: [1 (tinyint)]\n" +
			" │   │           │       │   │   └─ Table\n" +
			" │   │           │       │   │       ├─ name: \n" +
			" │   │           │       │   │       └─ columns: []\n" +
			" │   │           │       │   └─ Project\n" +
			" │   │           │       │       ├─ columns: [2 (tinyint)]\n" +
			" │   │           │       │       └─ Table\n" +
			" │   │           │       │           ├─ name: \n" +
			" │   │           │       │           └─ columns: []\n" +
			" │   │           │       └─ Project\n" +
			" │   │           │           ├─ columns: [3 (tinyint)]\n" +
			" │   │           │           └─ Table\n" +
			" │   │           │               ├─ name: \n" +
			" │   │           │               └─ columns: []\n" +
			" │   │           └─ HashLookup\n" +
			" │   │               ├─ left-key: TUPLE(t2.j:0!null)\n" +
			" │   │               ├─ right-key: TUPLE(t1.j:0!null)\n" +
			" │   │               └─ SubqueryAlias\n" +
			" │   │                   ├─ name: t1\n" +
			" │   │                   ├─ outerVisibility: false\n" +
			" │   │                   ├─ cacheable: true\n" +
			" │   │                   └─ Union distinct\n" +
			" │   │                       ├─ Union distinct\n" +
			" │   │                       │   ├─ Project\n" +
			" │   │                       │   │   ├─ columns: [1 (tinyint)]\n" +
			" │   │                       │   │   └─ Table\n" +
			" │   │                       │   │       ├─ name: \n" +
			" │   │                       │   │       └─ columns: []\n" +
			" │   │                       │   └─ Project\n" +
			" │   │                       │       ├─ columns: [2 (tinyint)]\n" +
			" │   │                       │       └─ Table\n" +
			" │   │                       │           ├─ name: \n" +
			" │   │                       │           └─ columns: []\n" +
			" │   │                       └─ Project\n" +
			" │   │                           ├─ columns: [3 (tinyint)]\n" +
			" │   │                           └─ Table\n" +
			" │   │                               ├─ name: \n" +
			" │   │                               └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: b\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Union distinct\n" +
			" │           ├─ Project\n" +
			" │           │   ├─ columns: [2 (tinyint)]\n" +
			" │           │   └─ Table\n" +
			" │           │       ├─ name: \n" +
			" │           │       └─ columns: []\n" +
			" │           └─ Project\n" +
			" │               ├─ columns: [3 (tinyint)]\n" +
			" │               └─ Table\n" +
			" │                   ├─ name: \n" +
			" │                   └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Union distinct\n" +
			"         ├─ Union distinct\n" +
			"         │   ├─ Project\n" +
			"         │   │   ├─ columns: [1 (tinyint)]\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: \n" +
			"         │   │       └─ columns: []\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [2 (tinyint)]\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: \n" +
			"         │           └─ columns: []\n" +
			"         └─ Project\n" +
			"             ├─ columns: [3 (tinyint)]\n" +
			"             └─ Table\n" +
			"                 ├─ name: \n" +
			"                 └─ columns: []\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1), b(i) as (select 2) (select j from a union select i from b order by j desc limit 1) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ sortFields: a.j:0!null\n" +
			" ├─ limit: 1\n" +
			" ├─ Union distinct\n" +
			" │   ├─ SubqueryAlias\n" +
			" │   │   ├─ name: a\n" +
			" │   │   ├─ outerVisibility: false\n" +
			" │   │   ├─ cacheable: true\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [1 (tinyint)]\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: \n" +
			" │   │           └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: b\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1 (tinyint)]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1), b(i) as (select 2) (select j from a union select i from b order by 1 limit 1) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ sortFields: a.j:0!null\n" +
			" ├─ limit: 1\n" +
			" ├─ Union distinct\n" +
			" │   ├─ SubqueryAlias\n" +
			" │   │   ├─ name: a\n" +
			" │   │   ├─ outerVisibility: false\n" +
			" │   │   ├─ cacheable: true\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [1 (tinyint)]\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: \n" +
			" │   │           └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: b\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [2 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1 (tinyint)]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `with a(j) as (select 1), b(i) as (select 1) (select j from a union all select i from b) union select j from a;`,
		ExpectedPlan: "Union distinct\n" +
			" ├─ Union all\n" +
			" │   ├─ SubqueryAlias\n" +
			" │   │   ├─ name: a\n" +
			" │   │   ├─ outerVisibility: false\n" +
			" │   │   ├─ cacheable: true\n" +
			" │   │   └─ Project\n" +
			" │   │       ├─ columns: [1 (tinyint)]\n" +
			" │   │       └─ Table\n" +
			" │   │           ├─ name: \n" +
			" │   │           └─ columns: []\n" +
			" │   └─ SubqueryAlias\n" +
			" │       ├─ name: b\n" +
			" │       ├─ outerVisibility: false\n" +
			" │       ├─ cacheable: true\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [1 (tinyint)]\n" +
			" │           └─ Table\n" +
			" │               ├─ name: \n" +
			" │               └─ columns: []\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: a\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [1 (tinyint)]\n" +
			"         └─ Table\n" +
			"             ├─ name: \n" +
			"             └─ columns: []\n" +
			"",
	},
	{
		Query: `
With c as (
  select * from (
    select a.s
    From mytable a
    Join (
      Select t2.*
      From mytable t2
      Where t2.i in (1,2)
    ) b
    On a.i = b.i
    Join (
      select t1.*
      from mytable t1
      Where t1.I in (2,3)
    ) e
    On b.I = e.i
  ) d
) select * from c;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: c\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: d\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [a.s:1!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [a.i:4!null, a.s:5!null, b.i:2!null, b.s:3!null, e.i:0!null, e.s:1!null]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ b.i:2!null\n" +
			"                 │   │   └─ e.i:0!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ a.i:4!null\n" +
			"                 │       └─ e.i:0!null\n" +
			"                 ├─ SubqueryAlias\n" +
			"                 │   ├─ name: e\n" +
			"                 │   ├─ outerVisibility: false\n" +
			"                 │   ├─ cacheable: true\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ HashIn\n" +
			"                 │       │   ├─ t1.i:0!null\n" +
			"                 │       │   └─ TUPLE(2 (tinyint), 3 (tinyint))\n" +
			"                 │       └─ TableAlias(t1)\n" +
			"                 │           └─ IndexedTableAccess(mytable)\n" +
			"                 │               ├─ index: [mytable.i]\n" +
			"                 │               ├─ static: [{[2, 2]}, {[3, 3]}]\n" +
			"                 │               └─ columns: [i s]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(e.i:0!null, e.i:0!null)\n" +
			"                     ├─ right-key: TUPLE(b.i:0!null, a.i:2!null)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ a.i:4!null\n" +
			"                         │   └─ b.i:2!null\n" +
			"                         ├─ SubqueryAlias\n" +
			"                         │   ├─ name: b\n" +
			"                         │   ├─ outerVisibility: false\n" +
			"                         │   ├─ cacheable: true\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ HashIn\n" +
			"                         │       │   ├─ t2.i:0!null\n" +
			"                         │       │   └─ TUPLE(1 (tinyint), 2 (tinyint))\n" +
			"                         │       └─ TableAlias(t2)\n" +
			"                         │           └─ IndexedTableAccess(mytable)\n" +
			"                         │               ├─ index: [mytable.i]\n" +
			"                         │               ├─ static: [{[1, 1]}, {[2, 2]}]\n" +
			"                         │               └─ columns: [i s]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(b.i:2!null)\n" +
			"                             ├─ right-key: TUPLE(a.i:0!null)\n" +
			"                             └─ TableAlias(a)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: mytable\n" +
			"                                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM mytable LIMIT 1) sq WHERE i = 3;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ Eq\n" +
			"     │   ├─ mytable.i:0!null\n" +
			"     │   └─ 3 (tinyint)\n" +
			"     └─ Limit(1)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [mytable.i:0!null]\n" +
			"             └─ Table\n" +
			"                 ├─ name: mytable\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM (SELECT i FROM mytable LIMIT 1) sq1) sq2 WHERE i = 3;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq2\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq1\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ 3 (tinyint)\n" +
			"         └─ Limit(1)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [mytable.i:0!null]\n" +
			"                 └─ Table\n" +
			"                     ├─ name: mytable\n" +
			"                     └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM mytable ORDER BY i DESC LIMIT 1) sq WHERE i = 3;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ Eq\n" +
			"     │   ├─ mytable.i:0!null\n" +
			"     │   └─ 3 (tinyint)\n" +
			"     └─ Limit(1)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [mytable.i:0!null]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{[NULL, ∞)}]\n" +
			"                 ├─ columns: [i s]\n" +
			"                 └─ reverse: true\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM (SELECT i FROM mytable ORDER BY i DESC  LIMIT 1) sq1) sq2 WHERE i = 3;`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq2\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq1\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ mytable.i:0!null\n" +
			"         │   └─ 3 (tinyint)\n" +
			"         └─ Limit(1)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [mytable.i:0!null]\n" +
			"                 └─ IndexedTableAccess(mytable)\n" +
			"                     ├─ index: [mytable.i]\n" +
			"                     ├─ static: [{[NULL, ∞)}]\n" +
			"                     ├─ columns: [i s]\n" +
			"                     └─ reverse: true\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM mytable WHERE i > 1) sq LIMIT 1;`,
		ExpectedPlan: "Limit(1)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ Project\n" +
			"         ├─ columns: [mytable.i:0!null]\n" +
			"         └─ IndexedTableAccess(mytable)\n" +
			"             ├─ index: [mytable.i]\n" +
			"             ├─ static: [{(1, ∞)}]\n" +
			"             └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM (SELECT i FROM mytable WHERE i > 1) sq1) sq2 LIMIT 1;`,
		ExpectedPlan: "Limit(1)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq2\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: sq1\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Project\n" +
			"             ├─ columns: [mytable.i:0!null]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{(1, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM (SELECT i FROM mytable) sq1 WHERE i > 1) sq2 LIMIT 1;`,
		ExpectedPlan: "Limit(1)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq2\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: sq1\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Project\n" +
			"             ├─ columns: [mytable.i:0!null]\n" +
			"             └─ IndexedTableAccess(mytable)\n" +
			"                 ├─ index: [mytable.i]\n" +
			"                 ├─ static: [{(1, ∞)}]\n" +
			"                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT i FROM (SELECT i FROM (SELECT i FROM mytable LIMIT 1) sq1 WHERE i > 1) sq2 LIMIT 10;`,
		ExpectedPlan: "Limit(10)\n" +
			" └─ SubqueryAlias\n" +
			"     ├─ name: sq2\n" +
			"     ├─ outerVisibility: false\n" +
			"     ├─ cacheable: true\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: sq1\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Filter\n" +
			"             ├─ GreaterThan\n" +
			"             │   ├─ mytable.i:0!null\n" +
			"             │   └─ 1 (tinyint)\n" +
			"             └─ Limit(1)\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [mytable.i:0!null]\n" +
			"                     └─ Table\n" +
			"                         ├─ name: mytable\n" +
			"                         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT a.pk, b.i FROM one_pk a JOIN mytable b ORDER BY a.pk ASC, b.i ASC LIMIT 1) sq WHERE i != 0`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ NOT\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ b.i:1!null\n" +
			"     │       └─ 0 (tinyint)\n" +
			"     └─ Limit(1)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [a.pk:0!null, b.i:6!null]\n" +
			"             └─ Sort(a.pk:0!null ASC nullsFirst, b.i:6!null ASC nullsFirst)\n" +
			"                 └─ CrossHashJoin\n" +
			"                     ├─ TableAlias(a)\n" +
			"                     │   └─ Table\n" +
			"                     │       ├─ name: one_pk\n" +
			"                     │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE()\n" +
			"                         ├─ right-key: TUPLE()\n" +
			"                         └─ TableAlias(b)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: mytable\n" +
			"                                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT a.pk, b.i FROM one_pk a JOIN mytable b ORDER BY a.pk DESC, b.i DESC LIMIT 1) sq WHERE i != 0`,
		ExpectedPlan: "SubqueryAlias\n" +
			" ├─ name: sq\n" +
			" ├─ outerVisibility: false\n" +
			" ├─ cacheable: true\n" +
			" └─ Filter\n" +
			"     ├─ NOT\n" +
			"     │   └─ Eq\n" +
			"     │       ├─ b.i:1!null\n" +
			"     │       └─ 0 (tinyint)\n" +
			"     └─ Limit(1)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [a.pk:0!null, b.i:6!null]\n" +
			"             └─ Sort(a.pk:0!null DESC nullsFirst, b.i:6!null DESC nullsFirst)\n" +
			"                 └─ CrossHashJoin\n" +
			"                     ├─ TableAlias(a)\n" +
			"                     │   └─ Table\n" +
			"                     │       ├─ name: one_pk\n" +
			"                     │       └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE()\n" +
			"                         ├─ right-key: TUPLE()\n" +
			"                         └─ TableAlias(b)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: mytable\n" +
			"                                 └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT * FROM (SELECT pk FROM one_pk WHERE pk < 2 LIMIT 1) a JOIN (SELECT i FROM mytable WHERE i > 1 LIMIT 1) b WHERE pk >= 2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.pk:1!null, b.i:0!null]\n" +
			" └─ CrossHashJoin\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: b\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ Limit(1)\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [mytable.i:0!null]\n" +
			"     │           └─ IndexedTableAccess(mytable)\n" +
			"     │               ├─ index: [mytable.i]\n" +
			"     │               ├─ static: [{(1, ∞)}]\n" +
			"     │               └─ columns: [i s]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE()\n" +
			"         ├─ right-key: TUPLE()\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: a\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThanOrEqual\n" +
			"                 │   ├─ one_pk.pk:0!null\n" +
			"                 │   └─ 2 (tinyint)\n" +
			"                 └─ Limit(1)\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [one_pk.pk:0!null]\n" +
			"                         └─ Filter\n" +
			"                             ├─ LessThan\n" +
			"                             │   ├─ one_pk.pk:0!null\n" +
			"                             │   └─ 2 (tinyint)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: one_pk\n" +
			"                                 └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `
SELECT COUNT(*)
FROM keyless
WHERE keyless.c0 IN (
    WITH RECURSIVE cte(depth, i, j) AS (
        SELECT 0, T1.c0, T1.c1
        FROM keyless T1
        WHERE T1.c0 = 0

        UNION ALL

        SELECT cte.depth + 1, cte.i, T2.c1 + 1
        FROM cte, keyless T2
        WHERE cte.depth = T2.c0
    )

    SELECT U0.c0
    FROM keyless U0, cte
    WHERE cte.j = keyless.c0
);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as COUNT(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ InSubquery\n" +
			"         │   ├─ left: keyless.c0:0\n" +
			"         │   └─ right: Subquery\n" +
			"         │       ├─ cacheable: false\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [u0.c0:2]\n" +
			"         │           └─ Project\n" +
			"         │               ├─ columns: [u0.c0:5, u0.c1:6, cte.depth:2!null, cte.i:3, cte.j:4]\n" +
			"         │               └─ Filter\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ cte.j:4\n" +
			"         │                   │   └─ keyless.c0:0\n" +
			"         │                   └─ CrossHashJoin\n" +
			"         │                       ├─ SubqueryAlias\n" +
			"         │                       │   ├─ name: cte\n" +
			"         │                       │   ├─ outerVisibility: true\n" +
			"         │                       │   ├─ cacheable: true\n" +
			"         │                       │   └─ RecursiveCTE\n" +
			"         │                       │       └─ Union all\n" +
			"         │                       │           ├─ Project\n" +
			"         │                       │           │   ├─ columns: [0 (tinyint), t1.c0:2, t1.c1:3]\n" +
			"         │                       │           │   └─ Filter\n" +
			"         │                       │           │       ├─ Eq\n" +
			"         │                       │           │       │   ├─ t1.c0:2\n" +
			"         │                       │           │       │   └─ 0 (tinyint)\n" +
			"         │                       │           │       └─ TableAlias(t1)\n" +
			"         │                       │           │           └─ Table\n" +
			"         │                       │           │               ├─ name: keyless\n" +
			"         │                       │           │               └─ columns: [c0 c1]\n" +
			"         │                       │           └─ Project\n" +
			"         │                       │               ├─ columns: [(cte.depth:2!null + 1 (tinyint)), cte.i:3, (t2.c1:6 + 1 (tinyint))]\n" +
			"         │                       │               └─ HashJoin\n" +
			"         │                       │                   ├─ Eq\n" +
			"         │                       │                   │   ├─ cte.depth:2!null\n" +
			"         │                       │                   │   └─ t2.c0:5\n" +
			"         │                       │                   ├─ RecursiveTable(cte)\n" +
			"         │                       │                   └─ HashLookup\n" +
			"         │                       │                       ├─ left-key: TUPLE(cte.depth:2!null)\n" +
			"         │                       │                       ├─ right-key: TUPLE(t2.c0:2)\n" +
			"         │                       │                       └─ TableAlias(t2)\n" +
			"         │                       │                           └─ Table\n" +
			"         │                       │                               ├─ name: keyless\n" +
			"         │                       │                               └─ columns: [c0 c1]\n" +
			"         │                       └─ HashLookup\n" +
			"         │                           ├─ left-key: TUPLE()\n" +
			"         │                           ├─ right-key: TUPLE()\n" +
			"         │                           └─ TableAlias(u0)\n" +
			"         │                               └─ Table\n" +
			"         │                                   ├─ name: keyless\n" +
			"         │                                   └─ columns: [c0 c1]\n" +
			"         └─ Table\n" +
			"             ├─ name: keyless\n" +
			"             └─ columns: [c0 c1]\n" +
			"",
	},
	{
		Query: `
SELECT COUNT(*)
FROM keyless
WHERE keyless.c0 IN (
    WITH RECURSIVE cte(depth, i, j) AS (
        SELECT 0, T1.c0, T1.c1
        FROM keyless T1
        WHERE T1.c0 = 0

        UNION ALL

        SELECT cte.depth + 1, cte.i, T2.c1 + 1
        FROM cte, keyless T2
        WHERE cte.depth = T2.c0
    )

    SELECT U0.c0
    FROM cte, keyless U0
    WHERE cte.j = keyless.c0
);`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as COUNT(*)]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: COUNT(1 (bigint))\n" +
			"     ├─ group: \n" +
			"     └─ Filter\n" +
			"         ├─ InSubquery\n" +
			"         │   ├─ left: keyless.c0:0\n" +
			"         │   └─ right: Subquery\n" +
			"         │       ├─ cacheable: false\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [u0.c0:5]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ Eq\n" +
			"         │               │   ├─ cte.j:4\n" +
			"         │               │   └─ keyless.c0:0\n" +
			"         │               └─ CrossHashJoin\n" +
			"         │                   ├─ SubqueryAlias\n" +
			"         │                   │   ├─ name: cte\n" +
			"         │                   │   ├─ outerVisibility: true\n" +
			"         │                   │   ├─ cacheable: true\n" +
			"         │                   │   └─ RecursiveCTE\n" +
			"         │                   │       └─ Union all\n" +
			"         │                   │           ├─ Project\n" +
			"         │                   │           │   ├─ columns: [0 (tinyint), t1.c0:2, t1.c1:3]\n" +
			"         │                   │           │   └─ Filter\n" +
			"         │                   │           │       ├─ Eq\n" +
			"         │                   │           │       │   ├─ t1.c0:2\n" +
			"         │                   │           │       │   └─ 0 (tinyint)\n" +
			"         │                   │           │       └─ TableAlias(t1)\n" +
			"         │                   │           │           └─ Table\n" +
			"         │                   │           │               ├─ name: keyless\n" +
			"         │                   │           │               └─ columns: [c0 c1]\n" +
			"         │                   │           └─ Project\n" +
			"         │                   │               ├─ columns: [(cte.depth:2!null + 1 (tinyint)), cte.i:3, (t2.c1:6 + 1 (tinyint))]\n" +
			"         │                   │               └─ HashJoin\n" +
			"         │                   │                   ├─ Eq\n" +
			"         │                   │                   │   ├─ cte.depth:2!null\n" +
			"         │                   │                   │   └─ t2.c0:5\n" +
			"         │                   │                   ├─ RecursiveTable(cte)\n" +
			"         │                   │                   └─ HashLookup\n" +
			"         │                   │                       ├─ left-key: TUPLE(cte.depth:2!null)\n" +
			"         │                   │                       ├─ right-key: TUPLE(t2.c0:2)\n" +
			"         │                   │                       └─ TableAlias(t2)\n" +
			"         │                   │                           └─ Table\n" +
			"         │                   │                               ├─ name: keyless\n" +
			"         │                   │                               └─ columns: [c0 c1]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: TUPLE()\n" +
			"         │                       ├─ right-key: TUPLE()\n" +
			"         │                       └─ TableAlias(u0)\n" +
			"         │                           └─ Table\n" +
			"         │                               ├─ name: keyless\n" +
			"         │                               └─ columns: [c0 c1]\n" +
			"         └─ Table\n" +
			"             ├─ name: keyless\n" +
			"             └─ columns: [c0 c1]\n" +
			"",
	},
	{
		Query: `SELECT s,i FROM mytable as a order by i;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [a.s:1!null, a.i:0!null]\n" +
			" └─ TableAlias(a)\n" +
			"     └─ IndexedTableAccess(mytable)\n" +
			"         ├─ index: [mytable.i]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [i s]\n" +
			"",
	},
	{
		Query: `SELECT s,i FROM mytable order by i DESC;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [mytable.s:1!null, mytable.i:0!null]\n" +
			" └─ IndexedTableAccess(mytable)\n" +
			"     ├─ index: [mytable.i]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     ├─ columns: [i s]\n" +
			"     └─ reverse: true\n" +
			"",
	},
	{
		Query: `SELECT pk1, pk2 FROM two_pk order by pk1 asc, pk2 asc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [two_pk.pk1:0!null, two_pk.pk2:1!null]\n" +
			" └─ IndexedTableAccess(two_pk)\n" +
			"     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"     └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk1, pk2 FROM two_pk order by pk1 asc, pk2 desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [two_pk.pk1:0!null, two_pk.pk2:1!null]\n" +
			" └─ Sort(two_pk.pk1:0!null ASC nullsFirst, two_pk.pk2:1!null DESC nullsFirst)\n" +
			"     └─ Table\n" +
			"         ├─ name: two_pk\n" +
			"         └─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT pk1, pk2 FROM two_pk order by pk1 desc, pk2 desc;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [two_pk.pk1:0!null, two_pk.pk2:1!null]\n" +
			" └─ IndexedTableAccess(two_pk)\n" +
			"     ├─ index: [two_pk.pk1,two_pk.pk2]\n" +
			"     ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"     ├─ columns: [pk1 pk2 c1 c2 c3 c4 c5]\n" +
			"     └─ reverse: true\n" +
			"",
	},
	{
		Query: `SELECT pk1, pk2 FROM two_pk group by pk1, pk2 order by pk1, pk2;`,
		ExpectedPlan: "Sort(two_pk.pk1:0!null ASC nullsFirst, two_pk.pk2:1!null ASC nullsFirst)\n" +
			" └─ GroupBy\n" +
			"     ├─ select: two_pk.pk1:0!null, two_pk.pk2:1!null\n" +
			"     ├─ group: two_pk.pk1:0!null, two_pk.pk2:1!null\n" +
			"     └─ Table\n" +
			"         ├─ name: two_pk\n" +
			"         └─ columns: [pk1 pk2]\n" +
			"",
	},
	{
		Query: `SELECT pk1, pk2 FROM two_pk group by pk1, pk2 order by pk1 desc, pk2 desc;`,
		ExpectedPlan: "Sort(two_pk.pk1:0!null DESC nullsFirst, two_pk.pk2:1!null DESC nullsFirst)\n" +
			" └─ GroupBy\n" +
			"     ├─ select: two_pk.pk1:0!null, two_pk.pk2:1!null\n" +
			"     ├─ group: two_pk.pk1:0!null, two_pk.pk2:1!null\n" +
			"     └─ Table\n" +
			"         ├─ name: two_pk\n" +
			"         └─ columns: [pk1 pk2]\n" +
			"",
	},
	{
		Query: `select pk1, pk2, row_number() over (partition by pk1 order by c1 desc) from two_pk order by 1,2;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [two_pk.pk1:1!null, two_pk.pk2:2!null, row_number() over ( partition by two_pk.pk1 order by two_pk.c1 desc):0!null as row_number() over (partition by pk1 order by c1 desc)]\n" +
			" └─ Sort(two_pk.pk1:1!null ASC nullsFirst, two_pk.pk2:2!null ASC nullsFirst)\n" +
			"     └─ Window\n" +
			"         ├─ row_number() over ( partition by two_pk.pk1 order by two_pk.c1 DESC)\n" +
			"         ├─ two_pk.pk1:0!null\n" +
			"         ├─ two_pk.pk2:1!null\n" +
			"         └─ Table\n" +
			"             ├─ name: two_pk\n" +
			"             └─ columns: [pk1 pk2 c1]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk ORDER BY pk LIMIT 0, 10;`,
		ExpectedPlan: "Limit(10)\n" +
			" └─ IndexedTableAccess(one_pk)\n" +
			"     ├─ index: [one_pk.pk]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
	{
		Query: `SELECT * FROM one_pk ORDER BY pk LIMIT 5, 10;`,
		ExpectedPlan: "Limit(10)\n" +
			" └─ Offset(5)\n" +
			"     └─ IndexedTableAccess(one_pk)\n" +
			"         ├─ index: [one_pk.pk]\n" +
			"         ├─ filters: [{[NULL, ∞)}]\n" +
			"         └─ columns: [pk c1 c2 c3 c4 c5]\n" +
			"",
	},
}

// QueryPlanTODOs are queries where the query planner produces a correct (results) but suboptimal plan.
var QueryPlanTODOs = []QueryPlanTest{
	{
		// TODO: this should use an index. Extra join condition should get moved out of the join clause into a filter
		Query: `SELECT pk,i,f FROM one_pk RIGHT JOIN niltable ON pk=i and pk > 0 ORDER BY 2,3`,
		ExpectedPlan: "Sort(niltable.i ASC, niltable.f ASC)\n" +
			" └─ Project(one_pk.pk, niltable.i, niltable.f)\n" +
			"     └─ RightJoin((one_pk.pk = niltable.i) AND (one_pk.pk > 0))\n" +
			"         ├─ Projected table access on [pk]\n" +
			"         │   └─ Table(one_pk)\n" +
			"         └─ Projected table access on [i f]\n" +
			"             └─ Table(niltable)\n" +
			"",
	},
}

// IntegrationPlanTests is a test of generating the right query plans for more complex queries that closely represent
// real use cases by customers. Like other query plan tests, these tests are fragile because they rely on string
// representations of query plans, but they're much easier to construct this way. To regenerate these plans after
// analyzer changes, use the TestWriteIntegrationQueryPlans function in testgen_test.go.
var IntegrationPlanTests = []QueryPlanTest{
	{
		Query: `
SELECT
    id, FTQLQ
FROM
    YK2GW
WHERE
    id NOT IN (SELECT IXUXU FROM THNTS)
;`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [yk2gw.id:0!null, yk2gw.ftqlq:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [yk2gw.id:0!null, YK2GW.FTQLQ:1!null, YK2GW.TUXML:2, YK2GW.PAEF5:3, YK2GW.RUCY4:4, YK2GW.TPNJ6:5!null, YK2GW.LBL53:6, YK2GW.NB3QS:7, YK2GW.EO7IV:8, YK2GW.MUHJF:9, YK2GW.FM34L:10, YK2GW.TY5RF:11, YK2GW.ZHTLH:12, YK2GW.NPB7W:13, YK2GW.SX3HH:14, YK2GW.ISBNF:15, YK2GW.YA7YB:16, YK2GW.C5YKB:17, YK2GW.QK7KT:18, YK2GW.FFGE6:19, YK2GW.FIIGJ:20, YK2GW.SH3NC:21, YK2GW.NTENA:22, YK2GW.M4AUB:23, YK2GW.X5AIR:24, YK2GW.SAB6M:25, YK2GW.G5QI5:26, YK2GW.ZVQVD:27, YK2GW.YKSSU:28, YK2GW.FHCYT:29]\n" +
			"     └─ Filter\n" +
			"         ├─ scalarSubq0.ixuxu:30 IS NULL\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ yk2gw.id:0!null\n" +
			"             │   └─ scalarSubq0.ixuxu:30\n" +
			"             ├─ IndexedTableAccess(YK2GW)\n" +
			"             │   ├─ index: [YK2GW.id]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [scalarSubq0.ixuxu:2]\n" +
			"                 └─ TableAlias(scalarSubq0)\n" +
			"                     └─ IndexedTableAccess(THNTS)\n" +
			"                         ├─ index: [THNTS.IXUXU]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   PBMRX.id AS id,
	   PBMRX.TW55N AS TEYBZ,
	   PBMRX.ZH72S AS FB6N7
	FROM
	   (
	       SELECT
	           ZH72S AS ZH72S,
	           COUNT(ZH72S) AS JTOA7,
	           MIN(WGBRL) AS TTDPM,
	           SUM(WGBRL) AS FBSRS
	       FROM
	           (
	           SELECT
	               nd.id AS id,
	               nd.ZH72S AS ZH72S,
	               (SELECT COUNT(*) FROM HDDVB WHERE UJ6XY = nd.id) AS WGBRL
	           FROM
	               E2I7U nd
	           WHERE nd.ZH72S IS NOT NULL
	           ) CCEFL
	       GROUP BY
	           ZH72S
	       HAVING
	           JTOA7 > 1
	   ) CL3DT
	INNER JOIN
	   E2I7U PBMRX
	ON
	   PBMRX.ZH72S IS NOT NULL AND PBMRX.ZH72S = CL3DT.ZH72S
	WHERE
	       CL3DT.TTDPM = 0
	   AND
	       CL3DT.FBSRS > 0
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:21!null, TEYBZ:22!null, FB6N7:23]\n" +
			" └─ Project\n" +
			"     ├─ columns: [cl3dt.ZH72S:17, cl3dt.JTOA7:18!null, cl3dt.TTDPM:19!null, cl3dt.FBSRS:20!null, pbmrx.id:0!null, pbmrx.dkcaj:1!null, pbmrx.kng7t:2, pbmrx.tw55n:3!null, pbmrx.qrqxw:4!null, pbmrx.ecxaj:5!null, pbmrx.fgg57:6, pbmrx.zh72s:7, pbmrx.fsk67:8!null, pbmrx.xqdyt:9!null, pbmrx.tce7a:10, pbmrx.iwv2h:11, pbmrx.hpcms:12!null, pbmrx.n5cc2:13, pbmrx.fhcyt:14, pbmrx.etaq7:15, pbmrx.a75x7:16, pbmrx.id:0!null as id, pbmrx.tw55n:3!null as TEYBZ, pbmrx.zh72s:7 as FB6N7]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ pbmrx.zh72s:7\n" +
			"             │   └─ cl3dt.ZH72S:17\n" +
			"             ├─ Filter\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"             │   └─ TableAlias(pbmrx)\n" +
			"             │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           ├─ index: [E2I7U.ZH72S]\n" +
			"             │           ├─ static: [{(NULL, ∞)}]\n" +
			"             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(pbmrx.zh72s:7)\n" +
			"                 ├─ right-key: TUPLE(cl3dt.ZH72S:0)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: cl3dt\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Filter\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ TTDPM:2!null\n" +
			"                         │   │   └─ 0 (tinyint)\n" +
			"                         │   └─ GreaterThan\n" +
			"                         │       ├─ FBSRS:3!null\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [ZH72S:4, JTOA7:5!null, TTDPM:6!null, FBSRS:7!null]\n" +
			"                             └─ Having\n" +
			"                                 ├─ GreaterThan\n" +
			"                                 │   ├─ JTOA7:5!null\n" +
			"                                 │   └─ 1 (tinyint)\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [count(ccefl.zh72s):0!null, min(ccefl.wgbrl):1!null, sum(ccefl.wgbrl):2!null, ccefl.ZH72S:3, ccefl.ZH72S:3 as ZH72S, count(ccefl.zh72s):0!null as JTOA7, min(ccefl.wgbrl):1!null as TTDPM, sum(ccefl.wgbrl):2!null as FBSRS]\n" +
			"                                     └─ GroupBy\n" +
			"                                         ├─ select: COUNT(ccefl.ZH72S:1), MIN(ccefl.WGBRL:2), SUM(ccefl.WGBRL:2), ccefl.ZH72S:1\n" +
			"                                         ├─ group: ccefl.ZH72S:1 as ZH72S\n" +
			"                                         └─ SubqueryAlias\n" +
			"                                             ├─ name: ccefl\n" +
			"                                             ├─ outerVisibility: false\n" +
			"                                             ├─ cacheable: true\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [id:17!null, ZH72S:18, WGBRL:19]\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, nd.id:0!null as id, nd.zh72s:7 as ZH72S, Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [count(1):17!null as COUNT(*)]\n" +
			"                                                     │       └─ GroupBy\n" +
			"                                                     │           ├─ select: COUNT(1 (bigint))\n" +
			"                                                     │           ├─ group: \n" +
			"                                                     │           └─ Filter\n" +
			"                                                     │               ├─ Eq\n" +
			"                                                     │               │   ├─ hddvb.uj6xy:17!null\n" +
			"                                                     │               │   └─ nd.id:0!null\n" +
			"                                                     │               └─ IndexedTableAccess(HDDVB)\n" +
			"                                                     │                   ├─ index: [HDDVB.UJ6XY]\n" +
			"                                                     │                   └─ columns: [uj6xy]\n" +
			"                                                     │   as WGBRL]\n" +
			"                                                     └─ Filter\n" +
			"                                                         ├─ NOT\n" +
			"                                                         │   └─ nd.zh72s:7 IS NULL\n" +
			"                                                         └─ TableAlias(nd)\n" +
			"                                                             └─ IndexedTableAccess(E2I7U)\n" +
			"                                                                 ├─ index: [E2I7U.ZH72S]\n" +
			"                                                                 ├─ static: [{(NULL, ∞)}]\n" +
			"                                                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ism.*
	FROM
	   HDDVB ism
	WHERE
	(
	       ism.PRUV2 IS NOT NULL
	   AND
	       (
	               (SELECT NHMXW.SWCQV FROM WGSDC NHMXW WHERE NHMXW.id = ism.PRUV2) = 1
	           OR
	               (
	                       (
	                           ism.FV24E IS NOT NULL
	                       AND
	                           (SELECT nd.id FROM E2I7U nd WHERE nd.TW55N =
	                               (SELECT NHMXW.FZXV5 FROM WGSDC NHMXW
	                               WHERE NHMXW.id = ism.PRUV2))
	                           <> ism.FV24E
	                       )
	                   OR
	                       (
	                           ism.UJ6XY IS NOT NULL
	                       AND
	                           (SELECT nd.id FROM E2I7U nd WHERE nd.TW55N =
	                               (SELECT NHMXW.DQYGV FROM WGSDC NHMXW
	                               WHERE NHMXW.id = ism.PRUV2))
	                           <> ism.UJ6XY
	                       )
	               )
	       )
	)
	OR
	(
	       ism.ETPQV IS NOT NULL
	   AND
	       ism.ETPQV IN
	       (
	       SELECT
	           TIZHK.id AS FWATE
	       FROM
	           WGSDC NHMXW
	       INNER JOIN
	           WRZVO TIZHK
	       ON
	               TIZHK.TVNW2 = NHMXW.NOHHR
	           AND
	               TIZHK.ZHITY = NHMXW.AVPYF
	           AND
	               TIZHK.SYPKF = NHMXW.SYPKF
	           AND
	               TIZHK.IDUT2 = NHMXW.IDUT2
	       WHERE
	               NHMXW.SWCQV = 0
	           AND
	               NHMXW.id NOT IN (SELECT PRUV2 FROM HDDVB WHERE PRUV2 IS NOT NULL)
	       )
	)
	`,
		ExpectedPlan: "Filter\n" +
			" ├─ Or\n" +
			" │   ├─ AND\n" +
			" │   │   ├─ NOT\n" +
			" │   │   │   └─ ism.pruv2:6 IS NULL\n" +
			" │   │   └─ Or\n" +
			" │   │       ├─ Eq\n" +
			" │   │       │   ├─ Subquery\n" +
			" │   │       │   │   ├─ cacheable: false\n" +
			" │   │       │   │   └─ Project\n" +
			" │   │       │   │       ├─ columns: [nhmxw.swcqv:16!null]\n" +
			" │   │       │   │       └─ Filter\n" +
			" │   │       │   │           ├─ Eq\n" +
			" │   │       │   │           │   ├─ nhmxw.id:9!null\n" +
			" │   │       │   │           │   └─ ism.pruv2:6\n" +
			" │   │       │   │           └─ TableAlias(nhmxw)\n" +
			" │   │       │   │               └─ IndexedTableAccess(WGSDC)\n" +
			" │   │       │   │                   ├─ index: [WGSDC.id]\n" +
			" │   │       │   │                   └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			" │   │       │   └─ 1 (tinyint)\n" +
			" │   │       └─ Or\n" +
			" │   │           ├─ AND\n" +
			" │   │           │   ├─ NOT\n" +
			" │   │           │   │   └─ ism.fv24e:1!null IS NULL\n" +
			" │   │           │   └─ NOT\n" +
			" │   │           │       └─ Eq\n" +
			" │   │           │           ├─ Subquery\n" +
			" │   │           │           │   ├─ cacheable: false\n" +
			" │   │           │           │   └─ Project\n" +
			" │   │           │           │       ├─ columns: [nd.id:9!null]\n" +
			" │   │           │           │       └─ Filter\n" +
			" │   │           │           │           ├─ Eq\n" +
			" │   │           │           │           │   ├─ nd.tw55n:12!null\n" +
			" │   │           │           │           │   └─ Subquery\n" +
			" │   │           │           │           │       ├─ cacheable: false\n" +
			" │   │           │           │           │       └─ Project\n" +
			" │   │           │           │           │           ├─ columns: [nhmxw.fzxv5:31]\n" +
			" │   │           │           │           │           └─ Filter\n" +
			" │   │           │           │           │               ├─ Eq\n" +
			" │   │           │           │           │               │   ├─ nhmxw.id:26!null\n" +
			" │   │           │           │           │               │   └─ ism.pruv2:6\n" +
			" │   │           │           │           │               └─ TableAlias(nhmxw)\n" +
			" │   │           │           │           │                   └─ IndexedTableAccess(WGSDC)\n" +
			" │   │           │           │           │                       ├─ index: [WGSDC.id]\n" +
			" │   │           │           │           │                       └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			" │   │           │           │           └─ TableAlias(nd)\n" +
			" │   │           │           │               └─ Table\n" +
			" │   │           │           │                   ├─ name: E2I7U\n" +
			" │   │           │           │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			" │   │           │           └─ ism.fv24e:1!null\n" +
			" │   │           └─ AND\n" +
			" │   │               ├─ NOT\n" +
			" │   │               │   └─ ism.uj6xy:2!null IS NULL\n" +
			" │   │               └─ NOT\n" +
			" │   │                   └─ Eq\n" +
			" │   │                       ├─ Subquery\n" +
			" │   │                       │   ├─ cacheable: false\n" +
			" │   │                       │   └─ Project\n" +
			" │   │                       │       ├─ columns: [nd.id:9!null]\n" +
			" │   │                       │       └─ Filter\n" +
			" │   │                       │           ├─ Eq\n" +
			" │   │                       │           │   ├─ nd.tw55n:12!null\n" +
			" │   │                       │           │   └─ Subquery\n" +
			" │   │                       │           │       ├─ cacheable: false\n" +
			" │   │                       │           │       └─ Project\n" +
			" │   │                       │           │           ├─ columns: [nhmxw.dqygv:32]\n" +
			" │   │                       │           │           └─ Filter\n" +
			" │   │                       │           │               ├─ Eq\n" +
			" │   │                       │           │               │   ├─ nhmxw.id:26!null\n" +
			" │   │                       │           │               │   └─ ism.pruv2:6\n" +
			" │   │                       │           │               └─ TableAlias(nhmxw)\n" +
			" │   │                       │           │                   └─ IndexedTableAccess(WGSDC)\n" +
			" │   │                       │           │                       ├─ index: [WGSDC.id]\n" +
			" │   │                       │           │                       └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			" │   │                       │           └─ TableAlias(nd)\n" +
			" │   │                       │               └─ Table\n" +
			" │   │                       │                   ├─ name: E2I7U\n" +
			" │   │                       │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			" │   │                       └─ ism.uj6xy:2!null\n" +
			" │   └─ AND\n" +
			" │       ├─ NOT\n" +
			" │       │   └─ ism.etpqv:5 IS NULL\n" +
			" │       └─ InSubquery\n" +
			" │           ├─ left: ism.etpqv:5\n" +
			" │           └─ right: Subquery\n" +
			" │               ├─ cacheable: true\n" +
			" │               └─ Project\n" +
			" │                   ├─ columns: [FWATE:29!null]\n" +
			" │                   └─ Project\n" +
			" │                       ├─ columns: [nhmxw.id:19!null, nhmxw.nohhr:20!null, nhmxw.avpyf:21!null, nhmxw.sypkf:22!null, nhmxw.idut2:23!null, nhmxw.fzxv5:24, nhmxw.dqygv:25, nhmxw.swcqv:26!null, nhmxw.ykssu:27, nhmxw.fhcyt:28, tizhk.id:9!null, tizhk.tvnw2:10, tizhk.zhity:11, tizhk.sypkf:12, tizhk.idut2:13, tizhk.o6qj3:14, tizhk.no2ja:15, tizhk.ykssu:16, tizhk.fhcyt:17, tizhk.qz6vt:18, tizhk.id:9!null as FWATE]\n" +
			" │                       └─ HashJoin\n" +
			" │                           ├─ AND\n" +
			" │                           │   ├─ AND\n" +
			" │                           │   │   ├─ AND\n" +
			" │                           │   │   │   ├─ Eq\n" +
			" │                           │   │   │   │   ├─ tizhk.tvnw2:10\n" +
			" │                           │   │   │   │   └─ nhmxw.nohhr:20!null\n" +
			" │                           │   │   │   └─ Eq\n" +
			" │                           │   │   │       ├─ tizhk.zhity:11\n" +
			" │                           │   │   │       └─ nhmxw.avpyf:21!null\n" +
			" │                           │   │   └─ Eq\n" +
			" │                           │   │       ├─ tizhk.sypkf:12\n" +
			" │                           │   │       └─ nhmxw.sypkf:22!null\n" +
			" │                           │   └─ Eq\n" +
			" │                           │       ├─ tizhk.idut2:13\n" +
			" │                           │       └─ nhmxw.idut2:23!null\n" +
			" │                           ├─ TableAlias(tizhk)\n" +
			" │                           │   └─ Table\n" +
			" │                           │       ├─ name: WRZVO\n" +
			" │                           │       └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			" │                           └─ HashLookup\n" +
			" │                               ├─ left-key: TUPLE(tizhk.tvnw2:10, tizhk.zhity:11, tizhk.sypkf:12, tizhk.idut2:13)\n" +
			" │                               ├─ right-key: TUPLE(nhmxw.nohhr:10!null, nhmxw.avpyf:11!null, nhmxw.sypkf:12!null, nhmxw.idut2:13!null)\n" +
			" │                               └─ Project\n" +
			" │                                   ├─ columns: [nhmxw.id:9!null, nhmxw.nohhr:10!null, nhmxw.avpyf:11!null, nhmxw.sypkf:12!null, nhmxw.idut2:13!null, nhmxw.FZXV5:14, nhmxw.DQYGV:15, nhmxw.swcqv:16!null, nhmxw.YKSSU:17, nhmxw.FHCYT:18]\n" +
			" │                                   └─ Filter\n" +
			" │                                       ├─ scalarSubq0.pruv2:19 IS NULL\n" +
			" │                                       └─ LeftOuterMergeJoin\n" +
			" │                                           ├─ cmp: Eq\n" +
			" │                                           │   ├─ nhmxw.id:19!null\n" +
			" │                                           │   └─ scalarSubq0.pruv2:29\n" +
			" │                                           ├─ Filter\n" +
			" │                                           │   ├─ Eq\n" +
			" │                                           │   │   ├─ nhmxw.swcqv:16!null\n" +
			" │                                           │   │   └─ 0 (tinyint)\n" +
			" │                                           │   └─ TableAlias(nhmxw)\n" +
			" │                                           │       └─ IndexedTableAccess(WGSDC)\n" +
			" │                                           │           ├─ index: [WGSDC.id]\n" +
			" │                                           │           ├─ static: [{[NULL, ∞)}]\n" +
			" │                                           │           └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			" │                                           └─ Project\n" +
			" │                                               ├─ columns: [scalarSubq0.pruv2:15]\n" +
			" │                                               └─ Filter\n" +
			" │                                                   ├─ NOT\n" +
			" │                                                   │   └─ scalarSubq0.pruv2:15 IS NULL\n" +
			" │                                                   └─ TableAlias(scalarSubq0)\n" +
			" │                                                       └─ IndexedTableAccess(HDDVB)\n" +
			" │                                                           ├─ index: [HDDVB.PRUV2]\n" +
			" │                                                           ├─ static: [{[NULL, ∞)}]\n" +
			" │                                                           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			" └─ TableAlias(ism)\n" +
			"     └─ Table\n" +
			"         ├─ name: HDDVB\n" +
			"         └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   TIZHK.*
	FROM
	   WRZVO TIZHK
	WHERE id IN
	   (
	       SELECT /*+ JOIN_ORDER( J4JYP, TIZHK, RHUZN, mf, aac ) */DISTINCT
	           TIZHK.id
	       FROM
	           WRZVO TIZHK
	       INNER JOIN
	           E2I7U J4JYP
	       ON
	           J4JYP.ZH72S = TIZHK.TVNW2
	       INNER JOIN
	           E2I7U RHUZN
	       ON
	           RHUZN.ZH72S = TIZHK.ZHITY
	       INNER JOIN
	           HGMQ6 mf ON mf.LUEVY = J4JYP.id
	       INNER JOIN
	           TPXBU aac ON aac.id = mf.M22QN
	       WHERE
	           aac.BTXC5 = TIZHK.SYPKF
	   )
	   AND
	       TIZHK.id NOT IN (SELECT ETPQV FROM HDDVB)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [tizhk.id:1!null, tizhk.TVNW2:2, tizhk.ZHITY:3, tizhk.SYPKF:4, tizhk.IDUT2:5, tizhk.O6QJ3:6, tizhk.NO2JA:7, tizhk.YKSSU:8, tizhk.FHCYT:9, tizhk.QZ6VT:10]\n" +
			" └─ Filter\n" +
			"     ├─ scalarSubq1.etpqv:11 IS NULL\n" +
			"     └─ LeftOuterHashJoinExcludeNulls\n" +
			"         ├─ Eq\n" +
			"         │   ├─ tizhk.id:1!null\n" +
			"         │   └─ scalarSubq1.etpqv:11\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tizhk.id:1!null\n" +
			"         │   │   └─ scalarSubq0.id:0!null\n" +
			"         │   ├─ Distinct\n" +
			"         │   │   └─ SubqueryAlias\n" +
			"         │   │       ├─ name: scalarSubq0\n" +
			"         │   │       ├─ outerVisibility: false\n" +
			"         │   │       ├─ cacheable: true\n" +
			"         │   │       └─ Distinct\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [tizhk.id:0!null]\n" +
			"         │   │               └─ Project\n" +
			"         │   │                   ├─ columns: [tizhk.id:17!null, tizhk.tvnw2:18, tizhk.zhity:19, tizhk.sypkf:20, tizhk.idut2:21, tizhk.o6qj3:22, tizhk.no2ja:23, tizhk.ykssu:24, tizhk.fhcyt:25, tizhk.qz6vt:26, j4jyp.id:0!null, j4jyp.dkcaj:1!null, j4jyp.kng7t:2, j4jyp.tw55n:3!null, j4jyp.qrqxw:4!null, j4jyp.ecxaj:5!null, j4jyp.fgg57:6, j4jyp.zh72s:7, j4jyp.fsk67:8!null, j4jyp.xqdyt:9!null, j4jyp.tce7a:10, j4jyp.iwv2h:11, j4jyp.hpcms:12!null, j4jyp.n5cc2:13, j4jyp.fhcyt:14, j4jyp.etaq7:15, j4jyp.a75x7:16, rhuzn.id:27!null, rhuzn.dkcaj:28!null, rhuzn.kng7t:29, rhuzn.tw55n:30!null, rhuzn.qrqxw:31!null, rhuzn.ecxaj:32!null, rhuzn.fgg57:33, rhuzn.zh72s:34, rhuzn.fsk67:35!null, rhuzn.xqdyt:36!null, rhuzn.tce7a:37, rhuzn.iwv2h:38, rhuzn.hpcms:39!null, rhuzn.n5cc2:40, rhuzn.fhcyt:41, rhuzn.etaq7:42, rhuzn.a75x7:43, mf.id:44!null, mf.gxlub:45!null, mf.luevy:46!null, mf.m22qn:47!null, mf.tjpt7:48!null, mf.arn5p:49!null, mf.xosd4:50!null, mf.ide43:51, mf.hmw4h:52, mf.zbt6r:53, mf.fsdy2:54!null, mf.lt7k6:55, mf.sppyd:56, mf.qcgts:57, mf.teuja:58, mf.qqv4m:59, mf.fhcyt:60, aac.id:61!null, aac.btxc5:62, aac.fhcyt:63]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ Eq\n" +
			"         │   │                       │   ├─ aac.btxc5:62\n" +
			"         │   │                       │   └─ tizhk.sypkf:20\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ mf.luevy:46!null\n" +
			"         │   │                           │   └─ j4jyp.id:0!null\n" +
			"         │   │                           ├─ HashJoin\n" +
			"         │   │                           │   ├─ Eq\n" +
			"         │   │                           │   │   ├─ rhuzn.zh72s:34\n" +
			"         │   │                           │   │   └─ tizhk.zhity:19\n" +
			"         │   │                           │   ├─ MergeJoin\n" +
			"         │   │                           │   │   ├─ cmp: Eq\n" +
			"         │   │                           │   │   │   ├─ j4jyp.zh72s:7\n" +
			"         │   │                           │   │   │   └─ tizhk.tvnw2:18\n" +
			"         │   │                           │   │   ├─ TableAlias(j4jyp)\n" +
			"         │   │                           │   │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"         │   │                           │   │   │       ├─ index: [E2I7U.ZH72S]\n" +
			"         │   │                           │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                           │   │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │                           │   │   └─ TableAlias(tizhk)\n" +
			"         │   │                           │   │       └─ IndexedTableAccess(WRZVO)\n" +
			"         │   │                           │   │           ├─ index: [WRZVO.TVNW2]\n" +
			"         │   │                           │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                           │   │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"         │   │                           │   └─ HashLookup\n" +
			"         │   │                           │       ├─ left-key: TUPLE(tizhk.zhity:19)\n" +
			"         │   │                           │       ├─ right-key: TUPLE(rhuzn.zh72s:7)\n" +
			"         │   │                           │       └─ TableAlias(rhuzn)\n" +
			"         │   │                           │           └─ Table\n" +
			"         │   │                           │               ├─ name: E2I7U\n" +
			"         │   │                           │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(j4jyp.id:0!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mf.luevy:2!null)\n" +
			"         │   │                               └─ MergeJoin\n" +
			"         │   │                                   ├─ cmp: Eq\n" +
			"         │   │                                   │   ├─ mf.m22qn:47!null\n" +
			"         │   │                                   │   └─ aac.id:61!null\n" +
			"         │   │                                   ├─ TableAlias(mf)\n" +
			"         │   │                                   │   └─ IndexedTableAccess(HGMQ6)\n" +
			"         │   │                                   │       ├─ index: [HGMQ6.M22QN]\n" +
			"         │   │                                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                   │       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         │   │                                   └─ TableAlias(aac)\n" +
			"         │   │                                       └─ IndexedTableAccess(TPXBU)\n" +
			"         │   │                                           ├─ index: [TPXBU.id]\n" +
			"         │   │                                           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                           └─ columns: [id btxc5 fhcyt]\n" +
			"         │   └─ TableAlias(tizhk)\n" +
			"         │       └─ IndexedTableAccess(WRZVO)\n" +
			"         │           ├─ index: [WRZVO.id]\n" +
			"         │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(tizhk.id:1!null)\n" +
			"             ├─ right-key: TUPLE(scalarSubq1.etpqv:0)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [scalarSubq1.etpqv:5]\n" +
			"                 └─ TableAlias(scalarSubq1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: HDDVB\n" +
			"                         └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   TIZHK.*
	FROM
	   WRZVO TIZHK
	WHERE id IN
	   (
	       SELECT DISTINCT
	           TIZHK.id
	       FROM
	           WRZVO TIZHK
	       INNER JOIN
	           E2I7U J4JYP
	       ON
	           J4JYP.ZH72S = TIZHK.TVNW2
	       INNER JOIN
	           E2I7U RHUZN
	       ON
	           RHUZN.ZH72S = TIZHK.ZHITY
	       INNER JOIN
	           HGMQ6 mf ON mf.LUEVY = J4JYP.id
	       INNER JOIN
	           TPXBU aac ON aac.id = mf.M22QN
	       WHERE
	           aac.BTXC5 = TIZHK.SYPKF
	   )
	   AND
	       TIZHK.id NOT IN (SELECT ETPQV FROM HDDVB)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [tizhk.id:1!null, tizhk.TVNW2:2, tizhk.ZHITY:3, tizhk.SYPKF:4, tizhk.IDUT2:5, tizhk.O6QJ3:6, tizhk.NO2JA:7, tizhk.YKSSU:8, tizhk.FHCYT:9, tizhk.QZ6VT:10]\n" +
			" └─ Filter\n" +
			"     ├─ scalarSubq1.etpqv:11 IS NULL\n" +
			"     └─ LeftOuterHashJoinExcludeNulls\n" +
			"         ├─ Eq\n" +
			"         │   ├─ tizhk.id:1!null\n" +
			"         │   └─ scalarSubq1.etpqv:11\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ tizhk.id:1!null\n" +
			"         │   │   └─ scalarSubq0.id:0!null\n" +
			"         │   ├─ Distinct\n" +
			"         │   │   └─ SubqueryAlias\n" +
			"         │   │       ├─ name: scalarSubq0\n" +
			"         │   │       ├─ outerVisibility: false\n" +
			"         │   │       ├─ cacheable: true\n" +
			"         │   │       └─ Distinct\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [tizhk.id:0!null]\n" +
			"         │   │               └─ Project\n" +
			"         │   │                   ├─ columns: [tizhk.id:37!null, tizhk.tvnw2:38, tizhk.zhity:39, tizhk.sypkf:40, tizhk.idut2:41, tizhk.o6qj3:42, tizhk.no2ja:43, tizhk.ykssu:44, tizhk.fhcyt:45, tizhk.qz6vt:46, j4jyp.id:47!null, j4jyp.dkcaj:48!null, j4jyp.kng7t:49, j4jyp.tw55n:50!null, j4jyp.qrqxw:51!null, j4jyp.ecxaj:52!null, j4jyp.fgg57:53, j4jyp.zh72s:54, j4jyp.fsk67:55!null, j4jyp.xqdyt:56!null, j4jyp.tce7a:57, j4jyp.iwv2h:58, j4jyp.hpcms:59!null, j4jyp.n5cc2:60, j4jyp.fhcyt:61, j4jyp.etaq7:62, j4jyp.a75x7:63, rhuzn.id:20!null, rhuzn.dkcaj:21!null, rhuzn.kng7t:22, rhuzn.tw55n:23!null, rhuzn.qrqxw:24!null, rhuzn.ecxaj:25!null, rhuzn.fgg57:26, rhuzn.zh72s:27, rhuzn.fsk67:28!null, rhuzn.xqdyt:29!null, rhuzn.tce7a:30, rhuzn.iwv2h:31, rhuzn.hpcms:32!null, rhuzn.n5cc2:33, rhuzn.fhcyt:34, rhuzn.etaq7:35, rhuzn.a75x7:36, mf.id:3!null, mf.gxlub:4!null, mf.luevy:5!null, mf.m22qn:6!null, mf.tjpt7:7!null, mf.arn5p:8!null, mf.xosd4:9!null, mf.ide43:10, mf.hmw4h:11, mf.zbt6r:12, mf.fsdy2:13!null, mf.lt7k6:14, mf.sppyd:15, mf.qcgts:16, mf.teuja:17, mf.qqv4m:18, mf.fhcyt:19, aac.id:0!null, aac.btxc5:1, aac.fhcyt:2]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ Eq\n" +
			"         │   │                       │   ├─ aac.btxc5:1\n" +
			"         │   │                       │   └─ tizhk.sypkf:40\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ mf.luevy:5!null\n" +
			"         │   │                           │   └─ j4jyp.id:47!null\n" +
			"         │   │                           ├─ MergeJoin\n" +
			"         │   │                           │   ├─ cmp: Eq\n" +
			"         │   │                           │   │   ├─ aac.id:0!null\n" +
			"         │   │                           │   │   └─ mf.m22qn:6!null\n" +
			"         │   │                           │   ├─ TableAlias(aac)\n" +
			"         │   │                           │   │   └─ IndexedTableAccess(TPXBU)\n" +
			"         │   │                           │   │       ├─ index: [TPXBU.id]\n" +
			"         │   │                           │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                           │   │       └─ columns: [id btxc5 fhcyt]\n" +
			"         │   │                           │   └─ TableAlias(mf)\n" +
			"         │   │                           │       └─ IndexedTableAccess(HGMQ6)\n" +
			"         │   │                           │           ├─ index: [HGMQ6.M22QN]\n" +
			"         │   │                           │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                           │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(mf.luevy:5!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(j4jyp.id:27!null)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ Eq\n" +
			"         │   │                                   │   ├─ j4jyp.zh72s:54\n" +
			"         │   │                                   │   └─ tizhk.tvnw2:38\n" +
			"         │   │                                   ├─ MergeJoin\n" +
			"         │   │                                   │   ├─ cmp: Eq\n" +
			"         │   │                                   │   │   ├─ rhuzn.zh72s:27\n" +
			"         │   │                                   │   │   └─ tizhk.zhity:39\n" +
			"         │   │                                   │   ├─ TableAlias(rhuzn)\n" +
			"         │   │                                   │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"         │   │                                   │   │       ├─ index: [E2I7U.ZH72S]\n" +
			"         │   │                                   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                   │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │                                   │   └─ TableAlias(tizhk)\n" +
			"         │   │                                   │       └─ IndexedTableAccess(WRZVO)\n" +
			"         │   │                                   │           ├─ index: [WRZVO.ZHITY]\n" +
			"         │   │                                   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                   │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: TUPLE(tizhk.tvnw2:38)\n" +
			"         │   │                                       ├─ right-key: TUPLE(j4jyp.zh72s:7)\n" +
			"         │   │                                       └─ TableAlias(j4jyp)\n" +
			"         │   │                                           └─ Table\n" +
			"         │   │                                               ├─ name: E2I7U\n" +
			"         │   │                                               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   └─ TableAlias(tizhk)\n" +
			"         │       └─ IndexedTableAccess(WRZVO)\n" +
			"         │           ├─ index: [WRZVO.id]\n" +
			"         │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(tizhk.id:1!null)\n" +
			"             ├─ right-key: TUPLE(scalarSubq1.etpqv:0)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [scalarSubq1.etpqv:5]\n" +
			"                 └─ TableAlias(scalarSubq1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: HDDVB\n" +
			"                         └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   PBMRX.id AS id,
	   PBMRX.TW55N AS TEYBZ,
	   PBMRX.ZH72S AS FB6N7
	FROM
	   (
	       SELECT
	           ZH72S AS ZH72S,
	           COUNT(ZH72S) AS JTOA7,
	           MIN(LEA4J) AS BADTB,
	           SUM(LEA4J) AS FLHXH
	       FROM
	           (
	           SELECT
	               nd.id AS id,
	               nd.ZH72S AS ZH72S,
	               (SELECT COUNT(*) FROM FLQLP WHERE LUEVY = nd.id) AS LEA4J
	           FROM
	               E2I7U nd
	           WHERE nd.ZH72S IS NOT NULL
	           ) WOOJ5
	       GROUP BY
	           ZH72S
	       HAVING
	           JTOA7 > 1
	   ) CL3DT
	INNER JOIN
	   E2I7U PBMRX
	ON
	   PBMRX.ZH72S IS NOT NULL AND PBMRX.ZH72S = CL3DT.ZH72S
	WHERE
	       CL3DT.BADTB = 0
	   AND
	       CL3DT.FLHXH > 0
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:21!null, TEYBZ:22!null, FB6N7:23]\n" +
			" └─ Project\n" +
			"     ├─ columns: [cl3dt.ZH72S:17, cl3dt.JTOA7:18!null, cl3dt.BADTB:19!null, cl3dt.FLHXH:20!null, pbmrx.id:0!null, pbmrx.dkcaj:1!null, pbmrx.kng7t:2, pbmrx.tw55n:3!null, pbmrx.qrqxw:4!null, pbmrx.ecxaj:5!null, pbmrx.fgg57:6, pbmrx.zh72s:7, pbmrx.fsk67:8!null, pbmrx.xqdyt:9!null, pbmrx.tce7a:10, pbmrx.iwv2h:11, pbmrx.hpcms:12!null, pbmrx.n5cc2:13, pbmrx.fhcyt:14, pbmrx.etaq7:15, pbmrx.a75x7:16, pbmrx.id:0!null as id, pbmrx.tw55n:3!null as TEYBZ, pbmrx.zh72s:7 as FB6N7]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ pbmrx.zh72s:7\n" +
			"             │   └─ cl3dt.ZH72S:17\n" +
			"             ├─ Filter\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"             │   └─ TableAlias(pbmrx)\n" +
			"             │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           ├─ index: [E2I7U.ZH72S]\n" +
			"             │           ├─ static: [{(NULL, ∞)}]\n" +
			"             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(pbmrx.zh72s:7)\n" +
			"                 ├─ right-key: TUPLE(cl3dt.ZH72S:0)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: cl3dt\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Filter\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ BADTB:2!null\n" +
			"                         │   │   └─ 0 (tinyint)\n" +
			"                         │   └─ GreaterThan\n" +
			"                         │       ├─ FLHXH:3!null\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [ZH72S:4, JTOA7:5!null, BADTB:6!null, FLHXH:7!null]\n" +
			"                             └─ Having\n" +
			"                                 ├─ GreaterThan\n" +
			"                                 │   ├─ JTOA7:5!null\n" +
			"                                 │   └─ 1 (tinyint)\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [count(wooj5.zh72s):0!null, min(wooj5.lea4j):1!null, sum(wooj5.lea4j):2!null, wooj5.ZH72S:3, wooj5.ZH72S:3 as ZH72S, count(wooj5.zh72s):0!null as JTOA7, min(wooj5.lea4j):1!null as BADTB, sum(wooj5.lea4j):2!null as FLHXH]\n" +
			"                                     └─ GroupBy\n" +
			"                                         ├─ select: COUNT(wooj5.ZH72S:1), MIN(wooj5.LEA4J:2), SUM(wooj5.LEA4J:2), wooj5.ZH72S:1\n" +
			"                                         ├─ group: wooj5.ZH72S:1 as ZH72S\n" +
			"                                         └─ SubqueryAlias\n" +
			"                                             ├─ name: wooj5\n" +
			"                                             ├─ outerVisibility: false\n" +
			"                                             ├─ cacheable: true\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [id:17!null, ZH72S:18, LEA4J:19]\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, nd.id:0!null as id, nd.zh72s:7 as ZH72S, Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [count(1):17!null as COUNT(*)]\n" +
			"                                                     │       └─ GroupBy\n" +
			"                                                     │           ├─ select: COUNT(1 (bigint))\n" +
			"                                                     │           ├─ group: \n" +
			"                                                     │           └─ Filter\n" +
			"                                                     │               ├─ Eq\n" +
			"                                                     │               │   ├─ flqlp.luevy:17!null\n" +
			"                                                     │               │   └─ nd.id:0!null\n" +
			"                                                     │               └─ IndexedTableAccess(FLQLP)\n" +
			"                                                     │                   ├─ index: [FLQLP.LUEVY]\n" +
			"                                                     │                   └─ columns: [luevy]\n" +
			"                                                     │   as LEA4J]\n" +
			"                                                     └─ Filter\n" +
			"                                                         ├─ NOT\n" +
			"                                                         │   └─ nd.zh72s:7 IS NULL\n" +
			"                                                         └─ TableAlias(nd)\n" +
			"                                                             └─ IndexedTableAccess(E2I7U)\n" +
			"                                                                 ├─ index: [E2I7U.ZH72S]\n" +
			"                                                                 ├─ static: [{(NULL, ∞)}]\n" +
			"                                                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ct.id AS id,
	   ci.FTQLQ AS VCGT3,
	   nd.TW55N AS UWBAI,
	   aac.BTXC5 AS TPXBU,
	   ct.V5DPX AS V5DPX,
	   ct.S3Q3Y AS S3Q3Y,
	   ct.ZRV3B AS ZRV3B
	FROM
	   FLQLP ct
	INNER JOIN
	   JDLNA ci
	ON
	   ci.id = ct.FZ2R5
	INNER JOIN
	   E2I7U nd
	ON
	   nd.id = ct.LUEVY
	INNER JOIN
	   TPXBU aac
	ON
	   aac.id = ct.M22QN
	WHERE
	(
	       ct.OCA7E IS NOT NULL
	   AND
	       (
	               (SELECT I7HCR.SWCQV FROM EPZU6 I7HCR WHERE I7HCR.id = ct.OCA7E) = 1
	           OR
	               (SELECT nd.id FROM E2I7U nd WHERE nd.TW55N =
	                   (SELECT I7HCR.FVUCX FROM EPZU6 I7HCR
	                   WHERE I7HCR.id = ct.OCA7E))
	               <> ct.LUEVY
	       )
	)
	OR
	(
	       ct.NRURT IS NOT NULL
	   AND
	       ct.NRURT IN
	       (
	       SELECT
	           uct.id AS FDL23
	       FROM
	           EPZU6 I7HCR
	       INNER JOIN
	           OUBDL uct
	       ON
	               uct.FTQLQ = I7HCR.TOFPN
	           AND
	               uct.ZH72S = I7HCR.SJYN2
	           AND
	               uct.LJLUM = I7HCR.BTXC5
	       WHERE
	               I7HCR.SWCQV = 0
	           AND
	               I7HCR.id NOT IN (SELECT OCA7E FROM FLQLP WHERE OCA7E IS NOT NULL)
	       )
	)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:37!null, VCGT3:38!null, UWBAI:39!null, TPXBU:40, V5DPX:41!null, S3Q3Y:42!null, ZRV3B:43!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [ct.id:0!null, ct.fz2r5:1!null, ct.luevy:2!null, ct.m22qn:3!null, ct.ove3e:4!null, ct.nrurt:5, ct.oca7e:6, ct.xmm6q:7, ct.v5dpx:8!null, ct.s3q3y:9!null, ct.zrv3b:10!null, ct.fhcyt:11, ci.id:15!null, ci.ftqlq:16!null, ci.fwwiq:17, ci.o3qxw:18, ci.fhcyt:19, nd.id:20!null, nd.dkcaj:21!null, nd.kng7t:22, nd.tw55n:23!null, nd.qrqxw:24!null, nd.ecxaj:25!null, nd.fgg57:26, nd.zh72s:27, nd.fsk67:28!null, nd.xqdyt:29!null, nd.tce7a:30, nd.iwv2h:31, nd.hpcms:32!null, nd.n5cc2:33, nd.fhcyt:34, nd.etaq7:35, nd.a75x7:36, aac.id:12!null, aac.btxc5:13, aac.fhcyt:14, ct.id:0!null as id, ci.ftqlq:16!null as VCGT3, nd.tw55n:23!null as UWBAI, aac.btxc5:13 as TPXBU, ct.v5dpx:8!null as V5DPX, ct.s3q3y:9!null as S3Q3Y, ct.zrv3b:10!null as ZRV3B]\n" +
			"     └─ Filter\n" +
			"         ├─ Or\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ NOT\n" +
			"         │   │   │   └─ ct.oca7e:6 IS NULL\n" +
			"         │   │   └─ Or\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ Subquery\n" +
			"         │   │       │   │   ├─ cacheable: false\n" +
			"         │   │       │   │   └─ Project\n" +
			"         │   │       │   │       ├─ columns: [i7hcr.swcqv:42!null]\n" +
			"         │   │       │   │       └─ Filter\n" +
			"         │   │       │   │           ├─ Eq\n" +
			"         │   │       │   │           │   ├─ i7hcr.id:37!null\n" +
			"         │   │       │   │           │   └─ ct.oca7e:6\n" +
			"         │   │       │   │           └─ TableAlias(i7hcr)\n" +
			"         │   │       │   │               └─ IndexedTableAccess(EPZU6)\n" +
			"         │   │       │   │                   ├─ index: [EPZU6.id]\n" +
			"         │   │       │   │                   └─ columns: [id tofpn sjyn2 btxc5 fvucx swcqv ykssu fhcyt]\n" +
			"         │   │       │   └─ 1 (tinyint)\n" +
			"         │   │       └─ NOT\n" +
			"         │   │           └─ Eq\n" +
			"         │   │               ├─ Subquery\n" +
			"         │   │               │   ├─ cacheable: false\n" +
			"         │   │               │   └─ Project\n" +
			"         │   │               │       ├─ columns: [nd.id:37!null]\n" +
			"         │   │               │       └─ Filter\n" +
			"         │   │               │           ├─ Eq\n" +
			"         │   │               │           │   ├─ nd.tw55n:40!null\n" +
			"         │   │               │           │   └─ Subquery\n" +
			"         │   │               │           │       ├─ cacheable: false\n" +
			"         │   │               │           │       └─ Project\n" +
			"         │   │               │           │           ├─ columns: [i7hcr.fvucx:58!null]\n" +
			"         │   │               │           │           └─ Filter\n" +
			"         │   │               │           │               ├─ Eq\n" +
			"         │   │               │           │               │   ├─ i7hcr.id:54!null\n" +
			"         │   │               │           │               │   └─ ct.oca7e:6\n" +
			"         │   │               │           │               └─ TableAlias(i7hcr)\n" +
			"         │   │               │           │                   └─ IndexedTableAccess(EPZU6)\n" +
			"         │   │               │           │                       ├─ index: [EPZU6.id]\n" +
			"         │   │               │           │                       └─ columns: [id tofpn sjyn2 btxc5 fvucx swcqv ykssu fhcyt]\n" +
			"         │   │               │           └─ TableAlias(nd)\n" +
			"         │   │               │               └─ Table\n" +
			"         │   │               │                   ├─ name: E2I7U\n" +
			"         │   │               │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │               └─ ct.luevy:2!null\n" +
			"         │   └─ AND\n" +
			"         │       ├─ NOT\n" +
			"         │       │   └─ ct.nrurt:5 IS NULL\n" +
			"         │       └─ InSubquery\n" +
			"         │           ├─ left: ct.nrurt:5\n" +
			"         │           └─ right: Subquery\n" +
			"         │               ├─ cacheable: true\n" +
			"         │               └─ Project\n" +
			"         │                   ├─ columns: [FDL23:58!null]\n" +
			"         │                   └─ Project\n" +
			"         │                       ├─ columns: [i7hcr.id:37!null, i7hcr.tofpn:38!null, i7hcr.sjyn2:39!null, i7hcr.btxc5:40!null, i7hcr.fvucx:41!null, i7hcr.swcqv:42!null, i7hcr.ykssu:43, i7hcr.fhcyt:44, uct.id:45!null, uct.ftqlq:46, uct.zh72s:47, uct.sfj6l:48, uct.v5dpx:49, uct.ljlum:50, uct.idpk7:51, uct.no52d:52, uct.zrv3b:53, uct.vyo5e:54, uct.ykssu:55, uct.fhcyt:56, uct.qz6vt:57, uct.id:45!null as FDL23]\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ AND\n" +
			"         │                           │   ├─ AND\n" +
			"         │                           │   │   ├─ Eq\n" +
			"         │                           │   │   │   ├─ uct.ftqlq:46\n" +
			"         │                           │   │   │   └─ i7hcr.tofpn:38!null\n" +
			"         │                           │   │   └─ Eq\n" +
			"         │                           │   │       ├─ uct.zh72s:47\n" +
			"         │                           │   │       └─ i7hcr.sjyn2:39!null\n" +
			"         │                           │   └─ Eq\n" +
			"         │                           │       ├─ uct.ljlum:50\n" +
			"         │                           │       └─ i7hcr.btxc5:40!null\n" +
			"         │                           ├─ Project\n" +
			"         │                           │   ├─ columns: [i7hcr.id:37!null, i7hcr.tofpn:38!null, i7hcr.sjyn2:39!null, i7hcr.btxc5:40!null, i7hcr.FVUCX:41!null, i7hcr.swcqv:42!null, i7hcr.YKSSU:43, i7hcr.FHCYT:44]\n" +
			"         │                           │   └─ Filter\n" +
			"         │                           │       ├─ scalarSubq0.oca7e:45 IS NULL\n" +
			"         │                           │       └─ LeftOuterMergeJoin\n" +
			"         │                           │           ├─ cmp: Eq\n" +
			"         │                           │           │   ├─ i7hcr.id:37!null\n" +
			"         │                           │           │   └─ scalarSubq0.oca7e:45\n" +
			"         │                           │           ├─ Filter\n" +
			"         │                           │           │   ├─ Eq\n" +
			"         │                           │           │   │   ├─ i7hcr.swcqv:42!null\n" +
			"         │                           │           │   │   └─ 0 (tinyint)\n" +
			"         │                           │           │   └─ TableAlias(i7hcr)\n" +
			"         │                           │           │       └─ IndexedTableAccess(EPZU6)\n" +
			"         │                           │           │           ├─ index: [EPZU6.id]\n" +
			"         │                           │           │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                           │           │           └─ columns: [id tofpn sjyn2 btxc5 fvucx swcqv ykssu fhcyt]\n" +
			"         │                           │           └─ Project\n" +
			"         │                           │               ├─ columns: [scalarSubq0.oca7e:43]\n" +
			"         │                           │               └─ Filter\n" +
			"         │                           │                   ├─ NOT\n" +
			"         │                           │                   │   └─ scalarSubq0.oca7e:43 IS NULL\n" +
			"         │                           │                   └─ TableAlias(scalarSubq0)\n" +
			"         │                           │                       └─ IndexedTableAccess(FLQLP)\n" +
			"         │                           │                           ├─ index: [FLQLP.OCA7E]\n" +
			"         │                           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                           │                           └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: TUPLE(i7hcr.tofpn:38!null, i7hcr.sjyn2:39!null, i7hcr.btxc5:40!null)\n" +
			"         │                               ├─ right-key: TUPLE(uct.ftqlq:38, uct.zh72s:39, uct.ljlum:42)\n" +
			"         │                               └─ TableAlias(uct)\n" +
			"         │                                   └─ Table\n" +
			"         │                                       ├─ name: OUBDL\n" +
			"         │                                       └─ columns: [id ftqlq zh72s sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e ykssu fhcyt qz6vt]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nd.id:20!null\n" +
			"             │   └─ ct.luevy:2!null\n" +
			"             ├─ HashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ ci.id:15!null\n" +
			"             │   │   └─ ct.fz2r5:1!null\n" +
			"             │   ├─ LookupJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ aac.id:12!null\n" +
			"             │   │   │   └─ ct.m22qn:3!null\n" +
			"             │   │   ├─ TableAlias(ct)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: FLQLP\n" +
			"             │   │   │       └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"             │   │   └─ TableAlias(aac)\n" +
			"             │   │       └─ IndexedTableAccess(TPXBU)\n" +
			"             │   │           ├─ index: [TPXBU.id]\n" +
			"             │   │           └─ columns: [id btxc5 fhcyt]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(ct.fz2r5:1!null)\n" +
			"             │       ├─ right-key: TUPLE(ci.id:0!null)\n" +
			"             │       └─ TableAlias(ci)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: JDLNA\n" +
			"             │               └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(ct.luevy:2!null)\n" +
			"                 ├─ right-key: TUPLE(nd.id:0!null)\n" +
			"                 └─ TableAlias(nd)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: E2I7U\n" +
			"                         └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   uct.*
	FROM
	(
	   SELECT DISTINCT
	       YLKSY.id AS FDL23
	   FROM
	       OUBDL YLKSY
	   INNER JOIN
	       JDLNA ci
	   ON
	       ci.FTQLQ = YLKSY.FTQLQ
	   INNER JOIN
	       E2I7U nd
	   ON
	       nd.ZH72S = YLKSY.ZH72S
	   INNER JOIN
	       TPXBU aac
	   ON
	       aac.BTXC5 = YLKSY.LJLUM
	   WHERE
	       YLKSY.LJLUM NOT LIKE '%|%'
	   AND
	       YLKSY.id NOT IN (SELECT NRURT FROM FLQLP WHERE NRURT IS NOT NULL)
	) FZWBD
	INNER JOIN
	   OUBDL uct
	ON
	   uct.id = FZWBD.FDL23
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [uct.id:1!null, uct.ftqlq:2, uct.zh72s:3, uct.sfj6l:4, uct.v5dpx:5, uct.ljlum:6, uct.idpk7:7, uct.no52d:8, uct.zrv3b:9, uct.vyo5e:10, uct.ykssu:11, uct.fhcyt:12, uct.qz6vt:13]\n" +
			" └─ LookupJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ uct.id:1!null\n" +
			"     │   └─ fzwbd.FDL23:0!null\n" +
			"     ├─ SubqueryAlias\n" +
			"     │   ├─ name: fzwbd\n" +
			"     │   ├─ outerVisibility: false\n" +
			"     │   ├─ cacheable: true\n" +
			"     │   └─ Distinct\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [FDL23:38!null]\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [ylksy.id:3!null, ylksy.ftqlq:4, ylksy.zh72s:5, ylksy.sfj6l:6, ylksy.v5dpx:7, ylksy.ljlum:8, ylksy.idpk7:9, ylksy.no52d:10, ylksy.zrv3b:11, ylksy.vyo5e:12, ylksy.ykssu:13, ylksy.fhcyt:14, ylksy.qz6vt:15, ci.id:16!null, ci.ftqlq:17!null, ci.fwwiq:18, ci.o3qxw:19, ci.fhcyt:20, nd.id:21!null, nd.dkcaj:22!null, nd.kng7t:23, nd.tw55n:24!null, nd.qrqxw:25!null, nd.ecxaj:26!null, nd.fgg57:27, nd.zh72s:28, nd.fsk67:29!null, nd.xqdyt:30!null, nd.tce7a:31, nd.iwv2h:32, nd.hpcms:33!null, nd.n5cc2:34, nd.fhcyt:35, nd.etaq7:36, nd.a75x7:37, aac.id:0!null, aac.btxc5:1, aac.fhcyt:2, ylksy.id:3!null as FDL23]\n" +
			"     │               └─ HashJoin\n" +
			"     │                   ├─ Eq\n" +
			"     │                   │   ├─ nd.zh72s:28\n" +
			"     │                   │   └─ ylksy.zh72s:5\n" +
			"     │                   ├─ HashJoin\n" +
			"     │                   │   ├─ Eq\n" +
			"     │                   │   │   ├─ ci.ftqlq:17!null\n" +
			"     │                   │   │   └─ ylksy.ftqlq:4\n" +
			"     │                   │   ├─ Project\n" +
			"     │                   │   │   ├─ columns: [aac.id:13!null, aac.btxc5:14, aac.FHCYT:15, ylksy.id:0!null, ylksy.ftqlq:1, ylksy.zh72s:2, ylksy.SFJ6L:3, ylksy.V5DPX:4, ylksy.ljlum:5, ylksy.IDPK7:6, ylksy.NO52D:7, ylksy.ZRV3B:8, ylksy.VYO5E:9, ylksy.YKSSU:10, ylksy.FHCYT:11, ylksy.QZ6VT:12]\n" +
			"     │                   │   │   └─ Filter\n" +
			"     │                   │   │       ├─ scalarSubq0.nrurt:16 IS NULL\n" +
			"     │                   │   │       └─ LeftOuterHashJoinExcludeNulls\n" +
			"     │                   │   │           ├─ Eq\n" +
			"     │                   │   │           │   ├─ ylksy.id:0!null\n" +
			"     │                   │   │           │   └─ scalarSubq0.nrurt:16\n" +
			"     │                   │   │           ├─ LookupJoin\n" +
			"     │                   │   │           │   ├─ Eq\n" +
			"     │                   │   │           │   │   ├─ aac.btxc5:14\n" +
			"     │                   │   │           │   │   └─ ylksy.ljlum:5\n" +
			"     │                   │   │           │   ├─ Filter\n" +
			"     │                   │   │           │   │   ├─ NOT\n" +
			"     │                   │   │           │   │   │   └─ ylksy.ljlum LIKE '%|%'\n" +
			"     │                   │   │           │   │   └─ TableAlias(ylksy)\n" +
			"     │                   │   │           │   │       └─ Table\n" +
			"     │                   │   │           │   │           ├─ name: OUBDL\n" +
			"     │                   │   │           │   │           └─ columns: [id ftqlq zh72s sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e ykssu fhcyt qz6vt]\n" +
			"     │                   │   │           │   └─ TableAlias(aac)\n" +
			"     │                   │   │           │       └─ IndexedTableAccess(TPXBU)\n" +
			"     │                   │   │           │           ├─ index: [TPXBU.BTXC5]\n" +
			"     │                   │   │           │           └─ columns: [id btxc5 fhcyt]\n" +
			"     │                   │   │           └─ HashLookup\n" +
			"     │                   │   │               ├─ left-key: TUPLE(ylksy.id:0!null)\n" +
			"     │                   │   │               ├─ right-key: TUPLE(scalarSubq0.nrurt:0)\n" +
			"     │                   │   │               └─ Project\n" +
			"     │                   │   │                   ├─ columns: [scalarSubq0.nrurt:5]\n" +
			"     │                   │   │                   └─ Filter\n" +
			"     │                   │   │                       ├─ NOT\n" +
			"     │                   │   │                       │   └─ scalarSubq0.nrurt:5 IS NULL\n" +
			"     │                   │   │                       └─ TableAlias(scalarSubq0)\n" +
			"     │                   │   │                           └─ Table\n" +
			"     │                   │   │                               ├─ name: FLQLP\n" +
			"     │                   │   │                               └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"     │                   │   └─ HashLookup\n" +
			"     │                   │       ├─ left-key: TUPLE(ylksy.ftqlq:4)\n" +
			"     │                   │       ├─ right-key: TUPLE(ci.ftqlq:1!null)\n" +
			"     │                   │       └─ TableAlias(ci)\n" +
			"     │                   │           └─ Table\n" +
			"     │                   │               ├─ name: JDLNA\n" +
			"     │                   │               └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"     │                   └─ HashLookup\n" +
			"     │                       ├─ left-key: TUPLE(ylksy.zh72s:5)\n" +
			"     │                       ├─ right-key: TUPLE(nd.zh72s:7)\n" +
			"     │                       └─ TableAlias(nd)\n" +
			"     │                           └─ Table\n" +
			"     │                               ├─ name: E2I7U\n" +
			"     │                               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"     └─ TableAlias(uct)\n" +
			"         └─ IndexedTableAccess(OUBDL)\n" +
			"             ├─ index: [OUBDL.id]\n" +
			"             └─ columns: [id ftqlq zh72s sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e ykssu fhcyt qz6vt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ct.id AS id,
	   ci.FTQLQ AS VCGT3,
	   nd.TW55N AS UWBAI,
	   aac.BTXC5 AS TPXBU,
	   ct.V5DPX AS V5DPX,
	   ct.S3Q3Y AS S3Q3Y,
	   ct.ZRV3B AS ZRV3B
	FROM
	   FLQLP ct
	INNER JOIN
	   HU5A5 TVTJS
	ON
	   TVTJS.id = ct.XMM6Q
	INNER JOIN
	   JDLNA ci
	ON
	   ci.id = ct.FZ2R5
	INNER JOIN
	   E2I7U nd
	ON
	   nd.id = ct.LUEVY
	INNER JOIN
	   TPXBU aac
	ON
	   aac.id = ct.M22QN
	WHERE
	   TVTJS.SWCQV = 1
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:50!null, VCGT3:51!null, UWBAI:52!null, TPXBU:53, V5DPX:54!null, S3Q3Y:55!null, ZRV3B:56!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [ct.id:0!null, ct.fz2r5:1!null, ct.luevy:2!null, ct.m22qn:3!null, ct.ove3e:4!null, ct.nrurt:5, ct.oca7e:6, ct.xmm6q:7, ct.v5dpx:8!null, ct.s3q3y:9!null, ct.zrv3b:10!null, ct.fhcyt:11, tvtjs.id:15!null, tvtjs.tofpn:16!null, tvtjs.i3vta:17!null, tvtjs.sfj6l:18, tvtjs.v5dpx:19!null, tvtjs.ljlum:20!null, tvtjs.idpk7:21!null, tvtjs.no52d:22!null, tvtjs.zrv3b:23!null, tvtjs.vyo5e:24, tvtjs.swcqv:25!null, tvtjs.ykssu:26, tvtjs.fhcyt:27, ci.id:28!null, ci.ftqlq:29!null, ci.fwwiq:30, ci.o3qxw:31, ci.fhcyt:32, nd.id:33!null, nd.dkcaj:34!null, nd.kng7t:35, nd.tw55n:36!null, nd.qrqxw:37!null, nd.ecxaj:38!null, nd.fgg57:39, nd.zh72s:40, nd.fsk67:41!null, nd.xqdyt:42!null, nd.tce7a:43, nd.iwv2h:44, nd.hpcms:45!null, nd.n5cc2:46, nd.fhcyt:47, nd.etaq7:48, nd.a75x7:49, aac.id:12!null, aac.btxc5:13, aac.fhcyt:14, ct.id:0!null as id, ci.ftqlq:29!null as VCGT3, nd.tw55n:36!null as UWBAI, aac.btxc5:13 as TPXBU, ct.v5dpx:8!null as V5DPX, ct.s3q3y:9!null as S3Q3Y, ct.zrv3b:10!null as ZRV3B]\n" +
			"     └─ Filter\n" +
			"         ├─ Eq\n" +
			"         │   ├─ tvtjs.swcqv:25!null\n" +
			"         │   └─ 1 (tinyint)\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nd.id:33!null\n" +
			"             │   └─ ct.luevy:2!null\n" +
			"             ├─ HashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ ci.id:28!null\n" +
			"             │   │   └─ ct.fz2r5:1!null\n" +
			"             │   ├─ HashJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ tvtjs.id:15!null\n" +
			"             │   │   │   └─ ct.xmm6q:7\n" +
			"             │   │   ├─ LookupJoin\n" +
			"             │   │   │   ├─ Eq\n" +
			"             │   │   │   │   ├─ aac.id:12!null\n" +
			"             │   │   │   │   └─ ct.m22qn:3!null\n" +
			"             │   │   │   ├─ TableAlias(ct)\n" +
			"             │   │   │   │   └─ Table\n" +
			"             │   │   │   │       ├─ name: FLQLP\n" +
			"             │   │   │   │       └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"             │   │   │   └─ TableAlias(aac)\n" +
			"             │   │   │       └─ IndexedTableAccess(TPXBU)\n" +
			"             │   │   │           ├─ index: [TPXBU.id]\n" +
			"             │   │   │           └─ columns: [id btxc5 fhcyt]\n" +
			"             │   │   └─ HashLookup\n" +
			"             │   │       ├─ left-key: TUPLE(ct.xmm6q:7)\n" +
			"             │   │       ├─ right-key: TUPLE(tvtjs.id:0!null)\n" +
			"             │   │       └─ Filter\n" +
			"             │   │           ├─ Eq\n" +
			"             │   │           │   ├─ tvtjs.swcqv:10!null\n" +
			"             │   │           │   └─ 1 (tinyint)\n" +
			"             │   │           └─ TableAlias(tvtjs)\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: HU5A5\n" +
			"             │   │                   └─ columns: [id tofpn i3vta sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e swcqv ykssu fhcyt]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(ct.fz2r5:1!null)\n" +
			"             │       ├─ right-key: TUPLE(ci.id:0!null)\n" +
			"             │       └─ TableAlias(ci)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: JDLNA\n" +
			"             │               └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(ct.luevy:2!null)\n" +
			"                 ├─ right-key: TUPLE(nd.id:0!null)\n" +
			"                 └─ TableAlias(nd)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: E2I7U\n" +
			"                         └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   *
	FROM
	   HU5A5
	WHERE
	       id NOT IN
	       (
	           SELECT
	               XMM6Q
	           FROM
	               FLQLP
	           WHERE XMM6Q IS NOT NULL
	       )
	   AND
	       SWCQV = 0
	`,
		ExpectedPlan: "Filter\n" +
			" ├─ Eq\n" +
			" │   ├─ hu5a5.swcqv:10!null\n" +
			" │   └─ 0 (tinyint)\n" +
			" └─ Project\n" +
			"     ├─ columns: [hu5a5.id:0!null, HU5A5.TOFPN:1!null, HU5A5.I3VTA:2!null, HU5A5.SFJ6L:3, HU5A5.V5DPX:4!null, HU5A5.LJLUM:5!null, HU5A5.IDPK7:6!null, HU5A5.NO52D:7!null, HU5A5.ZRV3B:8!null, HU5A5.VYO5E:9, HU5A5.SWCQV:10!null, HU5A5.YKSSU:11, HU5A5.FHCYT:12]\n" +
			"     └─ Filter\n" +
			"         ├─ scalarSubq0.xmm6q:13 IS NULL\n" +
			"         └─ LeftOuterMergeJoin\n" +
			"             ├─ cmp: Eq\n" +
			"             │   ├─ hu5a5.id:0!null\n" +
			"             │   └─ scalarSubq0.xmm6q:13\n" +
			"             ├─ IndexedTableAccess(HU5A5)\n" +
			"             │   ├─ index: [HU5A5.id]\n" +
			"             │   ├─ static: [{[NULL, ∞)}]\n" +
			"             │   └─ columns: [id tofpn i3vta sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e swcqv ykssu fhcyt]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [scalarSubq0.xmm6q:7]\n" +
			"                 └─ Filter\n" +
			"                     ├─ NOT\n" +
			"                     │   └─ scalarSubq0.xmm6q:7 IS NULL\n" +
			"                     └─ TableAlias(scalarSubq0)\n" +
			"                         └─ IndexedTableAccess(FLQLP)\n" +
			"                             ├─ index: [FLQLP.XMM6Q]\n" +
			"                             ├─ static: [{[NULL, ∞)}]\n" +
			"                             └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   rn.id AS id,
	   CONCAT(NSPLT.TW55N, 'FDNCN', LQNCX.TW55N) AS X37NA,
	   CONCAT(XLZA5.TW55N, 'FDNCN', AFJMD.TW55N) AS THWCS,
	   rn.HVHRZ AS HVHRZ
	FROM
	   QYWQD rn
	INNER JOIN
	   NOXN3 PV6R5
	ON
	   rn.WNUNU = PV6R5.id
	INNER JOIN
	   NOXN3 ZYUTC
	ON
	   rn.HHVLX = ZYUTC.id
	INNER JOIN
	   E2I7U NSPLT
	ON
	   NSPLT.id = PV6R5.BRQP2
	INNER JOIN
	   E2I7U LQNCX
	ON
	   LQNCX.id = PV6R5.FFTBJ
	INNER JOIN
	   E2I7U XLZA5
	ON
	   XLZA5.id = ZYUTC.BRQP2
	INNER JOIN
	   E2I7U AFJMD
	ON
	   AFJMD.id = ZYUTC.FFTBJ
	WHERE
	       PV6R5.FFTBJ <> ZYUTC.BRQP2
	   OR
	       PV6R5.NUMK2 <> 1
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:94!null, X37NA:95!null, THWCS:96!null, HVHRZ:97!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [rn.id:44!null, rn.wnunu:45!null, rn.hhvlx:46!null, rn.hvhrz:47!null, rn.ykssu:48, rn.fhcyt:49, pv6r5.id:17!null, pv6r5.brqp2:18!null, pv6r5.fftbj:19!null, pv6r5.a7xo2:20, pv6r5.kbo7r:21!null, pv6r5.ecdkm:22, pv6r5.numk2:23!null, pv6r5.letoe:24!null, pv6r5.ykssu:25, pv6r5.fhcyt:26, zyutc.id:67!null, zyutc.brqp2:68!null, zyutc.fftbj:69!null, zyutc.a7xo2:70, zyutc.kbo7r:71!null, zyutc.ecdkm:72, zyutc.numk2:73!null, zyutc.letoe:74!null, zyutc.ykssu:75, zyutc.fhcyt:76, nsplt.id:0!null, nsplt.dkcaj:1!null, nsplt.kng7t:2, nsplt.tw55n:3!null, nsplt.qrqxw:4!null, nsplt.ecxaj:5!null, nsplt.fgg57:6, nsplt.zh72s:7, nsplt.fsk67:8!null, nsplt.xqdyt:9!null, nsplt.tce7a:10, nsplt.iwv2h:11, nsplt.hpcms:12!null, nsplt.n5cc2:13, nsplt.fhcyt:14, nsplt.etaq7:15, nsplt.a75x7:16, lqncx.id:27!null, lqncx.dkcaj:28!null, lqncx.kng7t:29, lqncx.tw55n:30!null, lqncx.qrqxw:31!null, lqncx.ecxaj:32!null, lqncx.fgg57:33, lqncx.zh72s:34, lqncx.fsk67:35!null, lqncx.xqdyt:36!null, lqncx.tce7a:37, lqncx.iwv2h:38, lqncx.hpcms:39!null, lqncx.n5cc2:40, lqncx.fhcyt:41, lqncx.etaq7:42, lqncx.a75x7:43, xlza5.id:50!null, xlza5.dkcaj:51!null, xlza5.kng7t:52, xlza5.tw55n:53!null, xlza5.qrqxw:54!null, xlza5.ecxaj:55!null, xlza5.fgg57:56, xlza5.zh72s:57, xlza5.fsk67:58!null, xlza5.xqdyt:59!null, xlza5.tce7a:60, xlza5.iwv2h:61, xlza5.hpcms:62!null, xlza5.n5cc2:63, xlza5.fhcyt:64, xlza5.etaq7:65, xlza5.a75x7:66, afjmd.id:77!null, afjmd.dkcaj:78!null, afjmd.kng7t:79, afjmd.tw55n:80!null, afjmd.qrqxw:81!null, afjmd.ecxaj:82!null, afjmd.fgg57:83, afjmd.zh72s:84, afjmd.fsk67:85!null, afjmd.xqdyt:86!null, afjmd.tce7a:87, afjmd.iwv2h:88, afjmd.hpcms:89!null, afjmd.n5cc2:90, afjmd.fhcyt:91, afjmd.etaq7:92, afjmd.a75x7:93, rn.id:44!null as id, concat(nsplt.tw55n:3!null,FDNCN (longtext),lqncx.tw55n:30!null) as X37NA, concat(xlza5.tw55n:53!null,FDNCN (longtext),afjmd.tw55n:80!null) as THWCS, rn.hvhrz:47!null as HVHRZ]\n" +
			"     └─ Filter\n" +
			"         ├─ Or\n" +
			"         │   ├─ NOT\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ pv6r5.fftbj:19!null\n" +
			"         │   │       └─ zyutc.brqp2:68!null\n" +
			"         │   └─ NOT\n" +
			"         │       └─ Eq\n" +
			"         │           ├─ pv6r5.numk2:23!null\n" +
			"         │           └─ 1 (tinyint)\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rn.hhvlx:46!null\n" +
			"             │   └─ zyutc.id:67!null\n" +
			"             ├─ HashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rn.wnunu:45!null\n" +
			"             │   │   └─ pv6r5.id:17!null\n" +
			"             │   ├─ HashJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ lqncx.id:27!null\n" +
			"             │   │   │   └─ pv6r5.fftbj:19!null\n" +
			"             │   │   ├─ MergeJoin\n" +
			"             │   │   │   ├─ cmp: Eq\n" +
			"             │   │   │   │   ├─ nsplt.id:0!null\n" +
			"             │   │   │   │   └─ pv6r5.brqp2:18!null\n" +
			"             │   │   │   ├─ TableAlias(nsplt)\n" +
			"             │   │   │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │   │   │   │       ├─ index: [E2I7U.id]\n" +
			"             │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   │   │   └─ TableAlias(pv6r5)\n" +
			"             │   │   │       └─ IndexedTableAccess(NOXN3)\n" +
			"             │   │   │           ├─ index: [NOXN3.BRQP2]\n" +
			"             │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   │   └─ HashLookup\n" +
			"             │   │       ├─ left-key: TUPLE(pv6r5.fftbj:19!null)\n" +
			"             │   │       ├─ right-key: TUPLE(lqncx.id:0!null)\n" +
			"             │   │       └─ TableAlias(lqncx)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: E2I7U\n" +
			"             │   │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(pv6r5.id:17!null)\n" +
			"             │       ├─ right-key: TUPLE(rn.wnunu:1!null)\n" +
			"             │       └─ TableAlias(rn)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: QYWQD\n" +
			"             │               └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(rn.hhvlx:46!null)\n" +
			"                 ├─ right-key: TUPLE(zyutc.id:17!null)\n" +
			"                 └─ HashJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ afjmd.id:77!null\n" +
			"                     │   └─ zyutc.fftbj:69!null\n" +
			"                     ├─ MergeJoin\n" +
			"                     │   ├─ cmp: Eq\n" +
			"                     │   │   ├─ xlza5.id:50!null\n" +
			"                     │   │   └─ zyutc.brqp2:68!null\n" +
			"                     │   ├─ TableAlias(xlza5)\n" +
			"                     │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"                     │   │       ├─ index: [E2I7U.id]\n" +
			"                     │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                     │   └─ TableAlias(zyutc)\n" +
			"                     │       └─ IndexedTableAccess(NOXN3)\n" +
			"                     │           ├─ index: [NOXN3.BRQP2]\n" +
			"                     │           ├─ static: [{[NULL, ∞)}]\n" +
			"                     │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                     └─ HashLookup\n" +
			"                         ├─ left-key: TUPLE(zyutc.fftbj:69!null)\n" +
			"                         ├─ right-key: TUPLE(afjmd.id:0!null)\n" +
			"                         └─ TableAlias(afjmd)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: E2I7U\n" +
			"                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   sn.id AS DRIWM,
	   CONCAT(OE56M.TW55N, 'FDNCN', CGFRZ.TW55N) AS GRVSE,
	   SKPM6.id AS JIEVY,
	   CONCAT(V5SAY.TW55N, 'FDNCN', FQTHF.TW55N) AS ENCM3,
	   1.0 AS OHD3R
	FROM
	   NOXN3 sn
	INNER JOIN
	   NOXN3 SKPM6
	ON
	   SKPM6.BRQP2 = sn.FFTBJ
	LEFT JOIN
	   QYWQD rn
	ON
	       rn.WNUNU = sn.id
	   AND
	       rn.HHVLX = SKPM6.id
	INNER JOIN
	   E2I7U OE56M
	ON
	   OE56M.id = sn.BRQP2
	INNER JOIN
	   E2I7U CGFRZ
	ON
	   CGFRZ.id = sn.FFTBJ
	INNER JOIN
	   E2I7U V5SAY
	ON
	   V5SAY.id = SKPM6.BRQP2
	INNER JOIN
	   E2I7U FQTHF
	ON
	   FQTHF.id = SKPM6.FFTBJ
	WHERE
	       sn.NUMK2 = 1
	   AND
	       rn.WNUNU IS NULL AND rn.HHVLX IS NULL
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [DRIWM:94!null, GRVSE:95!null, JIEVY:96!null, ENCM3:97!null, OHD3R:98!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [sn.id:44!null, sn.brqp2:45!null, sn.fftbj:46!null, sn.a7xo2:47, sn.kbo7r:48!null, sn.ecdkm:49, sn.numk2:50!null, sn.letoe:51!null, sn.ykssu:52, sn.fhcyt:53, skpm6.id:17!null, skpm6.brqp2:18!null, skpm6.fftbj:19!null, skpm6.a7xo2:20, skpm6.kbo7r:21!null, skpm6.ecdkm:22, skpm6.numk2:23!null, skpm6.letoe:24!null, skpm6.ykssu:25, skpm6.fhcyt:26, rn.id:54!null, rn.wnunu:55!null, rn.hhvlx:56!null, rn.hvhrz:57!null, rn.ykssu:58, rn.fhcyt:59, oe56m.id:27!null, oe56m.dkcaj:28!null, oe56m.kng7t:29, oe56m.tw55n:30!null, oe56m.qrqxw:31!null, oe56m.ecxaj:32!null, oe56m.fgg57:33, oe56m.zh72s:34, oe56m.fsk67:35!null, oe56m.xqdyt:36!null, oe56m.tce7a:37, oe56m.iwv2h:38, oe56m.hpcms:39!null, oe56m.n5cc2:40, oe56m.fhcyt:41, oe56m.etaq7:42, oe56m.a75x7:43, cgfrz.id:77!null, cgfrz.dkcaj:78!null, cgfrz.kng7t:79, cgfrz.tw55n:80!null, cgfrz.qrqxw:81!null, cgfrz.ecxaj:82!null, cgfrz.fgg57:83, cgfrz.zh72s:84, cgfrz.fsk67:85!null, cgfrz.xqdyt:86!null, cgfrz.tce7a:87, cgfrz.iwv2h:88, cgfrz.hpcms:89!null, cgfrz.n5cc2:90, cgfrz.fhcyt:91, cgfrz.etaq7:92, cgfrz.a75x7:93, v5say.id:60!null, v5say.dkcaj:61!null, v5say.kng7t:62, v5say.tw55n:63!null, v5say.qrqxw:64!null, v5say.ecxaj:65!null, v5say.fgg57:66, v5say.zh72s:67, v5say.fsk67:68!null, v5say.xqdyt:69!null, v5say.tce7a:70, v5say.iwv2h:71, v5say.hpcms:72!null, v5say.n5cc2:73, v5say.fhcyt:74, v5say.etaq7:75, v5say.a75x7:76, fqthf.id:0!null, fqthf.dkcaj:1!null, fqthf.kng7t:2, fqthf.tw55n:3!null, fqthf.qrqxw:4!null, fqthf.ecxaj:5!null, fqthf.fgg57:6, fqthf.zh72s:7, fqthf.fsk67:8!null, fqthf.xqdyt:9!null, fqthf.tce7a:10, fqthf.iwv2h:11, fqthf.hpcms:12!null, fqthf.n5cc2:13, fqthf.fhcyt:14, fqthf.etaq7:15, fqthf.a75x7:16, sn.id:44!null as DRIWM, concat(oe56m.tw55n:30!null,FDNCN (longtext),cgfrz.tw55n:80!null) as GRVSE, skpm6.id:17!null as JIEVY, concat(v5say.tw55n:63!null,FDNCN (longtext),fqthf.tw55n:3!null) as ENCM3, 1 (decimal(2,1)) as OHD3R]\n" +
			"     └─ Filter\n" +
			"         ├─ AND\n" +
			"         │   ├─ rn.wnunu:55!null IS NULL\n" +
			"         │   └─ rn.hhvlx:56!null IS NULL\n" +
			"         └─ HashJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ AND\n" +
			"             │   │   │   ├─ Eq\n" +
			"             │   │   │   │   ├─ cgfrz.id:77!null\n" +
			"             │   │   │   │   └─ sn.fftbj:46!null\n" +
			"             │   │   │   └─ Eq\n" +
			"             │   │   │       ├─ v5say.id:60!null\n" +
			"             │   │   │       └─ skpm6.brqp2:18!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ sn.fftbj:46!null\n" +
			"             │   │       └─ v5say.id:60!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ skpm6.brqp2:18!null\n" +
			"             │       └─ cgfrz.id:77!null\n" +
			"             ├─ LeftOuterHashJoin\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ rn.wnunu:55!null\n" +
			"             │   │   │   └─ sn.id:44!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ rn.hhvlx:56!null\n" +
			"             │   │       └─ skpm6.id:17!null\n" +
			"             │   ├─ HashJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ skpm6.brqp2:18!null\n" +
			"             │   │   │   └─ sn.fftbj:46!null\n" +
			"             │   │   ├─ MergeJoin\n" +
			"             │   │   │   ├─ cmp: Eq\n" +
			"             │   │   │   │   ├─ fqthf.id:0!null\n" +
			"             │   │   │   │   └─ skpm6.fftbj:19!null\n" +
			"             │   │   │   ├─ TableAlias(fqthf)\n" +
			"             │   │   │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │   │   │   │       ├─ index: [E2I7U.id]\n" +
			"             │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   │   │   └─ TableAlias(skpm6)\n" +
			"             │   │   │       └─ IndexedTableAccess(NOXN3)\n" +
			"             │   │   │           ├─ index: [NOXN3.FFTBJ]\n" +
			"             │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   │   └─ HashLookup\n" +
			"             │   │       ├─ left-key: TUPLE(skpm6.brqp2:18!null)\n" +
			"             │   │       ├─ right-key: TUPLE(sn.fftbj:19!null)\n" +
			"             │   │       └─ MergeJoin\n" +
			"             │   │           ├─ cmp: Eq\n" +
			"             │   │           │   ├─ oe56m.id:27!null\n" +
			"             │   │           │   └─ sn.brqp2:45!null\n" +
			"             │   │           ├─ TableAlias(oe56m)\n" +
			"             │   │           │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │   │           │       ├─ index: [E2I7U.id]\n" +
			"             │   │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   │           └─ Filter\n" +
			"             │   │               ├─ Eq\n" +
			"             │   │               │   ├─ sn.numk2:6!null\n" +
			"             │   │               │   └─ 1 (tinyint)\n" +
			"             │   │               └─ TableAlias(sn)\n" +
			"             │   │                   └─ IndexedTableAccess(NOXN3)\n" +
			"             │   │                       ├─ index: [NOXN3.BRQP2]\n" +
			"             │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(sn.id:44!null, skpm6.id:17!null)\n" +
			"             │       ├─ right-key: TUPLE(rn.wnunu:1!null, rn.hhvlx:2!null)\n" +
			"             │       └─ TableAlias(rn)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: QYWQD\n" +
			"             │               └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(sn.fftbj:46!null, skpm6.brqp2:18!null, sn.fftbj:46!null, skpm6.brqp2:18!null)\n" +
			"                 ├─ right-key: TUPLE(cgfrz.id:17!null, v5say.id:0!null, v5say.id:0!null, cgfrz.id:17!null)\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ v5say.id:60!null\n" +
			"                     │   └─ cgfrz.id:77!null\n" +
			"                     ├─ TableAlias(v5say)\n" +
			"                     │   └─ IndexedTableAccess(E2I7U)\n" +
			"                     │       ├─ index: [E2I7U.id]\n" +
			"                     │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                     └─ TableAlias(cgfrz)\n" +
			"                         └─ IndexedTableAccess(E2I7U)\n" +
			"                             ├─ index: [E2I7U.id]\n" +
			"                             ├─ static: [{[NULL, ∞)}]\n" +
			"                             └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   id, FGG57, SSHPJ, SFJ6L
	FROM
	   TDRVG
	WHERE
	   id IN
	   (SELECT
	       (SELECT id FROM TDRVG WHERE SSHPJ = S7BYT.SSHPJ ORDER BY id LIMIT 1) AS id
	   FROM
	       (SELECT DISTINCT
	           S5KBM.SSHPJ AS SSHPJ,
	           S5KBM.SFJ6L AS SFJ6L
	       FROM
	           TDRVG S5KBM
	       INNER JOIN
	           E2I7U nd
	       ON
	           nd.FGG57 = S5KBM.FGG57) S7BYT
	   WHERE
	       S7BYT.SSHPJ NOT IN (SELECT SSHPJ FROM WE72E)
	   )
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [tdrvg.id:0!null, tdrvg.fgg57:1!null, tdrvg.sshpj:2!null, tdrvg.sfj6l:3!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [tdrvg.id:1!null, tdrvg.fgg57:2!null, tdrvg.sshpj:3!null, tdrvg.sfj6l:4!null, tdrvg.zh72s:5!null]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ tdrvg.id:1!null\n" +
			"         │   └─ scalarSubq0.id:0\n" +
			"         ├─ Distinct\n" +
			"         │   └─ SubqueryAlias\n" +
			"         │       ├─ name: scalarSubq0\n" +
			"         │       ├─ outerVisibility: false\n" +
			"         │       ├─ cacheable: true\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [id:2]\n" +
			"         │           └─ Project\n" +
			"         │               ├─ columns: [s7byt.SSHPJ:0!null, s7byt.SFJ6L:1!null, Subquery\n" +
			"         │               │   ├─ cacheable: false\n" +
			"         │               │   └─ Limit(1)\n" +
			"         │               │       └─ Project\n" +
			"         │               │           ├─ columns: [tdrvg.id:2!null]\n" +
			"         │               │           └─ Sort(tdrvg.id:2!null ASC nullsFirst)\n" +
			"         │               │               └─ Filter\n" +
			"         │               │                   ├─ Eq\n" +
			"         │               │                   │   ├─ tdrvg.sshpj:4!null\n" +
			"         │               │                   │   └─ s7byt.SSHPJ:0!null\n" +
			"         │               │                   └─ IndexedTableAccess(TDRVG)\n" +
			"         │               │                       ├─ index: [TDRVG.SSHPJ]\n" +
			"         │               │                       └─ columns: [id fgg57 sshpj sfj6l zh72s]\n" +
			"         │               │   as id]\n" +
			"         │               └─ AntiLookupJoin\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ s7byt.SSHPJ:0!null\n" +
			"         │                   │   └─ scalarSubq0.sshpj:4!null\n" +
			"         │                   ├─ SubqueryAlias\n" +
			"         │                   │   ├─ name: s7byt\n" +
			"         │                   │   ├─ outerVisibility: true\n" +
			"         │                   │   ├─ cacheable: true\n" +
			"         │                   │   └─ Distinct\n" +
			"         │                   │       └─ Project\n" +
			"         │                   │           ├─ columns: [SSHPJ:22!null, SFJ6L:23!null]\n" +
			"         │                   │           └─ Project\n" +
			"         │                   │               ├─ columns: [s5kbm.id:17!null, s5kbm.fgg57:18!null, s5kbm.sshpj:19!null, s5kbm.sfj6l:20!null, s5kbm.zh72s:21!null, nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, s5kbm.sshpj:19!null as SSHPJ, s5kbm.sfj6l:20!null as SFJ6L]\n" +
			"         │                   │               └─ LookupJoin\n" +
			"         │                   │                   ├─ Eq\n" +
			"         │                   │                   │   ├─ nd.fgg57:6\n" +
			"         │                   │                   │   └─ s5kbm.fgg57:18!null\n" +
			"         │                   │                   ├─ TableAlias(nd)\n" +
			"         │                   │                   │   └─ Table\n" +
			"         │                   │                   │       ├─ name: E2I7U\n" +
			"         │                   │                   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │                   │                   └─ TableAlias(s5kbm)\n" +
			"         │                   │                       └─ IndexedTableAccess(TDRVG)\n" +
			"         │                   │                           ├─ index: [TDRVG.FGG57]\n" +
			"         │                   │                           └─ columns: [id fgg57 sshpj sfj6l zh72s]\n" +
			"         │                   └─ TableAlias(scalarSubq0)\n" +
			"         │                       └─ IndexedTableAccess(WE72E)\n" +
			"         │                           ├─ index: [WE72E.SSHPJ]\n" +
			"         │                           └─ columns: [id qz7e7 sshpj fhcyt]\n" +
			"         └─ IndexedTableAccess(TDRVG)\n" +
			"             ├─ index: [TDRVG.id]\n" +
			"             └─ columns: [id fgg57 sshpj sfj6l zh72s]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   PBMRX.id AS id,
	   PBMRX.TW55N AS UYOGN,
	   PBMRX.ZH72S AS H4JEA
	FROM
	   (
	       SELECT
	           ZH72S AS ZH72S,
	           COUNT(ZH72S) AS JTOA7,
	           MIN(TJ66D) AS B4OVH,
	           SUM(TJ66D) AS R5CKX
	       FROM
	           (
	           SELECT
	               nd.id AS id,
	               nd.ZH72S AS ZH72S,
	               (SELECT COUNT(*) FROM AMYXQ WHERE LUEVY = nd.id) AS TJ66D
	           FROM
	               E2I7U nd
	           WHERE nd.ZH72S IS NOT NULL
	           ) TQ57W
	       GROUP BY
	           ZH72S
	       HAVING
	           JTOA7 > 1
	   ) CL3DT
	INNER JOIN
	   E2I7U PBMRX
	ON
	   PBMRX.ZH72S IS NOT NULL AND PBMRX.ZH72S = CL3DT.ZH72S
	WHERE
	       CL3DT.B4OVH = 0
	   AND
	       CL3DT.R5CKX > 0
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:21!null, UYOGN:22!null, H4JEA:23]\n" +
			" └─ Project\n" +
			"     ├─ columns: [cl3dt.ZH72S:17, cl3dt.JTOA7:18!null, cl3dt.B4OVH:19!null, cl3dt.R5CKX:20!null, pbmrx.id:0!null, pbmrx.dkcaj:1!null, pbmrx.kng7t:2, pbmrx.tw55n:3!null, pbmrx.qrqxw:4!null, pbmrx.ecxaj:5!null, pbmrx.fgg57:6, pbmrx.zh72s:7, pbmrx.fsk67:8!null, pbmrx.xqdyt:9!null, pbmrx.tce7a:10, pbmrx.iwv2h:11, pbmrx.hpcms:12!null, pbmrx.n5cc2:13, pbmrx.fhcyt:14, pbmrx.etaq7:15, pbmrx.a75x7:16, pbmrx.id:0!null as id, pbmrx.tw55n:3!null as UYOGN, pbmrx.zh72s:7 as H4JEA]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ pbmrx.zh72s:7\n" +
			"             │   └─ cl3dt.ZH72S:17\n" +
			"             ├─ Filter\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ pbmrx.zh72s:7 IS NULL\n" +
			"             │   └─ TableAlias(pbmrx)\n" +
			"             │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           ├─ index: [E2I7U.ZH72S]\n" +
			"             │           ├─ static: [{(NULL, ∞)}]\n" +
			"             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(pbmrx.zh72s:7)\n" +
			"                 ├─ right-key: TUPLE(cl3dt.ZH72S:0)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: cl3dt\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Filter\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ B4OVH:2!null\n" +
			"                         │   │   └─ 0 (tinyint)\n" +
			"                         │   └─ GreaterThan\n" +
			"                         │       ├─ R5CKX:3!null\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [ZH72S:4, JTOA7:5!null, B4OVH:6!null, R5CKX:7!null]\n" +
			"                             └─ Having\n" +
			"                                 ├─ GreaterThan\n" +
			"                                 │   ├─ JTOA7:5!null\n" +
			"                                 │   └─ 1 (tinyint)\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [count(tq57w.zh72s):0!null, min(tq57w.tj66d):1!null, sum(tq57w.tj66d):2!null, tq57w.ZH72S:3, tq57w.ZH72S:3 as ZH72S, count(tq57w.zh72s):0!null as JTOA7, min(tq57w.tj66d):1!null as B4OVH, sum(tq57w.tj66d):2!null as R5CKX]\n" +
			"                                     └─ GroupBy\n" +
			"                                         ├─ select: COUNT(tq57w.ZH72S:1), MIN(tq57w.TJ66D:2), SUM(tq57w.TJ66D:2), tq57w.ZH72S:1\n" +
			"                                         ├─ group: tq57w.ZH72S:1 as ZH72S\n" +
			"                                         └─ SubqueryAlias\n" +
			"                                             ├─ name: tq57w\n" +
			"                                             ├─ outerVisibility: false\n" +
			"                                             ├─ cacheable: true\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [id:17!null, ZH72S:18, TJ66D:19]\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, nd.id:0!null as id, nd.zh72s:7 as ZH72S, Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [count(1):17!null as COUNT(*)]\n" +
			"                                                     │       └─ GroupBy\n" +
			"                                                     │           ├─ select: COUNT(1 (bigint))\n" +
			"                                                     │           ├─ group: \n" +
			"                                                     │           └─ Filter\n" +
			"                                                     │               ├─ Eq\n" +
			"                                                     │               │   ├─ amyxq.luevy:17!null\n" +
			"                                                     │               │   └─ nd.id:0!null\n" +
			"                                                     │               └─ IndexedTableAccess(AMYXQ)\n" +
			"                                                     │                   ├─ index: [AMYXQ.LUEVY]\n" +
			"                                                     │                   └─ columns: [luevy]\n" +
			"                                                     │   as TJ66D]\n" +
			"                                                     └─ Filter\n" +
			"                                                         ├─ NOT\n" +
			"                                                         │   └─ nd.zh72s:7 IS NULL\n" +
			"                                                         └─ TableAlias(nd)\n" +
			"                                                             └─ IndexedTableAccess(E2I7U)\n" +
			"                                                                 ├─ index: [E2I7U.ZH72S]\n" +
			"                                                                 ├─ static: [{(NULL, ∞)}]\n" +
			"                                                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT /*+ JOIN_ORDER(ufc, nd, cla) */ DISTINCT
	   ufc.*
	FROM
	   SISUT ufc
	INNER JOIN
	   E2I7U nd
	ON
	   nd.ZH72S = ufc.ZH72S
	INNER JOIN
	   YK2GW cla
	ON
	   cla.FTQLQ = ufc.T4IBQ
	WHERE
	       nd.ZH72S IS NOT NULL
	   AND
	       ufc.id NOT IN (SELECT KKGN5 FROM AMYXQ)
	`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.amyxq:3, ufc.ktnz2:4, ufc.hiid2:5, ufc.dn3oq:6, ufc.vvknb:7, ufc.sh7tp:8, ufc.srzzo:9, ufc.qz6vt:10]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.amyxq:3, ufc.ktnz2:4, ufc.hiid2:5, ufc.dn3oq:6, ufc.vvknb:7, ufc.sh7tp:8, ufc.srzzo:9, ufc.qz6vt:10, nd.id:41!null, nd.dkcaj:42!null, nd.kng7t:43, nd.tw55n:44!null, nd.qrqxw:45!null, nd.ecxaj:46!null, nd.fgg57:47, nd.zh72s:48, nd.fsk67:49!null, nd.xqdyt:50!null, nd.tce7a:51, nd.iwv2h:52, nd.hpcms:53!null, nd.n5cc2:54, nd.fhcyt:55, nd.etaq7:56, nd.a75x7:57, cla.id:11!null, cla.ftqlq:12!null, cla.tuxml:13, cla.paef5:14, cla.rucy4:15, cla.tpnj6:16!null, cla.lbl53:17, cla.nb3qs:18, cla.eo7iv:19, cla.muhjf:20, cla.fm34l:21, cla.ty5rf:22, cla.zhtlh:23, cla.npb7w:24, cla.sx3hh:25, cla.isbnf:26, cla.ya7yb:27, cla.c5ykb:28, cla.qk7kt:29, cla.ffge6:30, cla.fiigj:31, cla.sh3nc:32, cla.ntena:33, cla.m4aub:34, cla.x5air:35, cla.sab6m:36, cla.g5qi5:37, cla.zvqvd:38, cla.ykssu:39, cla.fhcyt:40]\n" +
			"         └─ Filter\n" +
			"             ├─ NOT\n" +
			"             │   └─ nd.zh72s:48 IS NULL\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ nd.zh72s:48\n" +
			"                 │   └─ ufc.zh72s:2\n" +
			"                 ├─ HashJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ cla.ftqlq:12!null\n" +
			"                 │   │   └─ ufc.t4ibq:1\n" +
			"                 │   ├─ Project\n" +
			"                 │   │   ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.AMYXQ:3, ufc.KTNZ2:4, ufc.HIID2:5, ufc.DN3OQ:6, ufc.VVKNB:7, ufc.SH7TP:8, ufc.SRZZO:9, ufc.QZ6VT:10]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ scalarSubq0.kkgn5:11 IS NULL\n" +
			"                 │   │       └─ LeftOuterMergeJoin\n" +
			"                 │   │           ├─ cmp: Eq\n" +
			"                 │   │           │   ├─ ufc.id:0!null\n" +
			"                 │   │           │   └─ scalarSubq0.kkgn5:11\n" +
			"                 │   │           ├─ TableAlias(ufc)\n" +
			"                 │   │           │   └─ IndexedTableAccess(SISUT)\n" +
			"                 │   │           │       ├─ index: [SISUT.id]\n" +
			"                 │   │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │           │       └─ columns: [id t4ibq zh72s amyxq ktnz2 hiid2 dn3oq vvknb sh7tp srzzo qz6vt]\n" +
			"                 │   │           └─ Project\n" +
			"                 │   │               ├─ columns: [scalarSubq0.kkgn5:7]\n" +
			"                 │   │               └─ TableAlias(scalarSubq0)\n" +
			"                 │   │                   └─ IndexedTableAccess(AMYXQ)\n" +
			"                 │   │                       ├─ index: [AMYXQ.KKGN5]\n" +
			"                 │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │                       └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                 │   └─ HashLookup\n" +
			"                 │       ├─ left-key: TUPLE(ufc.t4ibq:1)\n" +
			"                 │       ├─ right-key: TUPLE(cla.ftqlq:1!null)\n" +
			"                 │       └─ TableAlias(cla)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: YK2GW\n" +
			"                 │               └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(ufc.zh72s:2)\n" +
			"                     ├─ right-key: TUPLE(nd.zh72s:7)\n" +
			"                     └─ Filter\n" +
			"                         ├─ NOT\n" +
			"                         │   └─ nd.zh72s:7 IS NULL\n" +
			"                         └─ TableAlias(nd)\n" +
			"                             └─ IndexedTableAccess(E2I7U)\n" +
			"                                 ├─ index: [E2I7U.ZH72S]\n" +
			"                                 ├─ static: [{(NULL, ∞)}]\n" +
			"                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT DISTINCT
	   ufc.*
	FROM
	   SISUT ufc
	INNER JOIN
	   E2I7U nd
	ON
	   nd.ZH72S = ufc.ZH72S
	INNER JOIN
	   YK2GW cla
	ON
	   cla.FTQLQ = ufc.T4IBQ
	WHERE
	       nd.ZH72S IS NOT NULL
	   AND
	       ufc.id NOT IN (SELECT KKGN5 FROM AMYXQ)
	`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.amyxq:3, ufc.ktnz2:4, ufc.hiid2:5, ufc.dn3oq:6, ufc.vvknb:7, ufc.sh7tp:8, ufc.srzzo:9, ufc.qz6vt:10]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.amyxq:3, ufc.ktnz2:4, ufc.hiid2:5, ufc.dn3oq:6, ufc.vvknb:7, ufc.sh7tp:8, ufc.srzzo:9, ufc.qz6vt:10, nd.id:41!null, nd.dkcaj:42!null, nd.kng7t:43, nd.tw55n:44!null, nd.qrqxw:45!null, nd.ecxaj:46!null, nd.fgg57:47, nd.zh72s:48, nd.fsk67:49!null, nd.xqdyt:50!null, nd.tce7a:51, nd.iwv2h:52, nd.hpcms:53!null, nd.n5cc2:54, nd.fhcyt:55, nd.etaq7:56, nd.a75x7:57, cla.id:11!null, cla.ftqlq:12!null, cla.tuxml:13, cla.paef5:14, cla.rucy4:15, cla.tpnj6:16!null, cla.lbl53:17, cla.nb3qs:18, cla.eo7iv:19, cla.muhjf:20, cla.fm34l:21, cla.ty5rf:22, cla.zhtlh:23, cla.npb7w:24, cla.sx3hh:25, cla.isbnf:26, cla.ya7yb:27, cla.c5ykb:28, cla.qk7kt:29, cla.ffge6:30, cla.fiigj:31, cla.sh3nc:32, cla.ntena:33, cla.m4aub:34, cla.x5air:35, cla.sab6m:36, cla.g5qi5:37, cla.zvqvd:38, cla.ykssu:39, cla.fhcyt:40]\n" +
			"         └─ Filter\n" +
			"             ├─ NOT\n" +
			"             │   └─ nd.zh72s:48 IS NULL\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ nd.zh72s:48\n" +
			"                 │   └─ ufc.zh72s:2\n" +
			"                 ├─ HashJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ cla.ftqlq:12!null\n" +
			"                 │   │   └─ ufc.t4ibq:1\n" +
			"                 │   ├─ Project\n" +
			"                 │   │   ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.AMYXQ:3, ufc.KTNZ2:4, ufc.HIID2:5, ufc.DN3OQ:6, ufc.VVKNB:7, ufc.SH7TP:8, ufc.SRZZO:9, ufc.QZ6VT:10]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ scalarSubq0.kkgn5:11 IS NULL\n" +
			"                 │   │       └─ LeftOuterMergeJoin\n" +
			"                 │   │           ├─ cmp: Eq\n" +
			"                 │   │           │   ├─ ufc.id:0!null\n" +
			"                 │   │           │   └─ scalarSubq0.kkgn5:11\n" +
			"                 │   │           ├─ TableAlias(ufc)\n" +
			"                 │   │           │   └─ IndexedTableAccess(SISUT)\n" +
			"                 │   │           │       ├─ index: [SISUT.id]\n" +
			"                 │   │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │           │       └─ columns: [id t4ibq zh72s amyxq ktnz2 hiid2 dn3oq vvknb sh7tp srzzo qz6vt]\n" +
			"                 │   │           └─ Project\n" +
			"                 │   │               ├─ columns: [scalarSubq0.kkgn5:7]\n" +
			"                 │   │               └─ TableAlias(scalarSubq0)\n" +
			"                 │   │                   └─ IndexedTableAccess(AMYXQ)\n" +
			"                 │   │                       ├─ index: [AMYXQ.KKGN5]\n" +
			"                 │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │                       └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                 │   └─ HashLookup\n" +
			"                 │       ├─ left-key: TUPLE(ufc.t4ibq:1)\n" +
			"                 │       ├─ right-key: TUPLE(cla.ftqlq:1!null)\n" +
			"                 │       └─ TableAlias(cla)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: YK2GW\n" +
			"                 │               └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(ufc.zh72s:2)\n" +
			"                     ├─ right-key: TUPLE(nd.zh72s:7)\n" +
			"                     └─ Filter\n" +
			"                         ├─ NOT\n" +
			"                         │   └─ nd.zh72s:7 IS NULL\n" +
			"                         └─ TableAlias(nd)\n" +
			"                             └─ IndexedTableAccess(E2I7U)\n" +
			"                                 ├─ index: [E2I7U.ZH72S]\n" +
			"                                 ├─ static: [{(NULL, ∞)}]\n" +
			"                                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ums.*
	FROM
	   FG26Y ums
	INNER JOIN
	   YK2GW cla
	ON
	   cla.FTQLQ = ums.T4IBQ
	WHERE
	   ums.id NOT IN (SELECT JOGI6 FROM SZQWJ)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.qz6vt:6]\n" +
			" └─ HashJoin\n" +
			"     ├─ Eq\n" +
			"     │   ├─ cla.ftqlq:8!null\n" +
			"     │   └─ ums.t4ibq:1\n" +
			"     ├─ Project\n" +
			"     │   ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.QZ6VT:6]\n" +
			"     │   └─ Filter\n" +
			"     │       ├─ scalarSubq0.jogi6:7 IS NULL\n" +
			"     │       └─ LeftOuterMergeJoin\n" +
			"     │           ├─ cmp: Eq\n" +
			"     │           │   ├─ ums.id:0!null\n" +
			"     │           │   └─ scalarSubq0.jogi6:7\n" +
			"     │           ├─ TableAlias(ums)\n" +
			"     │           │   └─ IndexedTableAccess(FG26Y)\n" +
			"     │           │       ├─ index: [FG26Y.id]\n" +
			"     │           │       ├─ static: [{[NULL, ∞)}]\n" +
			"     │           │       └─ columns: [id t4ibq ner ber hr mmr qz6vt]\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [scalarSubq0.jogi6:4]\n" +
			"     │               └─ TableAlias(scalarSubq0)\n" +
			"     │                   └─ IndexedTableAccess(SZQWJ)\n" +
			"     │                       ├─ index: [SZQWJ.JOGI6]\n" +
			"     │                       ├─ static: [{[NULL, ∞)}]\n" +
			"     │                       └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"     └─ HashLookup\n" +
			"         ├─ left-key: TUPLE(ums.t4ibq:1)\n" +
			"         ├─ right-key: TUPLE(cla.ftqlq:1!null)\n" +
			"         └─ TableAlias(cla)\n" +
			"             └─ Table\n" +
			"                 ├─ name: YK2GW\n" +
			"                 └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   mf.id AS id,
	   cla.FTQLQ AS T4IBQ,
	   nd.TW55N AS UWBAI,
	   aac.BTXC5 AS TPXBU,
	   mf.FSDY2 AS FSDY2
	FROM
	   HGMQ6 mf
	INNER JOIN
	   THNTS bs
	ON
	   bs.id = mf.GXLUB
	INNER JOIN
	   YK2GW cla
	ON
	   cla.id = bs.IXUXU
	INNER JOIN
	   E2I7U nd
	ON
	   nd.id = mf.LUEVY
	INNER JOIN
	   TPXBU aac
	ON
	   aac.id = mf.M22QN
	WHERE
	(
	       mf.QQV4M IS NOT NULL
	   AND
	       (
	               (SELECT TJ5D2.SWCQV FROM SZW6V TJ5D2 WHERE TJ5D2.id = mf.QQV4M) = 1
	           OR
	               (SELECT nd.id FROM E2I7U nd WHERE nd.TW55N =
	                   (SELECT TJ5D2.H4DMT FROM SZW6V TJ5D2
	                   WHERE TJ5D2.id = mf.QQV4M))
	               <> mf.LUEVY
	       )
	)
	OR
	(
	       mf.TEUJA IS NOT NULL
	   AND
	       mf.TEUJA IN
	       (
	       SELECT
	           umf.id AS ORB3K
	       FROM
	           SZW6V TJ5D2
	       INNER JOIN
	           NZKPM umf
	       ON
	               umf.T4IBQ = TJ5D2.T4IBQ
	           AND
	               umf.FGG57 = TJ5D2.V7UFH
	           AND
	               umf.SYPKF = TJ5D2.SYPKF
	       WHERE
	               TJ5D2.SWCQV = 0
	           AND
	               TJ5D2.id NOT IN (SELECT QQV4M FROM HGMQ6 WHERE QQV4M IS NOT NULL)
	       )
	)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [id:71!null, T4IBQ:72!null, UWBAI:73!null, TPXBU:74, FSDY2:75!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mf.id:17!null, mf.gxlub:18!null, mf.luevy:19!null, mf.m22qn:20!null, mf.tjpt7:21!null, mf.arn5p:22!null, mf.xosd4:23!null, mf.ide43:24, mf.hmw4h:25, mf.zbt6r:26, mf.fsdy2:27!null, mf.lt7k6:28, mf.sppyd:29, mf.qcgts:30, mf.teuja:31, mf.qqv4m:32, mf.fhcyt:33, bs.id:67!null, bs.nfryn:68!null, bs.ixuxu:69, bs.fhcyt:70, cla.id:37!null, cla.ftqlq:38!null, cla.tuxml:39, cla.paef5:40, cla.rucy4:41, cla.tpnj6:42!null, cla.lbl53:43, cla.nb3qs:44, cla.eo7iv:45, cla.muhjf:46, cla.fm34l:47, cla.ty5rf:48, cla.zhtlh:49, cla.npb7w:50, cla.sx3hh:51, cla.isbnf:52, cla.ya7yb:53, cla.c5ykb:54, cla.qk7kt:55, cla.ffge6:56, cla.fiigj:57, cla.sh3nc:58, cla.ntena:59, cla.m4aub:60, cla.x5air:61, cla.sab6m:62, cla.g5qi5:63, cla.zvqvd:64, cla.ykssu:65, cla.fhcyt:66, nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, aac.id:34!null, aac.btxc5:35, aac.fhcyt:36, mf.id:17!null as id, cla.ftqlq:38!null as T4IBQ, nd.tw55n:3!null as UWBAI, aac.btxc5:35 as TPXBU, mf.fsdy2:27!null as FSDY2]\n" +
			"     └─ Filter\n" +
			"         ├─ Or\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ NOT\n" +
			"         │   │   │   └─ mf.qqv4m:32 IS NULL\n" +
			"         │   │   └─ Or\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ Subquery\n" +
			"         │   │       │   │   ├─ cacheable: false\n" +
			"         │   │       │   │   └─ Project\n" +
			"         │   │       │   │       ├─ columns: [tj5d2.swcqv:76!null]\n" +
			"         │   │       │   │       └─ Filter\n" +
			"         │   │       │   │           ├─ Eq\n" +
			"         │   │       │   │           │   ├─ tj5d2.id:71!null\n" +
			"         │   │       │   │           │   └─ mf.qqv4m:32\n" +
			"         │   │       │   │           └─ TableAlias(tj5d2)\n" +
			"         │   │       │   │               └─ IndexedTableAccess(SZW6V)\n" +
			"         │   │       │   │                   ├─ index: [SZW6V.id]\n" +
			"         │   │       │   │                   └─ columns: [id t4ibq v7ufh sypkf h4dmt swcqv ykssu fhcyt]\n" +
			"         │   │       │   └─ 1 (tinyint)\n" +
			"         │   │       └─ NOT\n" +
			"         │   │           └─ Eq\n" +
			"         │   │               ├─ Subquery\n" +
			"         │   │               │   ├─ cacheable: false\n" +
			"         │   │               │   └─ Project\n" +
			"         │   │               │       ├─ columns: [nd.id:71!null]\n" +
			"         │   │               │       └─ Filter\n" +
			"         │   │               │           ├─ Eq\n" +
			"         │   │               │           │   ├─ nd.tw55n:74!null\n" +
			"         │   │               │           │   └─ Subquery\n" +
			"         │   │               │           │       ├─ cacheable: false\n" +
			"         │   │               │           │       └─ Project\n" +
			"         │   │               │           │           ├─ columns: [tj5d2.h4dmt:92!null]\n" +
			"         │   │               │           │           └─ Filter\n" +
			"         │   │               │           │               ├─ Eq\n" +
			"         │   │               │           │               │   ├─ tj5d2.id:88!null\n" +
			"         │   │               │           │               │   └─ mf.qqv4m:32\n" +
			"         │   │               │           │               └─ TableAlias(tj5d2)\n" +
			"         │   │               │           │                   └─ IndexedTableAccess(SZW6V)\n" +
			"         │   │               │           │                       ├─ index: [SZW6V.id]\n" +
			"         │   │               │           │                       └─ columns: [id t4ibq v7ufh sypkf h4dmt swcqv ykssu fhcyt]\n" +
			"         │   │               │           └─ TableAlias(nd)\n" +
			"         │   │               │               └─ Table\n" +
			"         │   │               │                   ├─ name: E2I7U\n" +
			"         │   │               │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │               └─ mf.luevy:19!null\n" +
			"         │   └─ AND\n" +
			"         │       ├─ NOT\n" +
			"         │       │   └─ mf.teuja:31 IS NULL\n" +
			"         │       └─ InSubquery\n" +
			"         │           ├─ left: mf.teuja:31\n" +
			"         │           └─ right: Subquery\n" +
			"         │               ├─ cacheable: true\n" +
			"         │               └─ Project\n" +
			"         │                   ├─ columns: [ORB3K:104!null]\n" +
			"         │                   └─ Project\n" +
			"         │                       ├─ columns: [tj5d2.id:71!null, tj5d2.t4ibq:72!null, tj5d2.v7ufh:73!null, tj5d2.sypkf:74!null, tj5d2.h4dmt:75!null, tj5d2.swcqv:76!null, tj5d2.ykssu:77, tj5d2.fhcyt:78, umf.id:79!null, umf.t4ibq:80, umf.fgg57:81, umf.sshpj:82, umf.nla6o:83, umf.sfj6l:84, umf.tjpt7:85, umf.arn5p:86, umf.sypkf:87, umf.ivfmk:88, umf.ide43:89, umf.az6sp:90, umf.fsdy2:91, umf.xosd4:92, umf.hmw4h:93, umf.s76om:94, umf.vaf:95, umf.zroh6:96, umf.qcgts:97, umf.lnfm6:98, umf.tvawl:99, umf.hdlcl:100, umf.bhhw6:101, umf.fhcyt:102, umf.qz6vt:103, umf.id:79!null as ORB3K]\n" +
			"         │                       └─ AntiLookupJoin\n" +
			"         │                           ├─ Eq\n" +
			"         │                           │   ├─ tj5d2.id:71!null\n" +
			"         │                           │   └─ scalarSubq0.qqv4m:119\n" +
			"         │                           ├─ LookupJoin\n" +
			"         │                           │   ├─ AND\n" +
			"         │                           │   │   ├─ AND\n" +
			"         │                           │   │   │   ├─ Eq\n" +
			"         │                           │   │   │   │   ├─ umf.t4ibq:80\n" +
			"         │                           │   │   │   │   └─ tj5d2.t4ibq:72!null\n" +
			"         │                           │   │   │   └─ Eq\n" +
			"         │                           │   │   │       ├─ umf.fgg57:81\n" +
			"         │                           │   │   │       └─ tj5d2.v7ufh:73!null\n" +
			"         │                           │   │   └─ Eq\n" +
			"         │                           │   │       ├─ umf.sypkf:87\n" +
			"         │                           │   │       └─ tj5d2.sypkf:74!null\n" +
			"         │                           │   ├─ Filter\n" +
			"         │                           │   │   ├─ Eq\n" +
			"         │                           │   │   │   ├─ tj5d2.swcqv:76!null\n" +
			"         │                           │   │   │   └─ 0 (tinyint)\n" +
			"         │                           │   │   └─ TableAlias(tj5d2)\n" +
			"         │                           │   │       └─ Table\n" +
			"         │                           │   │           ├─ name: SZW6V\n" +
			"         │                           │   │           └─ columns: [id t4ibq v7ufh sypkf h4dmt swcqv ykssu fhcyt]\n" +
			"         │                           │   └─ TableAlias(umf)\n" +
			"         │                           │       └─ IndexedTableAccess(NZKPM)\n" +
			"         │                           │           ├─ index: [NZKPM.FGG57]\n" +
			"         │                           │           └─ columns: [id t4ibq fgg57 sshpj nla6o sfj6l tjpt7 arn5p sypkf ivfmk ide43 az6sp fsdy2 xosd4 hmw4h s76om vaf zroh6 qcgts lnfm6 tvawl hdlcl bhhw6 fhcyt qz6vt]\n" +
			"         │                           └─ Filter\n" +
			"         │                               ├─ NOT\n" +
			"         │                               │   └─ scalarSubq0.qqv4m:86 IS NULL\n" +
			"         │                               └─ TableAlias(scalarSubq0)\n" +
			"         │                                   └─ IndexedTableAccess(HGMQ6)\n" +
			"         │                                       ├─ index: [HGMQ6.QQV4M]\n" +
			"         │                                       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ bs.id:67!null\n" +
			"             │   └─ mf.gxlub:18!null\n" +
			"             ├─ HashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ aac.id:34!null\n" +
			"             │   │   └─ mf.m22qn:20!null\n" +
			"             │   ├─ MergeJoin\n" +
			"             │   │   ├─ cmp: Eq\n" +
			"             │   │   │   ├─ nd.id:0!null\n" +
			"             │   │   │   └─ mf.luevy:19!null\n" +
			"             │   │   ├─ TableAlias(nd)\n" +
			"             │   │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │   │   │       ├─ index: [E2I7U.id]\n" +
			"             │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   │   └─ TableAlias(mf)\n" +
			"             │   │       └─ IndexedTableAccess(HGMQ6)\n" +
			"             │   │           ├─ index: [HGMQ6.LUEVY]\n" +
			"             │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(mf.m22qn:20!null)\n" +
			"             │       ├─ right-key: TUPLE(aac.id:0!null)\n" +
			"             │       └─ TableAlias(aac)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: TPXBU\n" +
			"             │               └─ columns: [id btxc5 fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(mf.gxlub:18!null)\n" +
			"                 ├─ right-key: TUPLE(bs.id:30!null)\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ cla.id:37!null\n" +
			"                     │   └─ bs.ixuxu:69\n" +
			"                     ├─ TableAlias(cla)\n" +
			"                     │   └─ IndexedTableAccess(YK2GW)\n" +
			"                     │       ├─ index: [YK2GW.id]\n" +
			"                     │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                     └─ TableAlias(bs)\n" +
			"                         └─ IndexedTableAccess(THNTS)\n" +
			"                             ├─ index: [THNTS.IXUXU]\n" +
			"                             ├─ static: [{[NULL, ∞)}]\n" +
			"                             └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   umf.*
	FROM
	   NZKPM umf
	INNER JOIN
	   E2I7U nd
	ON
	   nd.FGG57 = umf.FGG57
	INNER JOIN
	   YK2GW cla
	ON
	   cla.FTQLQ = umf.T4IBQ
	WHERE
	       nd.FGG57 IS NOT NULL
	   AND
	       umf.ARN5P <> 'N/A'
	   AND
	       umf.id NOT IN (SELECT TEUJA FROM HGMQ6)
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [umf.id:0!null, umf.t4ibq:1, umf.fgg57:2, umf.sshpj:3, umf.nla6o:4, umf.sfj6l:5, umf.tjpt7:6, umf.arn5p:7, umf.sypkf:8, umf.ivfmk:9, umf.ide43:10, umf.az6sp:11, umf.fsdy2:12, umf.xosd4:13, umf.hmw4h:14, umf.s76om:15, umf.vaf:16, umf.zroh6:17, umf.qcgts:18, umf.lnfm6:19, umf.tvawl:20, umf.hdlcl:21, umf.bhhw6:22, umf.fhcyt:23, umf.qz6vt:24]\n" +
			" └─ Project\n" +
			"     ├─ columns: [umf.id:0!null, umf.t4ibq:1, umf.fgg57:2, umf.sshpj:3, umf.nla6o:4, umf.sfj6l:5, umf.tjpt7:6, umf.arn5p:7, umf.sypkf:8, umf.ivfmk:9, umf.ide43:10, umf.az6sp:11, umf.fsdy2:12, umf.xosd4:13, umf.hmw4h:14, umf.s76om:15, umf.vaf:16, umf.zroh6:17, umf.qcgts:18, umf.lnfm6:19, umf.tvawl:20, umf.hdlcl:21, umf.bhhw6:22, umf.fhcyt:23, umf.qz6vt:24, nd.id:55!null, nd.dkcaj:56!null, nd.kng7t:57, nd.tw55n:58!null, nd.qrqxw:59!null, nd.ecxaj:60!null, nd.fgg57:61, nd.zh72s:62, nd.fsk67:63!null, nd.xqdyt:64!null, nd.tce7a:65, nd.iwv2h:66, nd.hpcms:67!null, nd.n5cc2:68, nd.fhcyt:69, nd.etaq7:70, nd.a75x7:71, cla.id:25!null, cla.ftqlq:26!null, cla.tuxml:27, cla.paef5:28, cla.rucy4:29, cla.tpnj6:30!null, cla.lbl53:31, cla.nb3qs:32, cla.eo7iv:33, cla.muhjf:34, cla.fm34l:35, cla.ty5rf:36, cla.zhtlh:37, cla.npb7w:38, cla.sx3hh:39, cla.isbnf:40, cla.ya7yb:41, cla.c5ykb:42, cla.qk7kt:43, cla.ffge6:44, cla.fiigj:45, cla.sh3nc:46, cla.ntena:47, cla.m4aub:48, cla.x5air:49, cla.sab6m:50, cla.g5qi5:51, cla.zvqvd:52, cla.ykssu:53, cla.fhcyt:54]\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ nd.fgg57:61 IS NULL\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nd.fgg57:61\n" +
			"             │   └─ umf.fgg57:2\n" +
			"             ├─ HashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ cla.ftqlq:26!null\n" +
			"             │   │   └─ umf.t4ibq:1\n" +
			"             │   ├─ Project\n" +
			"             │   │   ├─ columns: [umf.id:0!null, umf.t4ibq:1, umf.fgg57:2, umf.SSHPJ:3, umf.NLA6O:4, umf.SFJ6L:5, umf.TJPT7:6, umf.arn5p:7, umf.SYPKF:8, umf.IVFMK:9, umf.IDE43:10, umf.AZ6SP:11, umf.FSDY2:12, umf.XOSD4:13, umf.HMW4H:14, umf.S76OM:15, umf.vaf:16, umf.ZROH6:17, umf.QCGTS:18, umf.LNFM6:19, umf.TVAWL:20, umf.HDLCL:21, umf.BHHW6:22, umf.FHCYT:23, umf.QZ6VT:24]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ scalarSubq0.teuja:25 IS NULL\n" +
			"             │   │       └─ LeftOuterMergeJoin\n" +
			"             │   │           ├─ cmp: Eq\n" +
			"             │   │           │   ├─ umf.id:0!null\n" +
			"             │   │           │   └─ scalarSubq0.teuja:25\n" +
			"             │   │           ├─ Filter\n" +
			"             │   │           │   ├─ NOT\n" +
			"             │   │           │   │   └─ Eq\n" +
			"             │   │           │   │       ├─ umf.arn5p:7\n" +
			"             │   │           │   │       └─ N/A (longtext)\n" +
			"             │   │           │   └─ TableAlias(umf)\n" +
			"             │   │           │       └─ IndexedTableAccess(NZKPM)\n" +
			"             │   │           │           ├─ index: [NZKPM.id]\n" +
			"             │   │           │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           │           └─ columns: [id t4ibq fgg57 sshpj nla6o sfj6l tjpt7 arn5p sypkf ivfmk ide43 az6sp fsdy2 xosd4 hmw4h s76om vaf zroh6 qcgts lnfm6 tvawl hdlcl bhhw6 fhcyt qz6vt]\n" +
			"             │   │           └─ Project\n" +
			"             │   │               ├─ columns: [scalarSubq0.teuja:14]\n" +
			"             │   │               └─ TableAlias(scalarSubq0)\n" +
			"             │   │                   └─ IndexedTableAccess(HGMQ6)\n" +
			"             │   │                       ├─ index: [HGMQ6.TEUJA]\n" +
			"             │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │                       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(umf.t4ibq:1)\n" +
			"             │       ├─ right-key: TUPLE(cla.ftqlq:1!null)\n" +
			"             │       └─ TableAlias(cla)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: YK2GW\n" +
			"             │               └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(umf.fgg57:2)\n" +
			"                 ├─ right-key: TUPLE(nd.fgg57:6)\n" +
			"                 └─ Filter\n" +
			"                     ├─ NOT\n" +
			"                     │   └─ nd.fgg57:6 IS NULL\n" +
			"                     └─ TableAlias(nd)\n" +
			"                         └─ IndexedTableAccess(E2I7U)\n" +
			"                             ├─ index: [E2I7U.FGG57]\n" +
			"                             ├─ static: [{(NULL, ∞)}]\n" +
			"                             └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `SELECT
	   HVHRZ
	FROM
	   QYWQD
	ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [qywqd.hvhrz:3!null]\n" +
			" └─ IndexedTableAccess(QYWQD)\n" +
			"     ├─ index: [QYWQD.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   cla.FTQLQ AS T4IBQ,
	   SL3S5.TOFPN AS DL754,
	   sn.id AS BDNYB,
	   SL3S5.ADURZ AS ADURZ,
	   (SELECT aac.BTXC5 FROM TPXBU aac WHERE aac.id = SL3S5.M22QN) AS TPXBU,
	   SL3S5.NO52D AS NO52D,
	   SL3S5.IDPK7 AS IDPK7
	FROM
	   YK2GW cla
	INNER JOIN THNTS bs ON cla.id = bs.IXUXU
	INNER JOIN HGMQ6 mf ON bs.id = mf.GXLUB
	INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	INNER JOIN
	   (
	   SELECT /*+ JOIN_ORDER( ci, ct, cec, KHJJO ) */
	       KHJJO.BDNYB AS BDNYB,
	       ci.FTQLQ AS TOFPN,
	       ct.M22QN AS M22QN,
	       cec.ADURZ AS ADURZ,
	       cec.NO52D AS NO52D,
	       ct.S3Q3Y AS IDPK7
	   FROM
	       (
	       SELECT DISTINCT
	           mf.M22QN AS M22QN,
	           sn.id AS BDNYB,
	           mf.LUEVY AS LUEVY
	       FROM
	           HGMQ6 mf
	       INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	       ) KHJJO
	   INNER JOIN
	       FLQLP ct
	   ON
	           ct.M22QN = KHJJO.M22QN
	       AND
	           ct.LUEVY = KHJJO.LUEVY
	   INNER JOIN JDLNA ci ON  ci.id = ct.FZ2R5 AND ct.ZRV3B = '='
	   INNER JOIN SFEGG cec ON cec.id = ct.OVE3E
	   WHERE
	       ci.FTQLQ IN ('SQ1')
	   ) SL3S5
	ON
	       SL3S5.BDNYB = sn.id
	   AND
	       SL3S5.M22QN = mf.M22QN
	WHERE
	   cla.FTQLQ IN ('SQ1')
	UNION ALL

	SELECT
	   AOEV5.*,
	   VUMUY.*
	FROM (
	SELECT
	   SL3S5.TOFPN AS DL754,
	   sn.id AS BDNYB,
	   SL3S5.ADURZ AS ADURZ,
	   (SELECT aac.BTXC5 FROM TPXBU aac WHERE aac.id = SL3S5.M22QN) AS TPXBU,
	   SL3S5.NO52D AS NO52D,
	   SL3S5.IDPK7 AS IDPK7
	FROM
	   NOXN3 sn
	INNER JOIN
	   (
	   SELECT
	       sn.id AS BDNYB,
	       ci.FTQLQ AS TOFPN,
	       ct.M22QN AS M22QN,
	       cec.ADURZ AS ADURZ,
	       cec.NO52D AS NO52D,
	       ct.S3Q3Y AS IDPK7
	   FROM
	       NOXN3 sn
	   INNER JOIN
	       FLQLP ct
	   ON
	           ct.M22QN = (SELECT aac.id FROM TPXBU aac WHERE BTXC5 = 'WT')
	       AND
	           ct.LUEVY = sn.BRQP2
	   INNER JOIN JDLNA ci ON  ci.id = ct.FZ2R5 AND ct.ZRV3B = '='
	   INNER JOIN SFEGG cec ON cec.id = ct.OVE3E
	   WHERE
	       ci.FTQLQ IN ('SQ1')
	   ) SL3S5
	ON
	       SL3S5.BDNYB = sn.id ) VUMUY
	CROSS JOIN
	   (
	   SELECT * FROM (VALUES
	      ROW("1"),
	      ROW("2"),
	      ROW("3"),
	      ROW("4"),
	      ROW("5")
	       ) AS temp_AOEV5(T4IBQ)
	   ) AOEV5`,
		ExpectedPlan: "Union all\n" +
			" ├─ Project\n" +
			" │   ├─ columns: [convert\n" +
			" │   │   ├─ type: char\n" +
			" │   │   └─ T4IBQ:0!null\n" +
			" │   │   as T4IBQ, DL754:1!null, BDNYB:2!null, ADURZ:3!null, TPXBU:4, NO52D:5!null, IDPK7:6!null]\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [T4IBQ:67!null, DL754:68!null, BDNYB:69!null, ADURZ:70!null, TPXBU:71, NO52D:72!null, IDPK7:73!null]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [cla.id:33!null, cla.ftqlq:34!null, cla.tuxml:35, cla.paef5:36, cla.rucy4:37, cla.tpnj6:38!null, cla.lbl53:39, cla.nb3qs:40, cla.eo7iv:41, cla.muhjf:42, cla.fm34l:43, cla.ty5rf:44, cla.zhtlh:45, cla.npb7w:46, cla.sx3hh:47, cla.isbnf:48, cla.ya7yb:49, cla.c5ykb:50, cla.qk7kt:51, cla.ffge6:52, cla.fiigj:53, cla.sh3nc:54, cla.ntena:55, cla.m4aub:56, cla.x5air:57, cla.sab6m:58, cla.g5qi5:59, cla.zvqvd:60, cla.ykssu:61, cla.fhcyt:62, bs.id:63!null, bs.nfryn:64!null, bs.ixuxu:65, bs.fhcyt:66, mf.id:0!null, mf.gxlub:1!null, mf.luevy:2!null, mf.m22qn:3!null, mf.tjpt7:4!null, mf.arn5p:5!null, mf.xosd4:6!null, mf.ide43:7, mf.hmw4h:8, mf.zbt6r:9, mf.fsdy2:10!null, mf.lt7k6:11, mf.sppyd:12, mf.qcgts:13, mf.teuja:14, mf.qqv4m:15, mf.fhcyt:16, sn.id:23!null, sn.brqp2:24!null, sn.fftbj:25!null, sn.a7xo2:26, sn.kbo7r:27!null, sn.ecdkm:28, sn.numk2:29!null, sn.letoe:30!null, sn.ykssu:31, sn.fhcyt:32, sl3s5.BDNYB:17!null, sl3s5.TOFPN:18!null, sl3s5.M22QN:19!null, sl3s5.ADURZ:20!null, sl3s5.NO52D:21!null, sl3s5.IDPK7:22!null, cla.ftqlq:34!null as T4IBQ, sl3s5.TOFPN:18!null as DL754, sn.id:23!null as BDNYB, sl3s5.ADURZ:20!null as ADURZ, Subquery\n" +
			" │           │   ├─ cacheable: false\n" +
			" │           │   └─ Project\n" +
			" │           │       ├─ columns: [aac.btxc5:68]\n" +
			" │           │       └─ Filter\n" +
			" │           │           ├─ Eq\n" +
			" │           │           │   ├─ aac.id:67!null\n" +
			" │           │           │   └─ sl3s5.M22QN:19!null\n" +
			" │           │           └─ TableAlias(aac)\n" +
			" │           │               └─ IndexedTableAccess(TPXBU)\n" +
			" │           │                   ├─ index: [TPXBU.id]\n" +
			" │           │                   └─ columns: [id btxc5 fhcyt]\n" +
			" │           │   as TPXBU, sl3s5.NO52D:21!null as NO52D, sl3s5.IDPK7:22!null as IDPK7]\n" +
			" │           └─ HashJoin\n" +
			" │               ├─ Eq\n" +
			" │               │   ├─ bs.id:63!null\n" +
			" │               │   └─ mf.gxlub:1!null\n" +
			" │               ├─ HashJoin\n" +
			" │               │   ├─ AND\n" +
			" │               │   │   ├─ Eq\n" +
			" │               │   │   │   ├─ sn.brqp2:24!null\n" +
			" │               │   │   │   └─ mf.luevy:2!null\n" +
			" │               │   │   └─ Eq\n" +
			" │               │   │       ├─ sl3s5.M22QN:19!null\n" +
			" │               │   │       └─ mf.m22qn:3!null\n" +
			" │               │   ├─ TableAlias(mf)\n" +
			" │               │   │   └─ Table\n" +
			" │               │   │       ├─ name: HGMQ6\n" +
			" │               │   │       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			" │               │   └─ HashLookup\n" +
			" │               │       ├─ left-key: TUPLE(mf.luevy:2!null, mf.m22qn:3!null)\n" +
			" │               │       ├─ right-key: TUPLE(sn.brqp2:7!null, sl3s5.M22QN:2!null)\n" +
			" │               │       └─ LookupJoin\n" +
			" │               │           ├─ Eq\n" +
			" │               │           │   ├─ sl3s5.BDNYB:17!null\n" +
			" │               │           │   └─ sn.id:23!null\n" +
			" │               │           ├─ SubqueryAlias\n" +
			" │               │           │   ├─ name: sl3s5\n" +
			" │               │           │   ├─ outerVisibility: false\n" +
			" │               │           │   ├─ cacheable: true\n" +
			" │               │           │   └─ Project\n" +
			" │               │           │       ├─ columns: [BDNYB:26!null, TOFPN:27!null, M22QN:28!null, ADURZ:29!null, NO52D:30!null, IDPK7:31!null]\n" +
			" │               │           │       └─ Project\n" +
			" │               │           │           ├─ columns: [khjjo.M22QN:23!null, khjjo.BDNYB:24!null, khjjo.LUEVY:25!null, ct.id:5!null, ct.fz2r5:6!null, ct.luevy:7!null, ct.m22qn:8!null, ct.ove3e:9!null, ct.nrurt:10, ct.oca7e:11, ct.xmm6q:12, ct.v5dpx:13!null, ct.s3q3y:14!null, ct.zrv3b:15!null, ct.fhcyt:16, ci.id:0!null, ci.ftqlq:1!null, ci.fwwiq:2, ci.o3qxw:3, ci.fhcyt:4, cec.id:17!null, cec.no52d:18!null, cec.vyo5e:19, cec.dkcaj:20!null, cec.adurz:21!null, cec.fhcyt:22, khjjo.BDNYB:24!null as BDNYB, ci.ftqlq:1!null as TOFPN, ct.m22qn:8!null as M22QN, cec.adurz:21!null as ADURZ, cec.no52d:18!null as NO52D, ct.s3q3y:14!null as IDPK7]\n" +
			" │               │           │           └─ Filter\n" +
			" │               │           │               ├─ AND\n" +
			" │               │           │               │   ├─ Eq\n" +
			" │               │           │               │   │   ├─ ct.zrv3b:15!null\n" +
			" │               │           │               │   │   └─ = (longtext)\n" +
			" │               │           │               │   └─ HashIn\n" +
			" │               │           │               │       ├─ ci.ftqlq:1!null\n" +
			" │               │           │               │       └─ TUPLE(SQ1 (longtext))\n" +
			" │               │           │               └─ HashJoin\n" +
			" │               │           │                   ├─ AND\n" +
			" │               │           │                   │   ├─ Eq\n" +
			" │               │           │                   │   │   ├─ ct.m22qn:8!null\n" +
			" │               │           │                   │   │   └─ khjjo.M22QN:23!null\n" +
			" │               │           │                   │   └─ Eq\n" +
			" │               │           │                   │       ├─ ct.luevy:7!null\n" +
			" │               │           │                   │       └─ khjjo.LUEVY:25!null\n" +
			" │               │           │                   ├─ HashJoin\n" +
			" │               │           │                   │   ├─ Eq\n" +
			" │               │           │                   │   │   ├─ cec.id:17!null\n" +
			" │               │           │                   │   │   └─ ct.ove3e:9!null\n" +
			" │               │           │                   │   ├─ MergeJoin\n" +
			" │               │           │                   │   │   ├─ cmp: Eq\n" +
			" │               │           │                   │   │   │   ├─ ci.id:0!null\n" +
			" │               │           │                   │   │   │   └─ ct.fz2r5:6!null\n" +
			" │               │           │                   │   │   ├─ Filter\n" +
			" │               │           │                   │   │   │   ├─ HashIn\n" +
			" │               │           │                   │   │   │   │   ├─ ci.ftqlq:1!null\n" +
			" │               │           │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			" │               │           │                   │   │   │   └─ TableAlias(ci)\n" +
			" │               │           │                   │   │   │       └─ IndexedTableAccess(JDLNA)\n" +
			" │               │           │                   │   │   │           ├─ index: [JDLNA.id]\n" +
			" │               │           │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                   │   │   │           └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			" │               │           │                   │   │   └─ Filter\n" +
			" │               │           │                   │   │       ├─ Eq\n" +
			" │               │           │                   │   │       │   ├─ ct.zrv3b:10!null\n" +
			" │               │           │                   │   │       │   └─ = (longtext)\n" +
			" │               │           │                   │   │       └─ TableAlias(ct)\n" +
			" │               │           │                   │   │           └─ IndexedTableAccess(FLQLP)\n" +
			" │               │           │                   │   │               ├─ index: [FLQLP.FZ2R5]\n" +
			" │               │           │                   │   │               ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                   │   │               └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			" │               │           │                   │   └─ HashLookup\n" +
			" │               │           │                   │       ├─ left-key: TUPLE(ct.ove3e:9!null)\n" +
			" │               │           │                   │       ├─ right-key: TUPLE(cec.id:0!null)\n" +
			" │               │           │                   │       └─ TableAlias(cec)\n" +
			" │               │           │                   │           └─ Table\n" +
			" │               │           │                   │               ├─ name: SFEGG\n" +
			" │               │           │                   │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			" │               │           │                   └─ HashLookup\n" +
			" │               │           │                       ├─ left-key: TUPLE(ct.m22qn:8!null, ct.luevy:7!null)\n" +
			" │               │           │                       ├─ right-key: TUPLE(khjjo.M22QN:0!null, khjjo.LUEVY:2!null)\n" +
			" │               │           │                       └─ SubqueryAlias\n" +
			" │               │           │                           ├─ name: khjjo\n" +
			" │               │           │                           ├─ outerVisibility: false\n" +
			" │               │           │                           ├─ cacheable: true\n" +
			" │               │           │                           └─ Distinct\n" +
			" │               │           │                               └─ Project\n" +
			" │               │           │                                   ├─ columns: [M22QN:27!null, BDNYB:28!null, LUEVY:29!null]\n" +
			" │               │           │                                   └─ Project\n" +
			" │               │           │                                       ├─ columns: [mf.id:10!null, mf.gxlub:11!null, mf.luevy:12!null, mf.m22qn:13!null, mf.tjpt7:14!null, mf.arn5p:15!null, mf.xosd4:16!null, mf.ide43:17, mf.hmw4h:18, mf.zbt6r:19, mf.fsdy2:20!null, mf.lt7k6:21, mf.sppyd:22, mf.qcgts:23, mf.teuja:24, mf.qqv4m:25, mf.fhcyt:26, sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, mf.m22qn:13!null as M22QN, sn.id:0!null as BDNYB, mf.luevy:12!null as LUEVY]\n" +
			" │               │           │                                       └─ MergeJoin\n" +
			" │               │           │                                           ├─ cmp: Eq\n" +
			" │               │           │                                           │   ├─ sn.brqp2:1!null\n" +
			" │               │           │                                           │   └─ mf.luevy:12!null\n" +
			" │               │           │                                           ├─ TableAlias(sn)\n" +
			" │               │           │                                           │   └─ IndexedTableAccess(NOXN3)\n" +
			" │               │           │                                           │       ├─ index: [NOXN3.BRQP2]\n" +
			" │               │           │                                           │       ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                                           │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			" │               │           │                                           └─ TableAlias(mf)\n" +
			" │               │           │                                               └─ IndexedTableAccess(HGMQ6)\n" +
			" │               │           │                                                   ├─ index: [HGMQ6.LUEVY]\n" +
			" │               │           │                                                   ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                                                   └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			" │               │           └─ TableAlias(sn)\n" +
			" │               │               └─ IndexedTableAccess(NOXN3)\n" +
			" │               │                   ├─ index: [NOXN3.id]\n" +
			" │               │                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			" │               └─ HashLookup\n" +
			" │                   ├─ left-key: TUPLE(mf.gxlub:1!null)\n" +
			" │                   ├─ right-key: TUPLE(bs.id:30!null)\n" +
			" │                   └─ MergeJoin\n" +
			" │                       ├─ cmp: Eq\n" +
			" │                       │   ├─ cla.id:33!null\n" +
			" │                       │   └─ bs.ixuxu:65\n" +
			" │                       ├─ Filter\n" +
			" │                       │   ├─ HashIn\n" +
			" │                       │   │   ├─ cla.ftqlq:1!null\n" +
			" │                       │   │   └─ TUPLE(SQ1 (longtext))\n" +
			" │                       │   └─ TableAlias(cla)\n" +
			" │                       │       └─ IndexedTableAccess(YK2GW)\n" +
			" │                       │           ├─ index: [YK2GW.id]\n" +
			" │                       │           ├─ static: [{[NULL, ∞)}]\n" +
			" │                       │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			" │                       └─ TableAlias(bs)\n" +
			" │                           └─ IndexedTableAccess(THNTS)\n" +
			" │                               ├─ index: [THNTS.IXUXU]\n" +
			" │                               ├─ static: [{[NULL, ∞)}]\n" +
			" │                               └─ columns: [id nfryn ixuxu fhcyt]\n" +
			" └─ Project\n" +
			"     ├─ columns: [aoev5.t4ibq:0!null as t4ibq, vumuy.DL754:1!null, vumuy.BDNYB:2!null, vumuy.ADURZ:3!null, vumuy.TPXBU:4, vumuy.NO52D:5!null, vumuy.IDPK7:6!null]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [aoev5.t4ibq:6!null, vumuy.DL754:0!null, vumuy.BDNYB:1!null, vumuy.ADURZ:2!null, vumuy.TPXBU:3, vumuy.NO52D:4!null, vumuy.IDPK7:5!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [vumuy.DL754:1!null, vumuy.BDNYB:2!null, vumuy.ADURZ:3!null, vumuy.TPXBU:4, vumuy.NO52D:5!null, vumuy.IDPK7:6!null, aoev5.t4ibq:0!null]\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ SubqueryAlias\n" +
			"                 │   ├─ name: aoev5\n" +
			"                 │   ├─ outerVisibility: false\n" +
			"                 │   ├─ cacheable: true\n" +
			"                 │   └─ Values() as temp_AOEV5\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  1 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  2 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  3 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  4 (longtext))\n" +
			"                 │       └─ Row(\n" +
			"                 │          5 (longtext))\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ SubqueryAlias\n" +
			"                         ├─ name: vumuy\n" +
			"                         ├─ outerVisibility: false\n" +
			"                         ├─ cacheable: true\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [DL754:16!null, BDNYB:17!null, ADURZ:18!null, TPXBU:19, NO52D:20!null, IDPK7:21!null]\n" +
			"                             └─ Project\n" +
			"                                 ├─ columns: [sn.id:6!null, sn.brqp2:7!null, sn.fftbj:8!null, sn.a7xo2:9, sn.kbo7r:10!null, sn.ecdkm:11, sn.numk2:12!null, sn.letoe:13!null, sn.ykssu:14, sn.fhcyt:15, sl3s5.BDNYB:0!null, sl3s5.TOFPN:1!null, sl3s5.M22QN:2!null, sl3s5.ADURZ:3!null, sl3s5.NO52D:4!null, sl3s5.IDPK7:5!null, sl3s5.TOFPN:1!null as DL754, sn.id:6!null as BDNYB, sl3s5.ADURZ:3!null as ADURZ, Subquery\n" +
			"                                 │   ├─ cacheable: false\n" +
			"                                 │   └─ Project\n" +
			"                                 │       ├─ columns: [aac.btxc5:17]\n" +
			"                                 │       └─ Filter\n" +
			"                                 │           ├─ Eq\n" +
			"                                 │           │   ├─ aac.id:16!null\n" +
			"                                 │           │   └─ sl3s5.M22QN:2!null\n" +
			"                                 │           └─ TableAlias(aac)\n" +
			"                                 │               └─ IndexedTableAccess(TPXBU)\n" +
			"                                 │                   ├─ index: [TPXBU.id]\n" +
			"                                 │                   └─ columns: [id btxc5 fhcyt]\n" +
			"                                 │   as TPXBU, sl3s5.NO52D:4!null as NO52D, sl3s5.IDPK7:5!null as IDPK7]\n" +
			"                                 └─ LookupJoin\n" +
			"                                     ├─ Eq\n" +
			"                                     │   ├─ sl3s5.BDNYB:0!null\n" +
			"                                     │   └─ sn.id:6!null\n" +
			"                                     ├─ SubqueryAlias\n" +
			"                                     │   ├─ name: sl3s5\n" +
			"                                     │   ├─ outerVisibility: false\n" +
			"                                     │   ├─ cacheable: true\n" +
			"                                     │   └─ Project\n" +
			"                                     │       ├─ columns: [BDNYB:33!null, TOFPN:34!null, M22QN:35!null, ADURZ:36!null, NO52D:37!null, IDPK7:38!null]\n" +
			"                                     │       └─ Project\n" +
			"                                     │           ├─ columns: [sn.id:23!null, sn.brqp2:24!null, sn.fftbj:25!null, sn.a7xo2:26, sn.kbo7r:27!null, sn.ecdkm:28, sn.numk2:29!null, sn.letoe:30!null, sn.ykssu:31, sn.fhcyt:32, ct.id:5!null, ct.fz2r5:6!null, ct.luevy:7!null, ct.m22qn:8!null, ct.ove3e:9!null, ct.nrurt:10, ct.oca7e:11, ct.xmm6q:12, ct.v5dpx:13!null, ct.s3q3y:14!null, ct.zrv3b:15!null, ct.fhcyt:16, ci.id:0!null, ci.ftqlq:1!null, ci.fwwiq:2, ci.o3qxw:3, ci.fhcyt:4, cec.id:17!null, cec.no52d:18!null, cec.vyo5e:19, cec.dkcaj:20!null, cec.adurz:21!null, cec.fhcyt:22, sn.id:23!null as BDNYB, ci.ftqlq:1!null as TOFPN, ct.m22qn:8!null as M22QN, cec.adurz:21!null as ADURZ, cec.no52d:18!null as NO52D, ct.s3q3y:14!null as IDPK7]\n" +
			"                                     │           └─ Filter\n" +
			"                                     │               ├─ AND\n" +
			"                                     │               │   ├─ AND\n" +
			"                                     │               │   │   ├─ Eq\n" +
			"                                     │               │   │   │   ├─ ct.m22qn:8!null\n" +
			"                                     │               │   │   │   └─ Subquery\n" +
			"                                     │               │   │   │       ├─ cacheable: true\n" +
			"                                     │               │   │   │       └─ Project\n" +
			"                                     │               │   │   │           ├─ columns: [aac.id:33!null]\n" +
			"                                     │               │   │   │           └─ Filter\n" +
			"                                     │               │   │   │               ├─ Eq\n" +
			"                                     │               │   │   │               │   ├─ aac.btxc5:34\n" +
			"                                     │               │   │   │               │   └─ WT (longtext)\n" +
			"                                     │               │   │   │               └─ TableAlias(aac)\n" +
			"                                     │               │   │   │                   └─ IndexedTableAccess(TPXBU)\n" +
			"                                     │               │   │   │                       ├─ index: [TPXBU.BTXC5]\n" +
			"                                     │               │   │   │                       ├─ static: [{[WT, WT]}]\n" +
			"                                     │               │   │   │                       └─ columns: [id btxc5 fhcyt]\n" +
			"                                     │               │   │   └─ Eq\n" +
			"                                     │               │   │       ├─ ct.zrv3b:15!null\n" +
			"                                     │               │   │       └─ = (longtext)\n" +
			"                                     │               │   └─ HashIn\n" +
			"                                     │               │       ├─ ci.ftqlq:1!null\n" +
			"                                     │               │       └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │               └─ HashJoin\n" +
			"                                     │                   ├─ Eq\n" +
			"                                     │                   │   ├─ ct.luevy:7!null\n" +
			"                                     │                   │   └─ sn.brqp2:24!null\n" +
			"                                     │                   ├─ HashJoin\n" +
			"                                     │                   │   ├─ Eq\n" +
			"                                     │                   │   │   ├─ cec.id:17!null\n" +
			"                                     │                   │   │   └─ ct.ove3e:9!null\n" +
			"                                     │                   │   ├─ MergeJoin\n" +
			"                                     │                   │   │   ├─ cmp: Eq\n" +
			"                                     │                   │   │   │   ├─ ci.id:0!null\n" +
			"                                     │                   │   │   │   └─ ct.fz2r5:6!null\n" +
			"                                     │                   │   │   ├─ Filter\n" +
			"                                     │                   │   │   │   ├─ HashIn\n" +
			"                                     │                   │   │   │   │   ├─ ci.ftqlq:1!null\n" +
			"                                     │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │                   │   │   │   └─ TableAlias(ci)\n" +
			"                                     │                   │   │   │       └─ IndexedTableAccess(JDLNA)\n" +
			"                                     │                   │   │   │           ├─ index: [JDLNA.id]\n" +
			"                                     │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │   │           └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"                                     │                   │   │   └─ Filter\n" +
			"                                     │                   │   │       ├─ Eq\n" +
			"                                     │                   │   │       │   ├─ ct.zrv3b:10!null\n" +
			"                                     │                   │   │       │   └─ = (longtext)\n" +
			"                                     │                   │   │       └─ TableAlias(ct)\n" +
			"                                     │                   │   │           └─ IndexedTableAccess(FLQLP)\n" +
			"                                     │                   │   │               ├─ index: [FLQLP.FZ2R5]\n" +
			"                                     │                   │   │               ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │               └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"                                     │                   │   └─ HashLookup\n" +
			"                                     │                   │       ├─ left-key: TUPLE(ct.ove3e:9!null)\n" +
			"                                     │                   │       ├─ right-key: TUPLE(cec.id:0!null)\n" +
			"                                     │                   │       └─ TableAlias(cec)\n" +
			"                                     │                   │           └─ Table\n" +
			"                                     │                   │               ├─ name: SFEGG\n" +
			"                                     │                   │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"                                     │                   └─ HashLookup\n" +
			"                                     │                       ├─ left-key: TUPLE(ct.luevy:7!null)\n" +
			"                                     │                       ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"                                     │                       └─ TableAlias(sn)\n" +
			"                                     │                           └─ Table\n" +
			"                                     │                               ├─ name: NOXN3\n" +
			"                                     │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                     └─ TableAlias(sn)\n" +
			"                                         └─ IndexedTableAccess(NOXN3)\n" +
			"                                             ├─ index: [NOXN3.id]\n" +
			"                                             └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   cla.FTQLQ AS T4IBQ,
	   SL3S5.TOFPN AS DL754,
	   sn.id AS BDNYB,
	   SL3S5.ADURZ AS ADURZ,
	   (SELECT aac.BTXC5 FROM TPXBU aac WHERE aac.id = SL3S5.M22QN) AS TPXBU,
	   SL3S5.NO52D AS NO52D,
	   SL3S5.IDPK7 AS IDPK7
	FROM
	   YK2GW cla
	INNER JOIN THNTS bs ON cla.id = bs.IXUXU
	INNER JOIN HGMQ6 mf ON bs.id = mf.GXLUB
	INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	INNER JOIN
	   (
	   SELECT
	       KHJJO.BDNYB AS BDNYB,
	       ci.FTQLQ AS TOFPN,
	       ct.M22QN AS M22QN,
	       cec.ADURZ AS ADURZ,
	       cec.NO52D AS NO52D,
	       ct.S3Q3Y AS IDPK7
	   FROM
	       (
	       SELECT DISTINCT
	           mf.M22QN AS M22QN,
	           sn.id AS BDNYB,
	           mf.LUEVY AS LUEVY
	       FROM
	           HGMQ6 mf
	       INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	       ) KHJJO
	   INNER JOIN
	       FLQLP ct
	   ON
	           ct.M22QN = KHJJO.M22QN
	       AND
	           ct.LUEVY = KHJJO.LUEVY
	   INNER JOIN JDLNA ci ON  ci.id = ct.FZ2R5 AND ct.ZRV3B = '='
	   INNER JOIN SFEGG cec ON cec.id = ct.OVE3E
	   WHERE
	       ci.FTQLQ IN ('SQ1')
	   ) SL3S5
	ON
	       SL3S5.BDNYB = sn.id
	   AND
	       SL3S5.M22QN = mf.M22QN
	WHERE
	   cla.FTQLQ IN ('SQ1')
	UNION ALL

	SELECT
	   AOEV5.*,
	   VUMUY.*
	FROM (
	SELECT
	   SL3S5.TOFPN AS DL754,
	   sn.id AS BDNYB,
	   SL3S5.ADURZ AS ADURZ,
	   (SELECT aac.BTXC5 FROM TPXBU aac WHERE aac.id = SL3S5.M22QN) AS TPXBU,
	   SL3S5.NO52D AS NO52D,
	   SL3S5.IDPK7 AS IDPK7
	FROM
	   NOXN3 sn
	INNER JOIN
	   (
	   SELECT
	       sn.id AS BDNYB,
	       ci.FTQLQ AS TOFPN,
	       ct.M22QN AS M22QN,
	       cec.ADURZ AS ADURZ,
	       cec.NO52D AS NO52D,
	       ct.S3Q3Y AS IDPK7
	   FROM
	       NOXN3 sn
	   INNER JOIN
	       FLQLP ct
	   ON
	           ct.M22QN = (SELECT aac.id FROM TPXBU aac WHERE BTXC5 = 'WT')
	       AND
	           ct.LUEVY = sn.BRQP2
	   INNER JOIN JDLNA ci ON  ci.id = ct.FZ2R5 AND ct.ZRV3B = '='
	   INNER JOIN SFEGG cec ON cec.id = ct.OVE3E
	   WHERE
	       ci.FTQLQ IN ('SQ1')
	   ) SL3S5
	ON
	       SL3S5.BDNYB = sn.id ) VUMUY
	CROSS JOIN
	   (
	   SELECT * FROM (VALUES
	      ROW("1"),
	      ROW("2"),
	      ROW("3"),
	      ROW("4"),
	      ROW("5")
	       ) AS temp_AOEV5(T4IBQ)
	   ) AOEV5`,
		ExpectedPlan: "Union all\n" +
			" ├─ Project\n" +
			" │   ├─ columns: [convert\n" +
			" │   │   ├─ type: char\n" +
			" │   │   └─ T4IBQ:0!null\n" +
			" │   │   as T4IBQ, DL754:1!null, BDNYB:2!null, ADURZ:3!null, TPXBU:4, NO52D:5!null, IDPK7:6!null]\n" +
			" │   └─ Project\n" +
			" │       ├─ columns: [T4IBQ:67!null, DL754:68!null, BDNYB:69!null, ADURZ:70!null, TPXBU:71, NO52D:72!null, IDPK7:73!null]\n" +
			" │       └─ Project\n" +
			" │           ├─ columns: [cla.id:33!null, cla.ftqlq:34!null, cla.tuxml:35, cla.paef5:36, cla.rucy4:37, cla.tpnj6:38!null, cla.lbl53:39, cla.nb3qs:40, cla.eo7iv:41, cla.muhjf:42, cla.fm34l:43, cla.ty5rf:44, cla.zhtlh:45, cla.npb7w:46, cla.sx3hh:47, cla.isbnf:48, cla.ya7yb:49, cla.c5ykb:50, cla.qk7kt:51, cla.ffge6:52, cla.fiigj:53, cla.sh3nc:54, cla.ntena:55, cla.m4aub:56, cla.x5air:57, cla.sab6m:58, cla.g5qi5:59, cla.zvqvd:60, cla.ykssu:61, cla.fhcyt:62, bs.id:63!null, bs.nfryn:64!null, bs.ixuxu:65, bs.fhcyt:66, mf.id:0!null, mf.gxlub:1!null, mf.luevy:2!null, mf.m22qn:3!null, mf.tjpt7:4!null, mf.arn5p:5!null, mf.xosd4:6!null, mf.ide43:7, mf.hmw4h:8, mf.zbt6r:9, mf.fsdy2:10!null, mf.lt7k6:11, mf.sppyd:12, mf.qcgts:13, mf.teuja:14, mf.qqv4m:15, mf.fhcyt:16, sn.id:23!null, sn.brqp2:24!null, sn.fftbj:25!null, sn.a7xo2:26, sn.kbo7r:27!null, sn.ecdkm:28, sn.numk2:29!null, sn.letoe:30!null, sn.ykssu:31, sn.fhcyt:32, sl3s5.BDNYB:17!null, sl3s5.TOFPN:18!null, sl3s5.M22QN:19!null, sl3s5.ADURZ:20!null, sl3s5.NO52D:21!null, sl3s5.IDPK7:22!null, cla.ftqlq:34!null as T4IBQ, sl3s5.TOFPN:18!null as DL754, sn.id:23!null as BDNYB, sl3s5.ADURZ:20!null as ADURZ, Subquery\n" +
			" │           │   ├─ cacheable: false\n" +
			" │           │   └─ Project\n" +
			" │           │       ├─ columns: [aac.btxc5:68]\n" +
			" │           │       └─ Filter\n" +
			" │           │           ├─ Eq\n" +
			" │           │           │   ├─ aac.id:67!null\n" +
			" │           │           │   └─ sl3s5.M22QN:19!null\n" +
			" │           │           └─ TableAlias(aac)\n" +
			" │           │               └─ IndexedTableAccess(TPXBU)\n" +
			" │           │                   ├─ index: [TPXBU.id]\n" +
			" │           │                   └─ columns: [id btxc5 fhcyt]\n" +
			" │           │   as TPXBU, sl3s5.NO52D:21!null as NO52D, sl3s5.IDPK7:22!null as IDPK7]\n" +
			" │           └─ HashJoin\n" +
			" │               ├─ Eq\n" +
			" │               │   ├─ bs.id:63!null\n" +
			" │               │   └─ mf.gxlub:1!null\n" +
			" │               ├─ HashJoin\n" +
			" │               │   ├─ AND\n" +
			" │               │   │   ├─ Eq\n" +
			" │               │   │   │   ├─ sn.brqp2:24!null\n" +
			" │               │   │   │   └─ mf.luevy:2!null\n" +
			" │               │   │   └─ Eq\n" +
			" │               │   │       ├─ sl3s5.M22QN:19!null\n" +
			" │               │   │       └─ mf.m22qn:3!null\n" +
			" │               │   ├─ TableAlias(mf)\n" +
			" │               │   │   └─ Table\n" +
			" │               │   │       ├─ name: HGMQ6\n" +
			" │               │   │       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			" │               │   └─ HashLookup\n" +
			" │               │       ├─ left-key: TUPLE(mf.luevy:2!null, mf.m22qn:3!null)\n" +
			" │               │       ├─ right-key: TUPLE(sn.brqp2:7!null, sl3s5.M22QN:2!null)\n" +
			" │               │       └─ LookupJoin\n" +
			" │               │           ├─ Eq\n" +
			" │               │           │   ├─ sl3s5.BDNYB:17!null\n" +
			" │               │           │   └─ sn.id:23!null\n" +
			" │               │           ├─ SubqueryAlias\n" +
			" │               │           │   ├─ name: sl3s5\n" +
			" │               │           │   ├─ outerVisibility: false\n" +
			" │               │           │   ├─ cacheable: true\n" +
			" │               │           │   └─ Project\n" +
			" │               │           │       ├─ columns: [BDNYB:26!null, TOFPN:27!null, M22QN:28!null, ADURZ:29!null, NO52D:30!null, IDPK7:31!null]\n" +
			" │               │           │       └─ Project\n" +
			" │               │           │           ├─ columns: [khjjo.M22QN:23!null, khjjo.BDNYB:24!null, khjjo.LUEVY:25!null, ct.id:5!null, ct.fz2r5:6!null, ct.luevy:7!null, ct.m22qn:8!null, ct.ove3e:9!null, ct.nrurt:10, ct.oca7e:11, ct.xmm6q:12, ct.v5dpx:13!null, ct.s3q3y:14!null, ct.zrv3b:15!null, ct.fhcyt:16, ci.id:0!null, ci.ftqlq:1!null, ci.fwwiq:2, ci.o3qxw:3, ci.fhcyt:4, cec.id:17!null, cec.no52d:18!null, cec.vyo5e:19, cec.dkcaj:20!null, cec.adurz:21!null, cec.fhcyt:22, khjjo.BDNYB:24!null as BDNYB, ci.ftqlq:1!null as TOFPN, ct.m22qn:8!null as M22QN, cec.adurz:21!null as ADURZ, cec.no52d:18!null as NO52D, ct.s3q3y:14!null as IDPK7]\n" +
			" │               │           │           └─ Filter\n" +
			" │               │           │               ├─ AND\n" +
			" │               │           │               │   ├─ Eq\n" +
			" │               │           │               │   │   ├─ ct.zrv3b:15!null\n" +
			" │               │           │               │   │   └─ = (longtext)\n" +
			" │               │           │               │   └─ HashIn\n" +
			" │               │           │               │       ├─ ci.ftqlq:1!null\n" +
			" │               │           │               │       └─ TUPLE(SQ1 (longtext))\n" +
			" │               │           │               └─ HashJoin\n" +
			" │               │           │                   ├─ AND\n" +
			" │               │           │                   │   ├─ Eq\n" +
			" │               │           │                   │   │   ├─ ct.m22qn:8!null\n" +
			" │               │           │                   │   │   └─ khjjo.M22QN:23!null\n" +
			" │               │           │                   │   └─ Eq\n" +
			" │               │           │                   │       ├─ ct.luevy:7!null\n" +
			" │               │           │                   │       └─ khjjo.LUEVY:25!null\n" +
			" │               │           │                   ├─ HashJoin\n" +
			" │               │           │                   │   ├─ Eq\n" +
			" │               │           │                   │   │   ├─ cec.id:17!null\n" +
			" │               │           │                   │   │   └─ ct.ove3e:9!null\n" +
			" │               │           │                   │   ├─ MergeJoin\n" +
			" │               │           │                   │   │   ├─ cmp: Eq\n" +
			" │               │           │                   │   │   │   ├─ ci.id:0!null\n" +
			" │               │           │                   │   │   │   └─ ct.fz2r5:6!null\n" +
			" │               │           │                   │   │   ├─ Filter\n" +
			" │               │           │                   │   │   │   ├─ HashIn\n" +
			" │               │           │                   │   │   │   │   ├─ ci.ftqlq:1!null\n" +
			" │               │           │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			" │               │           │                   │   │   │   └─ TableAlias(ci)\n" +
			" │               │           │                   │   │   │       └─ IndexedTableAccess(JDLNA)\n" +
			" │               │           │                   │   │   │           ├─ index: [JDLNA.id]\n" +
			" │               │           │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                   │   │   │           └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			" │               │           │                   │   │   └─ Filter\n" +
			" │               │           │                   │   │       ├─ Eq\n" +
			" │               │           │                   │   │       │   ├─ ct.zrv3b:10!null\n" +
			" │               │           │                   │   │       │   └─ = (longtext)\n" +
			" │               │           │                   │   │       └─ TableAlias(ct)\n" +
			" │               │           │                   │   │           └─ IndexedTableAccess(FLQLP)\n" +
			" │               │           │                   │   │               ├─ index: [FLQLP.FZ2R5]\n" +
			" │               │           │                   │   │               ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                   │   │               └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			" │               │           │                   │   └─ HashLookup\n" +
			" │               │           │                   │       ├─ left-key: TUPLE(ct.ove3e:9!null)\n" +
			" │               │           │                   │       ├─ right-key: TUPLE(cec.id:0!null)\n" +
			" │               │           │                   │       └─ TableAlias(cec)\n" +
			" │               │           │                   │           └─ Table\n" +
			" │               │           │                   │               ├─ name: SFEGG\n" +
			" │               │           │                   │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			" │               │           │                   └─ HashLookup\n" +
			" │               │           │                       ├─ left-key: TUPLE(ct.m22qn:8!null, ct.luevy:7!null)\n" +
			" │               │           │                       ├─ right-key: TUPLE(khjjo.M22QN:0!null, khjjo.LUEVY:2!null)\n" +
			" │               │           │                       └─ SubqueryAlias\n" +
			" │               │           │                           ├─ name: khjjo\n" +
			" │               │           │                           ├─ outerVisibility: false\n" +
			" │               │           │                           ├─ cacheable: true\n" +
			" │               │           │                           └─ Distinct\n" +
			" │               │           │                               └─ Project\n" +
			" │               │           │                                   ├─ columns: [M22QN:27!null, BDNYB:28!null, LUEVY:29!null]\n" +
			" │               │           │                                   └─ Project\n" +
			" │               │           │                                       ├─ columns: [mf.id:10!null, mf.gxlub:11!null, mf.luevy:12!null, mf.m22qn:13!null, mf.tjpt7:14!null, mf.arn5p:15!null, mf.xosd4:16!null, mf.ide43:17, mf.hmw4h:18, mf.zbt6r:19, mf.fsdy2:20!null, mf.lt7k6:21, mf.sppyd:22, mf.qcgts:23, mf.teuja:24, mf.qqv4m:25, mf.fhcyt:26, sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, mf.m22qn:13!null as M22QN, sn.id:0!null as BDNYB, mf.luevy:12!null as LUEVY]\n" +
			" │               │           │                                       └─ MergeJoin\n" +
			" │               │           │                                           ├─ cmp: Eq\n" +
			" │               │           │                                           │   ├─ sn.brqp2:1!null\n" +
			" │               │           │                                           │   └─ mf.luevy:12!null\n" +
			" │               │           │                                           ├─ TableAlias(sn)\n" +
			" │               │           │                                           │   └─ IndexedTableAccess(NOXN3)\n" +
			" │               │           │                                           │       ├─ index: [NOXN3.BRQP2]\n" +
			" │               │           │                                           │       ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                                           │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			" │               │           │                                           └─ TableAlias(mf)\n" +
			" │               │           │                                               └─ IndexedTableAccess(HGMQ6)\n" +
			" │               │           │                                                   ├─ index: [HGMQ6.LUEVY]\n" +
			" │               │           │                                                   ├─ static: [{[NULL, ∞)}]\n" +
			" │               │           │                                                   └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			" │               │           └─ TableAlias(sn)\n" +
			" │               │               └─ IndexedTableAccess(NOXN3)\n" +
			" │               │                   ├─ index: [NOXN3.id]\n" +
			" │               │                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			" │               └─ HashLookup\n" +
			" │                   ├─ left-key: TUPLE(mf.gxlub:1!null)\n" +
			" │                   ├─ right-key: TUPLE(bs.id:30!null)\n" +
			" │                   └─ MergeJoin\n" +
			" │                       ├─ cmp: Eq\n" +
			" │                       │   ├─ cla.id:33!null\n" +
			" │                       │   └─ bs.ixuxu:65\n" +
			" │                       ├─ Filter\n" +
			" │                       │   ├─ HashIn\n" +
			" │                       │   │   ├─ cla.ftqlq:1!null\n" +
			" │                       │   │   └─ TUPLE(SQ1 (longtext))\n" +
			" │                       │   └─ TableAlias(cla)\n" +
			" │                       │       └─ IndexedTableAccess(YK2GW)\n" +
			" │                       │           ├─ index: [YK2GW.id]\n" +
			" │                       │           ├─ static: [{[NULL, ∞)}]\n" +
			" │                       │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			" │                       └─ TableAlias(bs)\n" +
			" │                           └─ IndexedTableAccess(THNTS)\n" +
			" │                               ├─ index: [THNTS.IXUXU]\n" +
			" │                               ├─ static: [{[NULL, ∞)}]\n" +
			" │                               └─ columns: [id nfryn ixuxu fhcyt]\n" +
			" └─ Project\n" +
			"     ├─ columns: [aoev5.t4ibq:0!null as t4ibq, vumuy.DL754:1!null, vumuy.BDNYB:2!null, vumuy.ADURZ:3!null, vumuy.TPXBU:4, vumuy.NO52D:5!null, vumuy.IDPK7:6!null]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [aoev5.t4ibq:6!null, vumuy.DL754:0!null, vumuy.BDNYB:1!null, vumuy.ADURZ:2!null, vumuy.TPXBU:3, vumuy.NO52D:4!null, vumuy.IDPK7:5!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [vumuy.DL754:1!null, vumuy.BDNYB:2!null, vumuy.ADURZ:3!null, vumuy.TPXBU:4, vumuy.NO52D:5!null, vumuy.IDPK7:6!null, aoev5.t4ibq:0!null]\n" +
			"             └─ CrossHashJoin\n" +
			"                 ├─ SubqueryAlias\n" +
			"                 │   ├─ name: aoev5\n" +
			"                 │   ├─ outerVisibility: false\n" +
			"                 │   ├─ cacheable: true\n" +
			"                 │   └─ Values() as temp_AOEV5\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  1 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  2 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  3 (longtext))\n" +
			"                 │       ├─ Row(\n" +
			"                 │       │  4 (longtext))\n" +
			"                 │       └─ Row(\n" +
			"                 │          5 (longtext))\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE()\n" +
			"                     ├─ right-key: TUPLE()\n" +
			"                     └─ SubqueryAlias\n" +
			"                         ├─ name: vumuy\n" +
			"                         ├─ outerVisibility: false\n" +
			"                         ├─ cacheable: true\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [DL754:16!null, BDNYB:17!null, ADURZ:18!null, TPXBU:19, NO52D:20!null, IDPK7:21!null]\n" +
			"                             └─ Project\n" +
			"                                 ├─ columns: [sn.id:6!null, sn.brqp2:7!null, sn.fftbj:8!null, sn.a7xo2:9, sn.kbo7r:10!null, sn.ecdkm:11, sn.numk2:12!null, sn.letoe:13!null, sn.ykssu:14, sn.fhcyt:15, sl3s5.BDNYB:0!null, sl3s5.TOFPN:1!null, sl3s5.M22QN:2!null, sl3s5.ADURZ:3!null, sl3s5.NO52D:4!null, sl3s5.IDPK7:5!null, sl3s5.TOFPN:1!null as DL754, sn.id:6!null as BDNYB, sl3s5.ADURZ:3!null as ADURZ, Subquery\n" +
			"                                 │   ├─ cacheable: false\n" +
			"                                 │   └─ Project\n" +
			"                                 │       ├─ columns: [aac.btxc5:17]\n" +
			"                                 │       └─ Filter\n" +
			"                                 │           ├─ Eq\n" +
			"                                 │           │   ├─ aac.id:16!null\n" +
			"                                 │           │   └─ sl3s5.M22QN:2!null\n" +
			"                                 │           └─ TableAlias(aac)\n" +
			"                                 │               └─ IndexedTableAccess(TPXBU)\n" +
			"                                 │                   ├─ index: [TPXBU.id]\n" +
			"                                 │                   └─ columns: [id btxc5 fhcyt]\n" +
			"                                 │   as TPXBU, sl3s5.NO52D:4!null as NO52D, sl3s5.IDPK7:5!null as IDPK7]\n" +
			"                                 └─ LookupJoin\n" +
			"                                     ├─ Eq\n" +
			"                                     │   ├─ sl3s5.BDNYB:0!null\n" +
			"                                     │   └─ sn.id:6!null\n" +
			"                                     ├─ SubqueryAlias\n" +
			"                                     │   ├─ name: sl3s5\n" +
			"                                     │   ├─ outerVisibility: false\n" +
			"                                     │   ├─ cacheable: true\n" +
			"                                     │   └─ Project\n" +
			"                                     │       ├─ columns: [BDNYB:33!null, TOFPN:34!null, M22QN:35!null, ADURZ:36!null, NO52D:37!null, IDPK7:38!null]\n" +
			"                                     │       └─ Project\n" +
			"                                     │           ├─ columns: [sn.id:23!null, sn.brqp2:24!null, sn.fftbj:25!null, sn.a7xo2:26, sn.kbo7r:27!null, sn.ecdkm:28, sn.numk2:29!null, sn.letoe:30!null, sn.ykssu:31, sn.fhcyt:32, ct.id:5!null, ct.fz2r5:6!null, ct.luevy:7!null, ct.m22qn:8!null, ct.ove3e:9!null, ct.nrurt:10, ct.oca7e:11, ct.xmm6q:12, ct.v5dpx:13!null, ct.s3q3y:14!null, ct.zrv3b:15!null, ct.fhcyt:16, ci.id:0!null, ci.ftqlq:1!null, ci.fwwiq:2, ci.o3qxw:3, ci.fhcyt:4, cec.id:17!null, cec.no52d:18!null, cec.vyo5e:19, cec.dkcaj:20!null, cec.adurz:21!null, cec.fhcyt:22, sn.id:23!null as BDNYB, ci.ftqlq:1!null as TOFPN, ct.m22qn:8!null as M22QN, cec.adurz:21!null as ADURZ, cec.no52d:18!null as NO52D, ct.s3q3y:14!null as IDPK7]\n" +
			"                                     │           └─ Filter\n" +
			"                                     │               ├─ AND\n" +
			"                                     │               │   ├─ AND\n" +
			"                                     │               │   │   ├─ Eq\n" +
			"                                     │               │   │   │   ├─ ct.m22qn:8!null\n" +
			"                                     │               │   │   │   └─ Subquery\n" +
			"                                     │               │   │   │       ├─ cacheable: true\n" +
			"                                     │               │   │   │       └─ Project\n" +
			"                                     │               │   │   │           ├─ columns: [aac.id:33!null]\n" +
			"                                     │               │   │   │           └─ Filter\n" +
			"                                     │               │   │   │               ├─ Eq\n" +
			"                                     │               │   │   │               │   ├─ aac.btxc5:34\n" +
			"                                     │               │   │   │               │   └─ WT (longtext)\n" +
			"                                     │               │   │   │               └─ TableAlias(aac)\n" +
			"                                     │               │   │   │                   └─ IndexedTableAccess(TPXBU)\n" +
			"                                     │               │   │   │                       ├─ index: [TPXBU.BTXC5]\n" +
			"                                     │               │   │   │                       ├─ static: [{[WT, WT]}]\n" +
			"                                     │               │   │   │                       └─ columns: [id btxc5 fhcyt]\n" +
			"                                     │               │   │   └─ Eq\n" +
			"                                     │               │   │       ├─ ct.zrv3b:15!null\n" +
			"                                     │               │   │       └─ = (longtext)\n" +
			"                                     │               │   └─ HashIn\n" +
			"                                     │               │       ├─ ci.ftqlq:1!null\n" +
			"                                     │               │       └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │               └─ HashJoin\n" +
			"                                     │                   ├─ Eq\n" +
			"                                     │                   │   ├─ ct.luevy:7!null\n" +
			"                                     │                   │   └─ sn.brqp2:24!null\n" +
			"                                     │                   ├─ HashJoin\n" +
			"                                     │                   │   ├─ Eq\n" +
			"                                     │                   │   │   ├─ cec.id:17!null\n" +
			"                                     │                   │   │   └─ ct.ove3e:9!null\n" +
			"                                     │                   │   ├─ MergeJoin\n" +
			"                                     │                   │   │   ├─ cmp: Eq\n" +
			"                                     │                   │   │   │   ├─ ci.id:0!null\n" +
			"                                     │                   │   │   │   └─ ct.fz2r5:6!null\n" +
			"                                     │                   │   │   ├─ Filter\n" +
			"                                     │                   │   │   │   ├─ HashIn\n" +
			"                                     │                   │   │   │   │   ├─ ci.ftqlq:1!null\n" +
			"                                     │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │                   │   │   │   └─ TableAlias(ci)\n" +
			"                                     │                   │   │   │       └─ IndexedTableAccess(JDLNA)\n" +
			"                                     │                   │   │   │           ├─ index: [JDLNA.id]\n" +
			"                                     │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │   │           └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"                                     │                   │   │   └─ Filter\n" +
			"                                     │                   │   │       ├─ Eq\n" +
			"                                     │                   │   │       │   ├─ ct.zrv3b:10!null\n" +
			"                                     │                   │   │       │   └─ = (longtext)\n" +
			"                                     │                   │   │       └─ TableAlias(ct)\n" +
			"                                     │                   │   │           └─ IndexedTableAccess(FLQLP)\n" +
			"                                     │                   │   │               ├─ index: [FLQLP.FZ2R5]\n" +
			"                                     │                   │   │               ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │               └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"                                     │                   │   └─ HashLookup\n" +
			"                                     │                   │       ├─ left-key: TUPLE(ct.ove3e:9!null)\n" +
			"                                     │                   │       ├─ right-key: TUPLE(cec.id:0!null)\n" +
			"                                     │                   │       └─ TableAlias(cec)\n" +
			"                                     │                   │           └─ Table\n" +
			"                                     │                   │               ├─ name: SFEGG\n" +
			"                                     │                   │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"                                     │                   └─ HashLookup\n" +
			"                                     │                       ├─ left-key: TUPLE(ct.luevy:7!null)\n" +
			"                                     │                       ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"                                     │                       └─ TableAlias(sn)\n" +
			"                                     │                           └─ Table\n" +
			"                                     │                               ├─ name: NOXN3\n" +
			"                                     │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                     └─ TableAlias(sn)\n" +
			"                                         └─ IndexedTableAccess(NOXN3)\n" +
			"                                             ├─ index: [NOXN3.id]\n" +
			"                                             └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT COUNT(*) FROM NOXN3`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as COUNT(*)]\n" +
			" └─ Project\n" +
			"     ├─ columns: [NOXN3.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(NOXN3) as COUNT(1)\n" +
			"",
	},
	{
		Query: `
	SELECT
	   NB6PJ.Y3IOU AS Y3IOU,
	   S7EGW.TW55N AS FJVD7,
	   TYMVL.TW55N AS KBXXJ,
	   NB6PJ.NUMK2 AS NUMK2,
	   NB6PJ.LETOE AS LETOE
	FROM
	   (SELECT
	       ROW_NUMBER() OVER (ORDER BY id ASC) Y3IOU,
	       id,
	       BRQP2,
	       FFTBJ,
	       NUMK2,
	       LETOE
	   FROM
	       NOXN3
	   ORDER BY id ASC) NB6PJ
	INNER JOIN
	   E2I7U S7EGW
	ON
	   S7EGW.id = NB6PJ.BRQP2
	INNER JOIN
	   E2I7U TYMVL
	ON
	   TYMVL.id = NB6PJ.FFTBJ
	ORDER BY Y3IOU`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [Y3IOU:40!null, FJVD7:41!null, KBXXJ:42!null, NUMK2:43!null, LETOE:44!null]\n" +
			" └─ Sort(nb6pj.Y3IOU:0!null as Y3IOU ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [nb6pj.Y3IOU:0!null, nb6pj.id:1!null, nb6pj.brqp2:2!null, nb6pj.fftbj:3!null, nb6pj.numk2:4!null, nb6pj.letoe:5!null, s7egw.id:23!null, s7egw.dkcaj:24!null, s7egw.kng7t:25, s7egw.tw55n:26!null, s7egw.qrqxw:27!null, s7egw.ecxaj:28!null, s7egw.fgg57:29, s7egw.zh72s:30, s7egw.fsk67:31!null, s7egw.xqdyt:32!null, s7egw.tce7a:33, s7egw.iwv2h:34, s7egw.hpcms:35!null, s7egw.n5cc2:36, s7egw.fhcyt:37, s7egw.etaq7:38, s7egw.a75x7:39, tymvl.id:6!null, tymvl.dkcaj:7!null, tymvl.kng7t:8, tymvl.tw55n:9!null, tymvl.qrqxw:10!null, tymvl.ecxaj:11!null, tymvl.fgg57:12, tymvl.zh72s:13, tymvl.fsk67:14!null, tymvl.xqdyt:15!null, tymvl.tce7a:16, tymvl.iwv2h:17, tymvl.hpcms:18!null, tymvl.n5cc2:19, tymvl.fhcyt:20, tymvl.etaq7:21, tymvl.a75x7:22, nb6pj.Y3IOU:0!null as Y3IOU, s7egw.tw55n:26!null as FJVD7, tymvl.tw55n:9!null as KBXXJ, nb6pj.numk2:4!null as NUMK2, nb6pj.letoe:5!null as LETOE]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ s7egw.id:23!null\n" +
			"             │   └─ nb6pj.brqp2:2!null\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ tymvl.id:6!null\n" +
			"             │   │   └─ nb6pj.fftbj:3!null\n" +
			"             │   ├─ SubqueryAlias\n" +
			"             │   │   ├─ name: nb6pj\n" +
			"             │   │   ├─ outerVisibility: false\n" +
			"             │   │   ├─ cacheable: true\n" +
			"             │   │   └─ Project\n" +
			"             │   │       ├─ columns: [Y3IOU:6!null, noxn3.id:1!null, noxn3.brqp2:2!null, noxn3.fftbj:3!null, noxn3.numk2:4!null, noxn3.letoe:5!null]\n" +
			"             │   │       └─ Sort(noxn3.id:1!null ASC nullsFirst)\n" +
			"             │   │           └─ Project\n" +
			"             │   │               ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, noxn3.brqp2:2!null, noxn3.fftbj:3!null, noxn3.numk2:4!null, noxn3.letoe:5!null, row_number() over ( order by noxn3.id asc):0!null as Y3IOU]\n" +
			"             │   │               └─ Window\n" +
			"             │   │                   ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"             │   │                   ├─ noxn3.id:0!null\n" +
			"             │   │                   ├─ noxn3.brqp2:1!null\n" +
			"             │   │                   ├─ noxn3.fftbj:2!null\n" +
			"             │   │                   ├─ noxn3.numk2:3!null\n" +
			"             │   │                   ├─ noxn3.letoe:4!null\n" +
			"             │   │                   └─ Table\n" +
			"             │   │                       ├─ name: NOXN3\n" +
			"             │   │                       └─ columns: [id brqp2 fftbj numk2 letoe]\n" +
			"             │   └─ TableAlias(tymvl)\n" +
			"             │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           ├─ index: [E2I7U.id]\n" +
			"             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ TableAlias(s7egw)\n" +
			"                 └─ IndexedTableAccess(E2I7U)\n" +
			"                     ├─ index: [E2I7U.id]\n" +
			"                     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   nd.TW55N AS TW55N,
	   NB6PJ.Y3IOU AS Y3IOU
	FROM
	   (SELECT
	       ROW_NUMBER() OVER (ORDER BY id ASC) Y3IOU,
	       id,
	       BRQP2,
	       FFTBJ,
	       NUMK2,
	       LETOE
	   FROM
	       NOXN3
	   ORDER BY id ASC) NB6PJ
	INNER JOIN
	   E2I7U nd
	ON
	   nd.id = NB6PJ.BRQP2
	ORDER BY TW55N, Y3IOU`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [TW55N:23!null, Y3IOU:24!null]\n" +
			" └─ Sort(nd.tw55n:9!null as TW55N ASC nullsFirst, nb6pj.Y3IOU:0!null as Y3IOU ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [nb6pj.Y3IOU:0!null, nb6pj.id:1!null, nb6pj.brqp2:2!null, nb6pj.fftbj:3!null, nb6pj.numk2:4!null, nb6pj.letoe:5!null, nd.id:6!null, nd.dkcaj:7!null, nd.kng7t:8, nd.tw55n:9!null, nd.qrqxw:10!null, nd.ecxaj:11!null, nd.fgg57:12, nd.zh72s:13, nd.fsk67:14!null, nd.xqdyt:15!null, nd.tce7a:16, nd.iwv2h:17, nd.hpcms:18!null, nd.n5cc2:19, nd.fhcyt:20, nd.etaq7:21, nd.a75x7:22, nd.tw55n:9!null as TW55N, nb6pj.Y3IOU:0!null as Y3IOU]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nd.id:6!null\n" +
			"             │   └─ nb6pj.brqp2:2!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: nb6pj\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [Y3IOU:6!null, noxn3.id:1!null, noxn3.brqp2:2!null, noxn3.fftbj:3!null, noxn3.numk2:4!null, noxn3.letoe:5!null]\n" +
			"             │       └─ Sort(noxn3.id:1!null ASC nullsFirst)\n" +
			"             │           └─ Project\n" +
			"             │               ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, noxn3.brqp2:2!null, noxn3.fftbj:3!null, noxn3.numk2:4!null, noxn3.letoe:5!null, row_number() over ( order by noxn3.id asc):0!null as Y3IOU]\n" +
			"             │               └─ Window\n" +
			"             │                   ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"             │                   ├─ noxn3.id:0!null\n" +
			"             │                   ├─ noxn3.brqp2:1!null\n" +
			"             │                   ├─ noxn3.fftbj:2!null\n" +
			"             │                   ├─ noxn3.numk2:3!null\n" +
			"             │                   ├─ noxn3.letoe:4!null\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: NOXN3\n" +
			"             │                       └─ columns: [id brqp2 fftbj numk2 letoe]\n" +
			"             └─ TableAlias(nd)\n" +
			"                 └─ IndexedTableAccess(E2I7U)\n" +
			"                     ├─ index: [E2I7U.id]\n" +
			"                     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ROW_NUMBER() OVER (ORDER BY sn.id ASC) - 1 M6T2N,
	   S7EGW.TW55N FJVD7,
	   TYMVL.TW55N KBXXJ,
	   NUMK2,
	   LETOE,
	   sn.id XLFIA
	FROM
	   NOXN3 sn
	INNER JOIN
	   E2I7U S7EGW ON (sn.BRQP2 = S7EGW.id)
	INNER JOIN
	   E2I7U TYMVL ON (sn.FFTBJ = TYMVL.id)
	ORDER BY M6T2N ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [M6T2N:5!null, FJVD7:6!null, KBXXJ:7!null, sn.numk2:2!null, sn.letoe:3!null, XLFIA:8!null]\n" +
			" └─ Sort((row_number() over ( order by sn.id asc):0!null - 1 (tinyint)) as M6T2N ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [row_number() over ( order by sn.id asc):0!null, s7egw.tw55n:1!null, sn.numk2:2!null, sn.letoe:3!null, sn.id:4!null, (row_number() over ( order by sn.id asc):0!null - 1 (tinyint)) as M6T2N, s7egw.tw55n:1!null as FJVD7, tymvl.tw55n:31!null as KBXXJ, sn.id:4!null as XLFIA]\n" +
			"         └─ Window\n" +
			"             ├─ row_number() over ( order by sn.id ASC)\n" +
			"             ├─ s7egw.tw55n:8!null\n" +
			"             ├─ sn.numk2:5!null\n" +
			"             ├─ sn.letoe:6!null\n" +
			"             ├─ sn.id:2!null\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ sn.brqp2:3!null\n" +
			"                 │   └─ s7egw.id:7!null\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ tymvl.id:0!null\n" +
			"                 │   │   └─ sn.fftbj:4!null\n" +
			"                 │   ├─ TableAlias(tymvl)\n" +
			"                 │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"                 │   │       ├─ index: [E2I7U.id]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [id tw55n]\n" +
			"                 │   └─ TableAlias(sn)\n" +
			"                 │       └─ IndexedTableAccess(NOXN3)\n" +
			"                 │           ├─ index: [NOXN3.FFTBJ]\n" +
			"                 │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │           └─ columns: [id brqp2 fftbj numk2 letoe]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(sn.brqp2:3!null)\n" +
			"                     ├─ right-key: TUPLE(s7egw.id:0!null)\n" +
			"                     └─ TableAlias(s7egw)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: E2I7U\n" +
			"                             └─ columns: [id tw55n]\n" +
			"",
	},
	{
		Query: `
	SELECT id FZZVR, ROW_NUMBER() OVER (ORDER BY sn.id ASC) - 1 M6T2N FROM NOXN3 sn`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [FZZVR:2!null, M6T2N:3!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [row_number() over ( order by sn.id asc):0!null, sn.id:1!null, sn.id:1!null as FZZVR, (row_number() over ( order by sn.id asc):0!null - 1 (tinyint)) as M6T2N]\n" +
			"     └─ Window\n" +
			"         ├─ row_number() over ( order by sn.id ASC)\n" +
			"         ├─ sn.id:0!null\n" +
			"         └─ TableAlias(sn)\n" +
			"             └─ Table\n" +
			"                 ├─ name: NOXN3\n" +
			"                 └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   nd.TW55N,
	   il.LIILR,
	   il.KSFXH,
	   il.KLMAU,
	   il.ecm
	FROM RLOHD il
	INNER JOIN E2I7U nd
	   ON il.LUEVY = nd.id
	INNER JOIN F35MI nt
	   ON nd.DKCAJ = nt.id
	WHERE nt.DZLIM <> 'SUZTA'

	ORDER BY nd.TW55N`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [nd.tw55n:11!null, il.liilr:2, il.ksfxh:3, il.klmau:4, il.ecm:5]\n" +
			" └─ Sort(nd.tw55n:11!null ASC nullsFirst)\n" +
			"     └─ Filter\n" +
			"         ├─ NOT\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ nt.dzlim:26!null\n" +
			"         │       └─ SUZTA (longtext)\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ nd.dkcaj:9!null\n" +
			"             │   └─ nt.id:25!null\n" +
			"             ├─ LookupJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ il.luevy:1!null\n" +
			"             │   │   └─ nd.id:8!null\n" +
			"             │   ├─ TableAlias(il)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: RLOHD\n" +
			"             │   │       └─ columns: [id luevy liilr ksfxh klmau ecm rqi4m fhcyt]\n" +
			"             │   └─ TableAlias(nd)\n" +
			"             │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           ├─ index: [E2I7U.id]\n" +
			"             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(nd.dkcaj:9!null)\n" +
			"                 ├─ right-key: TUPLE(nt.id:0!null)\n" +
			"                 └─ Filter\n" +
			"                     ├─ NOT\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ nt.dzlim:1!null\n" +
			"                     │       └─ SUZTA (longtext)\n" +
			"                     └─ TableAlias(nt)\n" +
			"                         └─ IndexedTableAccess(F35MI)\n" +
			"                             ├─ index: [F35MI.DZLIM]\n" +
			"                             ├─ static: [{(NULL, SUZTA)}, {(SUZTA, ∞)}]\n" +
			"                             └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   FTQLQ, TPNJ6
	FROM YK2GW
	WHERE FTQLQ IN ('SQ1')`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [yk2gw.ftqlq:1!null, yk2gw.tpnj6:5!null]\n" +
			" └─ Filter\n" +
			"     ├─ HashIn\n" +
			"     │   ├─ yk2gw.ftqlq:1!null\n" +
			"     │   └─ TUPLE(SQ1 (longtext))\n" +
			"     └─ IndexedTableAccess(YK2GW)\n" +
			"         ├─ index: [YK2GW.FTQLQ]\n" +
			"         ├─ static: [{[SQ1, SQ1]}]\n" +
			"         └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ATHCU.T4IBQ AS T4IBQ,
	   ATHCU.TW55N AS TW55N,
	   CASE
	       WHEN fc.OZTQF IS NULL THEN 0
	       WHEN ATHCU.SJ5DU IN ('log', 'com', 'ex') THEN 0
	       WHEN ATHCU.SOWRY = 'CRZ2X' THEN 0
	       WHEN ATHCU.SOWRY = 'z' THEN fc.OZTQF
	       WHEN ATHCU.SOWRY = 'o' THEN fc.OZTQF - 1
	   END AS OZTQF
	FROM
	(
	   SELECT
	       B2TX3,
	       T4IBQ,
	       nd.id AS YYKXN,
	       nd.TW55N AS TW55N,
	       nd.FSK67 AS SOWRY,
	       (SELECT nt.DZLIM FROM F35MI nt WHERE nt.id = nd.DKCAJ) AS SJ5DU
	   FROM
	   (
	       SELECT
	           bs.id AS B2TX3,
	           cla.FTQLQ AS T4IBQ
	       FROM
	           YK2GW cla
	       INNER JOIN
	           THNTS bs
	       ON
	           bs.IXUXU = cla.id
	       WHERE
	           cla.FTQLQ IN ('SQ1')
	   ) TMDTP
	   CROSS JOIN
	       E2I7U nd
	) ATHCU
	LEFT JOIN
	   AMYXQ fc
	ON
	   fc.LUEVY = YYKXN
	   AND
	   fc.GXLUB = B2TX3
	ORDER BY
	   YYKXN
	`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:14!null, TW55N:15!null, OZTQF:16]\n" +
			" └─ Sort(athcu.YYKXN:2!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [athcu.B2TX3:0!null, athcu.T4IBQ:1!null, athcu.YYKXN:2!null, athcu.TW55N:3!null, athcu.SOWRY:4!null, athcu.SJ5DU:5, fc.id:6!null, fc.gxlub:7!null, fc.luevy:8!null, fc.xqdyt:9!null, fc.amyxq:10!null, fc.oztqf:11!null, fc.z35gy:12!null, fc.kkgn5:13, athcu.T4IBQ:1!null as T4IBQ, athcu.TW55N:3!null as TW55N, CASE  WHEN fc.oztqf:11!null IS NULL THEN 0 (tinyint) WHEN IN\n" +
			"         │   ├─ left: athcu.SJ5DU:5\n" +
			"         │   └─ right: TUPLE(log (longtext), com (longtext), ex (longtext))\n" +
			"         │   THEN 0 (tinyint) WHEN Eq\n" +
			"         │   ├─ athcu.SOWRY:4!null\n" +
			"         │   └─ CRZ2X (longtext)\n" +
			"         │   THEN 0 (tinyint) WHEN Eq\n" +
			"         │   ├─ athcu.SOWRY:4!null\n" +
			"         │   └─ z (longtext)\n" +
			"         │   THEN fc.oztqf:11!null WHEN Eq\n" +
			"         │   ├─ athcu.SOWRY:4!null\n" +
			"         │   └─ o (longtext)\n" +
			"         │   THEN (fc.oztqf:11!null - 1 (tinyint)) END as OZTQF]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ fc.luevy:8!null\n" +
			"             │   │   └─ athcu.YYKXN:2!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ fc.gxlub:7!null\n" +
			"             │       └─ athcu.B2TX3:0!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: athcu\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [tmdtp.B2TX3:0!null, tmdtp.T4IBQ:1!null, YYKXN:19!null, TW55N:20!null, SOWRY:21!null, SJ5DU:22]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [tmdtp.B2TX3:17!null, tmdtp.T4IBQ:18!null, nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, nd.id:0!null as YYKXN, nd.tw55n:3!null as TW55N, nd.fsk67:8!null as SOWRY, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [nt.dzlim:20!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ nt.id:19!null\n" +
			"             │           │           │   └─ nd.dkcaj:1!null\n" +
			"             │           │           └─ TableAlias(nt)\n" +
			"             │           │               └─ IndexedTableAccess(F35MI)\n" +
			"             │           │                   ├─ index: [F35MI.id]\n" +
			"             │           │                   └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as SJ5DU]\n" +
			"             │           └─ CrossHashJoin\n" +
			"             │               ├─ TableAlias(nd)\n" +
			"             │               │   └─ Table\n" +
			"             │               │       ├─ name: E2I7U\n" +
			"             │               │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │               └─ HashLookup\n" +
			"             │                   ├─ left-key: TUPLE()\n" +
			"             │                   ├─ right-key: TUPLE()\n" +
			"             │                   └─ SubqueryAlias\n" +
			"             │                       ├─ name: tmdtp\n" +
			"             │                       ├─ outerVisibility: false\n" +
			"             │                       ├─ cacheable: true\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [B2TX3:34!null, T4IBQ:35!null]\n" +
			"             │                           └─ Project\n" +
			"             │                               ├─ columns: [cla.id:0!null, cla.ftqlq:1!null, cla.tuxml:2, cla.paef5:3, cla.rucy4:4, cla.tpnj6:5!null, cla.lbl53:6, cla.nb3qs:7, cla.eo7iv:8, cla.muhjf:9, cla.fm34l:10, cla.ty5rf:11, cla.zhtlh:12, cla.npb7w:13, cla.sx3hh:14, cla.isbnf:15, cla.ya7yb:16, cla.c5ykb:17, cla.qk7kt:18, cla.ffge6:19, cla.fiigj:20, cla.sh3nc:21, cla.ntena:22, cla.m4aub:23, cla.x5air:24, cla.sab6m:25, cla.g5qi5:26, cla.zvqvd:27, cla.ykssu:28, cla.fhcyt:29, bs.id:30!null, bs.nfryn:31!null, bs.ixuxu:32, bs.fhcyt:33, bs.id:30!null as B2TX3, cla.ftqlq:1!null as T4IBQ]\n" +
			"             │                               └─ MergeJoin\n" +
			"             │                                   ├─ cmp: Eq\n" +
			"             │                                   │   ├─ cla.id:0!null\n" +
			"             │                                   │   └─ bs.ixuxu:32\n" +
			"             │                                   ├─ Filter\n" +
			"             │                                   │   ├─ HashIn\n" +
			"             │                                   │   │   ├─ cla.ftqlq:1!null\n" +
			"             │                                   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"             │                                   │   └─ TableAlias(cla)\n" +
			"             │                                   │       └─ IndexedTableAccess(YK2GW)\n" +
			"             │                                   │           ├─ index: [YK2GW.id]\n" +
			"             │                                   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                   │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │                                   └─ TableAlias(bs)\n" +
			"             │                                       └─ IndexedTableAccess(THNTS)\n" +
			"             │                                           ├─ index: [THNTS.IXUXU]\n" +
			"             │                                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(athcu.YYKXN:2!null, athcu.B2TX3:0!null)\n" +
			"                 ├─ right-key: TUPLE(fc.luevy:2!null, fc.gxlub:1!null)\n" +
			"                 └─ TableAlias(fc)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: AMYXQ\n" +
			"                         └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"",
	},
	{
		Query: `
	WITH AX7FV AS
	   (SELECT
	       bs.T4IBQ AS T4IBQ,
	       pa.DZLIM AS ECUWU,
	       pga.DZLIM AS GSTQA,
	       pog.B5OUF,
	       fc.OZTQF,
	       F26ZW.YHYLK,
	       nd.TW55N AS TW55N
	   FROM
	       SZQWJ ms
	   INNER JOIN XOAOP pa
	       ON ms.CH3FR = pa.id
	   LEFT JOIN NPCYY pog
	       ON pa.id = pog.CH3FR
	   INNER JOIN PG27A pga
	       ON pog.XVSBH = pga.id
	   INNER JOIN FEIOE GZ7Z4
	       ON pog.id = GZ7Z4.GMSGA
	   INNER JOIN E2I7U nd
	       ON GZ7Z4.LUEVY = nd.id
	   RIGHT JOIN (
	       SELECT
	           THNTS.id,
	           YK2GW.FTQLQ AS T4IBQ
	       FROM THNTS
	       INNER JOIN YK2GW
	       ON IXUXU = YK2GW.id
	   ) bs
	       ON ms.GXLUB = bs.id
	   LEFT JOIN AMYXQ fc
	       ON bs.id = fc.GXLUB AND nd.id = fc.LUEVY
	   LEFT JOIN (
	       SELECT
	           iq.T4IBQ,
	           iq.BRQP2,
	           iq.Z7CP5,
	           CASE
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'KAOAS'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'OG'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'TSG'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'W6W24'
	               THEN 1
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'OG'
	               THEN 1
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'TSG'
	               THEN 0
	               ELSE NULL
	           END AS YHYLK
	       FROM (
	           SELECT /*+ JOIN_ORDER( cla, bs, mf, nd, nma, sn ) */
	               cla.FTQLQ AS T4IBQ,
	               sn.BRQP2,
	               mf.id AS Z7CP5,
	               mf.FSDY2,
	               nma.DZLIM AS IDWIO
	           FROM
	               HGMQ6 mf
	           INNER JOIN THNTS bs
	               ON mf.GXLUB = bs.id
	           INNER JOIN YK2GW cla
	               ON bs.IXUXU = cla.id
	           INNER JOIN E2I7U nd
	               ON mf.LUEVY = nd.id
	           INNER JOIN TNMXI nma
	               ON nd.HPCMS = nma.id
	           INNER JOIN NOXN3 sn
	               ON sn.BRQP2 = nd.id
	           WHERE cla.FTQLQ IN ('SQ1')
	       ) iq
	       LEFT JOIN SEQS3 W2MAO
	           ON iq.Z7CP5 = W2MAO.Z7CP5
	       LEFT JOIN D34QP vc
	           ON W2MAO.YH4XB = vc.id
	   ) F26ZW
	       ON F26ZW.T4IBQ = bs.T4IBQ AND F26ZW.BRQP2 = nd.id
	   LEFT JOIN TNMXI nma
	       ON nd.HPCMS = nma.id
	   WHERE bs.T4IBQ IN ('SQ1') AND ms.D237E = TRUE)
	SELECT
	   XPRW6.T4IBQ AS T4IBQ,
	   XPRW6.ECUWU AS ECUWU,
	   SUM(XPRW6.B5OUF) AS B5OUF,
	   SUM(XPRW6.SP4SI) AS SP4SI
	FROM (
	   SELECT
	       NRFJ3.T4IBQ AS T4IBQ,
	       NRFJ3.ECUWU AS ECUWU,
	       NRFJ3.GSTQA AS GSTQA,
	       NRFJ3.B5OUF AS B5OUF,
	       SUM(CASE
	               WHEN NRFJ3.OZTQF < 0.5 OR NRFJ3.YHYLK = 0 THEN 1
	               ELSE 0
	           END) AS SP4SI
	   FROM (
	       SELECT DISTINCT
	           T4IBQ,
	           ECUWU,
	           GSTQA,
	           B5OUF,
	           TW55N,
	           OZTQF,
	           YHYLK
	       FROM
	           AX7FV) NRFJ3
	   GROUP BY T4IBQ, ECUWU, GSTQA
	) XPRW6
	GROUP BY T4IBQ, ECUWU`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:4!null, ECUWU:5!null, B5OUF:6!null, SP4SI:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [sum(xprw6.b5ouf):0!null, sum(xprw6.sp4si):1!null, xprw6.T4IBQ:2!null, xprw6.ECUWU:3!null, xprw6.T4IBQ:2!null as T4IBQ, xprw6.ECUWU:3!null as ECUWU, sum(xprw6.b5ouf):0!null as B5OUF, sum(xprw6.sp4si):1!null as SP4SI]\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(xprw6.B5OUF:3), SUM(xprw6.SP4SI:4!null), xprw6.T4IBQ:0!null, xprw6.ECUWU:1!null\n" +
			"         ├─ group: xprw6.T4IBQ:0!null as T4IBQ, xprw6.ECUWU:1!null as ECUWU\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: xprw6\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [T4IBQ:5!null, ECUWU:6!null, GSTQA:7!null, B5OUF:8, SP4SI:9!null]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [sum(case  when ((nrfj3.oztqf < 0.5) or (nrfj3.yhylk = 0)) then 1 else 0 end):0!null, nrfj3.T4IBQ:1!null, nrfj3.ECUWU:2!null, nrfj3.GSTQA:3!null, nrfj3.b5ouf:4, nrfj3.T4IBQ:1!null as T4IBQ, nrfj3.ECUWU:2!null as ECUWU, nrfj3.GSTQA:3!null as GSTQA, nrfj3.b5ouf:4 as B5OUF, sum(case  when ((nrfj3.oztqf < 0.5) or (nrfj3.yhylk = 0)) then 1 else 0 end):0!null as SP4SI]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ select: SUM(CASE  WHEN Or\n" +
			"                         │   ├─ LessThan\n" +
			"                         │   │   ├─ nrfj3.oztqf:5!null\n" +
			"                         │   │   └─ 0.500000 (double)\n" +
			"                         │   └─ Eq\n" +
			"                         │       ├─ nrfj3.YHYLK:6\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         │   THEN 1 (tinyint) ELSE 0 (tinyint) END), nrfj3.T4IBQ:0!null, nrfj3.ECUWU:1!null, nrfj3.GSTQA:2!null, nrfj3.b5ouf:3\n" +
			"                         ├─ group: nrfj3.T4IBQ:0!null as T4IBQ, nrfj3.ECUWU:1!null as ECUWU, nrfj3.GSTQA:2!null as GSTQA\n" +
			"                         └─ SubqueryAlias\n" +
			"                             ├─ name: nrfj3\n" +
			"                             ├─ outerVisibility: false\n" +
			"                             ├─ cacheable: true\n" +
			"                             └─ Distinct\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [ax7fv.T4IBQ:0!null, ax7fv.ECUWU:1!null, ax7fv.GSTQA:2!null, ax7fv.b5ouf:3, ax7fv.TW55N:6!null, ax7fv.oztqf:4!null, ax7fv.YHYLK:5]\n" +
			"                                     └─ SubqueryAlias\n" +
			"                                         ├─ name: ax7fv\n" +
			"                                         ├─ outerVisibility: false\n" +
			"                                         ├─ cacheable: true\n" +
			"                                         └─ Project\n" +
			"                                             ├─ columns: [T4IBQ:55!null, ECUWU:56!null, GSTQA:57!null, pog.b5ouf:11, fc.oztqf:45!null, f26zw.YHYLK:51, TW55N:58!null]\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [ms.id:28!null, ms.gxlub:29!null, ms.ch3fr:30!null, ms.d237e:31!null, ms.jogi6:32, pa.id:25!null, pa.dzlim:26!null, pa.f3yue:27, pog.id:33!null, pog.ch3fr:34!null, pog.xvsbh:35, pog.b5ouf:36, pga.id:37!null, pga.dzlim:38!null, pga.f3yue:39, gz7z4.id:19!null, gz7z4.luevy:20!null, gz7z4.gmsga:21!null, gz7z4.fvgd2:22!null, gz7z4.yp2cr:23!null, gz7z4.tq7w3:24!null, nd.id:2!null, nd.dkcaj:3!null, nd.kng7t:4, nd.tw55n:5!null, nd.qrqxw:6!null, nd.ecxaj:7!null, nd.fgg57:8, nd.zh72s:9, nd.fsk67:10!null, nd.xqdyt:11!null, nd.tce7a:12, nd.iwv2h:13, nd.hpcms:14!null, nd.n5cc2:15, nd.fhcyt:16, nd.etaq7:17, nd.a75x7:18, bs.id:0!null, bs.T4IBQ:1!null, fc.id:40!null, fc.gxlub:41!null, fc.luevy:42!null, fc.xqdyt:43!null, fc.amyxq:44!null, fc.oztqf:45!null, fc.z35gy:46!null, fc.kkgn5:47, f26zw.T4IBQ:48!null, f26zw.brqp2:49!null, f26zw.Z7CP5:50!null, f26zw.YHYLK:51, nma.id:52!null, nma.dzlim:53!null, nma.f3yue:54, bs.T4IBQ:1!null as T4IBQ, pa.dzlim:26!null as ECUWU, pga.dzlim:38!null as GSTQA, nd.tw55n:5!null as TW55N]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ Eq\n" +
			"                                                     │   ├─ ms.d237e:31!null\n" +
			"                                                     │   └─ true (tinyint)\n" +
			"                                                     └─ LeftOuterHashJoin\n" +
			"                                                         ├─ Eq\n" +
			"                                                         │   ├─ nd.hpcms:14!null\n" +
			"                                                         │   └─ nma.id:52!null\n" +
			"                                                         ├─ LeftOuterHashJoin\n" +
			"                                                         │   ├─ AND\n" +
			"                                                         │   │   ├─ Eq\n" +
			"                                                         │   │   │   ├─ f26zw.T4IBQ:48!null\n" +
			"                                                         │   │   │   └─ bs.T4IBQ:1!null\n" +
			"                                                         │   │   └─ Eq\n" +
			"                                                         │   │       ├─ f26zw.brqp2:49!null\n" +
			"                                                         │   │       └─ nd.id:2!null\n" +
			"                                                         │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   ├─ AND\n" +
			"                                                         │   │   │   ├─ Eq\n" +
			"                                                         │   │   │   │   ├─ bs.id:0!null\n" +
			"                                                         │   │   │   │   └─ fc.gxlub:41!null\n" +
			"                                                         │   │   │   └─ Eq\n" +
			"                                                         │   │   │       ├─ nd.id:2!null\n" +
			"                                                         │   │   │       └─ fc.luevy:42!null\n" +
			"                                                         │   │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   │   ├─ Eq\n" +
			"                                                         │   │   │   │   ├─ ms.gxlub:29!null\n" +
			"                                                         │   │   │   │   └─ bs.id:0!null\n" +
			"                                                         │   │   │   ├─ SubqueryAlias\n" +
			"                                                         │   │   │   │   ├─ name: bs\n" +
			"                                                         │   │   │   │   ├─ outerVisibility: false\n" +
			"                                                         │   │   │   │   ├─ cacheable: true\n" +
			"                                                         │   │   │   │   └─ Filter\n" +
			"                                                         │   │   │   │       ├─ HashIn\n" +
			"                                                         │   │   │   │       │   ├─ T4IBQ:1!null\n" +
			"                                                         │   │   │   │       │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │   │   │   │       └─ Project\n" +
			"                                                         │   │   │   │           ├─ columns: [thnts.id:0!null, T4IBQ:34!null]\n" +
			"                                                         │   │   │   │           └─ Project\n" +
			"                                                         │   │   │   │               ├─ columns: [thnts.id:30!null, thnts.nfryn:31!null, thnts.ixuxu:32, thnts.fhcyt:33, yk2gw.id:0!null, yk2gw.ftqlq:1!null, yk2gw.tuxml:2, yk2gw.paef5:3, yk2gw.rucy4:4, yk2gw.tpnj6:5!null, yk2gw.lbl53:6, yk2gw.nb3qs:7, yk2gw.eo7iv:8, yk2gw.muhjf:9, yk2gw.fm34l:10, yk2gw.ty5rf:11, yk2gw.zhtlh:12, yk2gw.npb7w:13, yk2gw.sx3hh:14, yk2gw.isbnf:15, yk2gw.ya7yb:16, yk2gw.c5ykb:17, yk2gw.qk7kt:18, yk2gw.ffge6:19, yk2gw.fiigj:20, yk2gw.sh3nc:21, yk2gw.ntena:22, yk2gw.m4aub:23, yk2gw.x5air:24, yk2gw.sab6m:25, yk2gw.g5qi5:26, yk2gw.zvqvd:27, yk2gw.ykssu:28, yk2gw.fhcyt:29, yk2gw.ftqlq:1!null as T4IBQ]\n" +
			"                                                         │   │   │   │               └─ MergeJoin\n" +
			"                                                         │   │   │   │                   ├─ cmp: Eq\n" +
			"                                                         │   │   │   │                   │   ├─ yk2gw.id:0!null\n" +
			"                                                         │   │   │   │                   │   └─ thnts.ixuxu:32\n" +
			"                                                         │   │   │   │                   ├─ IndexedTableAccess(YK2GW)\n" +
			"                                                         │   │   │   │                   │   ├─ index: [YK2GW.id]\n" +
			"                                                         │   │   │   │                   │   ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │   │                   │   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                                         │   │   │   │                   └─ IndexedTableAccess(THNTS)\n" +
			"                                                         │   │   │   │                       ├─ index: [THNTS.IXUXU]\n" +
			"                                                         │   │   │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │   │                       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                                         │   │   │   └─ HashLookup\n" +
			"                                                         │   │   │       ├─ left-key: TUPLE(bs.id:0!null)\n" +
			"                                                         │   │   │       ├─ right-key: TUPLE(ms.gxlub:27!null)\n" +
			"                                                         │   │   │       └─ HashJoin\n" +
			"                                                         │   │   │           ├─ Eq\n" +
			"                                                         │   │   │           │   ├─ pog.id:33!null\n" +
			"                                                         │   │   │           │   └─ gz7z4.gmsga:21!null\n" +
			"                                                         │   │   │           ├─ MergeJoin\n" +
			"                                                         │   │   │           │   ├─ cmp: Eq\n" +
			"                                                         │   │   │           │   │   ├─ nd.id:2!null\n" +
			"                                                         │   │   │           │   │   └─ gz7z4.luevy:20!null\n" +
			"                                                         │   │   │           │   ├─ TableAlias(nd)\n" +
			"                                                         │   │   │           │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │   │   │           │   │       ├─ index: [E2I7U.id]\n" +
			"                                                         │   │   │           │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │           │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │   │   │           │   └─ TableAlias(gz7z4)\n" +
			"                                                         │   │   │           │       └─ IndexedTableAccess(FEIOE)\n" +
			"                                                         │   │   │           │           ├─ index: [FEIOE.LUEVY,FEIOE.GMSGA]\n" +
			"                                                         │   │   │           │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                                                         │   │   │           │           └─ columns: [id luevy gmsga fvgd2 yp2cr tq7w3]\n" +
			"                                                         │   │   │           └─ HashLookup\n" +
			"                                                         │   │   │               ├─ left-key: TUPLE(gz7z4.gmsga:21!null)\n" +
			"                                                         │   │   │               ├─ right-key: TUPLE(pog.id:8!null)\n" +
			"                                                         │   │   │               └─ HashJoin\n" +
			"                                                         │   │   │                   ├─ Eq\n" +
			"                                                         │   │   │                   │   ├─ pog.xvsbh:35\n" +
			"                                                         │   │   │                   │   └─ pga.id:37!null\n" +
			"                                                         │   │   │                   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   │                   │   ├─ Eq\n" +
			"                                                         │   │   │                   │   │   ├─ pa.id:25!null\n" +
			"                                                         │   │   │                   │   │   └─ pog.ch3fr:34!null\n" +
			"                                                         │   │   │                   │   ├─ MergeJoin\n" +
			"                                                         │   │   │                   │   │   ├─ cmp: Eq\n" +
			"                                                         │   │   │                   │   │   │   ├─ pa.id:25!null\n" +
			"                                                         │   │   │                   │   │   │   └─ ms.ch3fr:30!null\n" +
			"                                                         │   │   │                   │   │   ├─ TableAlias(pa)\n" +
			"                                                         │   │   │                   │   │   │   └─ IndexedTableAccess(XOAOP)\n" +
			"                                                         │   │   │                   │   │   │       ├─ index: [XOAOP.id]\n" +
			"                                                         │   │   │                   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │                   │   │   │       └─ columns: [id dzlim f3yue]\n" +
			"                                                         │   │   │                   │   │   └─ TableAlias(ms)\n" +
			"                                                         │   │   │                   │   │       └─ IndexedTableAccess(SZQWJ)\n" +
			"                                                         │   │   │                   │   │           ├─ index: [SZQWJ.CH3FR]\n" +
			"                                                         │   │   │                   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │                   │   │           └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"                                                         │   │   │                   │   └─ HashLookup\n" +
			"                                                         │   │   │                   │       ├─ left-key: TUPLE(pa.id:25!null)\n" +
			"                                                         │   │   │                   │       ├─ right-key: TUPLE(pog.ch3fr:1!null)\n" +
			"                                                         │   │   │                   │       └─ TableAlias(pog)\n" +
			"                                                         │   │   │                   │           └─ Table\n" +
			"                                                         │   │   │                   │               ├─ name: NPCYY\n" +
			"                                                         │   │   │                   │               └─ columns: [id ch3fr xvsbh b5ouf]\n" +
			"                                                         │   │   │                   └─ HashLookup\n" +
			"                                                         │   │   │                       ├─ left-key: TUPLE(pog.xvsbh:35)\n" +
			"                                                         │   │   │                       ├─ right-key: TUPLE(pga.id:0!null)\n" +
			"                                                         │   │   │                       └─ TableAlias(pga)\n" +
			"                                                         │   │   │                           └─ Table\n" +
			"                                                         │   │   │                               ├─ name: PG27A\n" +
			"                                                         │   │   │                               └─ columns: [id dzlim f3yue]\n" +
			"                                                         │   │   └─ HashLookup\n" +
			"                                                         │   │       ├─ left-key: TUPLE(bs.id:0!null, nd.id:2!null)\n" +
			"                                                         │   │       ├─ right-key: TUPLE(fc.gxlub:1!null, fc.luevy:2!null)\n" +
			"                                                         │   │       └─ TableAlias(fc)\n" +
			"                                                         │   │           └─ Table\n" +
			"                                                         │   │               ├─ name: AMYXQ\n" +
			"                                                         │   │               └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                                                         │   └─ HashLookup\n" +
			"                                                         │       ├─ left-key: TUPLE(bs.T4IBQ:1!null, nd.id:2!null)\n" +
			"                                                         │       ├─ right-key: TUPLE(f26zw.T4IBQ:0!null, f26zw.brqp2:1!null)\n" +
			"                                                         │       └─ SubqueryAlias\n" +
			"                                                         │           ├─ name: f26zw\n" +
			"                                                         │           ├─ outerVisibility: false\n" +
			"                                                         │           ├─ cacheable: true\n" +
			"                                                         │           └─ Project\n" +
			"                                                         │               ├─ columns: [iq.T4IBQ:0!null, iq.brqp2:1!null, iq.Z7CP5:2!null, YHYLK:14]\n" +
			"                                                         │               └─ Project\n" +
			"                                                         │                   ├─ columns: [iq.T4IBQ:0!null, iq.brqp2:1!null, iq.Z7CP5:2!null, iq.fsdy2:3!null, iq.IDWIO:4!null, w2mao.id:5!null, w2mao.z7cp5:6!null, w2mao.yh4xb:7!null, vc.id:8!null, vc.twmsr:9!null, vc.qhmge:10, vc.mlnpu:11!null, vc.fi3ga:12!null, vc.znp4p:13!null, CASE  WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ KAOAS (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ OG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ TSG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ W6W24 (longtext)\n" +
			"                                                         │                   │   THEN 1 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ OG (longtext)\n" +
			"                                                         │                   │   THEN 1 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ TSG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) ELSE NULL (null) END as YHYLK]\n" +
			"                                                         │                   └─ LeftOuterHashJoin\n" +
			"                                                         │                       ├─ Eq\n" +
			"                                                         │                       │   ├─ w2mao.yh4xb:7!null\n" +
			"                                                         │                       │   └─ vc.id:8!null\n" +
			"                                                         │                       ├─ LeftOuterHashJoin\n" +
			"                                                         │                       │   ├─ Eq\n" +
			"                                                         │                       │   │   ├─ iq.Z7CP5:2!null\n" +
			"                                                         │                       │   │   └─ w2mao.z7cp5:6!null\n" +
			"                                                         │                       │   ├─ SubqueryAlias\n" +
			"                                                         │                       │   │   ├─ name: iq\n" +
			"                                                         │                       │   │   ├─ outerVisibility: false\n" +
			"                                                         │                       │   │   ├─ cacheable: true\n" +
			"                                                         │                       │   │   └─ Project\n" +
			"                                                         │                       │   │       ├─ columns: [T4IBQ:81!null, sn.brqp2:72!null, Z7CP5:82!null, mf.fsdy2:10!null, IDWIO:83!null]\n" +
			"                                                         │                       │   │       └─ Project\n" +
			"                                                         │                       │   │           ├─ columns: [mf.id:34!null, mf.gxlub:35!null, mf.luevy:36!null, mf.m22qn:37!null, mf.tjpt7:38!null, mf.arn5p:39!null, mf.xosd4:40!null, mf.ide43:41, mf.hmw4h:42, mf.zbt6r:43, mf.fsdy2:44!null, mf.lt7k6:45, mf.sppyd:46, mf.qcgts:47, mf.teuja:48, mf.qqv4m:49, mf.fhcyt:50, bs.id:30!null, bs.nfryn:31!null, bs.ixuxu:32, bs.fhcyt:33, cla.id:0!null, cla.ftqlq:1!null, cla.tuxml:2, cla.paef5:3, cla.rucy4:4, cla.tpnj6:5!null, cla.lbl53:6, cla.nb3qs:7, cla.eo7iv:8, cla.muhjf:9, cla.fm34l:10, cla.ty5rf:11, cla.zhtlh:12, cla.npb7w:13, cla.sx3hh:14, cla.isbnf:15, cla.ya7yb:16, cla.c5ykb:17, cla.qk7kt:18, cla.ffge6:19, cla.fiigj:20, cla.sh3nc:21, cla.ntena:22, cla.m4aub:23, cla.x5air:24, cla.sab6m:25, cla.g5qi5:26, cla.zvqvd:27, cla.ykssu:28, cla.fhcyt:29, nd.id:51!null, nd.dkcaj:52!null, nd.kng7t:53, nd.tw55n:54!null, nd.qrqxw:55!null, nd.ecxaj:56!null, nd.fgg57:57, nd.zh72s:58, nd.fsk67:59!null, nd.xqdyt:60!null, nd.tce7a:61, nd.iwv2h:62, nd.hpcms:63!null, nd.n5cc2:64, nd.fhcyt:65, nd.etaq7:66, nd.a75x7:67, nma.id:68!null, nma.dzlim:69!null, nma.f3yue:70, sn.id:71!null, sn.brqp2:72!null, sn.fftbj:73!null, sn.a7xo2:74, sn.kbo7r:75!null, sn.ecdkm:76, sn.numk2:77!null, sn.letoe:78!null, sn.ykssu:79, sn.fhcyt:80, cla.ftqlq:1!null as T4IBQ, mf.id:34!null as Z7CP5, nma.dzlim:69!null as IDWIO]\n" +
			"                                                         │                       │   │           └─ Filter\n" +
			"                                                         │                       │   │               ├─ HashIn\n" +
			"                                                         │                       │   │               │   ├─ cla.ftqlq:1!null\n" +
			"                                                         │                       │   │               │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │                       │   │               └─ HashJoin\n" +
			"                                                         │                       │   │                   ├─ AND\n" +
			"                                                         │                       │   │                   │   ├─ Eq\n" +
			"                                                         │                       │   │                   │   │   ├─ mf.luevy:36!null\n" +
			"                                                         │                       │   │                   │   │   └─ nd.id:51!null\n" +
			"                                                         │                       │   │                   │   └─ Eq\n" +
			"                                                         │                       │   │                   │       ├─ mf.luevy:36!null\n" +
			"                                                         │                       │   │                   │       └─ sn.brqp2:72!null\n" +
			"                                                         │                       │   │                   ├─ HashJoin\n" +
			"                                                         │                       │   │                   │   ├─ Eq\n" +
			"                                                         │                       │   │                   │   │   ├─ mf.gxlub:35!null\n" +
			"                                                         │                       │   │                   │   │   └─ bs.id:30!null\n" +
			"                                                         │                       │   │                   │   ├─ MergeJoin\n" +
			"                                                         │                       │   │                   │   │   ├─ cmp: Eq\n" +
			"                                                         │                       │   │                   │   │   │   ├─ cla.id:0!null\n" +
			"                                                         │                       │   │                   │   │   │   └─ bs.ixuxu:32\n" +
			"                                                         │                       │   │                   │   │   ├─ Filter\n" +
			"                                                         │                       │   │                   │   │   │   ├─ HashIn\n" +
			"                                                         │                       │   │                   │   │   │   │   ├─ cla.ftqlq:1!null\n" +
			"                                                         │                       │   │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │                       │   │                   │   │   │   └─ TableAlias(cla)\n" +
			"                                                         │                       │   │                   │   │   │       └─ IndexedTableAccess(YK2GW)\n" +
			"                                                         │                       │   │                   │   │   │           ├─ index: [YK2GW.id]\n" +
			"                                                         │                       │   │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                   │   │   │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                                         │                       │   │                   │   │   └─ TableAlias(bs)\n" +
			"                                                         │                       │   │                   │   │       └─ IndexedTableAccess(THNTS)\n" +
			"                                                         │                       │   │                   │   │           ├─ index: [THNTS.IXUXU]\n" +
			"                                                         │                       │   │                   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                   │   │           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                                         │                       │   │                   │   └─ HashLookup\n" +
			"                                                         │                       │   │                   │       ├─ left-key: TUPLE(bs.id:30!null)\n" +
			"                                                         │                       │   │                   │       ├─ right-key: TUPLE(mf.gxlub:1!null)\n" +
			"                                                         │                       │   │                   │       └─ TableAlias(mf)\n" +
			"                                                         │                       │   │                   │           └─ Table\n" +
			"                                                         │                       │   │                   │               ├─ name: HGMQ6\n" +
			"                                                         │                       │   │                   │               └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                                                         │                       │   │                   └─ HashLookup\n" +
			"                                                         │                       │   │                       ├─ left-key: TUPLE(mf.luevy:36!null, mf.luevy:36!null)\n" +
			"                                                         │                       │   │                       ├─ right-key: TUPLE(nd.id:0!null, sn.brqp2:21!null)\n" +
			"                                                         │                       │   │                       └─ HashJoin\n" +
			"                                                         │                       │   │                           ├─ Eq\n" +
			"                                                         │                       │   │                           │   ├─ sn.brqp2:72!null\n" +
			"                                                         │                       │   │                           │   └─ nd.id:51!null\n" +
			"                                                         │                       │   │                           ├─ MergeJoin\n" +
			"                                                         │                       │   │                           │   ├─ cmp: Eq\n" +
			"                                                         │                       │   │                           │   │   ├─ nd.hpcms:63!null\n" +
			"                                                         │                       │   │                           │   │   └─ nma.id:68!null\n" +
			"                                                         │                       │   │                           │   ├─ TableAlias(nd)\n" +
			"                                                         │                       │   │                           │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │                       │   │                           │   │       ├─ index: [E2I7U.HPCMS]\n" +
			"                                                         │                       │   │                           │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                           │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │                       │   │                           │   └─ TableAlias(nma)\n" +
			"                                                         │                       │   │                           │       └─ IndexedTableAccess(TNMXI)\n" +
			"                                                         │                       │   │                           │           ├─ index: [TNMXI.id]\n" +
			"                                                         │                       │   │                           │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                           │           └─ columns: [id dzlim f3yue]\n" +
			"                                                         │                       │   │                           └─ HashLookup\n" +
			"                                                         │                       │   │                               ├─ left-key: TUPLE(nd.id:51!null)\n" +
			"                                                         │                       │   │                               ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"                                                         │                       │   │                               └─ TableAlias(sn)\n" +
			"                                                         │                       │   │                                   └─ Table\n" +
			"                                                         │                       │   │                                       ├─ name: NOXN3\n" +
			"                                                         │                       │   │                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │                       │   └─ HashLookup\n" +
			"                                                         │                       │       ├─ left-key: TUPLE(iq.Z7CP5:2!null)\n" +
			"                                                         │                       │       ├─ right-key: TUPLE(w2mao.z7cp5:1!null)\n" +
			"                                                         │                       │       └─ TableAlias(w2mao)\n" +
			"                                                         │                       │           └─ Table\n" +
			"                                                         │                       │               ├─ name: SEQS3\n" +
			"                                                         │                       │               └─ columns: [id z7cp5 yh4xb]\n" +
			"                                                         │                       └─ HashLookup\n" +
			"                                                         │                           ├─ left-key: TUPLE(w2mao.yh4xb:7!null)\n" +
			"                                                         │                           ├─ right-key: TUPLE(vc.id:0!null)\n" +
			"                                                         │                           └─ TableAlias(vc)\n" +
			"                                                         │                               └─ Table\n" +
			"                                                         │                                   ├─ name: D34QP\n" +
			"                                                         │                                   └─ columns: [id twmsr qhmge mlnpu fi3ga znp4p]\n" +
			"                                                         └─ HashLookup\n" +
			"                                                             ├─ left-key: TUPLE(nd.hpcms:14!null)\n" +
			"                                                             ├─ right-key: TUPLE(nma.id:0!null)\n" +
			"                                                             └─ TableAlias(nma)\n" +
			"                                                                 └─ Table\n" +
			"                                                                     ├─ name: TNMXI\n" +
			"                                                                     └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
	WITH AX7FV AS
	   (SELECT
	       bs.T4IBQ AS T4IBQ,
	       pa.DZLIM AS ECUWU,
	       pga.DZLIM AS GSTQA,
	       pog.B5OUF,
	       fc.OZTQF,
	       F26ZW.YHYLK,
	       nd.TW55N AS TW55N
	   FROM
	       SZQWJ ms
	   INNER JOIN XOAOP pa
	       ON ms.CH3FR = pa.id
	   LEFT JOIN NPCYY pog
	       ON pa.id = pog.CH3FR
	   INNER JOIN PG27A pga
	       ON pog.XVSBH = pga.id
	   INNER JOIN FEIOE GZ7Z4
	       ON pog.id = GZ7Z4.GMSGA
	   INNER JOIN E2I7U nd
	       ON GZ7Z4.LUEVY = nd.id
	   RIGHT JOIN (
	       SELECT
	           THNTS.id,
	           YK2GW.FTQLQ AS T4IBQ
	       FROM THNTS
	       INNER JOIN YK2GW
	       ON IXUXU = YK2GW.id
	   ) bs
	       ON ms.GXLUB = bs.id
	   LEFT JOIN AMYXQ fc
	       ON bs.id = fc.GXLUB AND nd.id = fc.LUEVY
	   LEFT JOIN (
	       SELECT
	           iq.T4IBQ,
	           iq.BRQP2,
	           iq.Z7CP5,
	           CASE
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'KAOAS'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'OG'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P = 'L5Q44' AND iq.IDWIO = 'TSG'
	               THEN 0
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'W6W24'
	               THEN 1
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'OG'
	               THEN 1
	               WHEN iq.FSDY2 IN ('SRARY','UBQWG') AND vc.ZNP4P <> 'L5Q44' AND iq.IDWIO = 'TSG'
	               THEN 0
	               ELSE NULL
	           END AS YHYLK
	       FROM (
	           SELECT
	               cla.FTQLQ AS T4IBQ,
	               sn.BRQP2,
	               mf.id AS Z7CP5,
	               mf.FSDY2,
	               nma.DZLIM AS IDWIO
	           FROM
	               HGMQ6 mf
	           INNER JOIN THNTS bs
	               ON mf.GXLUB = bs.id
	           INNER JOIN YK2GW cla
	               ON bs.IXUXU = cla.id
	           INNER JOIN E2I7U nd
	               ON mf.LUEVY = nd.id
	           INNER JOIN TNMXI nma
	               ON nd.HPCMS = nma.id
	           INNER JOIN NOXN3 sn
	               ON sn.BRQP2 = nd.id
	           WHERE cla.FTQLQ IN ('SQ1')
	       ) iq
	       LEFT JOIN SEQS3 W2MAO
	           ON iq.Z7CP5 = W2MAO.Z7CP5
	       LEFT JOIN D34QP vc
	           ON W2MAO.YH4XB = vc.id
	   ) F26ZW
	       ON F26ZW.T4IBQ = bs.T4IBQ AND F26ZW.BRQP2 = nd.id
	   LEFT JOIN TNMXI nma
	       ON nd.HPCMS = nma.id
	   WHERE bs.T4IBQ IN ('SQ1') AND ms.D237E = TRUE)
	SELECT
	   XPRW6.T4IBQ AS T4IBQ,
	   XPRW6.ECUWU AS ECUWU,
	   SUM(XPRW6.B5OUF) AS B5OUF,
	   SUM(XPRW6.SP4SI) AS SP4SI
	FROM (
	   SELECT
	       NRFJ3.T4IBQ AS T4IBQ,
	       NRFJ3.ECUWU AS ECUWU,
	       NRFJ3.GSTQA AS GSTQA,
	       NRFJ3.B5OUF AS B5OUF,
	       SUM(CASE
	               WHEN NRFJ3.OZTQF < 0.5 OR NRFJ3.YHYLK = 0 THEN 1
	               ELSE 0
	           END) AS SP4SI
	   FROM (
	       SELECT DISTINCT
	           T4IBQ,
	           ECUWU,
	           GSTQA,
	           B5OUF,
	           TW55N,
	           OZTQF,
	           YHYLK
	       FROM
	           AX7FV) NRFJ3
	   GROUP BY T4IBQ, ECUWU, GSTQA
	) XPRW6
	GROUP BY T4IBQ, ECUWU`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:4!null, ECUWU:5!null, B5OUF:6!null, SP4SI:7!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [sum(xprw6.b5ouf):0!null, sum(xprw6.sp4si):1!null, xprw6.T4IBQ:2!null, xprw6.ECUWU:3!null, xprw6.T4IBQ:2!null as T4IBQ, xprw6.ECUWU:3!null as ECUWU, sum(xprw6.b5ouf):0!null as B5OUF, sum(xprw6.sp4si):1!null as SP4SI]\n" +
			"     └─ GroupBy\n" +
			"         ├─ select: SUM(xprw6.B5OUF:3), SUM(xprw6.SP4SI:4!null), xprw6.T4IBQ:0!null, xprw6.ECUWU:1!null\n" +
			"         ├─ group: xprw6.T4IBQ:0!null as T4IBQ, xprw6.ECUWU:1!null as ECUWU\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: xprw6\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [T4IBQ:5!null, ECUWU:6!null, GSTQA:7!null, B5OUF:8, SP4SI:9!null]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [sum(case  when ((nrfj3.oztqf < 0.5) or (nrfj3.yhylk = 0)) then 1 else 0 end):0!null, nrfj3.T4IBQ:1!null, nrfj3.ECUWU:2!null, nrfj3.GSTQA:3!null, nrfj3.b5ouf:4, nrfj3.T4IBQ:1!null as T4IBQ, nrfj3.ECUWU:2!null as ECUWU, nrfj3.GSTQA:3!null as GSTQA, nrfj3.b5ouf:4 as B5OUF, sum(case  when ((nrfj3.oztqf < 0.5) or (nrfj3.yhylk = 0)) then 1 else 0 end):0!null as SP4SI]\n" +
			"                     └─ GroupBy\n" +
			"                         ├─ select: SUM(CASE  WHEN Or\n" +
			"                         │   ├─ LessThan\n" +
			"                         │   │   ├─ nrfj3.oztqf:5!null\n" +
			"                         │   │   └─ 0.500000 (double)\n" +
			"                         │   └─ Eq\n" +
			"                         │       ├─ nrfj3.YHYLK:6\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         │   THEN 1 (tinyint) ELSE 0 (tinyint) END), nrfj3.T4IBQ:0!null, nrfj3.ECUWU:1!null, nrfj3.GSTQA:2!null, nrfj3.b5ouf:3\n" +
			"                         ├─ group: nrfj3.T4IBQ:0!null as T4IBQ, nrfj3.ECUWU:1!null as ECUWU, nrfj3.GSTQA:2!null as GSTQA\n" +
			"                         └─ SubqueryAlias\n" +
			"                             ├─ name: nrfj3\n" +
			"                             ├─ outerVisibility: false\n" +
			"                             ├─ cacheable: true\n" +
			"                             └─ Distinct\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [ax7fv.T4IBQ:0!null, ax7fv.ECUWU:1!null, ax7fv.GSTQA:2!null, ax7fv.b5ouf:3, ax7fv.TW55N:6!null, ax7fv.oztqf:4!null, ax7fv.YHYLK:5]\n" +
			"                                     └─ SubqueryAlias\n" +
			"                                         ├─ name: ax7fv\n" +
			"                                         ├─ outerVisibility: false\n" +
			"                                         ├─ cacheable: true\n" +
			"                                         └─ Project\n" +
			"                                             ├─ columns: [T4IBQ:55!null, ECUWU:56!null, GSTQA:57!null, pog.b5ouf:11, fc.oztqf:45!null, f26zw.YHYLK:51, TW55N:58!null]\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [ms.id:28!null, ms.gxlub:29!null, ms.ch3fr:30!null, ms.d237e:31!null, ms.jogi6:32, pa.id:25!null, pa.dzlim:26!null, pa.f3yue:27, pog.id:33!null, pog.ch3fr:34!null, pog.xvsbh:35, pog.b5ouf:36, pga.id:37!null, pga.dzlim:38!null, pga.f3yue:39, gz7z4.id:19!null, gz7z4.luevy:20!null, gz7z4.gmsga:21!null, gz7z4.fvgd2:22!null, gz7z4.yp2cr:23!null, gz7z4.tq7w3:24!null, nd.id:2!null, nd.dkcaj:3!null, nd.kng7t:4, nd.tw55n:5!null, nd.qrqxw:6!null, nd.ecxaj:7!null, nd.fgg57:8, nd.zh72s:9, nd.fsk67:10!null, nd.xqdyt:11!null, nd.tce7a:12, nd.iwv2h:13, nd.hpcms:14!null, nd.n5cc2:15, nd.fhcyt:16, nd.etaq7:17, nd.a75x7:18, bs.id:0!null, bs.T4IBQ:1!null, fc.id:40!null, fc.gxlub:41!null, fc.luevy:42!null, fc.xqdyt:43!null, fc.amyxq:44!null, fc.oztqf:45!null, fc.z35gy:46!null, fc.kkgn5:47, f26zw.T4IBQ:48!null, f26zw.brqp2:49!null, f26zw.Z7CP5:50!null, f26zw.YHYLK:51, nma.id:52!null, nma.dzlim:53!null, nma.f3yue:54, bs.T4IBQ:1!null as T4IBQ, pa.dzlim:26!null as ECUWU, pga.dzlim:38!null as GSTQA, nd.tw55n:5!null as TW55N]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ Eq\n" +
			"                                                     │   ├─ ms.d237e:31!null\n" +
			"                                                     │   └─ true (tinyint)\n" +
			"                                                     └─ LeftOuterHashJoin\n" +
			"                                                         ├─ Eq\n" +
			"                                                         │   ├─ nd.hpcms:14!null\n" +
			"                                                         │   └─ nma.id:52!null\n" +
			"                                                         ├─ LeftOuterHashJoin\n" +
			"                                                         │   ├─ AND\n" +
			"                                                         │   │   ├─ Eq\n" +
			"                                                         │   │   │   ├─ f26zw.T4IBQ:48!null\n" +
			"                                                         │   │   │   └─ bs.T4IBQ:1!null\n" +
			"                                                         │   │   └─ Eq\n" +
			"                                                         │   │       ├─ f26zw.brqp2:49!null\n" +
			"                                                         │   │       └─ nd.id:2!null\n" +
			"                                                         │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   ├─ AND\n" +
			"                                                         │   │   │   ├─ Eq\n" +
			"                                                         │   │   │   │   ├─ bs.id:0!null\n" +
			"                                                         │   │   │   │   └─ fc.gxlub:41!null\n" +
			"                                                         │   │   │   └─ Eq\n" +
			"                                                         │   │   │       ├─ nd.id:2!null\n" +
			"                                                         │   │   │       └─ fc.luevy:42!null\n" +
			"                                                         │   │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   │   ├─ Eq\n" +
			"                                                         │   │   │   │   ├─ ms.gxlub:29!null\n" +
			"                                                         │   │   │   │   └─ bs.id:0!null\n" +
			"                                                         │   │   │   ├─ SubqueryAlias\n" +
			"                                                         │   │   │   │   ├─ name: bs\n" +
			"                                                         │   │   │   │   ├─ outerVisibility: false\n" +
			"                                                         │   │   │   │   ├─ cacheable: true\n" +
			"                                                         │   │   │   │   └─ Filter\n" +
			"                                                         │   │   │   │       ├─ HashIn\n" +
			"                                                         │   │   │   │       │   ├─ T4IBQ:1!null\n" +
			"                                                         │   │   │   │       │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │   │   │   │       └─ Project\n" +
			"                                                         │   │   │   │           ├─ columns: [thnts.id:0!null, T4IBQ:34!null]\n" +
			"                                                         │   │   │   │           └─ Project\n" +
			"                                                         │   │   │   │               ├─ columns: [thnts.id:30!null, thnts.nfryn:31!null, thnts.ixuxu:32, thnts.fhcyt:33, yk2gw.id:0!null, yk2gw.ftqlq:1!null, yk2gw.tuxml:2, yk2gw.paef5:3, yk2gw.rucy4:4, yk2gw.tpnj6:5!null, yk2gw.lbl53:6, yk2gw.nb3qs:7, yk2gw.eo7iv:8, yk2gw.muhjf:9, yk2gw.fm34l:10, yk2gw.ty5rf:11, yk2gw.zhtlh:12, yk2gw.npb7w:13, yk2gw.sx3hh:14, yk2gw.isbnf:15, yk2gw.ya7yb:16, yk2gw.c5ykb:17, yk2gw.qk7kt:18, yk2gw.ffge6:19, yk2gw.fiigj:20, yk2gw.sh3nc:21, yk2gw.ntena:22, yk2gw.m4aub:23, yk2gw.x5air:24, yk2gw.sab6m:25, yk2gw.g5qi5:26, yk2gw.zvqvd:27, yk2gw.ykssu:28, yk2gw.fhcyt:29, yk2gw.ftqlq:1!null as T4IBQ]\n" +
			"                                                         │   │   │   │               └─ MergeJoin\n" +
			"                                                         │   │   │   │                   ├─ cmp: Eq\n" +
			"                                                         │   │   │   │                   │   ├─ yk2gw.id:0!null\n" +
			"                                                         │   │   │   │                   │   └─ thnts.ixuxu:32\n" +
			"                                                         │   │   │   │                   ├─ IndexedTableAccess(YK2GW)\n" +
			"                                                         │   │   │   │                   │   ├─ index: [YK2GW.id]\n" +
			"                                                         │   │   │   │                   │   ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │   │                   │   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                                         │   │   │   │                   └─ IndexedTableAccess(THNTS)\n" +
			"                                                         │   │   │   │                       ├─ index: [THNTS.IXUXU]\n" +
			"                                                         │   │   │   │                       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │   │                       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                                         │   │   │   └─ HashLookup\n" +
			"                                                         │   │   │       ├─ left-key: TUPLE(bs.id:0!null)\n" +
			"                                                         │   │   │       ├─ right-key: TUPLE(ms.gxlub:27!null)\n" +
			"                                                         │   │   │       └─ HashJoin\n" +
			"                                                         │   │   │           ├─ Eq\n" +
			"                                                         │   │   │           │   ├─ pog.id:33!null\n" +
			"                                                         │   │   │           │   └─ gz7z4.gmsga:21!null\n" +
			"                                                         │   │   │           ├─ MergeJoin\n" +
			"                                                         │   │   │           │   ├─ cmp: Eq\n" +
			"                                                         │   │   │           │   │   ├─ nd.id:2!null\n" +
			"                                                         │   │   │           │   │   └─ gz7z4.luevy:20!null\n" +
			"                                                         │   │   │           │   ├─ TableAlias(nd)\n" +
			"                                                         │   │   │           │   │   └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │   │   │           │   │       ├─ index: [E2I7U.id]\n" +
			"                                                         │   │   │           │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │           │   │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │   │   │           │   └─ TableAlias(gz7z4)\n" +
			"                                                         │   │   │           │       └─ IndexedTableAccess(FEIOE)\n" +
			"                                                         │   │   │           │           ├─ index: [FEIOE.LUEVY,FEIOE.GMSGA]\n" +
			"                                                         │   │   │           │           ├─ static: [{[NULL, ∞), [NULL, ∞)}]\n" +
			"                                                         │   │   │           │           └─ columns: [id luevy gmsga fvgd2 yp2cr tq7w3]\n" +
			"                                                         │   │   │           └─ HashLookup\n" +
			"                                                         │   │   │               ├─ left-key: TUPLE(gz7z4.gmsga:21!null)\n" +
			"                                                         │   │   │               ├─ right-key: TUPLE(pog.id:8!null)\n" +
			"                                                         │   │   │               └─ HashJoin\n" +
			"                                                         │   │   │                   ├─ Eq\n" +
			"                                                         │   │   │                   │   ├─ pog.xvsbh:35\n" +
			"                                                         │   │   │                   │   └─ pga.id:37!null\n" +
			"                                                         │   │   │                   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │   │                   │   ├─ Eq\n" +
			"                                                         │   │   │                   │   │   ├─ pa.id:25!null\n" +
			"                                                         │   │   │                   │   │   └─ pog.ch3fr:34!null\n" +
			"                                                         │   │   │                   │   ├─ MergeJoin\n" +
			"                                                         │   │   │                   │   │   ├─ cmp: Eq\n" +
			"                                                         │   │   │                   │   │   │   ├─ pa.id:25!null\n" +
			"                                                         │   │   │                   │   │   │   └─ ms.ch3fr:30!null\n" +
			"                                                         │   │   │                   │   │   ├─ TableAlias(pa)\n" +
			"                                                         │   │   │                   │   │   │   └─ IndexedTableAccess(XOAOP)\n" +
			"                                                         │   │   │                   │   │   │       ├─ index: [XOAOP.id]\n" +
			"                                                         │   │   │                   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │                   │   │   │       └─ columns: [id dzlim f3yue]\n" +
			"                                                         │   │   │                   │   │   └─ TableAlias(ms)\n" +
			"                                                         │   │   │                   │   │       └─ IndexedTableAccess(SZQWJ)\n" +
			"                                                         │   │   │                   │   │           ├─ index: [SZQWJ.CH3FR]\n" +
			"                                                         │   │   │                   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │   │                   │   │           └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"                                                         │   │   │                   │   └─ HashLookup\n" +
			"                                                         │   │   │                   │       ├─ left-key: TUPLE(pa.id:25!null)\n" +
			"                                                         │   │   │                   │       ├─ right-key: TUPLE(pog.ch3fr:1!null)\n" +
			"                                                         │   │   │                   │       └─ TableAlias(pog)\n" +
			"                                                         │   │   │                   │           └─ Table\n" +
			"                                                         │   │   │                   │               ├─ name: NPCYY\n" +
			"                                                         │   │   │                   │               └─ columns: [id ch3fr xvsbh b5ouf]\n" +
			"                                                         │   │   │                   └─ HashLookup\n" +
			"                                                         │   │   │                       ├─ left-key: TUPLE(pog.xvsbh:35)\n" +
			"                                                         │   │   │                       ├─ right-key: TUPLE(pga.id:0!null)\n" +
			"                                                         │   │   │                       └─ TableAlias(pga)\n" +
			"                                                         │   │   │                           └─ Table\n" +
			"                                                         │   │   │                               ├─ name: PG27A\n" +
			"                                                         │   │   │                               └─ columns: [id dzlim f3yue]\n" +
			"                                                         │   │   └─ HashLookup\n" +
			"                                                         │   │       ├─ left-key: TUPLE(bs.id:0!null, nd.id:2!null)\n" +
			"                                                         │   │       ├─ right-key: TUPLE(fc.gxlub:1!null, fc.luevy:2!null)\n" +
			"                                                         │   │       └─ TableAlias(fc)\n" +
			"                                                         │   │           └─ Table\n" +
			"                                                         │   │               ├─ name: AMYXQ\n" +
			"                                                         │   │               └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                                                         │   └─ HashLookup\n" +
			"                                                         │       ├─ left-key: TUPLE(bs.T4IBQ:1!null, nd.id:2!null)\n" +
			"                                                         │       ├─ right-key: TUPLE(f26zw.T4IBQ:0!null, f26zw.brqp2:1!null)\n" +
			"                                                         │       └─ SubqueryAlias\n" +
			"                                                         │           ├─ name: f26zw\n" +
			"                                                         │           ├─ outerVisibility: false\n" +
			"                                                         │           ├─ cacheable: true\n" +
			"                                                         │           └─ Project\n" +
			"                                                         │               ├─ columns: [iq.T4IBQ:0!null, iq.brqp2:1!null, iq.Z7CP5:2!null, YHYLK:14]\n" +
			"                                                         │               └─ Project\n" +
			"                                                         │                   ├─ columns: [iq.T4IBQ:0!null, iq.brqp2:1!null, iq.Z7CP5:2!null, iq.fsdy2:3!null, iq.IDWIO:4!null, w2mao.id:5!null, w2mao.z7cp5:6!null, w2mao.yh4xb:7!null, vc.id:8!null, vc.twmsr:9!null, vc.qhmge:10, vc.mlnpu:11!null, vc.fi3ga:12!null, vc.znp4p:13!null, CASE  WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ KAOAS (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ OG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ Eq\n" +
			"                                                         │                   │   │       ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │       └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ TSG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ W6W24 (longtext)\n" +
			"                                                         │                   │   THEN 1 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ OG (longtext)\n" +
			"                                                         │                   │   THEN 1 (tinyint) WHEN AND\n" +
			"                                                         │                   │   ├─ AND\n" +
			"                                                         │                   │   │   ├─ IN\n" +
			"                                                         │                   │   │   │   ├─ left: iq.fsdy2:3!null\n" +
			"                                                         │                   │   │   │   └─ right: TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                                                         │                   │   │   └─ NOT\n" +
			"                                                         │                   │   │       └─ Eq\n" +
			"                                                         │                   │   │           ├─ vc.znp4p:13!null\n" +
			"                                                         │                   │   │           └─ L5Q44 (longtext)\n" +
			"                                                         │                   │   └─ Eq\n" +
			"                                                         │                   │       ├─ iq.IDWIO:4!null\n" +
			"                                                         │                   │       └─ TSG (longtext)\n" +
			"                                                         │                   │   THEN 0 (tinyint) ELSE NULL (null) END as YHYLK]\n" +
			"                                                         │                   └─ LeftOuterHashJoin\n" +
			"                                                         │                       ├─ Eq\n" +
			"                                                         │                       │   ├─ w2mao.yh4xb:7!null\n" +
			"                                                         │                       │   └─ vc.id:8!null\n" +
			"                                                         │                       ├─ LeftOuterHashJoin\n" +
			"                                                         │                       │   ├─ Eq\n" +
			"                                                         │                       │   │   ├─ iq.Z7CP5:2!null\n" +
			"                                                         │                       │   │   └─ w2mao.z7cp5:6!null\n" +
			"                                                         │                       │   ├─ SubqueryAlias\n" +
			"                                                         │                       │   │   ├─ name: iq\n" +
			"                                                         │                       │   │   ├─ outerVisibility: false\n" +
			"                                                         │                       │   │   ├─ cacheable: true\n" +
			"                                                         │                       │   │   └─ Project\n" +
			"                                                         │                       │   │       ├─ columns: [T4IBQ:81!null, sn.brqp2:72!null, Z7CP5:82!null, mf.fsdy2:10!null, IDWIO:83!null]\n" +
			"                                                         │                       │   │       └─ Project\n" +
			"                                                         │                       │   │           ├─ columns: [mf.id:4!null, mf.gxlub:5!null, mf.luevy:6!null, mf.m22qn:7!null, mf.tjpt7:8!null, mf.arn5p:9!null, mf.xosd4:10!null, mf.ide43:11, mf.hmw4h:12, mf.zbt6r:13, mf.fsdy2:14!null, mf.lt7k6:15, mf.sppyd:16, mf.qcgts:17, mf.teuja:18, mf.qqv4m:19, mf.fhcyt:20, bs.id:0!null, bs.nfryn:1!null, bs.ixuxu:2, bs.fhcyt:3, cla.id:21!null, cla.ftqlq:22!null, cla.tuxml:23, cla.paef5:24, cla.rucy4:25, cla.tpnj6:26!null, cla.lbl53:27, cla.nb3qs:28, cla.eo7iv:29, cla.muhjf:30, cla.fm34l:31, cla.ty5rf:32, cla.zhtlh:33, cla.npb7w:34, cla.sx3hh:35, cla.isbnf:36, cla.ya7yb:37, cla.c5ykb:38, cla.qk7kt:39, cla.ffge6:40, cla.fiigj:41, cla.sh3nc:42, cla.ntena:43, cla.m4aub:44, cla.x5air:45, cla.sab6m:46, cla.g5qi5:47, cla.zvqvd:48, cla.ykssu:49, cla.fhcyt:50, nd.id:64!null, nd.dkcaj:65!null, nd.kng7t:66, nd.tw55n:67!null, nd.qrqxw:68!null, nd.ecxaj:69!null, nd.fgg57:70, nd.zh72s:71, nd.fsk67:72!null, nd.xqdyt:73!null, nd.tce7a:74, nd.iwv2h:75, nd.hpcms:76!null, nd.n5cc2:77, nd.fhcyt:78, nd.etaq7:79, nd.a75x7:80, nma.id:61!null, nma.dzlim:62!null, nma.f3yue:63, sn.id:51!null, sn.brqp2:52!null, sn.fftbj:53!null, sn.a7xo2:54, sn.kbo7r:55!null, sn.ecdkm:56, sn.numk2:57!null, sn.letoe:58!null, sn.ykssu:59, sn.fhcyt:60, cla.ftqlq:22!null as T4IBQ, mf.id:4!null as Z7CP5, nma.dzlim:62!null as IDWIO]\n" +
			"                                                         │                       │   │           └─ Filter\n" +
			"                                                         │                       │   │               ├─ HashIn\n" +
			"                                                         │                       │   │               │   ├─ cla.ftqlq:22!null\n" +
			"                                                         │                       │   │               │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │                       │   │               └─ HashJoin\n" +
			"                                                         │                       │   │                   ├─ AND\n" +
			"                                                         │                       │   │                   │   ├─ Eq\n" +
			"                                                         │                       │   │                   │   │   ├─ mf.luevy:6!null\n" +
			"                                                         │                       │   │                   │   │   └─ nd.id:64!null\n" +
			"                                                         │                       │   │                   │   └─ Eq\n" +
			"                                                         │                       │   │                   │       ├─ mf.luevy:6!null\n" +
			"                                                         │                       │   │                   │       └─ sn.brqp2:52!null\n" +
			"                                                         │                       │   │                   ├─ HashJoin\n" +
			"                                                         │                       │   │                   │   ├─ Eq\n" +
			"                                                         │                       │   │                   │   │   ├─ bs.ixuxu:2\n" +
			"                                                         │                       │   │                   │   │   └─ cla.id:21!null\n" +
			"                                                         │                       │   │                   │   ├─ MergeJoin\n" +
			"                                                         │                       │   │                   │   │   ├─ cmp: Eq\n" +
			"                                                         │                       │   │                   │   │   │   ├─ bs.id:0!null\n" +
			"                                                         │                       │   │                   │   │   │   └─ mf.gxlub:5!null\n" +
			"                                                         │                       │   │                   │   │   ├─ TableAlias(bs)\n" +
			"                                                         │                       │   │                   │   │   │   └─ IndexedTableAccess(THNTS)\n" +
			"                                                         │                       │   │                   │   │   │       ├─ index: [THNTS.id]\n" +
			"                                                         │                       │   │                   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                   │   │   │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                                         │                       │   │                   │   │   └─ TableAlias(mf)\n" +
			"                                                         │                       │   │                   │   │       └─ IndexedTableAccess(HGMQ6)\n" +
			"                                                         │                       │   │                   │   │           ├─ index: [HGMQ6.GXLUB]\n" +
			"                                                         │                       │   │                   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                   │   │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                                                         │                       │   │                   │   └─ HashLookup\n" +
			"                                                         │                       │   │                   │       ├─ left-key: TUPLE(bs.ixuxu:2)\n" +
			"                                                         │                       │   │                   │       ├─ right-key: TUPLE(cla.id:0!null)\n" +
			"                                                         │                       │   │                   │       └─ Filter\n" +
			"                                                         │                       │   │                   │           ├─ HashIn\n" +
			"                                                         │                       │   │                   │           │   ├─ cla.ftqlq:1!null\n" +
			"                                                         │                       │   │                   │           │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                                         │                       │   │                   │           └─ TableAlias(cla)\n" +
			"                                                         │                       │   │                   │               └─ IndexedTableAccess(YK2GW)\n" +
			"                                                         │                       │   │                   │                   ├─ index: [YK2GW.FTQLQ]\n" +
			"                                                         │                       │   │                   │                   ├─ static: [{[SQ1, SQ1]}]\n" +
			"                                                         │                       │   │                   │                   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                                         │                       │   │                   └─ HashLookup\n" +
			"                                                         │                       │   │                       ├─ left-key: TUPLE(mf.luevy:6!null, mf.luevy:6!null)\n" +
			"                                                         │                       │   │                       ├─ right-key: TUPLE(nd.id:13!null, sn.brqp2:1!null)\n" +
			"                                                         │                       │   │                       └─ HashJoin\n" +
			"                                                         │                       │   │                           ├─ Eq\n" +
			"                                                         │                       │   │                           │   ├─ sn.brqp2:52!null\n" +
			"                                                         │                       │   │                           │   └─ nd.id:64!null\n" +
			"                                                         │                       │   │                           ├─ TableAlias(sn)\n" +
			"                                                         │                       │   │                           │   └─ Table\n" +
			"                                                         │                       │   │                           │       ├─ name: NOXN3\n" +
			"                                                         │                       │   │                           │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │                       │   │                           └─ HashLookup\n" +
			"                                                         │                       │   │                               ├─ left-key: TUPLE(sn.brqp2:52!null)\n" +
			"                                                         │                       │   │                               ├─ right-key: TUPLE(nd.id:3!null)\n" +
			"                                                         │                       │   │                               └─ MergeJoin\n" +
			"                                                         │                       │   │                                   ├─ cmp: Eq\n" +
			"                                                         │                       │   │                                   │   ├─ nma.id:61!null\n" +
			"                                                         │                       │   │                                   │   └─ nd.hpcms:76!null\n" +
			"                                                         │                       │   │                                   ├─ TableAlias(nma)\n" +
			"                                                         │                       │   │                                   │   └─ IndexedTableAccess(TNMXI)\n" +
			"                                                         │                       │   │                                   │       ├─ index: [TNMXI.id]\n" +
			"                                                         │                       │   │                                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                                   │       └─ columns: [id dzlim f3yue]\n" +
			"                                                         │                       │   │                                   └─ TableAlias(nd)\n" +
			"                                                         │                       │   │                                       └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │                       │   │                                           ├─ index: [E2I7U.HPCMS]\n" +
			"                                                         │                       │   │                                           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │                       │   │                                           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │                       │   └─ HashLookup\n" +
			"                                                         │                       │       ├─ left-key: TUPLE(iq.Z7CP5:2!null)\n" +
			"                                                         │                       │       ├─ right-key: TUPLE(w2mao.z7cp5:1!null)\n" +
			"                                                         │                       │       └─ TableAlias(w2mao)\n" +
			"                                                         │                       │           └─ Table\n" +
			"                                                         │                       │               ├─ name: SEQS3\n" +
			"                                                         │                       │               └─ columns: [id z7cp5 yh4xb]\n" +
			"                                                         │                       └─ HashLookup\n" +
			"                                                         │                           ├─ left-key: TUPLE(w2mao.yh4xb:7!null)\n" +
			"                                                         │                           ├─ right-key: TUPLE(vc.id:0!null)\n" +
			"                                                         │                           └─ TableAlias(vc)\n" +
			"                                                         │                               └─ Table\n" +
			"                                                         │                                   ├─ name: D34QP\n" +
			"                                                         │                                   └─ columns: [id twmsr qhmge mlnpu fi3ga znp4p]\n" +
			"                                                         └─ HashLookup\n" +
			"                                                             ├─ left-key: TUPLE(nd.hpcms:14!null)\n" +
			"                                                             ├─ right-key: TUPLE(nma.id:0!null)\n" +
			"                                                             └─ TableAlias(nma)\n" +
			"                                                                 └─ Table\n" +
			"                                                                     ├─ name: TNMXI\n" +
			"                                                                     └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   TUSAY.Y3IOU AS RWGEU
	FROM
	   (SELECT
	       id AS Y46B2,
	       WNUNU AS WNUNU,
	       HVHRZ AS HVHRZ
	   FROM
	       QYWQD) XJ2RD
	INNER JOIN
	   (SELECT
	       ROW_NUMBER() OVER (ORDER BY id ASC) Y3IOU,
	       id AS XLFIA
	   FROM
	       NOXN3) TUSAY

	   ON XJ2RD.WNUNU = TUSAY.XLFIA
	ORDER BY Y46B2 ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [RWGEU:5!null]\n" +
			" └─ Sort(xj2rd.Y46B2:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [xj2rd.Y46B2:2!null, xj2rd.WNUNU:3!null, xj2rd.HVHRZ:4!null, tusay.Y3IOU:0!null, tusay.XLFIA:1!null, tusay.Y3IOU:0!null as RWGEU]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xj2rd.WNUNU:3!null\n" +
			"             │   └─ tusay.XLFIA:1!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: tusay\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [Y3IOU:2!null, XLFIA:3!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, row_number() over ( order by noxn3.id asc):0!null as Y3IOU, noxn3.id:1!null as XLFIA]\n" +
			"             │           └─ Window\n" +
			"             │               ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"             │               ├─ noxn3.id:0!null\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: NOXN3\n" +
			"             │                   └─ columns: [id]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(tusay.XLFIA:1!null)\n" +
			"                 ├─ right-key: TUPLE(xj2rd.WNUNU:1!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: xj2rd\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [Y46B2:6!null, WNUNU:7!null, HVHRZ:8!null]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [qywqd.id:0!null, qywqd.wnunu:1!null, qywqd.hhvlx:2!null, qywqd.hvhrz:3!null, qywqd.ykssu:4, qywqd.fhcyt:5, qywqd.id:0!null as Y46B2, qywqd.wnunu:1!null as WNUNU, qywqd.hvhrz:3!null as HVHRZ]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: QYWQD\n" +
			"                                 └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   ECXAJ
	FROM
	   E2I7U
	ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [e2i7u.ecxaj:5!null]\n" +
			" └─ IndexedTableAccess(E2I7U)\n" +
			"     ├─ index: [E2I7U.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   CASE
	       WHEN YZXYP.Z35GY IS NOT NULL THEN YZXYP.Z35GY
	       ELSE -1
	   END AS FMSOH
	   FROM
	   (SELECT
	       nd.T722E,
	       fc.Z35GY
	   FROM
	       (SELECT
	           id AS T722E
	       FROM
	           E2I7U) nd
	       LEFT JOIN
	       (SELECT
	           LUEVY AS ZPAIK,
	           MAX(Z35GY) AS Z35GY
	       FROM AMYXQ
	       GROUP BY LUEVY) fc
	       ON nd.T722E = fc.ZPAIK
	   ORDER BY nd.T722E ASC) YZXYP`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [FMSOH:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [yzxyp.T722E:0!null, yzxyp.Z35GY:1!null, CASE  WHEN NOT\n" +
			"     │   └─ yzxyp.Z35GY:1!null IS NULL\n" +
			"     │   THEN yzxyp.Z35GY:1!null ELSE -1 (tinyint) END as FMSOH]\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: yzxyp\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Project\n" +
			"             ├─ columns: [nd.T722E:0!null, fc.Z35GY:2!null]\n" +
			"             └─ Sort(nd.T722E:0!null ASC nullsFirst)\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [nd.T722E:0!null, fc.ZPAIK:1!null, fc.Z35GY:2!null]\n" +
			"                     └─ LeftOuterHashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ nd.T722E:0!null\n" +
			"                         │   └─ fc.ZPAIK:1!null\n" +
			"                         ├─ SubqueryAlias\n" +
			"                         │   ├─ name: nd\n" +
			"                         │   ├─ outerVisibility: false\n" +
			"                         │   ├─ cacheable: true\n" +
			"                         │   └─ Project\n" +
			"                         │       ├─ columns: [T722E:17!null]\n" +
			"                         │       └─ Project\n" +
			"                         │           ├─ columns: [e2i7u.id:0!null, e2i7u.dkcaj:1!null, e2i7u.kng7t:2, e2i7u.tw55n:3!null, e2i7u.qrqxw:4!null, e2i7u.ecxaj:5!null, e2i7u.fgg57:6, e2i7u.zh72s:7, e2i7u.fsk67:8!null, e2i7u.xqdyt:9!null, e2i7u.tce7a:10, e2i7u.iwv2h:11, e2i7u.hpcms:12!null, e2i7u.n5cc2:13, e2i7u.fhcyt:14, e2i7u.etaq7:15, e2i7u.a75x7:16, e2i7u.id:0!null as T722E]\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: E2I7U\n" +
			"                         │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(nd.T722E:0!null)\n" +
			"                             ├─ right-key: TUPLE(fc.ZPAIK:0!null)\n" +
			"                             └─ SubqueryAlias\n" +
			"                                 ├─ name: fc\n" +
			"                                 ├─ outerVisibility: false\n" +
			"                                 ├─ cacheable: true\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [ZPAIK:2!null, Z35GY:3!null]\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [max(amyxq.z35gy):0!null, amyxq.luevy:1!null, amyxq.luevy:1!null as ZPAIK, max(amyxq.z35gy):0!null as Z35GY]\n" +
			"                                         └─ GroupBy\n" +
			"                                             ├─ select: MAX(amyxq.z35gy:1!null), amyxq.luevy:0!null\n" +
			"                                             ├─ group: amyxq.luevy:0!null\n" +
			"                                             └─ Table\n" +
			"                                                 ├─ name: AMYXQ\n" +
			"                                                 └─ columns: [luevy z35gy]\n" +
			"",
	},
	{
		Query: `
	SELECT
	   CASE
	       WHEN
	           FGG57 IS NULL
	           THEN 0
	       WHEN
	           id IN (SELECT id FROM E2I7U WHERE NOT id IN (SELECT LUEVY FROM AMYXQ))
	           THEN 1
	       WHEN
	           FSK67 = 'z'
	           THEN 2
	       WHEN
	           FSK67 = 'CRZ2X'
	           THEN 0
	       ELSE 3
	   END AS SZ6KK
	   FROM E2I7U
	   ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [SZ6KK:17!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [e2i7u.id:0!null, e2i7u.dkcaj:1!null, e2i7u.kng7t:2, e2i7u.tw55n:3!null, e2i7u.qrqxw:4!null, e2i7u.ecxaj:5!null, e2i7u.fgg57:6, e2i7u.zh72s:7, e2i7u.fsk67:8!null, e2i7u.xqdyt:9!null, e2i7u.tce7a:10, e2i7u.iwv2h:11, e2i7u.hpcms:12!null, e2i7u.n5cc2:13, e2i7u.fhcyt:14, e2i7u.etaq7:15, e2i7u.a75x7:16, CASE  WHEN e2i7u.fgg57:6 IS NULL THEN 0 (tinyint) WHEN InSubquery\n" +
			"     │   ├─ left: e2i7u.id:0!null\n" +
			"     │   └─ right: Subquery\n" +
			"     │       ├─ cacheable: true\n" +
			"     │       └─ Project\n" +
			"     │           ├─ columns: [e2i7u.id:17!null]\n" +
			"     │           └─ Project\n" +
			"     │               ├─ columns: [e2i7u.id:17!null, E2I7U.DKCAJ:18!null, E2I7U.KNG7T:19, E2I7U.TW55N:20!null, E2I7U.QRQXW:21!null, E2I7U.ECXAJ:22!null, E2I7U.FGG57:23, E2I7U.ZH72S:24, E2I7U.FSK67:25!null, E2I7U.XQDYT:26!null, E2I7U.TCE7A:27, E2I7U.IWV2H:28, E2I7U.HPCMS:29!null, E2I7U.N5CC2:30, E2I7U.FHCYT:31, E2I7U.ETAQ7:32, E2I7U.A75X7:33]\n" +
			"     │               └─ Filter\n" +
			"     │                   ├─ scalarSubq0.luevy:34!null IS NULL\n" +
			"     │                   └─ LeftOuterMergeJoin\n" +
			"     │                       ├─ cmp: Eq\n" +
			"     │                       │   ├─ e2i7u.id:17!null\n" +
			"     │                       │   └─ scalarSubq0.luevy:34!null\n" +
			"     │                       ├─ IndexedTableAccess(E2I7U)\n" +
			"     │                       │   ├─ index: [E2I7U.id]\n" +
			"     │                       │   ├─ static: [{[NULL, ∞)}]\n" +
			"     │                       │   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"     │                       └─ Project\n" +
			"     │                           ├─ columns: [scalarSubq0.luevy:19!null]\n" +
			"     │                           └─ TableAlias(scalarSubq0)\n" +
			"     │                               └─ IndexedTableAccess(AMYXQ)\n" +
			"     │                                   ├─ index: [AMYXQ.LUEVY]\n" +
			"     │                                   ├─ static: [{[NULL, ∞)}]\n" +
			"     │                                   └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"     │   THEN 1 (tinyint) WHEN Eq\n" +
			"     │   ├─ e2i7u.fsk67:8!null\n" +
			"     │   └─ z (longtext)\n" +
			"     │   THEN 2 (tinyint) WHEN Eq\n" +
			"     │   ├─ e2i7u.fsk67:8!null\n" +
			"     │   └─ CRZ2X (longtext)\n" +
			"     │   THEN 0 (tinyint) ELSE 3 (tinyint) END as SZ6KK]\n" +
			"     └─ IndexedTableAccess(E2I7U)\n" +
			"         ├─ index: [E2I7U.id]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
	WITH
	   BMRZU AS
	           (SELECT /*+ JOIN_ORDER( cla, bs, mf, sn, aac, W2MAO, vc ) */
	               cla.FTQLQ AS T4IBQ,
	               sn.id AS BDNYB,
	               aac.BTXC5 AS BTXC5,
	               mf.id AS Z7CP5,
	               CASE
	                   WHEN mf.LT7K6 IS NOT NULL THEN mf.LT7K6
	                   ELSE mf.SPPYD
	               END AS vaf,
	               CASE
	                   WHEN mf.QCGTS IS NOT NULL THEN QCGTS
	                   ELSE 0.5
	               END AS QCGTS,
	               CASE
	                   WHEN vc.ZNP4P = 'L5Q44' THEN 1
	                   ELSE 0
	               END AS SNY4H
	           FROM YK2GW cla
	           INNER JOIN THNTS bs ON bs.IXUXU = cla.id
	           INNER JOIN HGMQ6 mf ON mf.GXLUB = bs.id
	           INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	           INNER JOIN TPXBU aac ON aac.id = mf.M22QN
	           INNER JOIN SEQS3 W2MAO ON W2MAO.Z7CP5 = mf.id
	           INNER JOIN D34QP vc ON vc.id = W2MAO.YH4XB
	           WHERE cla.FTQLQ IN ('SQ1')
	AND mf.FSDY2 IN ('SRARY', 'UBQWG')),
	   YU7NY AS
	           (SELECT
	               nd.TW55N AS KUXQY,
	               sn.id AS BDNYB,
	               nma.DZLIM AS YHVEZ,
	               CASE
	                   WHEN nd.TCE7A < 0.9 THEN 1
	                   ELSE 0
	               END AS YAZ4X
	           FROM NOXN3 sn
	           LEFT JOIN E2I7U nd ON sn.BRQP2 = nd.id
	           LEFT JOIN TNMXI nma ON nd.HPCMS = nma.id
	           WHERE nma.DZLIM != 'Q5I4E'
	           ORDER BY sn.id ASC)
	SELECT DISTINCT
	   OXXEI.T4IBQ,
	   OXXEI.Z7CP5,
	   E52AP.KUXQY,
	   OXXEI.BDNYB,
	   CKELE.M6T2N,
	   OXXEI.BTXC5 as BTXC5,
	   OXXEI.vaf as vaf,
	   OXXEI.QCGTS as QCGTS,
	   OXXEI.SNY4H as SNY4H,
	   E52AP.YHVEZ as YHVEZ,
	   E52AP.YAZ4X as YAZ4X
	FROM
	   BMRZU OXXEI
	INNER JOIN YU7NY E52AP ON E52AP.BDNYB = OXXEI.BDNYB
	INNER JOIN
	   (SELECT
	       NOXN3.id as LWQ6O,
	       ROW_NUMBER() OVER (ORDER BY NOXN3.id ASC) M6T2N
	   FROM NOXN3) CKELE
	ON CKELE.LWQ6O = OXXEI.BDNYB
	ORDER BY CKELE.M6T2N ASC`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [oxxei.T4IBQ:0!null, oxxei.Z7CP5:3!null, e52ap.KUXQY:7!null, oxxei.BDNYB:1!null, ckele.M6T2N:12!null, BTXC5:13, vaf:14, QCGTS:15, SNY4H:16!null, YHVEZ:17!null, YAZ4X:18!null]\n" +
			"     └─ Sort(ckele.M6T2N:12!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [oxxei.T4IBQ:2!null, oxxei.BDNYB:3!null, oxxei.BTXC5:4, oxxei.Z7CP5:5!null, oxxei.vaf:6, oxxei.QCGTS:7, oxxei.SNY4H:8!null, e52ap.KUXQY:9!null, e52ap.BDNYB:10!null, e52ap.YHVEZ:11!null, e52ap.YAZ4X:12!null, ckele.LWQ6O:0!null, ckele.M6T2N:1!null, oxxei.BTXC5:4 as BTXC5, oxxei.vaf:6 as vaf, oxxei.QCGTS:7 as QCGTS, oxxei.SNY4H:8!null as SNY4H, e52ap.YHVEZ:11!null as YHVEZ, e52ap.YAZ4X:12!null as YAZ4X]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ e52ap.BDNYB:10!null\n" +
			"                 │   │   └─ oxxei.BDNYB:3!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ e52ap.BDNYB:10!null\n" +
			"                 │       └─ ckele.LWQ6O:0!null\n" +
			"                 ├─ HashJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ckele.LWQ6O:0!null\n" +
			"                 │   │   └─ oxxei.BDNYB:3!null\n" +
			"                 │   ├─ SubqueryAlias\n" +
			"                 │   │   ├─ name: ckele\n" +
			"                 │   │   ├─ outerVisibility: false\n" +
			"                 │   │   ├─ cacheable: true\n" +
			"                 │   │   └─ Project\n" +
			"                 │   │       ├─ columns: [LWQ6O:2!null, M6T2N:3!null]\n" +
			"                 │   │       └─ Project\n" +
			"                 │   │           ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, noxn3.id:1!null as LWQ6O, row_number() over ( order by noxn3.id asc):0!null as M6T2N]\n" +
			"                 │   │           └─ Window\n" +
			"                 │   │               ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                 │   │               ├─ noxn3.id:0!null\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: NOXN3\n" +
			"                 │   │                   └─ columns: [id]\n" +
			"                 │   └─ HashLookup\n" +
			"                 │       ├─ left-key: TUPLE(ckele.LWQ6O:0!null)\n" +
			"                 │       ├─ right-key: TUPLE(oxxei.BDNYB:1!null)\n" +
			"                 │       └─ SubqueryAlias\n" +
			"                 │           ├─ name: oxxei\n" +
			"                 │           ├─ outerVisibility: false\n" +
			"                 │           ├─ cacheable: true\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [T4IBQ:73!null, BDNYB:74!null, BTXC5:75, Z7CP5:76!null, vaf:77, QCGTS:78, SNY4H:79!null]\n" +
			"                 │               └─ Project\n" +
			"                 │                   ├─ columns: [cla.id:0!null, cla.ftqlq:1!null, cla.tuxml:2, cla.paef5:3, cla.rucy4:4, cla.tpnj6:5!null, cla.lbl53:6, cla.nb3qs:7, cla.eo7iv:8, cla.muhjf:9, cla.fm34l:10, cla.ty5rf:11, cla.zhtlh:12, cla.npb7w:13, cla.sx3hh:14, cla.isbnf:15, cla.ya7yb:16, cla.c5ykb:17, cla.qk7kt:18, cla.ffge6:19, cla.fiigj:20, cla.sh3nc:21, cla.ntena:22, cla.m4aub:23, cla.x5air:24, cla.sab6m:25, cla.g5qi5:26, cla.zvqvd:27, cla.ykssu:28, cla.fhcyt:29, bs.id:30!null, bs.nfryn:31!null, bs.ixuxu:32, bs.fhcyt:33, mf.id:34!null, mf.gxlub:35!null, mf.luevy:36!null, mf.m22qn:37!null, mf.tjpt7:38!null, mf.arn5p:39!null, mf.xosd4:40!null, mf.ide43:41, mf.hmw4h:42, mf.zbt6r:43, mf.fsdy2:44!null, mf.lt7k6:45, mf.sppyd:46, mf.qcgts:47, mf.teuja:48, mf.qqv4m:49, mf.fhcyt:50, sn.id:51!null, sn.brqp2:52!null, sn.fftbj:53!null, sn.a7xo2:54, sn.kbo7r:55!null, sn.ecdkm:56, sn.numk2:57!null, sn.letoe:58!null, sn.ykssu:59, sn.fhcyt:60, aac.id:61!null, aac.btxc5:62, aac.fhcyt:63, w2mao.id:64!null, w2mao.z7cp5:65!null, w2mao.yh4xb:66!null, vc.id:67!null, vc.twmsr:68!null, vc.qhmge:69, vc.mlnpu:70!null, vc.fi3ga:71!null, vc.znp4p:72!null, cla.ftqlq:1!null as T4IBQ, sn.id:51!null as BDNYB, aac.btxc5:62 as BTXC5, mf.id:34!null as Z7CP5, CASE  WHEN NOT\n" +
			"                 │                   │   └─ mf.lt7k6:45 IS NULL\n" +
			"                 │                   │   THEN mf.lt7k6:45 ELSE mf.sppyd:46 END as vaf, CASE  WHEN NOT\n" +
			"                 │                   │   └─ mf.qcgts:47 IS NULL\n" +
			"                 │                   │   THEN mf.qcgts:47 ELSE 0.500000 (double) END as QCGTS, CASE  WHEN Eq\n" +
			"                 │                   │   ├─ vc.znp4p:72!null\n" +
			"                 │                   │   └─ L5Q44 (longtext)\n" +
			"                 │                   │   THEN 1 (tinyint) ELSE 0 (tinyint) END as SNY4H]\n" +
			"                 │                   └─ Filter\n" +
			"                 │                       ├─ HashIn\n" +
			"                 │                       │   ├─ mf.fsdy2:44!null\n" +
			"                 │                       │   └─ TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                 │                       └─ HashJoin\n" +
			"                 │                           ├─ Eq\n" +
			"                 │                           │   ├─ w2mao.z7cp5:65!null\n" +
			"                 │                           │   └─ mf.id:34!null\n" +
			"                 │                           ├─ HashJoin\n" +
			"                 │                           │   ├─ Eq\n" +
			"                 │                           │   │   ├─ aac.id:61!null\n" +
			"                 │                           │   │   └─ mf.m22qn:37!null\n" +
			"                 │                           │   ├─ HashJoin\n" +
			"                 │                           │   │   ├─ Eq\n" +
			"                 │                           │   │   │   ├─ sn.brqp2:52!null\n" +
			"                 │                           │   │   │   └─ mf.luevy:36!null\n" +
			"                 │                           │   │   ├─ HashJoin\n" +
			"                 │                           │   │   │   ├─ Eq\n" +
			"                 │                           │   │   │   │   ├─ mf.gxlub:35!null\n" +
			"                 │                           │   │   │   │   └─ bs.id:30!null\n" +
			"                 │                           │   │   │   ├─ MergeJoin\n" +
			"                 │                           │   │   │   │   ├─ cmp: Eq\n" +
			"                 │                           │   │   │   │   │   ├─ cla.id:0!null\n" +
			"                 │                           │   │   │   │   │   └─ bs.ixuxu:32\n" +
			"                 │                           │   │   │   │   ├─ Filter\n" +
			"                 │                           │   │   │   │   │   ├─ HashIn\n" +
			"                 │                           │   │   │   │   │   │   ├─ cla.ftqlq:1!null\n" +
			"                 │                           │   │   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                 │                           │   │   │   │   │   └─ TableAlias(cla)\n" +
			"                 │                           │   │   │   │   │       └─ IndexedTableAccess(YK2GW)\n" +
			"                 │                           │   │   │   │   │           ├─ index: [YK2GW.id]\n" +
			"                 │                           │   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │   │   │   │   │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                 │                           │   │   │   │   └─ TableAlias(bs)\n" +
			"                 │                           │   │   │   │       └─ IndexedTableAccess(THNTS)\n" +
			"                 │                           │   │   │   │           ├─ index: [THNTS.IXUXU]\n" +
			"                 │                           │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │   │   │   │           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                 │                           │   │   │   └─ HashLookup\n" +
			"                 │                           │   │   │       ├─ left-key: TUPLE(bs.id:30!null)\n" +
			"                 │                           │   │   │       ├─ right-key: TUPLE(mf.gxlub:1!null)\n" +
			"                 │                           │   │   │       └─ Filter\n" +
			"                 │                           │   │   │           ├─ HashIn\n" +
			"                 │                           │   │   │           │   ├─ mf.fsdy2:10!null\n" +
			"                 │                           │   │   │           │   └─ TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                 │                           │   │   │           └─ TableAlias(mf)\n" +
			"                 │                           │   │   │               └─ Table\n" +
			"                 │                           │   │   │                   ├─ name: HGMQ6\n" +
			"                 │                           │   │   │                   └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                 │                           │   │   └─ HashLookup\n" +
			"                 │                           │   │       ├─ left-key: TUPLE(mf.luevy:36!null)\n" +
			"                 │                           │   │       ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"                 │                           │   │       └─ TableAlias(sn)\n" +
			"                 │                           │   │           └─ Table\n" +
			"                 │                           │   │               ├─ name: NOXN3\n" +
			"                 │                           │   │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                 │                           │   └─ HashLookup\n" +
			"                 │                           │       ├─ left-key: TUPLE(mf.m22qn:37!null)\n" +
			"                 │                           │       ├─ right-key: TUPLE(aac.id:0!null)\n" +
			"                 │                           │       └─ TableAlias(aac)\n" +
			"                 │                           │           └─ Table\n" +
			"                 │                           │               ├─ name: TPXBU\n" +
			"                 │                           │               └─ columns: [id btxc5 fhcyt]\n" +
			"                 │                           └─ HashLookup\n" +
			"                 │                               ├─ left-key: TUPLE(mf.id:34!null)\n" +
			"                 │                               ├─ right-key: TUPLE(w2mao.z7cp5:1!null)\n" +
			"                 │                               └─ MergeJoin\n" +
			"                 │                                   ├─ cmp: Eq\n" +
			"                 │                                   │   ├─ w2mao.yh4xb:66!null\n" +
			"                 │                                   │   └─ vc.id:67!null\n" +
			"                 │                                   ├─ TableAlias(w2mao)\n" +
			"                 │                                   │   └─ IndexedTableAccess(SEQS3)\n" +
			"                 │                                   │       ├─ index: [SEQS3.YH4XB]\n" +
			"                 │                                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                                   │       └─ columns: [id z7cp5 yh4xb]\n" +
			"                 │                                   └─ TableAlias(vc)\n" +
			"                 │                                       └─ IndexedTableAccess(D34QP)\n" +
			"                 │                                           ├─ index: [D34QP.id]\n" +
			"                 │                                           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                                           └─ columns: [id twmsr qhmge mlnpu fi3ga znp4p]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(oxxei.BDNYB:3!null, ckele.LWQ6O:0!null)\n" +
			"                     ├─ right-key: TUPLE(e52ap.BDNYB:1!null, e52ap.BDNYB:1!null)\n" +
			"                     └─ SubqueryAlias\n" +
			"                         ├─ name: e52ap\n" +
			"                         ├─ outerVisibility: false\n" +
			"                         ├─ cacheable: true\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [KUXQY:30!null, BDNYB:31!null, YHVEZ:32!null, YAZ4X:33!null]\n" +
			"                             └─ Sort(sn.id:0!null ASC nullsFirst)\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, nd.id:10!null, nd.dkcaj:11!null, nd.kng7t:12, nd.tw55n:13!null, nd.qrqxw:14!null, nd.ecxaj:15!null, nd.fgg57:16, nd.zh72s:17, nd.fsk67:18!null, nd.xqdyt:19!null, nd.tce7a:20, nd.iwv2h:21, nd.hpcms:22!null, nd.n5cc2:23, nd.fhcyt:24, nd.etaq7:25, nd.a75x7:26, nma.id:27!null, nma.dzlim:28!null, nma.f3yue:29, nd.tw55n:13!null as KUXQY, sn.id:0!null as BDNYB, nma.dzlim:28!null as YHVEZ, CASE  WHEN LessThan\n" +
			"                                     │   ├─ nd.tce7a:20\n" +
			"                                     │   └─ 0.900000 (double)\n" +
			"                                     │   THEN 1 (tinyint) ELSE 0 (tinyint) END as YAZ4X]\n" +
			"                                     └─ Filter\n" +
			"                                         ├─ NOT\n" +
			"                                         │   └─ Eq\n" +
			"                                         │       ├─ nma.dzlim:28!null\n" +
			"                                         │       └─ Q5I4E (longtext)\n" +
			"                                         └─ LeftOuterHashJoin\n" +
			"                                             ├─ Eq\n" +
			"                                             │   ├─ nd.hpcms:22!null\n" +
			"                                             │   └─ nma.id:27!null\n" +
			"                                             ├─ LeftOuterMergeJoin\n" +
			"                                             │   ├─ cmp: Eq\n" +
			"                                             │   │   ├─ sn.brqp2:1!null\n" +
			"                                             │   │   └─ nd.id:10!null\n" +
			"                                             │   ├─ TableAlias(sn)\n" +
			"                                             │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"                                             │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"                                             │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                             │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                             │   └─ TableAlias(nd)\n" +
			"                                             │       └─ IndexedTableAccess(E2I7U)\n" +
			"                                             │           ├─ index: [E2I7U.id]\n" +
			"                                             │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                             └─ HashLookup\n" +
			"                                                 ├─ left-key: TUPLE(nd.hpcms:22!null)\n" +
			"                                                 ├─ right-key: TUPLE(nma.id:0!null)\n" +
			"                                                 └─ TableAlias(nma)\n" +
			"                                                     └─ Table\n" +
			"                                                         ├─ name: TNMXI\n" +
			"                                                         └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
	WITH
	   BMRZU AS
	           (SELECT
	               cla.FTQLQ AS T4IBQ,
	               sn.id AS BDNYB,
	               aac.BTXC5 AS BTXC5,
	               mf.id AS Z7CP5,
	               CASE
	                   WHEN mf.LT7K6 IS NOT NULL THEN mf.LT7K6
	                   ELSE mf.SPPYD
	               END AS vaf,
	               CASE
	                   WHEN mf.QCGTS IS NOT NULL THEN QCGTS
	                   ELSE 0.5
	               END AS QCGTS,
	               CASE
	                   WHEN vc.ZNP4P = 'L5Q44' THEN 1
	                   ELSE 0
	               END AS SNY4H
	           FROM YK2GW cla
	           INNER JOIN THNTS bs ON bs.IXUXU = cla.id
	           INNER JOIN HGMQ6 mf ON mf.GXLUB = bs.id
	           INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
	           INNER JOIN TPXBU aac ON aac.id = mf.M22QN
	           INNER JOIN SEQS3 W2MAO ON W2MAO.Z7CP5 = mf.id
	           INNER JOIN D34QP vc ON vc.id = W2MAO.YH4XB
	           WHERE cla.FTQLQ IN ('SQ1')
	AND mf.FSDY2 IN ('SRARY', 'UBQWG')),
	   YU7NY AS
	           (SELECT
	               nd.TW55N AS KUXQY,
	               sn.id AS BDNYB,
	               nma.DZLIM AS YHVEZ,
	               CASE
	                   WHEN nd.TCE7A < 0.9 THEN 1
	                   ELSE 0
	               END AS YAZ4X
	           FROM NOXN3 sn
	           LEFT JOIN E2I7U nd ON sn.BRQP2 = nd.id
	           LEFT JOIN TNMXI nma ON nd.HPCMS = nma.id
	           WHERE nma.DZLIM != 'Q5I4E'
	           ORDER BY sn.id ASC)
	SELECT DISTINCT
	   OXXEI.T4IBQ,
	   OXXEI.Z7CP5,
	   E52AP.KUXQY,
	   OXXEI.BDNYB,
	   CKELE.M6T2N,
	   OXXEI.BTXC5 as BTXC5,
	   OXXEI.vaf as vaf,
	   OXXEI.QCGTS as QCGTS,
	   OXXEI.SNY4H as SNY4H,
	   E52AP.YHVEZ as YHVEZ,
	   E52AP.YAZ4X as YAZ4X
	FROM
	   BMRZU OXXEI
	INNER JOIN YU7NY E52AP ON E52AP.BDNYB = OXXEI.BDNYB
	INNER JOIN
	   (SELECT
	       NOXN3.id as LWQ6O,
	       ROW_NUMBER() OVER (ORDER BY NOXN3.id ASC) M6T2N
	   FROM NOXN3) CKELE
	ON CKELE.LWQ6O = OXXEI.BDNYB
	ORDER BY CKELE.M6T2N ASC`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [oxxei.T4IBQ:0!null, oxxei.Z7CP5:3!null, e52ap.KUXQY:7!null, oxxei.BDNYB:1!null, ckele.M6T2N:12!null, BTXC5:13, vaf:14, QCGTS:15, SNY4H:16!null, YHVEZ:17!null, YAZ4X:18!null]\n" +
			"     └─ Sort(ckele.M6T2N:12!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [oxxei.T4IBQ:2!null, oxxei.BDNYB:3!null, oxxei.BTXC5:4, oxxei.Z7CP5:5!null, oxxei.vaf:6, oxxei.QCGTS:7, oxxei.SNY4H:8!null, e52ap.KUXQY:9!null, e52ap.BDNYB:10!null, e52ap.YHVEZ:11!null, e52ap.YAZ4X:12!null, ckele.LWQ6O:0!null, ckele.M6T2N:1!null, oxxei.BTXC5:4 as BTXC5, oxxei.vaf:6 as vaf, oxxei.QCGTS:7 as QCGTS, oxxei.SNY4H:8!null as SNY4H, e52ap.YHVEZ:11!null as YHVEZ, e52ap.YAZ4X:12!null as YAZ4X]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ e52ap.BDNYB:10!null\n" +
			"                 │   │   └─ oxxei.BDNYB:3!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ e52ap.BDNYB:10!null\n" +
			"                 │       └─ ckele.LWQ6O:0!null\n" +
			"                 ├─ HashJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ckele.LWQ6O:0!null\n" +
			"                 │   │   └─ oxxei.BDNYB:3!null\n" +
			"                 │   ├─ SubqueryAlias\n" +
			"                 │   │   ├─ name: ckele\n" +
			"                 │   │   ├─ outerVisibility: false\n" +
			"                 │   │   ├─ cacheable: true\n" +
			"                 │   │   └─ Project\n" +
			"                 │   │       ├─ columns: [LWQ6O:2!null, M6T2N:3!null]\n" +
			"                 │   │       └─ Project\n" +
			"                 │   │           ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, noxn3.id:1!null as LWQ6O, row_number() over ( order by noxn3.id asc):0!null as M6T2N]\n" +
			"                 │   │           └─ Window\n" +
			"                 │   │               ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                 │   │               ├─ noxn3.id:0!null\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: NOXN3\n" +
			"                 │   │                   └─ columns: [id]\n" +
			"                 │   └─ HashLookup\n" +
			"                 │       ├─ left-key: TUPLE(ckele.LWQ6O:0!null)\n" +
			"                 │       ├─ right-key: TUPLE(oxxei.BDNYB:1!null)\n" +
			"                 │       └─ SubqueryAlias\n" +
			"                 │           ├─ name: oxxei\n" +
			"                 │           ├─ outerVisibility: false\n" +
			"                 │           ├─ cacheable: true\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [T4IBQ:73!null, BDNYB:74!null, BTXC5:75, Z7CP5:76!null, vaf:77, QCGTS:78, SNY4H:79!null]\n" +
			"                 │               └─ Project\n" +
			"                 │                   ├─ columns: [cla.id:30!null, cla.ftqlq:31!null, cla.tuxml:32, cla.paef5:33, cla.rucy4:34, cla.tpnj6:35!null, cla.lbl53:36, cla.nb3qs:37, cla.eo7iv:38, cla.muhjf:39, cla.fm34l:40, cla.ty5rf:41, cla.zhtlh:42, cla.npb7w:43, cla.sx3hh:44, cla.isbnf:45, cla.ya7yb:46, cla.c5ykb:47, cla.qk7kt:48, cla.ffge6:49, cla.fiigj:50, cla.sh3nc:51, cla.ntena:52, cla.m4aub:53, cla.x5air:54, cla.sab6m:55, cla.g5qi5:56, cla.zvqvd:57, cla.ykssu:58, cla.fhcyt:59, bs.id:60!null, bs.nfryn:61!null, bs.ixuxu:62, bs.fhcyt:63, mf.id:10!null, mf.gxlub:11!null, mf.luevy:12!null, mf.m22qn:13!null, mf.tjpt7:14!null, mf.arn5p:15!null, mf.xosd4:16!null, mf.ide43:17, mf.hmw4h:18, mf.zbt6r:19, mf.fsdy2:20!null, mf.lt7k6:21, mf.sppyd:22, mf.qcgts:23, mf.teuja:24, mf.qqv4m:25, mf.fhcyt:26, sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, aac.id:27!null, aac.btxc5:28, aac.fhcyt:29, w2mao.id:70!null, w2mao.z7cp5:71!null, w2mao.yh4xb:72!null, vc.id:64!null, vc.twmsr:65!null, vc.qhmge:66, vc.mlnpu:67!null, vc.fi3ga:68!null, vc.znp4p:69!null, cla.ftqlq:31!null as T4IBQ, sn.id:0!null as BDNYB, aac.btxc5:28 as BTXC5, mf.id:10!null as Z7CP5, CASE  WHEN NOT\n" +
			"                 │                   │   └─ mf.lt7k6:21 IS NULL\n" +
			"                 │                   │   THEN mf.lt7k6:21 ELSE mf.sppyd:22 END as vaf, CASE  WHEN NOT\n" +
			"                 │                   │   └─ mf.qcgts:23 IS NULL\n" +
			"                 │                   │   THEN mf.qcgts:23 ELSE 0.500000 (double) END as QCGTS, CASE  WHEN Eq\n" +
			"                 │                   │   ├─ vc.znp4p:69!null\n" +
			"                 │                   │   └─ L5Q44 (longtext)\n" +
			"                 │                   │   THEN 1 (tinyint) ELSE 0 (tinyint) END as SNY4H]\n" +
			"                 │                   └─ Filter\n" +
			"                 │                       ├─ HashIn\n" +
			"                 │                       │   ├─ mf.fsdy2:20!null\n" +
			"                 │                       │   └─ TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                 │                       └─ HashJoin\n" +
			"                 │                           ├─ Eq\n" +
			"                 │                           │   ├─ w2mao.z7cp5:71!null\n" +
			"                 │                           │   └─ mf.id:10!null\n" +
			"                 │                           ├─ HashJoin\n" +
			"                 │                           │   ├─ Eq\n" +
			"                 │                           │   │   ├─ mf.gxlub:11!null\n" +
			"                 │                           │   │   └─ bs.id:60!null\n" +
			"                 │                           │   ├─ HashJoin\n" +
			"                 │                           │   │   ├─ Eq\n" +
			"                 │                           │   │   │   ├─ aac.id:27!null\n" +
			"                 │                           │   │   │   └─ mf.m22qn:13!null\n" +
			"                 │                           │   │   ├─ MergeJoin\n" +
			"                 │                           │   │   │   ├─ cmp: Eq\n" +
			"                 │                           │   │   │   │   ├─ sn.brqp2:1!null\n" +
			"                 │                           │   │   │   │   └─ mf.luevy:12!null\n" +
			"                 │                           │   │   │   ├─ TableAlias(sn)\n" +
			"                 │                           │   │   │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"                 │                           │   │   │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"                 │                           │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │   │   │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                 │                           │   │   │   └─ Filter\n" +
			"                 │                           │   │   │       ├─ HashIn\n" +
			"                 │                           │   │   │       │   ├─ mf.fsdy2:10!null\n" +
			"                 │                           │   │   │       │   └─ TUPLE(SRARY (longtext), UBQWG (longtext))\n" +
			"                 │                           │   │   │       └─ TableAlias(mf)\n" +
			"                 │                           │   │   │           └─ IndexedTableAccess(HGMQ6)\n" +
			"                 │                           │   │   │               ├─ index: [HGMQ6.LUEVY]\n" +
			"                 │                           │   │   │               ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │   │   │               └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                 │                           │   │   └─ HashLookup\n" +
			"                 │                           │   │       ├─ left-key: TUPLE(mf.m22qn:13!null)\n" +
			"                 │                           │   │       ├─ right-key: TUPLE(aac.id:0!null)\n" +
			"                 │                           │   │       └─ TableAlias(aac)\n" +
			"                 │                           │   │           └─ Table\n" +
			"                 │                           │   │               ├─ name: TPXBU\n" +
			"                 │                           │   │               └─ columns: [id btxc5 fhcyt]\n" +
			"                 │                           │   └─ HashLookup\n" +
			"                 │                           │       ├─ left-key: TUPLE(mf.gxlub:11!null)\n" +
			"                 │                           │       ├─ right-key: TUPLE(bs.id:30!null)\n" +
			"                 │                           │       └─ MergeJoin\n" +
			"                 │                           │           ├─ cmp: Eq\n" +
			"                 │                           │           │   ├─ cla.id:30!null\n" +
			"                 │                           │           │   └─ bs.ixuxu:62\n" +
			"                 │                           │           ├─ Filter\n" +
			"                 │                           │           │   ├─ HashIn\n" +
			"                 │                           │           │   │   ├─ cla.ftqlq:1!null\n" +
			"                 │                           │           │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                 │                           │           │   └─ TableAlias(cla)\n" +
			"                 │                           │           │       └─ IndexedTableAccess(YK2GW)\n" +
			"                 │                           │           │           ├─ index: [YK2GW.id]\n" +
			"                 │                           │           │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │           │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                 │                           │           └─ TableAlias(bs)\n" +
			"                 │                           │               └─ IndexedTableAccess(THNTS)\n" +
			"                 │                           │                   ├─ index: [THNTS.IXUXU]\n" +
			"                 │                           │                   ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                           │                   └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                 │                           └─ HashLookup\n" +
			"                 │                               ├─ left-key: TUPLE(mf.id:10!null)\n" +
			"                 │                               ├─ right-key: TUPLE(w2mao.z7cp5:7!null)\n" +
			"                 │                               └─ MergeJoin\n" +
			"                 │                                   ├─ cmp: Eq\n" +
			"                 │                                   │   ├─ vc.id:64!null\n" +
			"                 │                                   │   └─ w2mao.yh4xb:72!null\n" +
			"                 │                                   ├─ TableAlias(vc)\n" +
			"                 │                                   │   └─ IndexedTableAccess(D34QP)\n" +
			"                 │                                   │       ├─ index: [D34QP.id]\n" +
			"                 │                                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                                   │       └─ columns: [id twmsr qhmge mlnpu fi3ga znp4p]\n" +
			"                 │                                   └─ TableAlias(w2mao)\n" +
			"                 │                                       └─ IndexedTableAccess(SEQS3)\n" +
			"                 │                                           ├─ index: [SEQS3.YH4XB]\n" +
			"                 │                                           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                                           └─ columns: [id z7cp5 yh4xb]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(oxxei.BDNYB:3!null, ckele.LWQ6O:0!null)\n" +
			"                     ├─ right-key: TUPLE(e52ap.BDNYB:1!null, e52ap.BDNYB:1!null)\n" +
			"                     └─ SubqueryAlias\n" +
			"                         ├─ name: e52ap\n" +
			"                         ├─ outerVisibility: false\n" +
			"                         ├─ cacheable: true\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [KUXQY:30!null, BDNYB:31!null, YHVEZ:32!null, YAZ4X:33!null]\n" +
			"                             └─ Sort(sn.id:0!null ASC nullsFirst)\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, nd.id:10!null, nd.dkcaj:11!null, nd.kng7t:12, nd.tw55n:13!null, nd.qrqxw:14!null, nd.ecxaj:15!null, nd.fgg57:16, nd.zh72s:17, nd.fsk67:18!null, nd.xqdyt:19!null, nd.tce7a:20, nd.iwv2h:21, nd.hpcms:22!null, nd.n5cc2:23, nd.fhcyt:24, nd.etaq7:25, nd.a75x7:26, nma.id:27!null, nma.dzlim:28!null, nma.f3yue:29, nd.tw55n:13!null as KUXQY, sn.id:0!null as BDNYB, nma.dzlim:28!null as YHVEZ, CASE  WHEN LessThan\n" +
			"                                     │   ├─ nd.tce7a:20\n" +
			"                                     │   └─ 0.900000 (double)\n" +
			"                                     │   THEN 1 (tinyint) ELSE 0 (tinyint) END as YAZ4X]\n" +
			"                                     └─ Filter\n" +
			"                                         ├─ NOT\n" +
			"                                         │   └─ Eq\n" +
			"                                         │       ├─ nma.dzlim:28!null\n" +
			"                                         │       └─ Q5I4E (longtext)\n" +
			"                                         └─ LeftOuterHashJoin\n" +
			"                                             ├─ Eq\n" +
			"                                             │   ├─ nd.hpcms:22!null\n" +
			"                                             │   └─ nma.id:27!null\n" +
			"                                             ├─ LeftOuterMergeJoin\n" +
			"                                             │   ├─ cmp: Eq\n" +
			"                                             │   │   ├─ sn.brqp2:1!null\n" +
			"                                             │   │   └─ nd.id:10!null\n" +
			"                                             │   ├─ TableAlias(sn)\n" +
			"                                             │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"                                             │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"                                             │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                             │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                             │   └─ TableAlias(nd)\n" +
			"                                             │       └─ IndexedTableAccess(E2I7U)\n" +
			"                                             │           ├─ index: [E2I7U.id]\n" +
			"                                             │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                             │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                             └─ HashLookup\n" +
			"                                                 ├─ left-key: TUPLE(nd.hpcms:22!null)\n" +
			"                                                 ├─ right-key: TUPLE(nma.id:0!null)\n" +
			"                                                 └─ TableAlias(nma)\n" +
			"                                                     └─ Table\n" +
			"                                                         ├─ name: TNMXI\n" +
			"                                                         └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
	WITH
	   FZFVD AS (
	       SELECT id, ROW_NUMBER() OVER (ORDER BY id ASC) - 1 AS M6T2N FROM NOXN3),
	   JCHIR AS (
	       SELECT
	       ism.FV24E AS FJDP5,
	       CPMFE.id AS BJUF2,
	       CPMFE.TW55N AS PSMU6,
	       ism.M22QN AS M22QN,
	       G3YXS.GE5EL,
	       G3YXS.F7A4Q,
	       G3YXS.ESFVY,
	       CASE
	           WHEN G3YXS.SL76B IN ('FO422', 'SJ53H') THEN 0
	           WHEN G3YXS.SL76B IN ('DCV4Z', 'UOSM4', 'FUGIP', 'H5MCC', 'YKEQE', 'D3AKL') THEN 1
	           WHEN G3YXS.SL76B IN ('QJEXM', 'J6S7P', 'VT7FI') THEN 2
	           WHEN G3YXS.SL76B IN ('Y62X7') THEN 3
	       END AS CC4AX,
	       G3YXS.SL76B AS SL76B,
	       YQIF4.id AS QNI57,
	       YVHJZ.id AS TDEIU
	       FROM
	       HDDVB ism
	       INNER JOIN YYBCX G3YXS ON G3YXS.id = ism.NZ4MQ
	       LEFT JOIN
	       WGSDC NHMXW
	       ON
	       NHMXW.id = ism.PRUV2
	       LEFT JOIN
	       E2I7U CPMFE
	       ON
	       CPMFE.ZH72S = NHMXW.NOHHR AND CPMFE.id <> ism.FV24E
	       LEFT JOIN
	       NOXN3 YQIF4
	       ON
	           YQIF4.BRQP2 = ism.FV24E
	       AND
	           YQIF4.FFTBJ = ism.UJ6XY
	       LEFT JOIN
	       NOXN3 YVHJZ
	       ON
	           YVHJZ.BRQP2 = ism.UJ6XY
	       AND
	           YVHJZ.FFTBJ = ism.FV24E
	       WHERE
	           YQIF4.id IS NOT NULL
	       OR
	           YVHJZ.id IS NOT NULL
	),
	OXDGK AS (
	   SELECT
	       FJDP5,
	       BJUF2,
	       PSMU6,
	       M22QN,
	       GE5EL,
	       F7A4Q,
	       ESFVY,
	       CC4AX,
	       SL76B,
	       QNI57,
	       TDEIU
	   FROM
	       JCHIR
	   WHERE
	           (QNI57 IS NOT NULL AND TDEIU IS NULL)
	       OR
	           (QNI57 IS NULL AND TDEIU IS NOT NULL)
	   UNION
	   SELECT
	       FJDP5,
	       BJUF2,
	       PSMU6,
	       M22QN,
	       GE5EL,
	       F7A4Q,
	       ESFVY,
	       CC4AX,
	       SL76B,
	       QNI57,
	       NULL AS TDEIU
	   FROM
	       JCHIR
	   WHERE
	       (QNI57 IS NOT NULL AND TDEIU IS NOT NULL)
	   UNION
	   SELECT
	       FJDP5,
	       BJUF2,
	       PSMU6,
	       M22QN,
	       GE5EL,
	       F7A4Q,
	       ESFVY,
	       CC4AX,
	       SL76B,
	       NULL AS QNI57,
	       TDEIU
	   FROM
	       JCHIR
	   WHERE
	       (QNI57 IS NOT NULL AND TDEIU IS NOT NULL)
	)
	SELECT
	mf.FTQLQ AS T4IBQ,

	CASE
	   WHEN MJR3D.QNI57 IS NOT NULL
	   THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.QNI57)
	   WHEN MJR3D.TDEIU IS NOT NULL
	   THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.TDEIU)
	END AS M6T2N,

	GE5EL AS GE5EL,
	F7A4Q AS F7A4Q,
	CC4AX AS CC4AX,
	SL76B AS SL76B,
	aac.BTXC5 AS YEBDJ,
	PSMU6

	FROM
	OXDGK MJR3D
	LEFT JOIN
	NOXN3 sn
	ON
	(
	   QNI57 IS NOT NULL
	   AND
	   sn.id = MJR3D.QNI57
	   AND
	   MJR3D.BJUF2 IS NULL
	)
	OR
	(
	   QNI57 IS NOT NULL
	   AND
	   MJR3D.BJUF2 IS NOT NULL
	   AND
	   sn.id IN (SELECT JTEHG.id FROM NOXN3 JTEHG WHERE BRQP2 = MJR3D.BJUF2)
	)
	OR
	(
	   TDEIU IS NOT NULL
	   AND
	   MJR3D.BJUF2 IS NULL
	   AND
	   sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.FJDP5)
	)
	OR
	(
	   TDEIU IS NOT NULL
	   AND
	   MJR3D.BJUF2 IS NOT NULL
	   AND
	   sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.BJUF2)
	)
	INNER JOIN
	(
	   SELECT FTQLQ, mf.LUEVY, mf.M22QN
	   FROM YK2GW cla
	   INNER JOIN THNTS bs ON cla.id = bs.IXUXU
	   INNER JOIN HGMQ6 mf ON bs.id = mf.GXLUB
	   WHERE cla.FTQLQ IN ('SQ1')
	) mf
	ON mf.LUEVY = sn.BRQP2 AND mf.M22QN = MJR3D.M22QN
	INNER JOIN
	   (SELECT * FROM TPXBU) aac
	ON aac.id = MJR3D.M22QN`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:27!null, M6T2N:28, GE5EL:29, F7A4Q:30, CC4AX:31, SL76B:32!null, YEBDJ:33, mjr3d.PSMU6:2!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [mjr3d.FJDP5:0!null, mjr3d.BJUF2:1!null, mjr3d.PSMU6:2!null, mjr3d.M22QN:3!null, mjr3d.ge5el:4, mjr3d.f7a4q:5, mjr3d.esfvy:6!null, mjr3d.CC4AX:7, mjr3d.SL76B:8!null, mjr3d.QNI57:9!null, mjr3d.TDEIU:10!null, sn.id:11!null, sn.brqp2:12!null, sn.fftbj:13!null, sn.a7xo2:14, sn.kbo7r:15!null, sn.ecdkm:16, sn.numk2:17!null, sn.letoe:18!null, sn.ykssu:19, sn.fhcyt:20, mf.ftqlq:24!null, mf.luevy:25!null, mf.m22qn:26!null, aac.id:21!null, aac.btxc5:22, aac.fhcyt:23, mf.ftqlq:24!null as T4IBQ, CASE  WHEN NOT\n" +
			"     │   └─ mjr3d.QNI57:9!null IS NULL\n" +
			"     │   THEN Subquery\n" +
			"     │   ├─ cacheable: false\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [ei.M6T2N:28!null]\n" +
			"     │       └─ Filter\n" +
			"     │           ├─ Eq\n" +
			"     │           │   ├─ ei.id:27!null\n" +
			"     │           │   └─ mjr3d.QNI57:9!null\n" +
			"     │           └─ SubqueryAlias\n" +
			"     │               ├─ name: ei\n" +
			"     │               ├─ outerVisibility: true\n" +
			"     │               ├─ cacheable: true\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [noxn3.id:28!null, M6T2N:29!null]\n" +
			"     │                   └─ Project\n" +
			"     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):27!null, noxn3.id:28!null, (row_number() over ( order by noxn3.id asc):27!null - 1 (tinyint)) as M6T2N]\n" +
			"     │                       └─ Window\n" +
			"     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"     │                           ├─ noxn3.id:27!null\n" +
			"     │                           └─ Table\n" +
			"     │                               ├─ name: NOXN3\n" +
			"     │                               └─ columns: [id]\n" +
			"     │   WHEN NOT\n" +
			"     │   └─ mjr3d.TDEIU:10!null IS NULL\n" +
			"     │   THEN Subquery\n" +
			"     │   ├─ cacheable: false\n" +
			"     │   └─ Project\n" +
			"     │       ├─ columns: [ei.M6T2N:28!null]\n" +
			"     │       └─ Filter\n" +
			"     │           ├─ Eq\n" +
			"     │           │   ├─ ei.id:27!null\n" +
			"     │           │   └─ mjr3d.TDEIU:10!null\n" +
			"     │           └─ SubqueryAlias\n" +
			"     │               ├─ name: ei\n" +
			"     │               ├─ outerVisibility: true\n" +
			"     │               ├─ cacheable: true\n" +
			"     │               └─ Project\n" +
			"     │                   ├─ columns: [noxn3.id:28!null, M6T2N:29!null]\n" +
			"     │                   └─ Project\n" +
			"     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):27!null, noxn3.id:28!null, (row_number() over ( order by noxn3.id asc):27!null - 1 (tinyint)) as M6T2N]\n" +
			"     │                       └─ Window\n" +
			"     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"     │                           ├─ noxn3.id:27!null\n" +
			"     │                           └─ Table\n" +
			"     │                               ├─ name: NOXN3\n" +
			"     │                               └─ columns: [id]\n" +
			"     │   END as M6T2N, mjr3d.ge5el:4 as GE5EL, mjr3d.f7a4q:5 as F7A4Q, mjr3d.CC4AX:7 as CC4AX, mjr3d.SL76B:8!null as SL76B, aac.btxc5:22 as YEBDJ]\n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mf.luevy:25!null\n" +
			"         │   │   │   └─ sn.brqp2:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mf.m22qn:26!null\n" +
			"         │   │       └─ mjr3d.M22QN:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ aac.id:21!null\n" +
			"         │       └─ mjr3d.M22QN:3!null\n" +
			"         ├─ LeftOuterJoin\n" +
			"         │   ├─ Or\n" +
			"         │   │   ├─ Or\n" +
			"         │   │   │   ├─ Or\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ NOT\n" +
			"         │   │   │   │   │   │   │   └─ mjr3d.QNI57:9!null IS NULL\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ sn.id:11!null\n" +
			"         │   │   │   │   │   │       └─ mjr3d.QNI57:9!null\n" +
			"         │   │   │   │   │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │   │   │   │   └─ AND\n" +
			"         │   │   │   │       ├─ AND\n" +
			"         │   │   │   │       │   ├─ NOT\n" +
			"         │   │   │   │       │   │   └─ mjr3d.QNI57:9!null IS NULL\n" +
			"         │   │   │   │       │   └─ NOT\n" +
			"         │   │   │   │       │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │   │   │   │       └─ InSubquery\n" +
			"         │   │   │   │           ├─ left: sn.id:11!null\n" +
			"         │   │   │   │           └─ right: Subquery\n" +
			"         │   │   │   │               ├─ cacheable: false\n" +
			"         │   │   │   │               └─ Project\n" +
			"         │   │   │   │                   ├─ columns: [jtehg.id:21!null]\n" +
			"         │   │   │   │                   └─ Filter\n" +
			"         │   │   │   │                       ├─ Eq\n" +
			"         │   │   │   │                       │   ├─ jtehg.brqp2:22!null\n" +
			"         │   │   │   │                       │   └─ mjr3d.BJUF2:1!null\n" +
			"         │   │   │   │                       └─ TableAlias(jtehg)\n" +
			"         │   │   │   │                           └─ IndexedTableAccess(NOXN3)\n" +
			"         │   │   │   │                               ├─ index: [NOXN3.BRQP2]\n" +
			"         │   │   │   │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │   │   └─ AND\n" +
			"         │   │   │       ├─ AND\n" +
			"         │   │   │       │   ├─ NOT\n" +
			"         │   │   │       │   │   └─ mjr3d.TDEIU:10!null IS NULL\n" +
			"         │   │   │       │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │   │   │       └─ InSubquery\n" +
			"         │   │   │           ├─ left: sn.id:11!null\n" +
			"         │   │   │           └─ right: Subquery\n" +
			"         │   │   │               ├─ cacheable: false\n" +
			"         │   │   │               └─ Project\n" +
			"         │   │   │                   ├─ columns: [xmafz.id:21!null]\n" +
			"         │   │   │                   └─ Filter\n" +
			"         │   │   │                       ├─ Eq\n" +
			"         │   │   │                       │   ├─ xmafz.brqp2:22!null\n" +
			"         │   │   │                       │   └─ mjr3d.FJDP5:0!null\n" +
			"         │   │   │                       └─ TableAlias(xmafz)\n" +
			"         │   │   │                           └─ IndexedTableAccess(NOXN3)\n" +
			"         │   │   │                               ├─ index: [NOXN3.BRQP2]\n" +
			"         │   │   │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │   └─ AND\n" +
			"         │   │       ├─ AND\n" +
			"         │   │       │   ├─ NOT\n" +
			"         │   │       │   │   └─ mjr3d.TDEIU:10!null IS NULL\n" +
			"         │   │       │   └─ NOT\n" +
			"         │   │       │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │   │       └─ InSubquery\n" +
			"         │   │           ├─ left: sn.id:11!null\n" +
			"         │   │           └─ right: Subquery\n" +
			"         │   │               ├─ cacheable: false\n" +
			"         │   │               └─ Project\n" +
			"         │   │                   ├─ columns: [xmafz.id:21!null]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ Eq\n" +
			"         │   │                       │   ├─ xmafz.brqp2:22!null\n" +
			"         │   │                       │   └─ mjr3d.BJUF2:1!null\n" +
			"         │   │                       └─ TableAlias(xmafz)\n" +
			"         │   │                           └─ IndexedTableAccess(NOXN3)\n" +
			"         │   │                               ├─ index: [NOXN3.BRQP2]\n" +
			"         │   │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   ├─ SubqueryAlias\n" +
			"         │   │   ├─ name: mjr3d\n" +
			"         │   │   ├─ outerVisibility: false\n" +
			"         │   │   ├─ cacheable: true\n" +
			"         │   │   └─ Union distinct\n" +
			"         │   │       ├─ Project\n" +
			"         │   │       │   ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, convert\n" +
			"         │   │       │   │   ├─ type: char\n" +
			"         │   │       │   │   └─ jchir.QNI57:9!null\n" +
			"         │   │       │   │   as QNI57, jchir.TDEIU:10]\n" +
			"         │   │       │   └─ Union distinct\n" +
			"         │   │       │       ├─ Project\n" +
			"         │   │       │       │   ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, jchir.QNI57:9!null, convert\n" +
			"         │   │       │       │   │   ├─ type: char\n" +
			"         │   │       │       │   │   └─ jchir.TDEIU:10!null\n" +
			"         │   │       │       │   │   as TDEIU]\n" +
			"         │   │       │       │   └─ SubqueryAlias\n" +
			"         │   │       │       │       ├─ name: jchir\n" +
			"         │   │       │       │       ├─ outerVisibility: false\n" +
			"         │   │       │       │       ├─ cacheable: true\n" +
			"         │   │       │       │       └─ Filter\n" +
			"         │   │       │       │           ├─ Or\n" +
			"         │   │       │       │           │   ├─ AND\n" +
			"         │   │       │       │           │   │   ├─ NOT\n" +
			"         │   │       │       │           │   │   │   └─ QNI57:9!null IS NULL\n" +
			"         │   │       │       │           │   │   └─ TDEIU:10!null IS NULL\n" +
			"         │   │       │       │           │   └─ AND\n" +
			"         │   │       │       │           │       ├─ QNI57:9!null IS NULL\n" +
			"         │   │       │       │           │       └─ NOT\n" +
			"         │   │       │       │           │           └─ TDEIU:10!null IS NULL\n" +
			"         │   │       │       │           └─ Project\n" +
			"         │   │       │       │               ├─ columns: [FJDP5:64!null, BJUF2:65!null, PSMU6:66!null, M22QN:67!null, g3yxs.ge5el:12, g3yxs.f7a4q:13, g3yxs.esfvy:10!null, CC4AX:68, SL76B:69!null, QNI57:70!null, TDEIU:71!null]\n" +
			"         │   │       │       │               └─ Project\n" +
			"         │   │       │       │                   ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, cpmfe.tw55n:30!null as PSMU6, ism.m22qn:11!null as M22QN, CASE  WHEN IN\n" +
			"         │   │       │       │                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │       │                   │   └─ right: TUPLE(FO422 (longtext), SJ53H (longtext))\n" +
			"         │   │       │       │                   │   THEN 0 (tinyint) WHEN IN\n" +
			"         │   │       │       │                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │       │                   │   └─ right: TUPLE(DCV4Z (longtext), UOSM4 (longtext), FUGIP (longtext), H5MCC (longtext), YKEQE (longtext), D3AKL (longtext))\n" +
			"         │   │       │       │                   │   THEN 1 (tinyint) WHEN IN\n" +
			"         │   │       │       │                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │       │                   │   └─ right: TUPLE(QJEXM (longtext), J6S7P (longtext), VT7FI (longtext))\n" +
			"         │   │       │       │                   │   THEN 2 (tinyint) WHEN IN\n" +
			"         │   │       │       │                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │       │                   │   └─ right: TUPLE(Y62X7 (longtext))\n" +
			"         │   │       │       │                   │   THEN 3 (tinyint) END as CC4AX, g3yxs.sl76b:2!null as SL76B, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"         │   │       │       │                   └─ Filter\n" +
			"         │   │       │       │                       ├─ Or\n" +
			"         │   │       │       │                       │   ├─ NOT\n" +
			"         │   │       │       │                       │   │   └─ yqif4.id:44!null IS NULL\n" +
			"         │   │       │       │                       │   └─ NOT\n" +
			"         │   │       │       │                       │       └─ yvhjz.id:54!null IS NULL\n" +
			"         │   │       │       │                       └─ LeftOuterHashJoin\n" +
			"         │   │       │       │                           ├─ AND\n" +
			"         │   │       │       │                           │   ├─ Eq\n" +
			"         │   │       │       │                           │   │   ├─ yvhjz.brqp2:55!null\n" +
			"         │   │       │       │                           │   │   └─ ism.uj6xy:10!null\n" +
			"         │   │       │       │                           │   └─ Eq\n" +
			"         │   │       │       │                           │       ├─ yvhjz.fftbj:56!null\n" +
			"         │   │       │       │                           │       └─ ism.fv24e:9!null\n" +
			"         │   │       │       │                           ├─ LeftOuterHashJoin\n" +
			"         │   │       │       │                           │   ├─ AND\n" +
			"         │   │       │       │                           │   │   ├─ Eq\n" +
			"         │   │       │       │                           │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"         │   │       │       │                           │   │   │   └─ ism.fv24e:9!null\n" +
			"         │   │       │       │                           │   │   └─ Eq\n" +
			"         │   │       │       │                           │   │       ├─ yqif4.fftbj:46!null\n" +
			"         │   │       │       │                           │   │       └─ ism.uj6xy:10!null\n" +
			"         │   │       │       │                           │   ├─ LeftOuterLookupJoin\n" +
			"         │   │       │       │                           │   │   ├─ AND\n" +
			"         │   │       │       │                           │   │   │   ├─ Eq\n" +
			"         │   │       │       │                           │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"         │   │       │       │                           │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"         │   │       │       │                           │   │   │   └─ NOT\n" +
			"         │   │       │       │                           │   │   │       └─ Eq\n" +
			"         │   │       │       │                           │   │   │           ├─ cpmfe.id:27!null\n" +
			"         │   │       │       │                           │   │   │           └─ ism.fv24e:9!null\n" +
			"         │   │       │       │                           │   │   ├─ LeftOuterHashJoin\n" +
			"         │   │       │       │                           │   │   │   ├─ Eq\n" +
			"         │   │       │       │                           │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"         │   │       │       │                           │   │   │   │   └─ ism.pruv2:14\n" +
			"         │   │       │       │                           │   │   │   ├─ MergeJoin\n" +
			"         │   │       │       │                           │   │   │   │   ├─ cmp: Eq\n" +
			"         │   │       │       │                           │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"         │   │       │       │                           │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"         │   │       │       │                           │   │   │   │   ├─ TableAlias(g3yxs)\n" +
			"         │   │       │       │                           │   │   │   │   │   └─ IndexedTableAccess(YYBCX)\n" +
			"         │   │       │       │                           │   │   │   │   │       ├─ index: [YYBCX.id]\n" +
			"         │   │       │       │                           │   │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       │       │                           │   │   │   │   │       └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"         │   │       │       │                           │   │   │   │   └─ TableAlias(ism)\n" +
			"         │   │       │       │                           │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"         │   │       │       │                           │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"         │   │       │       │                           │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       │       │                           │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"         │   │       │       │                           │   │   │   └─ HashLookup\n" +
			"         │   │       │       │                           │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"         │   │       │       │                           │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"         │   │       │       │                           │   │   │       └─ TableAlias(nhmxw)\n" +
			"         │   │       │       │                           │   │   │           └─ Table\n" +
			"         │   │       │       │                           │   │   │               ├─ name: WGSDC\n" +
			"         │   │       │       │                           │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"         │   │       │       │                           │   │   └─ TableAlias(cpmfe)\n" +
			"         │   │       │       │                           │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"         │   │       │       │                           │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"         │   │       │       │                           │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │       │       │                           │   └─ HashLookup\n" +
			"         │   │       │       │                           │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"         │   │       │       │                           │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"         │   │       │       │                           │       └─ TableAlias(yqif4)\n" +
			"         │   │       │       │                           │           └─ Table\n" +
			"         │   │       │       │                           │               ├─ name: NOXN3\n" +
			"         │   │       │       │                           │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │       │       │                           └─ HashLookup\n" +
			"         │   │       │       │                               ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"         │   │       │       │                               ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"         │   │       │       │                               └─ TableAlias(yvhjz)\n" +
			"         │   │       │       │                                   └─ Table\n" +
			"         │   │       │       │                                       ├─ name: NOXN3\n" +
			"         │   │       │       │                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │       │       └─ Project\n" +
			"         │   │       │           ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, jchir.QNI57:9!null, convert\n" +
			"         │   │       │           │   ├─ type: char\n" +
			"         │   │       │           │   └─ TDEIU:10\n" +
			"         │   │       │           │   as TDEIU]\n" +
			"         │   │       │           └─ Project\n" +
			"         │   │       │               ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, jchir.QNI57:9!null, TDEIU:11]\n" +
			"         │   │       │               └─ Project\n" +
			"         │   │       │                   ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, jchir.QNI57:9!null, jchir.TDEIU:10!null, NULL (null) as TDEIU]\n" +
			"         │   │       │                   └─ SubqueryAlias\n" +
			"         │   │       │                       ├─ name: jchir\n" +
			"         │   │       │                       ├─ outerVisibility: false\n" +
			"         │   │       │                       ├─ cacheable: true\n" +
			"         │   │       │                       └─ Filter\n" +
			"         │   │       │                           ├─ AND\n" +
			"         │   │       │                           │   ├─ NOT\n" +
			"         │   │       │                           │   │   └─ QNI57:9!null IS NULL\n" +
			"         │   │       │                           │   └─ NOT\n" +
			"         │   │       │                           │       └─ TDEIU:10!null IS NULL\n" +
			"         │   │       │                           └─ Project\n" +
			"         │   │       │                               ├─ columns: [FJDP5:64!null, BJUF2:65!null, PSMU6:66!null, M22QN:67!null, g3yxs.ge5el:12, g3yxs.f7a4q:13, g3yxs.esfvy:10!null, CC4AX:68, SL76B:69!null, QNI57:70!null, TDEIU:71!null]\n" +
			"         │   │       │                               └─ Project\n" +
			"         │   │       │                                   ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, cpmfe.tw55n:30!null as PSMU6, ism.m22qn:11!null as M22QN, CASE  WHEN IN\n" +
			"         │   │       │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │                                   │   └─ right: TUPLE(FO422 (longtext), SJ53H (longtext))\n" +
			"         │   │       │                                   │   THEN 0 (tinyint) WHEN IN\n" +
			"         │   │       │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │                                   │   └─ right: TUPLE(DCV4Z (longtext), UOSM4 (longtext), FUGIP (longtext), H5MCC (longtext), YKEQE (longtext), D3AKL (longtext))\n" +
			"         │   │       │                                   │   THEN 1 (tinyint) WHEN IN\n" +
			"         │   │       │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │                                   │   └─ right: TUPLE(QJEXM (longtext), J6S7P (longtext), VT7FI (longtext))\n" +
			"         │   │       │                                   │   THEN 2 (tinyint) WHEN IN\n" +
			"         │   │       │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │       │                                   │   └─ right: TUPLE(Y62X7 (longtext))\n" +
			"         │   │       │                                   │   THEN 3 (tinyint) END as CC4AX, g3yxs.sl76b:2!null as SL76B, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"         │   │       │                                   └─ Filter\n" +
			"         │   │       │                                       ├─ Or\n" +
			"         │   │       │                                       │   ├─ NOT\n" +
			"         │   │       │                                       │   │   └─ yqif4.id:44!null IS NULL\n" +
			"         │   │       │                                       │   └─ NOT\n" +
			"         │   │       │                                       │       └─ yvhjz.id:54!null IS NULL\n" +
			"         │   │       │                                       └─ LeftOuterHashJoin\n" +
			"         │   │       │                                           ├─ AND\n" +
			"         │   │       │                                           │   ├─ Eq\n" +
			"         │   │       │                                           │   │   ├─ yvhjz.brqp2:55!null\n" +
			"         │   │       │                                           │   │   └─ ism.uj6xy:10!null\n" +
			"         │   │       │                                           │   └─ Eq\n" +
			"         │   │       │                                           │       ├─ yvhjz.fftbj:56!null\n" +
			"         │   │       │                                           │       └─ ism.fv24e:9!null\n" +
			"         │   │       │                                           ├─ LeftOuterHashJoin\n" +
			"         │   │       │                                           │   ├─ AND\n" +
			"         │   │       │                                           │   │   ├─ Eq\n" +
			"         │   │       │                                           │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"         │   │       │                                           │   │   │   └─ ism.fv24e:9!null\n" +
			"         │   │       │                                           │   │   └─ Eq\n" +
			"         │   │       │                                           │   │       ├─ yqif4.fftbj:46!null\n" +
			"         │   │       │                                           │   │       └─ ism.uj6xy:10!null\n" +
			"         │   │       │                                           │   ├─ LeftOuterLookupJoin\n" +
			"         │   │       │                                           │   │   ├─ AND\n" +
			"         │   │       │                                           │   │   │   ├─ Eq\n" +
			"         │   │       │                                           │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"         │   │       │                                           │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"         │   │       │                                           │   │   │   └─ NOT\n" +
			"         │   │       │                                           │   │   │       └─ Eq\n" +
			"         │   │       │                                           │   │   │           ├─ cpmfe.id:27!null\n" +
			"         │   │       │                                           │   │   │           └─ ism.fv24e:9!null\n" +
			"         │   │       │                                           │   │   ├─ LeftOuterHashJoin\n" +
			"         │   │       │                                           │   │   │   ├─ Eq\n" +
			"         │   │       │                                           │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"         │   │       │                                           │   │   │   │   └─ ism.pruv2:14\n" +
			"         │   │       │                                           │   │   │   ├─ MergeJoin\n" +
			"         │   │       │                                           │   │   │   │   ├─ cmp: Eq\n" +
			"         │   │       │                                           │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"         │   │       │                                           │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"         │   │       │                                           │   │   │   │   ├─ TableAlias(g3yxs)\n" +
			"         │   │       │                                           │   │   │   │   │   └─ IndexedTableAccess(YYBCX)\n" +
			"         │   │       │                                           │   │   │   │   │       ├─ index: [YYBCX.id]\n" +
			"         │   │       │                                           │   │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       │                                           │   │   │   │   │       └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"         │   │       │                                           │   │   │   │   └─ TableAlias(ism)\n" +
			"         │   │       │                                           │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"         │   │       │                                           │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"         │   │       │                                           │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │       │                                           │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"         │   │       │                                           │   │   │   └─ HashLookup\n" +
			"         │   │       │                                           │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"         │   │       │                                           │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"         │   │       │                                           │   │   │       └─ TableAlias(nhmxw)\n" +
			"         │   │       │                                           │   │   │           └─ Table\n" +
			"         │   │       │                                           │   │   │               ├─ name: WGSDC\n" +
			"         │   │       │                                           │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"         │   │       │                                           │   │   └─ TableAlias(cpmfe)\n" +
			"         │   │       │                                           │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"         │   │       │                                           │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"         │   │       │                                           │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │       │                                           │   └─ HashLookup\n" +
			"         │   │       │                                           │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"         │   │       │                                           │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"         │   │       │                                           │       └─ TableAlias(yqif4)\n" +
			"         │   │       │                                           │           └─ Table\n" +
			"         │   │       │                                           │               ├─ name: NOXN3\n" +
			"         │   │       │                                           │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │       │                                           └─ HashLookup\n" +
			"         │   │       │                                               ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"         │   │       │                                               ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"         │   │       │                                               └─ TableAlias(yvhjz)\n" +
			"         │   │       │                                                   └─ Table\n" +
			"         │   │       │                                                       ├─ name: NOXN3\n" +
			"         │   │       │                                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │       └─ Project\n" +
			"         │   │           ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, convert\n" +
			"         │   │           │   ├─ type: char\n" +
			"         │   │           │   └─ QNI57:9\n" +
			"         │   │           │   as QNI57, jchir.TDEIU:10!null]\n" +
			"         │   │           └─ Project\n" +
			"         │   │               ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, QNI57:11, jchir.TDEIU:10!null]\n" +
			"         │   │               └─ Project\n" +
			"         │   │                   ├─ columns: [jchir.FJDP5:0!null, jchir.BJUF2:1!null, jchir.PSMU6:2!null, jchir.M22QN:3!null, jchir.ge5el:4, jchir.f7a4q:5, jchir.esfvy:6!null, jchir.CC4AX:7, jchir.SL76B:8!null, jchir.QNI57:9!null, jchir.TDEIU:10!null, NULL (null) as QNI57]\n" +
			"         │   │                   └─ SubqueryAlias\n" +
			"         │   │                       ├─ name: jchir\n" +
			"         │   │                       ├─ outerVisibility: false\n" +
			"         │   │                       ├─ cacheable: true\n" +
			"         │   │                       └─ Filter\n" +
			"         │   │                           ├─ AND\n" +
			"         │   │                           │   ├─ NOT\n" +
			"         │   │                           │   │   └─ QNI57:9!null IS NULL\n" +
			"         │   │                           │   └─ NOT\n" +
			"         │   │                           │       └─ TDEIU:10!null IS NULL\n" +
			"         │   │                           └─ Project\n" +
			"         │   │                               ├─ columns: [FJDP5:64!null, BJUF2:65!null, PSMU6:66!null, M22QN:67!null, g3yxs.ge5el:12, g3yxs.f7a4q:13, g3yxs.esfvy:10!null, CC4AX:68, SL76B:69!null, QNI57:70!null, TDEIU:71!null]\n" +
			"         │   │                               └─ Project\n" +
			"         │   │                                   ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, cpmfe.tw55n:30!null as PSMU6, ism.m22qn:11!null as M22QN, CASE  WHEN IN\n" +
			"         │   │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │                                   │   └─ right: TUPLE(FO422 (longtext), SJ53H (longtext))\n" +
			"         │   │                                   │   THEN 0 (tinyint) WHEN IN\n" +
			"         │   │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │                                   │   └─ right: TUPLE(DCV4Z (longtext), UOSM4 (longtext), FUGIP (longtext), H5MCC (longtext), YKEQE (longtext), D3AKL (longtext))\n" +
			"         │   │                                   │   THEN 1 (tinyint) WHEN IN\n" +
			"         │   │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │                                   │   └─ right: TUPLE(QJEXM (longtext), J6S7P (longtext), VT7FI (longtext))\n" +
			"         │   │                                   │   THEN 2 (tinyint) WHEN IN\n" +
			"         │   │                                   │   ├─ left: g3yxs.sl76b:2!null\n" +
			"         │   │                                   │   └─ right: TUPLE(Y62X7 (longtext))\n" +
			"         │   │                                   │   THEN 3 (tinyint) END as CC4AX, g3yxs.sl76b:2!null as SL76B, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ Or\n" +
			"         │   │                                       │   ├─ NOT\n" +
			"         │   │                                       │   │   └─ yqif4.id:44!null IS NULL\n" +
			"         │   │                                       │   └─ NOT\n" +
			"         │   │                                       │       └─ yvhjz.id:54!null IS NULL\n" +
			"         │   │                                       └─ LeftOuterHashJoin\n" +
			"         │   │                                           ├─ AND\n" +
			"         │   │                                           │   ├─ Eq\n" +
			"         │   │                                           │   │   ├─ yvhjz.brqp2:55!null\n" +
			"         │   │                                           │   │   └─ ism.uj6xy:10!null\n" +
			"         │   │                                           │   └─ Eq\n" +
			"         │   │                                           │       ├─ yvhjz.fftbj:56!null\n" +
			"         │   │                                           │       └─ ism.fv24e:9!null\n" +
			"         │   │                                           ├─ LeftOuterHashJoin\n" +
			"         │   │                                           │   ├─ AND\n" +
			"         │   │                                           │   │   ├─ Eq\n" +
			"         │   │                                           │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"         │   │                                           │   │   │   └─ ism.fv24e:9!null\n" +
			"         │   │                                           │   │   └─ Eq\n" +
			"         │   │                                           │   │       ├─ yqif4.fftbj:46!null\n" +
			"         │   │                                           │   │       └─ ism.uj6xy:10!null\n" +
			"         │   │                                           │   ├─ LeftOuterLookupJoin\n" +
			"         │   │                                           │   │   ├─ AND\n" +
			"         │   │                                           │   │   │   ├─ Eq\n" +
			"         │   │                                           │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"         │   │                                           │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"         │   │                                           │   │   │   └─ NOT\n" +
			"         │   │                                           │   │   │       └─ Eq\n" +
			"         │   │                                           │   │   │           ├─ cpmfe.id:27!null\n" +
			"         │   │                                           │   │   │           └─ ism.fv24e:9!null\n" +
			"         │   │                                           │   │   ├─ LeftOuterHashJoin\n" +
			"         │   │                                           │   │   │   ├─ Eq\n" +
			"         │   │                                           │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"         │   │                                           │   │   │   │   └─ ism.pruv2:14\n" +
			"         │   │                                           │   │   │   ├─ MergeJoin\n" +
			"         │   │                                           │   │   │   │   ├─ cmp: Eq\n" +
			"         │   │                                           │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"         │   │                                           │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"         │   │                                           │   │   │   │   ├─ TableAlias(g3yxs)\n" +
			"         │   │                                           │   │   │   │   │   └─ IndexedTableAccess(YYBCX)\n" +
			"         │   │                                           │   │   │   │   │       ├─ index: [YYBCX.id]\n" +
			"         │   │                                           │   │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                           │   │   │   │   │       └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"         │   │                                           │   │   │   │   └─ TableAlias(ism)\n" +
			"         │   │                                           │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"         │   │                                           │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"         │   │                                           │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │   │                                           │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"         │   │                                           │   │   │   └─ HashLookup\n" +
			"         │   │                                           │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"         │   │                                           │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"         │   │                                           │   │   │       └─ TableAlias(nhmxw)\n" +
			"         │   │                                           │   │   │           └─ Table\n" +
			"         │   │                                           │   │   │               ├─ name: WGSDC\n" +
			"         │   │                                           │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"         │   │                                           │   │   └─ TableAlias(cpmfe)\n" +
			"         │   │                                           │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"         │   │                                           │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"         │   │                                           │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │   │                                           │   └─ HashLookup\n" +
			"         │   │                                           │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"         │   │                                           │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"         │   │                                           │       └─ TableAlias(yqif4)\n" +
			"         │   │                                           │           └─ Table\n" +
			"         │   │                                           │               ├─ name: NOXN3\n" +
			"         │   │                                           │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   │                                           └─ HashLookup\n" +
			"         │   │                                               ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"         │   │                                               ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"         │   │                                               └─ TableAlias(yvhjz)\n" +
			"         │   │                                                   └─ Table\n" +
			"         │   │                                                       ├─ name: NOXN3\n" +
			"         │   │                                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │   └─ TableAlias(sn)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: NOXN3\n" +
			"         │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(sn.brqp2:12!null, mjr3d.M22QN:3!null, mjr3d.M22QN:3!null)\n" +
			"             ├─ right-key: TUPLE(mf.luevy:4!null, mf.m22qn:5!null, aac.id:0!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ mf.m22qn:26!null\n" +
			"                 │   └─ aac.id:21!null\n" +
			"                 ├─ SubqueryAlias\n" +
			"                 │   ├─ name: aac\n" +
			"                 │   ├─ outerVisibility: false\n" +
			"                 │   ├─ cacheable: true\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: TPXBU\n" +
			"                 │       └─ columns: [id btxc5 fhcyt]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(aac.id:21!null)\n" +
			"                     ├─ right-key: TUPLE(mf.m22qn:2!null)\n" +
			"                     └─ SubqueryAlias\n" +
			"                         ├─ name: mf\n" +
			"                         ├─ outerVisibility: false\n" +
			"                         ├─ cacheable: true\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [cla.ftqlq:1!null, mf.luevy:36!null, mf.m22qn:37!null]\n" +
			"                             └─ Project\n" +
			"                                 ├─ columns: [cla.id:21!null, cla.ftqlq:22!null, cla.tuxml:23, cla.paef5:24, cla.rucy4:25, cla.tpnj6:26!null, cla.lbl53:27, cla.nb3qs:28, cla.eo7iv:29, cla.muhjf:30, cla.fm34l:31, cla.ty5rf:32, cla.zhtlh:33, cla.npb7w:34, cla.sx3hh:35, cla.isbnf:36, cla.ya7yb:37, cla.c5ykb:38, cla.qk7kt:39, cla.ffge6:40, cla.fiigj:41, cla.sh3nc:42, cla.ntena:43, cla.m4aub:44, cla.x5air:45, cla.sab6m:46, cla.g5qi5:47, cla.zvqvd:48, cla.ykssu:49, cla.fhcyt:50, bs.id:0!null, bs.nfryn:1!null, bs.ixuxu:2, bs.fhcyt:3, mf.id:4!null, mf.gxlub:5!null, mf.luevy:6!null, mf.m22qn:7!null, mf.tjpt7:8!null, mf.arn5p:9!null, mf.xosd4:10!null, mf.ide43:11, mf.hmw4h:12, mf.zbt6r:13, mf.fsdy2:14!null, mf.lt7k6:15, mf.sppyd:16, mf.qcgts:17, mf.teuja:18, mf.qqv4m:19, mf.fhcyt:20]\n" +
			"                                 └─ HashJoin\n" +
			"                                     ├─ Eq\n" +
			"                                     │   ├─ cla.id:21!null\n" +
			"                                     │   └─ bs.ixuxu:2\n" +
			"                                     ├─ MergeJoin\n" +
			"                                     │   ├─ cmp: Eq\n" +
			"                                     │   │   ├─ bs.id:0!null\n" +
			"                                     │   │   └─ mf.gxlub:5!null\n" +
			"                                     │   ├─ TableAlias(bs)\n" +
			"                                     │   │   └─ IndexedTableAccess(THNTS)\n" +
			"                                     │   │       ├─ index: [THNTS.id]\n" +
			"                                     │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │   │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                     │   └─ TableAlias(mf)\n" +
			"                                     │       └─ IndexedTableAccess(HGMQ6)\n" +
			"                                     │           ├─ index: [HGMQ6.GXLUB]\n" +
			"                                     │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                                     └─ HashLookup\n" +
			"                                         ├─ left-key: TUPLE(bs.ixuxu:2)\n" +
			"                                         ├─ right-key: TUPLE(cla.id:0!null)\n" +
			"                                         └─ Filter\n" +
			"                                             ├─ HashIn\n" +
			"                                             │   ├─ cla.ftqlq:1!null\n" +
			"                                             │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                             └─ TableAlias(cla)\n" +
			"                                                 └─ IndexedTableAccess(YK2GW)\n" +
			"                                                     ├─ index: [YK2GW.FTQLQ]\n" +
			"                                                     ├─ static: [{[SQ1, SQ1]}]\n" +
			"                                                     └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
WITH
   FZFVD AS (
       SELECT id, ROW_NUMBER() OVER (ORDER BY id ASC) - 1 AS M6T2N FROM NOXN3
   ),
   OXDGK AS (
       SELECT DISTINCT
       ism.FV24E AS FJDP5,
       CPMFE.id AS BJUF2,
       ism.M22QN AS M22QN,
       G3YXS.TUV25 AS TUV25,
       G3YXS.ESFVY AS ESFVY,
       YQIF4.id AS QNI57,
       YVHJZ.id AS TDEIU
       FROM
       HDDVB ism
       INNER JOIN YYBCX G3YXS ON G3YXS.id = ism.NZ4MQ
       LEFT JOIN
       WGSDC NHMXW
       ON
       NHMXW.id = ism.PRUV2
       LEFT JOIN
       E2I7U CPMFE
       ON
       CPMFE.ZH72S = NHMXW.NOHHR AND CPMFE.id <> ism.FV24E
       LEFT JOIN
       NOXN3 YQIF4
       ON
           YQIF4.BRQP2 = ism.FV24E
       AND
           YQIF4.FFTBJ = ism.UJ6XY
       LEFT JOIN
       NOXN3 YVHJZ
       ON
           YVHJZ.BRQP2 = ism.UJ6XY
       AND
           YVHJZ.FFTBJ = ism.FV24E
       WHERE
           G3YXS.TUV25 IS NOT NULL
       AND
           (YQIF4.id IS NOT NULL
       OR
           YVHJZ.id IS NOT NULL)
   ),

   HTKBS AS (
       SELECT /*+ JOIN_ORDER(cla, bs, mf, sn) */
           cla.FTQLQ AS T4IBQ,
           sn.id AS BDNYB,
           mf.M22QN AS M22QN
       FROM HGMQ6 mf
       INNER JOIN THNTS bs ON bs.id = mf.GXLUB
       INNER JOIN YK2GW cla ON cla.id = bs.IXUXU
       INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
       WHERE cla.FTQLQ IN ('SQ1')
   ),
   JQHRG AS (
       SELECT
           CASE
                   WHEN MJR3D.QNI57 IS NOT NULL
                       THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.QNI57)
                   WHEN MJR3D.TDEIU IS NOT NULL
                       THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.TDEIU)
           END AS M6T2N,

           aac.BTXC5 AS BTXC5,
           aac.id AS NTOFG,
           sn.id AS LWQ6O,
           MJR3D.TUV25 AS TUV25
           FROM
               OXDGK MJR3D
           INNER JOIN TPXBU aac ON aac.id = MJR3D.M22QN
           LEFT JOIN
           NOXN3 sn
           ON
           (
               QNI57 IS NOT NULL
               AND
               sn.id = MJR3D.QNI57
               AND
               MJR3D.BJUF2 IS NULL
           )
           OR
           (
               QNI57 IS NOT NULL
               AND
               sn.id IN (SELECT JTEHG.id FROM NOXN3 JTEHG WHERE BRQP2 = MJR3D.BJUF2)
               AND
               MJR3D.BJUF2 IS NOT NULL
           )
           OR
           (
               TDEIU IS NOT NULL
               AND
               sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.FJDP5)
               AND
               MJR3D.BJUF2 IS NULL
           )
           OR
           (
               TDEIU IS NOT NULL
               AND
               sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.BJUF2)
               AND
               MJR3D.BJUF2 IS NOT NULL
           )
   ),

   F6BRC AS (
       SELECT
           RSA3Y.T4IBQ AS T4IBQ,
           JMHIE.M6T2N AS M6T2N,
           JMHIE.BTXC5 AS BTXC5,
           JMHIE.TUV25 AS TUV25
       FROM
           (SELECT DISTINCT M6T2N, BTXC5, TUV25 FROM JQHRG) JMHIE
       CROSS JOIN
           (SELECT DISTINCT T4IBQ FROM HTKBS) RSA3Y
   ),

   ZMSPR AS (
       SELECT DISTINCT
           cld.T4IBQ AS T4IBQ,
           P4PJZ.M6T2N AS M6T2N,
           P4PJZ.BTXC5 AS BTXC5,
           P4PJZ.TUV25 AS TUV25
       FROM
           HTKBS cld
       LEFT JOIN
           JQHRG P4PJZ
       ON P4PJZ.LWQ6O = cld.BDNYB AND P4PJZ.NTOFG = cld.M22QN
       WHERE
               P4PJZ.M6T2N IS NOT NULL
   )
SELECT
   fs.T4IBQ AS T4IBQ,
   fs.M6T2N AS M6T2N,
   fs.TUV25 AS TUV25,
   fs.BTXC5 AS YEBDJ
FROM
   F6BRC fs
WHERE
   (fs.T4IBQ, fs.M6T2N, fs.BTXC5, fs.TUV25)
   NOT IN (
       SELECT
           ZMSPR.T4IBQ,
           ZMSPR.M6T2N,
           ZMSPR.BTXC5,
           ZMSPR.TUV25
       FROM
           ZMSPR
   )`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:4!null, M6T2N:5, TUV25:6, YEBDJ:7]\n" +
			" └─ Project\n" +
			"     ├─ columns: [fs.T4IBQ:0!null, fs.M6T2N:1, fs.BTXC5:2, fs.TUV25:3, fs.T4IBQ:0!null as T4IBQ, fs.M6T2N:1 as M6T2N, fs.TUV25:3 as TUV25, fs.BTXC5:2 as YEBDJ]\n" +
			"     └─ AntiJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ TUPLE(fs.T4IBQ:0!null, fs.M6T2N:1, fs.BTXC5:2, fs.TUV25:3)\n" +
			"         │   └─ TUPLE(scalarSubq0.T4IBQ:4!null, scalarSubq0.M6T2N:5, scalarSubq0.BTXC5:6, scalarSubq0.TUV25:7)\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: fs\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [T4IBQ:4!null, M6T2N:5, BTXC5:6, TUV25:7]\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [jmhie.M6T2N:1, jmhie.BTXC5:2, jmhie.TUV25:3, rsa3y.T4IBQ:0!null, rsa3y.T4IBQ:0!null as T4IBQ, jmhie.M6T2N:1 as M6T2N, jmhie.BTXC5:2 as BTXC5, jmhie.TUV25:3 as TUV25]\n" +
			"         │           └─ CrossHashJoin\n" +
			"         │               ├─ SubqueryAlias\n" +
			"         │               │   ├─ name: rsa3y\n" +
			"         │               │   ├─ outerVisibility: false\n" +
			"         │               │   ├─ cacheable: true\n" +
			"         │               │   └─ Distinct\n" +
			"         │               │       └─ Project\n" +
			"         │               │           ├─ columns: [htkbs.T4IBQ:0!null]\n" +
			"         │               │           └─ SubqueryAlias\n" +
			"         │               │               ├─ name: htkbs\n" +
			"         │               │               ├─ outerVisibility: false\n" +
			"         │               │               ├─ cacheable: true\n" +
			"         │               │               └─ Project\n" +
			"         │               │                   ├─ columns: [T4IBQ:61!null, BDNYB:62!null, M22QN:63!null]\n" +
			"         │               │                   └─ Project\n" +
			"         │               │                       ├─ columns: [mf.id:34!null, mf.gxlub:35!null, mf.luevy:36!null, mf.m22qn:37!null, mf.tjpt7:38!null, mf.arn5p:39!null, mf.xosd4:40!null, mf.ide43:41, mf.hmw4h:42, mf.zbt6r:43, mf.fsdy2:44!null, mf.lt7k6:45, mf.sppyd:46, mf.qcgts:47, mf.teuja:48, mf.qqv4m:49, mf.fhcyt:50, bs.id:30!null, bs.nfryn:31!null, bs.ixuxu:32, bs.fhcyt:33, cla.id:0!null, cla.ftqlq:1!null, cla.tuxml:2, cla.paef5:3, cla.rucy4:4, cla.tpnj6:5!null, cla.lbl53:6, cla.nb3qs:7, cla.eo7iv:8, cla.muhjf:9, cla.fm34l:10, cla.ty5rf:11, cla.zhtlh:12, cla.npb7w:13, cla.sx3hh:14, cla.isbnf:15, cla.ya7yb:16, cla.c5ykb:17, cla.qk7kt:18, cla.ffge6:19, cla.fiigj:20, cla.sh3nc:21, cla.ntena:22, cla.m4aub:23, cla.x5air:24, cla.sab6m:25, cla.g5qi5:26, cla.zvqvd:27, cla.ykssu:28, cla.fhcyt:29, sn.id:51!null, sn.brqp2:52!null, sn.fftbj:53!null, sn.a7xo2:54, sn.kbo7r:55!null, sn.ecdkm:56, sn.numk2:57!null, sn.letoe:58!null, sn.ykssu:59, sn.fhcyt:60, cla.ftqlq:1!null as T4IBQ, sn.id:51!null as BDNYB, mf.m22qn:37!null as M22QN]\n" +
			"         │               │                       └─ Filter\n" +
			"         │               │                           ├─ HashIn\n" +
			"         │               │                           │   ├─ cla.ftqlq:1!null\n" +
			"         │               │                           │   └─ TUPLE(SQ1 (longtext))\n" +
			"         │               │                           └─ HashJoin\n" +
			"         │               │                               ├─ Eq\n" +
			"         │               │                               │   ├─ sn.brqp2:52!null\n" +
			"         │               │                               │   └─ mf.luevy:36!null\n" +
			"         │               │                               ├─ HashJoin\n" +
			"         │               │                               │   ├─ Eq\n" +
			"         │               │                               │   │   ├─ bs.id:30!null\n" +
			"         │               │                               │   │   └─ mf.gxlub:35!null\n" +
			"         │               │                               │   ├─ MergeJoin\n" +
			"         │               │                               │   │   ├─ cmp: Eq\n" +
			"         │               │                               │   │   │   ├─ cla.id:0!null\n" +
			"         │               │                               │   │   │   └─ bs.ixuxu:32\n" +
			"         │               │                               │   │   ├─ Filter\n" +
			"         │               │                               │   │   │   ├─ HashIn\n" +
			"         │               │                               │   │   │   │   ├─ cla.ftqlq:1!null\n" +
			"         │               │                               │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"         │               │                               │   │   │   └─ TableAlias(cla)\n" +
			"         │               │                               │   │   │       └─ IndexedTableAccess(YK2GW)\n" +
			"         │               │                               │   │   │           ├─ index: [YK2GW.id]\n" +
			"         │               │                               │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                               │   │   │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"         │               │                               │   │   └─ TableAlias(bs)\n" +
			"         │               │                               │   │       └─ IndexedTableAccess(THNTS)\n" +
			"         │               │                               │   │           ├─ index: [THNTS.IXUXU]\n" +
			"         │               │                               │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                               │   │           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"         │               │                               │   └─ HashLookup\n" +
			"         │               │                               │       ├─ left-key: TUPLE(bs.id:30!null)\n" +
			"         │               │                               │       ├─ right-key: TUPLE(mf.gxlub:1!null)\n" +
			"         │               │                               │       └─ TableAlias(mf)\n" +
			"         │               │                               │           └─ Table\n" +
			"         │               │                               │               ├─ name: HGMQ6\n" +
			"         │               │                               │               └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         │               │                               └─ HashLookup\n" +
			"         │               │                                   ├─ left-key: TUPLE(mf.luevy:36!null)\n" +
			"         │               │                                   ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"         │               │                                   └─ TableAlias(sn)\n" +
			"         │               │                                       └─ Table\n" +
			"         │               │                                           ├─ name: NOXN3\n" +
			"         │               │                                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │               └─ HashLookup\n" +
			"         │                   ├─ left-key: TUPLE()\n" +
			"         │                   ├─ right-key: TUPLE()\n" +
			"         │                   └─ SubqueryAlias\n" +
			"         │                       ├─ name: jmhie\n" +
			"         │                       ├─ outerVisibility: false\n" +
			"         │                       ├─ cacheable: true\n" +
			"         │                       └─ Distinct\n" +
			"         │                           └─ Project\n" +
			"         │                               ├─ columns: [jqhrg.M6T2N:0, jqhrg.BTXC5:1, jqhrg.TUV25:4]\n" +
			"         │                               └─ SubqueryAlias\n" +
			"         │                                   ├─ name: jqhrg\n" +
			"         │                                   ├─ outerVisibility: false\n" +
			"         │                                   ├─ cacheable: true\n" +
			"         │                                   └─ Project\n" +
			"         │                                       ├─ columns: [M6T2N:20, BTXC5:21, NTOFG:22!null, LWQ6O:23!null, TUV25:24]\n" +
			"         │                                       └─ Project\n" +
			"         │                                           ├─ columns: [mjr3d.FJDP5:0!null, mjr3d.BJUF2:1!null, mjr3d.M22QN:2!null, mjr3d.TUV25:3, mjr3d.ESFVY:4!null, mjr3d.QNI57:5!null, mjr3d.TDEIU:6!null, aac.id:7!null, aac.btxc5:8, aac.fhcyt:9, sn.id:10!null, sn.brqp2:11!null, sn.fftbj:12!null, sn.a7xo2:13, sn.kbo7r:14!null, sn.ecdkm:15, sn.numk2:16!null, sn.letoe:17!null, sn.ykssu:18, sn.fhcyt:19, CASE  WHEN NOT\n" +
			"         │                                           │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                           │   THEN Subquery\n" +
			"         │                                           │   ├─ cacheable: false\n" +
			"         │                                           │   └─ Project\n" +
			"         │                                           │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"         │                                           │       └─ Filter\n" +
			"         │                                           │           ├─ Eq\n" +
			"         │                                           │           │   ├─ ei.id:20!null\n" +
			"         │                                           │           │   └─ mjr3d.QNI57:5!null\n" +
			"         │                                           │           └─ SubqueryAlias\n" +
			"         │                                           │               ├─ name: ei\n" +
			"         │                                           │               ├─ outerVisibility: true\n" +
			"         │                                           │               ├─ cacheable: true\n" +
			"         │                                           │               └─ Project\n" +
			"         │                                           │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"         │                                           │                   └─ Project\n" +
			"         │                                           │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"         │                                           │                       └─ Window\n" +
			"         │                                           │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"         │                                           │                           ├─ noxn3.id:20!null\n" +
			"         │                                           │                           └─ Table\n" +
			"         │                                           │                               ├─ name: NOXN3\n" +
			"         │                                           │                               └─ columns: [id]\n" +
			"         │                                           │   WHEN NOT\n" +
			"         │                                           │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                           │   THEN Subquery\n" +
			"         │                                           │   ├─ cacheable: false\n" +
			"         │                                           │   └─ Project\n" +
			"         │                                           │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"         │                                           │       └─ Filter\n" +
			"         │                                           │           ├─ Eq\n" +
			"         │                                           │           │   ├─ ei.id:20!null\n" +
			"         │                                           │           │   └─ mjr3d.TDEIU:6!null\n" +
			"         │                                           │           └─ SubqueryAlias\n" +
			"         │                                           │               ├─ name: ei\n" +
			"         │                                           │               ├─ outerVisibility: true\n" +
			"         │                                           │               ├─ cacheable: true\n" +
			"         │                                           │               └─ Project\n" +
			"         │                                           │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"         │                                           │                   └─ Project\n" +
			"         │                                           │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"         │                                           │                       └─ Window\n" +
			"         │                                           │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"         │                                           │                           ├─ noxn3.id:20!null\n" +
			"         │                                           │                           └─ Table\n" +
			"         │                                           │                               ├─ name: NOXN3\n" +
			"         │                                           │                               └─ columns: [id]\n" +
			"         │                                           │   END as M6T2N, aac.btxc5:8 as BTXC5, aac.id:7!null as NTOFG, sn.id:10!null as LWQ6O, mjr3d.TUV25:3 as TUV25]\n" +
			"         │                                           └─ LeftOuterJoin\n" +
			"         │                                               ├─ Or\n" +
			"         │                                               │   ├─ Or\n" +
			"         │                                               │   │   ├─ Or\n" +
			"         │                                               │   │   │   ├─ AND\n" +
			"         │                                               │   │   │   │   ├─ AND\n" +
			"         │                                               │   │   │   │   │   ├─ NOT\n" +
			"         │                                               │   │   │   │   │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                               │   │   │   │   │   └─ Eq\n" +
			"         │                                               │   │   │   │   │       ├─ sn.id:10!null\n" +
			"         │                                               │   │   │   │   │       └─ mjr3d.QNI57:5!null\n" +
			"         │                                               │   │   │   │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   │   │   └─ AND\n" +
			"         │                                               │   │   │       ├─ AND\n" +
			"         │                                               │   │   │       │   ├─ NOT\n" +
			"         │                                               │   │   │       │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                               │   │   │       │   └─ InSubquery\n" +
			"         │                                               │   │   │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │   │   │       │       └─ right: Subquery\n" +
			"         │                                               │   │   │       │           ├─ cacheable: false\n" +
			"         │                                               │   │   │       │           └─ Project\n" +
			"         │                                               │   │   │       │               ├─ columns: [jtehg.id:20!null]\n" +
			"         │                                               │   │   │       │               └─ Filter\n" +
			"         │                                               │   │   │       │                   ├─ Eq\n" +
			"         │                                               │   │   │       │                   │   ├─ jtehg.brqp2:21!null\n" +
			"         │                                               │   │   │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"         │                                               │   │   │       │                   └─ TableAlias(jtehg)\n" +
			"         │                                               │   │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │   │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │   │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │   │       └─ NOT\n" +
			"         │                                               │   │   │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   │   └─ AND\n" +
			"         │                                               │   │       ├─ AND\n" +
			"         │                                               │   │       │   ├─ NOT\n" +
			"         │                                               │   │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                               │   │       │   └─ InSubquery\n" +
			"         │                                               │   │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │   │       │       └─ right: Subquery\n" +
			"         │                                               │   │       │           ├─ cacheable: false\n" +
			"         │                                               │   │       │           └─ Project\n" +
			"         │                                               │   │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"         │                                               │   │       │               └─ Filter\n" +
			"         │                                               │   │       │                   ├─ Eq\n" +
			"         │                                               │   │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"         │                                               │   │       │                   │   └─ mjr3d.FJDP5:0!null\n" +
			"         │                                               │   │       │                   └─ TableAlias(xmafz)\n" +
			"         │                                               │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   └─ AND\n" +
			"         │                                               │       ├─ AND\n" +
			"         │                                               │       │   ├─ NOT\n" +
			"         │                                               │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                               │       │   └─ InSubquery\n" +
			"         │                                               │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │       │       └─ right: Subquery\n" +
			"         │                                               │       │           ├─ cacheable: false\n" +
			"         │                                               │       │           └─ Project\n" +
			"         │                                               │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"         │                                               │       │               └─ Filter\n" +
			"         │                                               │       │                   ├─ Eq\n" +
			"         │                                               │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"         │                                               │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"         │                                               │       │                   └─ TableAlias(xmafz)\n" +
			"         │                                               │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │       └─ NOT\n" +
			"         │                                               │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               ├─ LookupJoin\n" +
			"         │                                               │   ├─ Eq\n" +
			"         │                                               │   │   ├─ aac.id:7!null\n" +
			"         │                                               │   │   └─ mjr3d.M22QN:2!null\n" +
			"         │                                               │   ├─ SubqueryAlias\n" +
			"         │                                               │   │   ├─ name: mjr3d\n" +
			"         │                                               │   │   ├─ outerVisibility: false\n" +
			"         │                                               │   │   ├─ cacheable: true\n" +
			"         │                                               │   │   └─ Distinct\n" +
			"         │                                               │   │       └─ Project\n" +
			"         │                                               │   │           ├─ columns: [FJDP5:64!null, BJUF2:65!null, M22QN:66!null, TUV25:67, ESFVY:68!null, QNI57:69!null, TDEIU:70!null]\n" +
			"         │                                               │   │           └─ Project\n" +
			"         │                                               │   │               ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, ism.m22qn:11!null as M22QN, g3yxs.tuv25:5 as TUV25, g3yxs.esfvy:1!null as ESFVY, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"         │                                               │   │               └─ Filter\n" +
			"         │                                               │   │                   ├─ AND\n" +
			"         │                                               │   │                   │   ├─ NOT\n" +
			"         │                                               │   │                   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"         │                                               │   │                   │   └─ Or\n" +
			"         │                                               │   │                   │       ├─ NOT\n" +
			"         │                                               │   │                   │       │   └─ yqif4.id:44!null IS NULL\n" +
			"         │                                               │   │                   │       └─ NOT\n" +
			"         │                                               │   │                   │           └─ yvhjz.id:54!null IS NULL\n" +
			"         │                                               │   │                   └─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       ├─ AND\n" +
			"         │                                               │   │                       │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   ├─ yvhjz.brqp2:55!null\n" +
			"         │                                               │   │                       │   │   └─ ism.uj6xy:10!null\n" +
			"         │                                               │   │                       │   └─ Eq\n" +
			"         │                                               │   │                       │       ├─ yvhjz.fftbj:56!null\n" +
			"         │                                               │   │                       │       └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       ├─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       │   ├─ AND\n" +
			"         │                                               │   │                       │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"         │                                               │   │                       │   │   │   └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       │   │   └─ Eq\n" +
			"         │                                               │   │                       │   │       ├─ yqif4.fftbj:46!null\n" +
			"         │                                               │   │                       │   │       └─ ism.uj6xy:10!null\n" +
			"         │                                               │   │                       │   ├─ LeftOuterLookupJoin\n" +
			"         │                                               │   │                       │   │   ├─ AND\n" +
			"         │                                               │   │                       │   │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"         │                                               │   │                       │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"         │                                               │   │                       │   │   │   └─ NOT\n" +
			"         │                                               │   │                       │   │   │       └─ Eq\n" +
			"         │                                               │   │                       │   │   │           ├─ cpmfe.id:27!null\n" +
			"         │                                               │   │                       │   │   │           └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       │   │   ├─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       │   │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"         │                                               │   │                       │   │   │   │   └─ ism.pruv2:14\n" +
			"         │                                               │   │                       │   │   │   ├─ MergeJoin\n" +
			"         │                                               │   │                       │   │   │   │   ├─ cmp: Eq\n" +
			"         │                                               │   │                       │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"         │                                               │   │                       │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"         │                                               │   │                       │   │   │   │   ├─ Filter\n" +
			"         │                                               │   │                       │   │   │   │   │   ├─ NOT\n" +
			"         │                                               │   │                       │   │   │   │   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"         │                                               │   │                       │   │   │   │   │   └─ TableAlias(g3yxs)\n" +
			"         │                                               │   │                       │   │   │   │   │       └─ IndexedTableAccess(YYBCX)\n" +
			"         │                                               │   │                       │   │   │   │   │           ├─ index: [YYBCX.id]\n" +
			"         │                                               │   │                       │   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                                               │   │                       │   │   │   │   │           └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   │   │   └─ TableAlias(ism)\n" +
			"         │                                               │   │                       │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"         │                                               │   │                       │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"         │                                               │   │                       │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                                               │   │                       │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   │   └─ HashLookup\n" +
			"         │                                               │   │                       │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"         │                                               │   │                       │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"         │                                               │   │                       │   │   │       └─ TableAlias(nhmxw)\n" +
			"         │                                               │   │                       │   │   │           └─ Table\n" +
			"         │                                               │   │                       │   │   │               ├─ name: WGSDC\n" +
			"         │                                               │   │                       │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   └─ TableAlias(cpmfe)\n" +
			"         │                                               │   │                       │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"         │                                               │   │                       │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"         │                                               │   │                       │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │                                               │   │                       │   └─ HashLookup\n" +
			"         │                                               │   │                       │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"         │                                               │   │                       │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"         │                                               │   │                       │       └─ TableAlias(yqif4)\n" +
			"         │                                               │   │                       │           └─ Table\n" +
			"         │                                               │   │                       │               ├─ name: NOXN3\n" +
			"         │                                               │   │                       │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │                       └─ HashLookup\n" +
			"         │                                               │   │                           ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"         │                                               │   │                           ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"         │                                               │   │                           └─ TableAlias(yvhjz)\n" +
			"         │                                               │   │                               └─ Table\n" +
			"         │                                               │   │                                   ├─ name: NOXN3\n" +
			"         │                                               │   │                                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   └─ TableAlias(aac)\n" +
			"         │                                               │       └─ IndexedTableAccess(TPXBU)\n" +
			"         │                                               │           ├─ index: [TPXBU.id]\n" +
			"         │                                               │           └─ columns: [id btxc5 fhcyt]\n" +
			"         │                                               └─ TableAlias(sn)\n" +
			"         │                                                   └─ Table\n" +
			"         │                                                       ├─ name: NOXN3\n" +
			"         │                                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: scalarSubq0\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: zmspr\n" +
			"                 ├─ outerVisibility: true\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Distinct\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [T4IBQ:8!null, M6T2N:9, BTXC5:10, TUV25:11]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [cld.T4IBQ:0!null, cld.BDNYB:1!null, cld.M22QN:2!null, p4pjz.M6T2N:3, p4pjz.BTXC5:4, p4pjz.NTOFG:5!null, p4pjz.LWQ6O:6!null, p4pjz.TUV25:7, cld.T4IBQ:0!null as T4IBQ, p4pjz.M6T2N:3 as M6T2N, p4pjz.BTXC5:4 as BTXC5, p4pjz.TUV25:7 as TUV25]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ NOT\n" +
			"                                 │   └─ p4pjz.M6T2N:3 IS NULL\n" +
			"                                 └─ LeftOuterHashJoin\n" +
			"                                     ├─ AND\n" +
			"                                     │   ├─ Eq\n" +
			"                                     │   │   ├─ p4pjz.LWQ6O:6!null\n" +
			"                                     │   │   └─ cld.BDNYB:1!null\n" +
			"                                     │   └─ Eq\n" +
			"                                     │       ├─ p4pjz.NTOFG:5!null\n" +
			"                                     │       └─ cld.M22QN:2!null\n" +
			"                                     ├─ SubqueryAlias\n" +
			"                                     │   ├─ name: cld\n" +
			"                                     │   ├─ outerVisibility: false\n" +
			"                                     │   ├─ cacheable: true\n" +
			"                                     │   └─ Project\n" +
			"                                     │       ├─ columns: [T4IBQ:61!null, BDNYB:62!null, M22QN:63!null]\n" +
			"                                     │       └─ Project\n" +
			"                                     │           ├─ columns: [mf.id:34!null, mf.gxlub:35!null, mf.luevy:36!null, mf.m22qn:37!null, mf.tjpt7:38!null, mf.arn5p:39!null, mf.xosd4:40!null, mf.ide43:41, mf.hmw4h:42, mf.zbt6r:43, mf.fsdy2:44!null, mf.lt7k6:45, mf.sppyd:46, mf.qcgts:47, mf.teuja:48, mf.qqv4m:49, mf.fhcyt:50, bs.id:30!null, bs.nfryn:31!null, bs.ixuxu:32, bs.fhcyt:33, cla.id:0!null, cla.ftqlq:1!null, cla.tuxml:2, cla.paef5:3, cla.rucy4:4, cla.tpnj6:5!null, cla.lbl53:6, cla.nb3qs:7, cla.eo7iv:8, cla.muhjf:9, cla.fm34l:10, cla.ty5rf:11, cla.zhtlh:12, cla.npb7w:13, cla.sx3hh:14, cla.isbnf:15, cla.ya7yb:16, cla.c5ykb:17, cla.qk7kt:18, cla.ffge6:19, cla.fiigj:20, cla.sh3nc:21, cla.ntena:22, cla.m4aub:23, cla.x5air:24, cla.sab6m:25, cla.g5qi5:26, cla.zvqvd:27, cla.ykssu:28, cla.fhcyt:29, sn.id:51!null, sn.brqp2:52!null, sn.fftbj:53!null, sn.a7xo2:54, sn.kbo7r:55!null, sn.ecdkm:56, sn.numk2:57!null, sn.letoe:58!null, sn.ykssu:59, sn.fhcyt:60, cla.ftqlq:1!null as T4IBQ, sn.id:51!null as BDNYB, mf.m22qn:37!null as M22QN]\n" +
			"                                     │           └─ Filter\n" +
			"                                     │               ├─ HashIn\n" +
			"                                     │               │   ├─ cla.ftqlq:1!null\n" +
			"                                     │               │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │               └─ HashJoin\n" +
			"                                     │                   ├─ Eq\n" +
			"                                     │                   │   ├─ sn.brqp2:52!null\n" +
			"                                     │                   │   └─ mf.luevy:36!null\n" +
			"                                     │                   ├─ HashJoin\n" +
			"                                     │                   │   ├─ Eq\n" +
			"                                     │                   │   │   ├─ bs.id:30!null\n" +
			"                                     │                   │   │   └─ mf.gxlub:35!null\n" +
			"                                     │                   │   ├─ MergeJoin\n" +
			"                                     │                   │   │   ├─ cmp: Eq\n" +
			"                                     │                   │   │   │   ├─ cla.id:0!null\n" +
			"                                     │                   │   │   │   └─ bs.ixuxu:32\n" +
			"                                     │                   │   │   ├─ Filter\n" +
			"                                     │                   │   │   │   ├─ HashIn\n" +
			"                                     │                   │   │   │   │   ├─ cla.ftqlq:1!null\n" +
			"                                     │                   │   │   │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │                   │   │   │   └─ TableAlias(cla)\n" +
			"                                     │                   │   │   │       └─ IndexedTableAccess(YK2GW)\n" +
			"                                     │                   │   │   │           ├─ index: [YK2GW.id]\n" +
			"                                     │                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │   │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                     │                   │   │   └─ TableAlias(bs)\n" +
			"                                     │                   │   │       └─ IndexedTableAccess(THNTS)\n" +
			"                                     │                   │   │           ├─ index: [THNTS.IXUXU]\n" +
			"                                     │                   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                     │                   │   └─ HashLookup\n" +
			"                                     │                   │       ├─ left-key: TUPLE(bs.id:30!null)\n" +
			"                                     │                   │       ├─ right-key: TUPLE(mf.gxlub:1!null)\n" +
			"                                     │                   │       └─ TableAlias(mf)\n" +
			"                                     │                   │           └─ Table\n" +
			"                                     │                   │               ├─ name: HGMQ6\n" +
			"                                     │                   │               └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                                     │                   └─ HashLookup\n" +
			"                                     │                       ├─ left-key: TUPLE(mf.luevy:36!null)\n" +
			"                                     │                       ├─ right-key: TUPLE(sn.brqp2:1!null)\n" +
			"                                     │                       └─ TableAlias(sn)\n" +
			"                                     │                           └─ Table\n" +
			"                                     │                               ├─ name: NOXN3\n" +
			"                                     │                               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                     └─ HashLookup\n" +
			"                                         ├─ left-key: TUPLE(cld.BDNYB:1!null, cld.M22QN:2!null)\n" +
			"                                         ├─ right-key: TUPLE(p4pjz.LWQ6O:3!null, p4pjz.NTOFG:2!null)\n" +
			"                                         └─ SubqueryAlias\n" +
			"                                             ├─ name: p4pjz\n" +
			"                                             ├─ outerVisibility: false\n" +
			"                                             ├─ cacheable: true\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [M6T2N:20, BTXC5:21, NTOFG:22!null, LWQ6O:23!null, TUV25:24]\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [mjr3d.FJDP5:0!null, mjr3d.BJUF2:1!null, mjr3d.M22QN:2!null, mjr3d.TUV25:3, mjr3d.ESFVY:4!null, mjr3d.QNI57:5!null, mjr3d.TDEIU:6!null, aac.id:7!null, aac.btxc5:8, aac.fhcyt:9, sn.id:10!null, sn.brqp2:11!null, sn.fftbj:12!null, sn.a7xo2:13, sn.kbo7r:14!null, sn.ecdkm:15, sn.numk2:16!null, sn.letoe:17!null, sn.ykssu:18, sn.fhcyt:19, CASE  WHEN NOT\n" +
			"                                                     │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                     │   THEN Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"                                                     │       └─ Filter\n" +
			"                                                     │           ├─ Eq\n" +
			"                                                     │           │   ├─ ei.id:20!null\n" +
			"                                                     │           │   └─ mjr3d.QNI57:5!null\n" +
			"                                                     │           └─ SubqueryAlias\n" +
			"                                                     │               ├─ name: ei\n" +
			"                                                     │               ├─ outerVisibility: true\n" +
			"                                                     │               ├─ cacheable: true\n" +
			"                                                     │               └─ Project\n" +
			"                                                     │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"                                                     │                   └─ Project\n" +
			"                                                     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"                                                     │                       └─ Window\n" +
			"                                                     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                                                     │                           ├─ noxn3.id:20!null\n" +
			"                                                     │                           └─ Table\n" +
			"                                                     │                               ├─ name: NOXN3\n" +
			"                                                     │                               └─ columns: [id]\n" +
			"                                                     │   WHEN NOT\n" +
			"                                                     │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                     │   THEN Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"                                                     │       └─ Filter\n" +
			"                                                     │           ├─ Eq\n" +
			"                                                     │           │   ├─ ei.id:20!null\n" +
			"                                                     │           │   └─ mjr3d.TDEIU:6!null\n" +
			"                                                     │           └─ SubqueryAlias\n" +
			"                                                     │               ├─ name: ei\n" +
			"                                                     │               ├─ outerVisibility: true\n" +
			"                                                     │               ├─ cacheable: true\n" +
			"                                                     │               └─ Project\n" +
			"                                                     │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"                                                     │                   └─ Project\n" +
			"                                                     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"                                                     │                       └─ Window\n" +
			"                                                     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                                                     │                           ├─ noxn3.id:20!null\n" +
			"                                                     │                           └─ Table\n" +
			"                                                     │                               ├─ name: NOXN3\n" +
			"                                                     │                               └─ columns: [id]\n" +
			"                                                     │   END as M6T2N, aac.btxc5:8 as BTXC5, aac.id:7!null as NTOFG, sn.id:10!null as LWQ6O, mjr3d.TUV25:3 as TUV25]\n" +
			"                                                     └─ LeftOuterJoin\n" +
			"                                                         ├─ Or\n" +
			"                                                         │   ├─ Or\n" +
			"                                                         │   │   ├─ Or\n" +
			"                                                         │   │   │   ├─ AND\n" +
			"                                                         │   │   │   │   ├─ AND\n" +
			"                                                         │   │   │   │   │   ├─ NOT\n" +
			"                                                         │   │   │   │   │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                         │   │   │   │   │   └─ Eq\n" +
			"                                                         │   │   │   │   │       ├─ sn.id:10!null\n" +
			"                                                         │   │   │   │   │       └─ mjr3d.QNI57:5!null\n" +
			"                                                         │   │   │   │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   │   │   └─ AND\n" +
			"                                                         │   │   │       ├─ AND\n" +
			"                                                         │   │   │       │   ├─ NOT\n" +
			"                                                         │   │   │       │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                         │   │   │       │   └─ InSubquery\n" +
			"                                                         │   │   │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │   │   │       │       └─ right: Subquery\n" +
			"                                                         │   │   │       │           ├─ cacheable: false\n" +
			"                                                         │   │   │       │           └─ Project\n" +
			"                                                         │   │   │       │               ├─ columns: [jtehg.id:20!null]\n" +
			"                                                         │   │   │       │               └─ Filter\n" +
			"                                                         │   │   │       │                   ├─ Eq\n" +
			"                                                         │   │   │       │                   │   ├─ jtehg.brqp2:21!null\n" +
			"                                                         │   │   │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"                                                         │   │   │       │                   └─ TableAlias(jtehg)\n" +
			"                                                         │   │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │   │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │   │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │   │       └─ NOT\n" +
			"                                                         │   │   │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   │   └─ AND\n" +
			"                                                         │   │       ├─ AND\n" +
			"                                                         │   │       │   ├─ NOT\n" +
			"                                                         │   │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                         │   │       │   └─ InSubquery\n" +
			"                                                         │   │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │   │       │       └─ right: Subquery\n" +
			"                                                         │   │       │           ├─ cacheable: false\n" +
			"                                                         │   │       │           └─ Project\n" +
			"                                                         │   │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"                                                         │   │       │               └─ Filter\n" +
			"                                                         │   │       │                   ├─ Eq\n" +
			"                                                         │   │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"                                                         │   │       │                   │   └─ mjr3d.FJDP5:0!null\n" +
			"                                                         │   │       │                   └─ TableAlias(xmafz)\n" +
			"                                                         │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   └─ AND\n" +
			"                                                         │       ├─ AND\n" +
			"                                                         │       │   ├─ NOT\n" +
			"                                                         │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                         │       │   └─ InSubquery\n" +
			"                                                         │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │       │       └─ right: Subquery\n" +
			"                                                         │       │           ├─ cacheable: false\n" +
			"                                                         │       │           └─ Project\n" +
			"                                                         │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"                                                         │       │               └─ Filter\n" +
			"                                                         │       │                   ├─ Eq\n" +
			"                                                         │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"                                                         │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"                                                         │       │                   └─ TableAlias(xmafz)\n" +
			"                                                         │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │       └─ NOT\n" +
			"                                                         │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         ├─ LookupJoin\n" +
			"                                                         │   ├─ Eq\n" +
			"                                                         │   │   ├─ aac.id:7!null\n" +
			"                                                         │   │   └─ mjr3d.M22QN:2!null\n" +
			"                                                         │   ├─ SubqueryAlias\n" +
			"                                                         │   │   ├─ name: mjr3d\n" +
			"                                                         │   │   ├─ outerVisibility: false\n" +
			"                                                         │   │   ├─ cacheable: true\n" +
			"                                                         │   │   └─ Distinct\n" +
			"                                                         │   │       └─ Project\n" +
			"                                                         │   │           ├─ columns: [FJDP5:64!null, BJUF2:65!null, M22QN:66!null, TUV25:67, ESFVY:68!null, QNI57:69!null, TDEIU:70!null]\n" +
			"                                                         │   │           └─ Project\n" +
			"                                                         │   │               ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, ism.m22qn:11!null as M22QN, g3yxs.tuv25:5 as TUV25, g3yxs.esfvy:1!null as ESFVY, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"                                                         │   │               └─ Filter\n" +
			"                                                         │   │                   ├─ AND\n" +
			"                                                         │   │                   │   ├─ NOT\n" +
			"                                                         │   │                   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"                                                         │   │                   │   └─ Or\n" +
			"                                                         │   │                   │       ├─ NOT\n" +
			"                                                         │   │                   │       │   └─ yqif4.id:44!null IS NULL\n" +
			"                                                         │   │                   │       └─ NOT\n" +
			"                                                         │   │                   │           └─ yvhjz.id:54!null IS NULL\n" +
			"                                                         │   │                   └─ LeftOuterHashJoin\n" +
			"                                                         │   │                       ├─ AND\n" +
			"                                                         │   │                       │   ├─ Eq\n" +
			"                                                         │   │                       │   │   ├─ yvhjz.brqp2:55!null\n" +
			"                                                         │   │                       │   │   └─ ism.uj6xy:10!null\n" +
			"                                                         │   │                       │   └─ Eq\n" +
			"                                                         │   │                       │       ├─ yvhjz.fftbj:56!null\n" +
			"                                                         │   │                       │       └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       ├─ LeftOuterHashJoin\n" +
			"                                                         │   │                       │   ├─ AND\n" +
			"                                                         │   │                       │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"                                                         │   │                       │   │   │   └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       │   │   └─ Eq\n" +
			"                                                         │   │                       │   │       ├─ yqif4.fftbj:46!null\n" +
			"                                                         │   │                       │   │       └─ ism.uj6xy:10!null\n" +
			"                                                         │   │                       │   ├─ LeftOuterLookupJoin\n" +
			"                                                         │   │                       │   │   ├─ AND\n" +
			"                                                         │   │                       │   │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"                                                         │   │                       │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"                                                         │   │                       │   │   │   └─ NOT\n" +
			"                                                         │   │                       │   │   │       └─ Eq\n" +
			"                                                         │   │                       │   │   │           ├─ cpmfe.id:27!null\n" +
			"                                                         │   │                       │   │   │           └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       │   │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │                       │   │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"                                                         │   │                       │   │   │   │   └─ ism.pruv2:14\n" +
			"                                                         │   │                       │   │   │   ├─ MergeJoin\n" +
			"                                                         │   │                       │   │   │   │   ├─ cmp: Eq\n" +
			"                                                         │   │                       │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"                                                         │   │                       │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"                                                         │   │                       │   │   │   │   ├─ Filter\n" +
			"                                                         │   │                       │   │   │   │   │   ├─ NOT\n" +
			"                                                         │   │                       │   │   │   │   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"                                                         │   │                       │   │   │   │   │   └─ TableAlias(g3yxs)\n" +
			"                                                         │   │                       │   │   │   │   │       └─ IndexedTableAccess(YYBCX)\n" +
			"                                                         │   │                       │   │   │   │   │           ├─ index: [YYBCX.id]\n" +
			"                                                         │   │                       │   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │                       │   │   │   │   │           └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   │   │   └─ TableAlias(ism)\n" +
			"                                                         │   │                       │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"                                                         │   │                       │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"                                                         │   │                       │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │                       │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   │   └─ HashLookup\n" +
			"                                                         │   │                       │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"                                                         │   │                       │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"                                                         │   │                       │   │   │       └─ TableAlias(nhmxw)\n" +
			"                                                         │   │                       │   │   │           └─ Table\n" +
			"                                                         │   │                       │   │   │               ├─ name: WGSDC\n" +
			"                                                         │   │                       │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   └─ TableAlias(cpmfe)\n" +
			"                                                         │   │                       │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │   │                       │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"                                                         │   │                       │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │   │                       │   └─ HashLookup\n" +
			"                                                         │   │                       │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"                                                         │   │                       │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"                                                         │   │                       │       └─ TableAlias(yqif4)\n" +
			"                                                         │   │                       │           └─ Table\n" +
			"                                                         │   │                       │               ├─ name: NOXN3\n" +
			"                                                         │   │                       │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │                       └─ HashLookup\n" +
			"                                                         │   │                           ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"                                                         │   │                           ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"                                                         │   │                           └─ TableAlias(yvhjz)\n" +
			"                                                         │   │                               └─ Table\n" +
			"                                                         │   │                                   ├─ name: NOXN3\n" +
			"                                                         │   │                                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   └─ TableAlias(aac)\n" +
			"                                                         │       └─ IndexedTableAccess(TPXBU)\n" +
			"                                                         │           ├─ index: [TPXBU.id]\n" +
			"                                                         │           └─ columns: [id btxc5 fhcyt]\n" +
			"                                                         └─ TableAlias(sn)\n" +
			"                                                             └─ Table\n" +
			"                                                                 ├─ name: NOXN3\n" +
			"                                                                 └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
WITH

   FZFVD AS (
       SELECT id, ROW_NUMBER() OVER (ORDER BY id ASC) - 1 AS M6T2N FROM NOXN3
   ),
   OXDGK AS (
       SELECT DISTINCT
       ism.FV24E AS FJDP5,
       CPMFE.id AS BJUF2,
       ism.M22QN AS M22QN,
       G3YXS.TUV25 AS TUV25,
       G3YXS.ESFVY AS ESFVY,
       YQIF4.id AS QNI57,
       YVHJZ.id AS TDEIU
       FROM
       HDDVB ism
       INNER JOIN YYBCX G3YXS ON G3YXS.id = ism.NZ4MQ
       LEFT JOIN
       WGSDC NHMXW
       ON
       NHMXW.id = ism.PRUV2
       LEFT JOIN
       E2I7U CPMFE
       ON
       CPMFE.ZH72S = NHMXW.NOHHR AND CPMFE.id <> ism.FV24E
       LEFT JOIN
       NOXN3 YQIF4
       ON
           YQIF4.BRQP2 = ism.FV24E
       AND
           YQIF4.FFTBJ = ism.UJ6XY
       LEFT JOIN
       NOXN3 YVHJZ
       ON
           YVHJZ.BRQP2 = ism.UJ6XY
       AND
           YVHJZ.FFTBJ = ism.FV24E
       WHERE
           G3YXS.TUV25 IS NOT NULL
       AND
           (YQIF4.id IS NOT NULL
       OR
           YVHJZ.id IS NOT NULL)
   ),

   HTKBS AS (
       SELECT
           cla.FTQLQ AS T4IBQ,
           sn.id AS BDNYB,
           mf.M22QN AS M22QN
       FROM HGMQ6 mf
       INNER JOIN THNTS bs ON bs.id = mf.GXLUB
       INNER JOIN YK2GW cla ON cla.id = bs.IXUXU
       INNER JOIN NOXN3 sn ON sn.BRQP2 = mf.LUEVY
       WHERE cla.FTQLQ IN ('SQ1')
   ),
   JQHRG AS (
       SELECT
           CASE
                   WHEN MJR3D.QNI57 IS NOT NULL
                       THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.QNI57)
                   WHEN MJR3D.TDEIU IS NOT NULL
                       THEN (SELECT ei.M6T2N FROM FZFVD ei WHERE ei.id = MJR3D.TDEIU)
           END AS M6T2N,

           aac.BTXC5 AS BTXC5,
           aac.id AS NTOFG,
           sn.id AS LWQ6O,
           MJR3D.TUV25 AS TUV25
           FROM
               OXDGK MJR3D
           INNER JOIN TPXBU aac ON aac.id = MJR3D.M22QN
           LEFT JOIN
           NOXN3 sn
           ON
           (
               QNI57 IS NOT NULL
               AND
               sn.id = MJR3D.QNI57
               AND
               MJR3D.BJUF2 IS NULL
           )
           OR
           (
               QNI57 IS NOT NULL
               AND
               sn.id IN (SELECT JTEHG.id FROM NOXN3 JTEHG WHERE BRQP2 = MJR3D.BJUF2)
               AND
               MJR3D.BJUF2 IS NOT NULL
           )
           OR
           (
               TDEIU IS NOT NULL
               AND
               sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.FJDP5)
               AND
               MJR3D.BJUF2 IS NULL
           )
           OR
           (
               TDEIU IS NOT NULL
               AND
               sn.id IN (SELECT XMAFZ.id FROM NOXN3 XMAFZ WHERE BRQP2 = MJR3D.BJUF2)
               AND
               MJR3D.BJUF2 IS NOT NULL
           )
   ),

   F6BRC AS (
       SELECT
           RSA3Y.T4IBQ AS T4IBQ,
           JMHIE.M6T2N AS M6T2N,
           JMHIE.BTXC5 AS BTXC5,
           JMHIE.TUV25 AS TUV25
       FROM
           (SELECT DISTINCT M6T2N, BTXC5, TUV25 FROM JQHRG) JMHIE
       CROSS JOIN
           (SELECT DISTINCT T4IBQ FROM HTKBS) RSA3Y
   ),

   ZMSPR AS (
       SELECT DISTINCT
           cld.T4IBQ AS T4IBQ,
           P4PJZ.M6T2N AS M6T2N,
           P4PJZ.BTXC5 AS BTXC5,
           P4PJZ.TUV25 AS TUV25
       FROM
           HTKBS cld
       LEFT JOIN
           JQHRG P4PJZ
       ON P4PJZ.LWQ6O = cld.BDNYB AND P4PJZ.NTOFG = cld.M22QN
       WHERE
               P4PJZ.M6T2N IS NOT NULL
   )
SELECT
   fs.T4IBQ AS T4IBQ,
   fs.M6T2N AS M6T2N,
   fs.TUV25 AS TUV25,
   fs.BTXC5 AS YEBDJ
FROM
   F6BRC fs
WHERE
   (fs.T4IBQ, fs.M6T2N, fs.BTXC5, fs.TUV25)
   NOT IN (
       SELECT
           ZMSPR.T4IBQ,
           ZMSPR.M6T2N,
           ZMSPR.BTXC5,
           ZMSPR.TUV25
       FROM
           ZMSPR
   )`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [T4IBQ:4!null, M6T2N:5, TUV25:6, YEBDJ:7]\n" +
			" └─ Project\n" +
			"     ├─ columns: [fs.T4IBQ:0!null, fs.M6T2N:1, fs.BTXC5:2, fs.TUV25:3, fs.T4IBQ:0!null as T4IBQ, fs.M6T2N:1 as M6T2N, fs.TUV25:3 as TUV25, fs.BTXC5:2 as YEBDJ]\n" +
			"     └─ AntiJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ TUPLE(fs.T4IBQ:0!null, fs.M6T2N:1, fs.BTXC5:2, fs.TUV25:3)\n" +
			"         │   └─ TUPLE(scalarSubq0.T4IBQ:4!null, scalarSubq0.M6T2N:5, scalarSubq0.BTXC5:6, scalarSubq0.TUV25:7)\n" +
			"         ├─ SubqueryAlias\n" +
			"         │   ├─ name: fs\n" +
			"         │   ├─ outerVisibility: false\n" +
			"         │   ├─ cacheable: true\n" +
			"         │   └─ Project\n" +
			"         │       ├─ columns: [T4IBQ:4!null, M6T2N:5, BTXC5:6, TUV25:7]\n" +
			"         │       └─ Project\n" +
			"         │           ├─ columns: [jmhie.M6T2N:1, jmhie.BTXC5:2, jmhie.TUV25:3, rsa3y.T4IBQ:0!null, rsa3y.T4IBQ:0!null as T4IBQ, jmhie.M6T2N:1 as M6T2N, jmhie.BTXC5:2 as BTXC5, jmhie.TUV25:3 as TUV25]\n" +
			"         │           └─ CrossHashJoin\n" +
			"         │               ├─ SubqueryAlias\n" +
			"         │               │   ├─ name: rsa3y\n" +
			"         │               │   ├─ outerVisibility: false\n" +
			"         │               │   ├─ cacheable: true\n" +
			"         │               │   └─ Distinct\n" +
			"         │               │       └─ Project\n" +
			"         │               │           ├─ columns: [htkbs.T4IBQ:0!null]\n" +
			"         │               │           └─ SubqueryAlias\n" +
			"         │               │               ├─ name: htkbs\n" +
			"         │               │               ├─ outerVisibility: false\n" +
			"         │               │               ├─ cacheable: true\n" +
			"         │               │               └─ Project\n" +
			"         │               │                   ├─ columns: [T4IBQ:61!null, BDNYB:62!null, M22QN:63!null]\n" +
			"         │               │                   └─ Project\n" +
			"         │               │                       ├─ columns: [mf.id:10!null, mf.gxlub:11!null, mf.luevy:12!null, mf.m22qn:13!null, mf.tjpt7:14!null, mf.arn5p:15!null, mf.xosd4:16!null, mf.ide43:17, mf.hmw4h:18, mf.zbt6r:19, mf.fsdy2:20!null, mf.lt7k6:21, mf.sppyd:22, mf.qcgts:23, mf.teuja:24, mf.qqv4m:25, mf.fhcyt:26, bs.id:57!null, bs.nfryn:58!null, bs.ixuxu:59, bs.fhcyt:60, cla.id:27!null, cla.ftqlq:28!null, cla.tuxml:29, cla.paef5:30, cla.rucy4:31, cla.tpnj6:32!null, cla.lbl53:33, cla.nb3qs:34, cla.eo7iv:35, cla.muhjf:36, cla.fm34l:37, cla.ty5rf:38, cla.zhtlh:39, cla.npb7w:40, cla.sx3hh:41, cla.isbnf:42, cla.ya7yb:43, cla.c5ykb:44, cla.qk7kt:45, cla.ffge6:46, cla.fiigj:47, cla.sh3nc:48, cla.ntena:49, cla.m4aub:50, cla.x5air:51, cla.sab6m:52, cla.g5qi5:53, cla.zvqvd:54, cla.ykssu:55, cla.fhcyt:56, sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, cla.ftqlq:28!null as T4IBQ, sn.id:0!null as BDNYB, mf.m22qn:13!null as M22QN]\n" +
			"         │               │                       └─ Filter\n" +
			"         │               │                           ├─ HashIn\n" +
			"         │               │                           │   ├─ cla.ftqlq:28!null\n" +
			"         │               │                           │   └─ TUPLE(SQ1 (longtext))\n" +
			"         │               │                           └─ HashJoin\n" +
			"         │               │                               ├─ Eq\n" +
			"         │               │                               │   ├─ bs.id:57!null\n" +
			"         │               │                               │   └─ mf.gxlub:11!null\n" +
			"         │               │                               ├─ MergeJoin\n" +
			"         │               │                               │   ├─ cmp: Eq\n" +
			"         │               │                               │   │   ├─ sn.brqp2:1!null\n" +
			"         │               │                               │   │   └─ mf.luevy:12!null\n" +
			"         │               │                               │   ├─ TableAlias(sn)\n" +
			"         │               │                               │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"         │               │                               │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"         │               │                               │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                               │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │               │                               │   └─ TableAlias(mf)\n" +
			"         │               │                               │       └─ IndexedTableAccess(HGMQ6)\n" +
			"         │               │                               │           ├─ index: [HGMQ6.LUEVY]\n" +
			"         │               │                               │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                               │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         │               │                               └─ HashLookup\n" +
			"         │               │                                   ├─ left-key: TUPLE(mf.gxlub:11!null)\n" +
			"         │               │                                   ├─ right-key: TUPLE(bs.id:30!null)\n" +
			"         │               │                                   └─ MergeJoin\n" +
			"         │               │                                       ├─ cmp: Eq\n" +
			"         │               │                                       │   ├─ cla.id:27!null\n" +
			"         │               │                                       │   └─ bs.ixuxu:59\n" +
			"         │               │                                       ├─ Filter\n" +
			"         │               │                                       │   ├─ HashIn\n" +
			"         │               │                                       │   │   ├─ cla.ftqlq:1!null\n" +
			"         │               │                                       │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"         │               │                                       │   └─ TableAlias(cla)\n" +
			"         │               │                                       │       └─ IndexedTableAccess(YK2GW)\n" +
			"         │               │                                       │           ├─ index: [YK2GW.id]\n" +
			"         │               │                                       │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                                       │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"         │               │                                       └─ TableAlias(bs)\n" +
			"         │               │                                           └─ IndexedTableAccess(THNTS)\n" +
			"         │               │                                               ├─ index: [THNTS.IXUXU]\n" +
			"         │               │                                               ├─ static: [{[NULL, ∞)}]\n" +
			"         │               │                                               └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"         │               └─ HashLookup\n" +
			"         │                   ├─ left-key: TUPLE()\n" +
			"         │                   ├─ right-key: TUPLE()\n" +
			"         │                   └─ SubqueryAlias\n" +
			"         │                       ├─ name: jmhie\n" +
			"         │                       ├─ outerVisibility: false\n" +
			"         │                       ├─ cacheable: true\n" +
			"         │                       └─ Distinct\n" +
			"         │                           └─ Project\n" +
			"         │                               ├─ columns: [jqhrg.M6T2N:0, jqhrg.BTXC5:1, jqhrg.TUV25:4]\n" +
			"         │                               └─ SubqueryAlias\n" +
			"         │                                   ├─ name: jqhrg\n" +
			"         │                                   ├─ outerVisibility: false\n" +
			"         │                                   ├─ cacheable: true\n" +
			"         │                                   └─ Project\n" +
			"         │                                       ├─ columns: [M6T2N:20, BTXC5:21, NTOFG:22!null, LWQ6O:23!null, TUV25:24]\n" +
			"         │                                       └─ Project\n" +
			"         │                                           ├─ columns: [mjr3d.FJDP5:0!null, mjr3d.BJUF2:1!null, mjr3d.M22QN:2!null, mjr3d.TUV25:3, mjr3d.ESFVY:4!null, mjr3d.QNI57:5!null, mjr3d.TDEIU:6!null, aac.id:7!null, aac.btxc5:8, aac.fhcyt:9, sn.id:10!null, sn.brqp2:11!null, sn.fftbj:12!null, sn.a7xo2:13, sn.kbo7r:14!null, sn.ecdkm:15, sn.numk2:16!null, sn.letoe:17!null, sn.ykssu:18, sn.fhcyt:19, CASE  WHEN NOT\n" +
			"         │                                           │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                           │   THEN Subquery\n" +
			"         │                                           │   ├─ cacheable: false\n" +
			"         │                                           │   └─ Project\n" +
			"         │                                           │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"         │                                           │       └─ Filter\n" +
			"         │                                           │           ├─ Eq\n" +
			"         │                                           │           │   ├─ ei.id:20!null\n" +
			"         │                                           │           │   └─ mjr3d.QNI57:5!null\n" +
			"         │                                           │           └─ SubqueryAlias\n" +
			"         │                                           │               ├─ name: ei\n" +
			"         │                                           │               ├─ outerVisibility: true\n" +
			"         │                                           │               ├─ cacheable: true\n" +
			"         │                                           │               └─ Project\n" +
			"         │                                           │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"         │                                           │                   └─ Project\n" +
			"         │                                           │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"         │                                           │                       └─ Window\n" +
			"         │                                           │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"         │                                           │                           ├─ noxn3.id:20!null\n" +
			"         │                                           │                           └─ Table\n" +
			"         │                                           │                               ├─ name: NOXN3\n" +
			"         │                                           │                               └─ columns: [id]\n" +
			"         │                                           │   WHEN NOT\n" +
			"         │                                           │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                           │   THEN Subquery\n" +
			"         │                                           │   ├─ cacheable: false\n" +
			"         │                                           │   └─ Project\n" +
			"         │                                           │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"         │                                           │       └─ Filter\n" +
			"         │                                           │           ├─ Eq\n" +
			"         │                                           │           │   ├─ ei.id:20!null\n" +
			"         │                                           │           │   └─ mjr3d.TDEIU:6!null\n" +
			"         │                                           │           └─ SubqueryAlias\n" +
			"         │                                           │               ├─ name: ei\n" +
			"         │                                           │               ├─ outerVisibility: true\n" +
			"         │                                           │               ├─ cacheable: true\n" +
			"         │                                           │               └─ Project\n" +
			"         │                                           │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"         │                                           │                   └─ Project\n" +
			"         │                                           │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"         │                                           │                       └─ Window\n" +
			"         │                                           │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"         │                                           │                           ├─ noxn3.id:20!null\n" +
			"         │                                           │                           └─ Table\n" +
			"         │                                           │                               ├─ name: NOXN3\n" +
			"         │                                           │                               └─ columns: [id]\n" +
			"         │                                           │   END as M6T2N, aac.btxc5:8 as BTXC5, aac.id:7!null as NTOFG, sn.id:10!null as LWQ6O, mjr3d.TUV25:3 as TUV25]\n" +
			"         │                                           └─ LeftOuterJoin\n" +
			"         │                                               ├─ Or\n" +
			"         │                                               │   ├─ Or\n" +
			"         │                                               │   │   ├─ Or\n" +
			"         │                                               │   │   │   ├─ AND\n" +
			"         │                                               │   │   │   │   ├─ AND\n" +
			"         │                                               │   │   │   │   │   ├─ NOT\n" +
			"         │                                               │   │   │   │   │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                               │   │   │   │   │   └─ Eq\n" +
			"         │                                               │   │   │   │   │       ├─ sn.id:10!null\n" +
			"         │                                               │   │   │   │   │       └─ mjr3d.QNI57:5!null\n" +
			"         │                                               │   │   │   │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   │   │   └─ AND\n" +
			"         │                                               │   │   │       ├─ AND\n" +
			"         │                                               │   │   │       │   ├─ NOT\n" +
			"         │                                               │   │   │       │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"         │                                               │   │   │       │   └─ InSubquery\n" +
			"         │                                               │   │   │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │   │   │       │       └─ right: Subquery\n" +
			"         │                                               │   │   │       │           ├─ cacheable: false\n" +
			"         │                                               │   │   │       │           └─ Project\n" +
			"         │                                               │   │   │       │               ├─ columns: [jtehg.id:20!null]\n" +
			"         │                                               │   │   │       │               └─ Filter\n" +
			"         │                                               │   │   │       │                   ├─ Eq\n" +
			"         │                                               │   │   │       │                   │   ├─ jtehg.brqp2:21!null\n" +
			"         │                                               │   │   │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"         │                                               │   │   │       │                   └─ TableAlias(jtehg)\n" +
			"         │                                               │   │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │   │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │   │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │   │       └─ NOT\n" +
			"         │                                               │   │   │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   │   └─ AND\n" +
			"         │                                               │   │       ├─ AND\n" +
			"         │                                               │   │       │   ├─ NOT\n" +
			"         │                                               │   │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                               │   │       │   └─ InSubquery\n" +
			"         │                                               │   │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │   │       │       └─ right: Subquery\n" +
			"         │                                               │   │       │           ├─ cacheable: false\n" +
			"         │                                               │   │       │           └─ Project\n" +
			"         │                                               │   │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"         │                                               │   │       │               └─ Filter\n" +
			"         │                                               │   │       │                   ├─ Eq\n" +
			"         │                                               │   │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"         │                                               │   │       │                   │   └─ mjr3d.FJDP5:0!null\n" +
			"         │                                               │   │       │                   └─ TableAlias(xmafz)\n" +
			"         │                                               │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               │   └─ AND\n" +
			"         │                                               │       ├─ AND\n" +
			"         │                                               │       │   ├─ NOT\n" +
			"         │                                               │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"         │                                               │       │   └─ InSubquery\n" +
			"         │                                               │       │       ├─ left: sn.id:10!null\n" +
			"         │                                               │       │       └─ right: Subquery\n" +
			"         │                                               │       │           ├─ cacheable: false\n" +
			"         │                                               │       │           └─ Project\n" +
			"         │                                               │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"         │                                               │       │               └─ Filter\n" +
			"         │                                               │       │                   ├─ Eq\n" +
			"         │                                               │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"         │                                               │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"         │                                               │       │                   └─ TableAlias(xmafz)\n" +
			"         │                                               │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"         │                                               │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"         │                                               │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │       └─ NOT\n" +
			"         │                                               │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"         │                                               ├─ LookupJoin\n" +
			"         │                                               │   ├─ Eq\n" +
			"         │                                               │   │   ├─ aac.id:7!null\n" +
			"         │                                               │   │   └─ mjr3d.M22QN:2!null\n" +
			"         │                                               │   ├─ SubqueryAlias\n" +
			"         │                                               │   │   ├─ name: mjr3d\n" +
			"         │                                               │   │   ├─ outerVisibility: false\n" +
			"         │                                               │   │   ├─ cacheable: true\n" +
			"         │                                               │   │   └─ Distinct\n" +
			"         │                                               │   │       └─ Project\n" +
			"         │                                               │   │           ├─ columns: [FJDP5:64!null, BJUF2:65!null, M22QN:66!null, TUV25:67, ESFVY:68!null, QNI57:69!null, TDEIU:70!null]\n" +
			"         │                                               │   │           └─ Project\n" +
			"         │                                               │   │               ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, ism.m22qn:11!null as M22QN, g3yxs.tuv25:5 as TUV25, g3yxs.esfvy:1!null as ESFVY, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"         │                                               │   │               └─ Filter\n" +
			"         │                                               │   │                   ├─ AND\n" +
			"         │                                               │   │                   │   ├─ NOT\n" +
			"         │                                               │   │                   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"         │                                               │   │                   │   └─ Or\n" +
			"         │                                               │   │                   │       ├─ NOT\n" +
			"         │                                               │   │                   │       │   └─ yqif4.id:44!null IS NULL\n" +
			"         │                                               │   │                   │       └─ NOT\n" +
			"         │                                               │   │                   │           └─ yvhjz.id:54!null IS NULL\n" +
			"         │                                               │   │                   └─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       ├─ AND\n" +
			"         │                                               │   │                       │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   ├─ yvhjz.brqp2:55!null\n" +
			"         │                                               │   │                       │   │   └─ ism.uj6xy:10!null\n" +
			"         │                                               │   │                       │   └─ Eq\n" +
			"         │                                               │   │                       │       ├─ yvhjz.fftbj:56!null\n" +
			"         │                                               │   │                       │       └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       ├─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       │   ├─ AND\n" +
			"         │                                               │   │                       │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"         │                                               │   │                       │   │   │   └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       │   │   └─ Eq\n" +
			"         │                                               │   │                       │   │       ├─ yqif4.fftbj:46!null\n" +
			"         │                                               │   │                       │   │       └─ ism.uj6xy:10!null\n" +
			"         │                                               │   │                       │   ├─ LeftOuterLookupJoin\n" +
			"         │                                               │   │                       │   │   ├─ AND\n" +
			"         │                                               │   │                       │   │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"         │                                               │   │                       │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"         │                                               │   │                       │   │   │   └─ NOT\n" +
			"         │                                               │   │                       │   │   │       └─ Eq\n" +
			"         │                                               │   │                       │   │   │           ├─ cpmfe.id:27!null\n" +
			"         │                                               │   │                       │   │   │           └─ ism.fv24e:9!null\n" +
			"         │                                               │   │                       │   │   ├─ LeftOuterHashJoin\n" +
			"         │                                               │   │                       │   │   │   ├─ Eq\n" +
			"         │                                               │   │                       │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"         │                                               │   │                       │   │   │   │   └─ ism.pruv2:14\n" +
			"         │                                               │   │                       │   │   │   ├─ MergeJoin\n" +
			"         │                                               │   │                       │   │   │   │   ├─ cmp: Eq\n" +
			"         │                                               │   │                       │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"         │                                               │   │                       │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"         │                                               │   │                       │   │   │   │   ├─ Filter\n" +
			"         │                                               │   │                       │   │   │   │   │   ├─ NOT\n" +
			"         │                                               │   │                       │   │   │   │   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"         │                                               │   │                       │   │   │   │   │   └─ TableAlias(g3yxs)\n" +
			"         │                                               │   │                       │   │   │   │   │       └─ IndexedTableAccess(YYBCX)\n" +
			"         │                                               │   │                       │   │   │   │   │           ├─ index: [YYBCX.id]\n" +
			"         │                                               │   │                       │   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                                               │   │                       │   │   │   │   │           └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   │   │   └─ TableAlias(ism)\n" +
			"         │                                               │   │                       │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"         │                                               │   │                       │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"         │                                               │   │                       │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"         │                                               │   │                       │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   │   └─ HashLookup\n" +
			"         │                                               │   │                       │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"         │                                               │   │                       │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"         │                                               │   │                       │   │   │       └─ TableAlias(nhmxw)\n" +
			"         │                                               │   │                       │   │   │           └─ Table\n" +
			"         │                                               │   │                       │   │   │               ├─ name: WGSDC\n" +
			"         │                                               │   │                       │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"         │                                               │   │                       │   │   └─ TableAlias(cpmfe)\n" +
			"         │                                               │   │                       │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"         │                                               │   │                       │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"         │                                               │   │                       │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"         │                                               │   │                       │   └─ HashLookup\n" +
			"         │                                               │   │                       │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"         │                                               │   │                       │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"         │                                               │   │                       │       └─ TableAlias(yqif4)\n" +
			"         │                                               │   │                       │           └─ Table\n" +
			"         │                                               │   │                       │               ├─ name: NOXN3\n" +
			"         │                                               │   │                       │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   │                       └─ HashLookup\n" +
			"         │                                               │   │                           ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"         │                                               │   │                           ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"         │                                               │   │                           └─ TableAlias(yvhjz)\n" +
			"         │                                               │   │                               └─ Table\n" +
			"         │                                               │   │                                   ├─ name: NOXN3\n" +
			"         │                                               │   │                                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         │                                               │   └─ TableAlias(aac)\n" +
			"         │                                               │       └─ IndexedTableAccess(TPXBU)\n" +
			"         │                                               │           ├─ index: [TPXBU.id]\n" +
			"         │                                               │           └─ columns: [id btxc5 fhcyt]\n" +
			"         │                                               └─ TableAlias(sn)\n" +
			"         │                                                   └─ Table\n" +
			"         │                                                       ├─ name: NOXN3\n" +
			"         │                                                       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"         └─ SubqueryAlias\n" +
			"             ├─ name: scalarSubq0\n" +
			"             ├─ outerVisibility: false\n" +
			"             ├─ cacheable: true\n" +
			"             └─ SubqueryAlias\n" +
			"                 ├─ name: zmspr\n" +
			"                 ├─ outerVisibility: true\n" +
			"                 ├─ cacheable: true\n" +
			"                 └─ Distinct\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [T4IBQ:8!null, M6T2N:9, BTXC5:10, TUV25:11]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [cld.T4IBQ:0!null, cld.BDNYB:1!null, cld.M22QN:2!null, p4pjz.M6T2N:3, p4pjz.BTXC5:4, p4pjz.NTOFG:5!null, p4pjz.LWQ6O:6!null, p4pjz.TUV25:7, cld.T4IBQ:0!null as T4IBQ, p4pjz.M6T2N:3 as M6T2N, p4pjz.BTXC5:4 as BTXC5, p4pjz.TUV25:7 as TUV25]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ NOT\n" +
			"                                 │   └─ p4pjz.M6T2N:3 IS NULL\n" +
			"                                 └─ LeftOuterHashJoin\n" +
			"                                     ├─ AND\n" +
			"                                     │   ├─ Eq\n" +
			"                                     │   │   ├─ p4pjz.LWQ6O:6!null\n" +
			"                                     │   │   └─ cld.BDNYB:1!null\n" +
			"                                     │   └─ Eq\n" +
			"                                     │       ├─ p4pjz.NTOFG:5!null\n" +
			"                                     │       └─ cld.M22QN:2!null\n" +
			"                                     ├─ SubqueryAlias\n" +
			"                                     │   ├─ name: cld\n" +
			"                                     │   ├─ outerVisibility: false\n" +
			"                                     │   ├─ cacheable: true\n" +
			"                                     │   └─ Project\n" +
			"                                     │       ├─ columns: [T4IBQ:61!null, BDNYB:62!null, M22QN:63!null]\n" +
			"                                     │       └─ Project\n" +
			"                                     │           ├─ columns: [mf.id:10!null, mf.gxlub:11!null, mf.luevy:12!null, mf.m22qn:13!null, mf.tjpt7:14!null, mf.arn5p:15!null, mf.xosd4:16!null, mf.ide43:17, mf.hmw4h:18, mf.zbt6r:19, mf.fsdy2:20!null, mf.lt7k6:21, mf.sppyd:22, mf.qcgts:23, mf.teuja:24, mf.qqv4m:25, mf.fhcyt:26, bs.id:57!null, bs.nfryn:58!null, bs.ixuxu:59, bs.fhcyt:60, cla.id:27!null, cla.ftqlq:28!null, cla.tuxml:29, cla.paef5:30, cla.rucy4:31, cla.tpnj6:32!null, cla.lbl53:33, cla.nb3qs:34, cla.eo7iv:35, cla.muhjf:36, cla.fm34l:37, cla.ty5rf:38, cla.zhtlh:39, cla.npb7w:40, cla.sx3hh:41, cla.isbnf:42, cla.ya7yb:43, cla.c5ykb:44, cla.qk7kt:45, cla.ffge6:46, cla.fiigj:47, cla.sh3nc:48, cla.ntena:49, cla.m4aub:50, cla.x5air:51, cla.sab6m:52, cla.g5qi5:53, cla.zvqvd:54, cla.ykssu:55, cla.fhcyt:56, sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, cla.ftqlq:28!null as T4IBQ, sn.id:0!null as BDNYB, mf.m22qn:13!null as M22QN]\n" +
			"                                     │           └─ Filter\n" +
			"                                     │               ├─ HashIn\n" +
			"                                     │               │   ├─ cla.ftqlq:28!null\n" +
			"                                     │               │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │               └─ HashJoin\n" +
			"                                     │                   ├─ Eq\n" +
			"                                     │                   │   ├─ bs.id:57!null\n" +
			"                                     │                   │   └─ mf.gxlub:11!null\n" +
			"                                     │                   ├─ MergeJoin\n" +
			"                                     │                   │   ├─ cmp: Eq\n" +
			"                                     │                   │   │   ├─ sn.brqp2:1!null\n" +
			"                                     │                   │   │   └─ mf.luevy:12!null\n" +
			"                                     │                   │   ├─ TableAlias(sn)\n" +
			"                                     │                   │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"                                     │                   │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"                                     │                   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                     │                   │   └─ TableAlias(mf)\n" +
			"                                     │                   │       └─ IndexedTableAccess(HGMQ6)\n" +
			"                                     │                   │           ├─ index: [HGMQ6.LUEVY]\n" +
			"                                     │                   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                   │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                                     │                   └─ HashLookup\n" +
			"                                     │                       ├─ left-key: TUPLE(mf.gxlub:11!null)\n" +
			"                                     │                       ├─ right-key: TUPLE(bs.id:30!null)\n" +
			"                                     │                       └─ MergeJoin\n" +
			"                                     │                           ├─ cmp: Eq\n" +
			"                                     │                           │   ├─ cla.id:27!null\n" +
			"                                     │                           │   └─ bs.ixuxu:59\n" +
			"                                     │                           ├─ Filter\n" +
			"                                     │                           │   ├─ HashIn\n" +
			"                                     │                           │   │   ├─ cla.ftqlq:1!null\n" +
			"                                     │                           │   │   └─ TUPLE(SQ1 (longtext))\n" +
			"                                     │                           │   └─ TableAlias(cla)\n" +
			"                                     │                           │       └─ IndexedTableAccess(YK2GW)\n" +
			"                                     │                           │           ├─ index: [YK2GW.id]\n" +
			"                                     │                           │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                           │           └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"                                     │                           └─ TableAlias(bs)\n" +
			"                                     │                               └─ IndexedTableAccess(THNTS)\n" +
			"                                     │                                   ├─ index: [THNTS.IXUXU]\n" +
			"                                     │                                   ├─ static: [{[NULL, ∞)}]\n" +
			"                                     │                                   └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                                     └─ HashLookup\n" +
			"                                         ├─ left-key: TUPLE(cld.BDNYB:1!null, cld.M22QN:2!null)\n" +
			"                                         ├─ right-key: TUPLE(p4pjz.LWQ6O:3!null, p4pjz.NTOFG:2!null)\n" +
			"                                         └─ SubqueryAlias\n" +
			"                                             ├─ name: p4pjz\n" +
			"                                             ├─ outerVisibility: false\n" +
			"                                             ├─ cacheable: true\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [M6T2N:20, BTXC5:21, NTOFG:22!null, LWQ6O:23!null, TUV25:24]\n" +
			"                                                 └─ Project\n" +
			"                                                     ├─ columns: [mjr3d.FJDP5:0!null, mjr3d.BJUF2:1!null, mjr3d.M22QN:2!null, mjr3d.TUV25:3, mjr3d.ESFVY:4!null, mjr3d.QNI57:5!null, mjr3d.TDEIU:6!null, aac.id:7!null, aac.btxc5:8, aac.fhcyt:9, sn.id:10!null, sn.brqp2:11!null, sn.fftbj:12!null, sn.a7xo2:13, sn.kbo7r:14!null, sn.ecdkm:15, sn.numk2:16!null, sn.letoe:17!null, sn.ykssu:18, sn.fhcyt:19, CASE  WHEN NOT\n" +
			"                                                     │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                     │   THEN Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"                                                     │       └─ Filter\n" +
			"                                                     │           ├─ Eq\n" +
			"                                                     │           │   ├─ ei.id:20!null\n" +
			"                                                     │           │   └─ mjr3d.QNI57:5!null\n" +
			"                                                     │           └─ SubqueryAlias\n" +
			"                                                     │               ├─ name: ei\n" +
			"                                                     │               ├─ outerVisibility: true\n" +
			"                                                     │               ├─ cacheable: true\n" +
			"                                                     │               └─ Project\n" +
			"                                                     │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"                                                     │                   └─ Project\n" +
			"                                                     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"                                                     │                       └─ Window\n" +
			"                                                     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                                                     │                           ├─ noxn3.id:20!null\n" +
			"                                                     │                           └─ Table\n" +
			"                                                     │                               ├─ name: NOXN3\n" +
			"                                                     │                               └─ columns: [id]\n" +
			"                                                     │   WHEN NOT\n" +
			"                                                     │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                     │   THEN Subquery\n" +
			"                                                     │   ├─ cacheable: false\n" +
			"                                                     │   └─ Project\n" +
			"                                                     │       ├─ columns: [ei.M6T2N:21!null]\n" +
			"                                                     │       └─ Filter\n" +
			"                                                     │           ├─ Eq\n" +
			"                                                     │           │   ├─ ei.id:20!null\n" +
			"                                                     │           │   └─ mjr3d.TDEIU:6!null\n" +
			"                                                     │           └─ SubqueryAlias\n" +
			"                                                     │               ├─ name: ei\n" +
			"                                                     │               ├─ outerVisibility: true\n" +
			"                                                     │               ├─ cacheable: true\n" +
			"                                                     │               └─ Project\n" +
			"                                                     │                   ├─ columns: [noxn3.id:21!null, M6T2N:22!null]\n" +
			"                                                     │                   └─ Project\n" +
			"                                                     │                       ├─ columns: [row_number() over ( order by noxn3.id asc):20!null, noxn3.id:21!null, (row_number() over ( order by noxn3.id asc):20!null - 1 (tinyint)) as M6T2N]\n" +
			"                                                     │                       └─ Window\n" +
			"                                                     │                           ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                                                     │                           ├─ noxn3.id:20!null\n" +
			"                                                     │                           └─ Table\n" +
			"                                                     │                               ├─ name: NOXN3\n" +
			"                                                     │                               └─ columns: [id]\n" +
			"                                                     │   END as M6T2N, aac.btxc5:8 as BTXC5, aac.id:7!null as NTOFG, sn.id:10!null as LWQ6O, mjr3d.TUV25:3 as TUV25]\n" +
			"                                                     └─ LeftOuterJoin\n" +
			"                                                         ├─ Or\n" +
			"                                                         │   ├─ Or\n" +
			"                                                         │   │   ├─ Or\n" +
			"                                                         │   │   │   ├─ AND\n" +
			"                                                         │   │   │   │   ├─ AND\n" +
			"                                                         │   │   │   │   │   ├─ NOT\n" +
			"                                                         │   │   │   │   │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                         │   │   │   │   │   └─ Eq\n" +
			"                                                         │   │   │   │   │       ├─ sn.id:10!null\n" +
			"                                                         │   │   │   │   │       └─ mjr3d.QNI57:5!null\n" +
			"                                                         │   │   │   │   └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   │   │   └─ AND\n" +
			"                                                         │   │   │       ├─ AND\n" +
			"                                                         │   │   │       │   ├─ NOT\n" +
			"                                                         │   │   │       │   │   └─ mjr3d.QNI57:5!null IS NULL\n" +
			"                                                         │   │   │       │   └─ InSubquery\n" +
			"                                                         │   │   │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │   │   │       │       └─ right: Subquery\n" +
			"                                                         │   │   │       │           ├─ cacheable: false\n" +
			"                                                         │   │   │       │           └─ Project\n" +
			"                                                         │   │   │       │               ├─ columns: [jtehg.id:20!null]\n" +
			"                                                         │   │   │       │               └─ Filter\n" +
			"                                                         │   │   │       │                   ├─ Eq\n" +
			"                                                         │   │   │       │                   │   ├─ jtehg.brqp2:21!null\n" +
			"                                                         │   │   │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"                                                         │   │   │       │                   └─ TableAlias(jtehg)\n" +
			"                                                         │   │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │   │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │   │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │   │       └─ NOT\n" +
			"                                                         │   │   │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   │   └─ AND\n" +
			"                                                         │   │       ├─ AND\n" +
			"                                                         │   │       │   ├─ NOT\n" +
			"                                                         │   │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                         │   │       │   └─ InSubquery\n" +
			"                                                         │   │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │   │       │       └─ right: Subquery\n" +
			"                                                         │   │       │           ├─ cacheable: false\n" +
			"                                                         │   │       │           └─ Project\n" +
			"                                                         │   │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"                                                         │   │       │               └─ Filter\n" +
			"                                                         │   │       │                   ├─ Eq\n" +
			"                                                         │   │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"                                                         │   │       │                   │   └─ mjr3d.FJDP5:0!null\n" +
			"                                                         │   │       │                   └─ TableAlias(xmafz)\n" +
			"                                                         │   │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │   │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │   │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │       └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         │   └─ AND\n" +
			"                                                         │       ├─ AND\n" +
			"                                                         │       │   ├─ NOT\n" +
			"                                                         │       │   │   └─ mjr3d.TDEIU:6!null IS NULL\n" +
			"                                                         │       │   └─ InSubquery\n" +
			"                                                         │       │       ├─ left: sn.id:10!null\n" +
			"                                                         │       │       └─ right: Subquery\n" +
			"                                                         │       │           ├─ cacheable: false\n" +
			"                                                         │       │           └─ Project\n" +
			"                                                         │       │               ├─ columns: [xmafz.id:20!null]\n" +
			"                                                         │       │               └─ Filter\n" +
			"                                                         │       │                   ├─ Eq\n" +
			"                                                         │       │                   │   ├─ xmafz.brqp2:21!null\n" +
			"                                                         │       │                   │   └─ mjr3d.BJUF2:1!null\n" +
			"                                                         │       │                   └─ TableAlias(xmafz)\n" +
			"                                                         │       │                       └─ IndexedTableAccess(NOXN3)\n" +
			"                                                         │       │                           ├─ index: [NOXN3.BRQP2]\n" +
			"                                                         │       │                           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │       └─ NOT\n" +
			"                                                         │           └─ mjr3d.BJUF2:1!null IS NULL\n" +
			"                                                         ├─ LookupJoin\n" +
			"                                                         │   ├─ Eq\n" +
			"                                                         │   │   ├─ aac.id:7!null\n" +
			"                                                         │   │   └─ mjr3d.M22QN:2!null\n" +
			"                                                         │   ├─ SubqueryAlias\n" +
			"                                                         │   │   ├─ name: mjr3d\n" +
			"                                                         │   │   ├─ outerVisibility: false\n" +
			"                                                         │   │   ├─ cacheable: true\n" +
			"                                                         │   │   └─ Distinct\n" +
			"                                                         │   │       └─ Project\n" +
			"                                                         │   │           ├─ columns: [FJDP5:64!null, BJUF2:65!null, M22QN:66!null, TUV25:67, ESFVY:68!null, QNI57:69!null, TDEIU:70!null]\n" +
			"                                                         │   │           └─ Project\n" +
			"                                                         │   │               ├─ columns: [ism.id:8!null, ism.fv24e:9!null, ism.uj6xy:10!null, ism.m22qn:11!null, ism.nz4mq:12!null, ism.etpqv:13, ism.pruv2:14, ism.ykssu:15, ism.fhcyt:16, g3yxs.id:0!null, g3yxs.esfvy:1!null, g3yxs.sl76b:2!null, g3yxs.ge5el:3, g3yxs.f7a4q:4, g3yxs.tuv25:5, g3yxs.ykssu:6, g3yxs.fhcyt:7, nhmxw.id:17!null, nhmxw.nohhr:18!null, nhmxw.avpyf:19!null, nhmxw.sypkf:20!null, nhmxw.idut2:21!null, nhmxw.fzxv5:22, nhmxw.dqygv:23, nhmxw.swcqv:24!null, nhmxw.ykssu:25, nhmxw.fhcyt:26, cpmfe.id:27!null, cpmfe.dkcaj:28!null, cpmfe.kng7t:29, cpmfe.tw55n:30!null, cpmfe.qrqxw:31!null, cpmfe.ecxaj:32!null, cpmfe.fgg57:33, cpmfe.zh72s:34, cpmfe.fsk67:35!null, cpmfe.xqdyt:36!null, cpmfe.tce7a:37, cpmfe.iwv2h:38, cpmfe.hpcms:39!null, cpmfe.n5cc2:40, cpmfe.fhcyt:41, cpmfe.etaq7:42, cpmfe.a75x7:43, yqif4.id:44!null, yqif4.brqp2:45!null, yqif4.fftbj:46!null, yqif4.a7xo2:47, yqif4.kbo7r:48!null, yqif4.ecdkm:49, yqif4.numk2:50!null, yqif4.letoe:51!null, yqif4.ykssu:52, yqif4.fhcyt:53, yvhjz.id:54!null, yvhjz.brqp2:55!null, yvhjz.fftbj:56!null, yvhjz.a7xo2:57, yvhjz.kbo7r:58!null, yvhjz.ecdkm:59, yvhjz.numk2:60!null, yvhjz.letoe:61!null, yvhjz.ykssu:62, yvhjz.fhcyt:63, ism.fv24e:9!null as FJDP5, cpmfe.id:27!null as BJUF2, ism.m22qn:11!null as M22QN, g3yxs.tuv25:5 as TUV25, g3yxs.esfvy:1!null as ESFVY, yqif4.id:44!null as QNI57, yvhjz.id:54!null as TDEIU]\n" +
			"                                                         │   │               └─ Filter\n" +
			"                                                         │   │                   ├─ AND\n" +
			"                                                         │   │                   │   ├─ NOT\n" +
			"                                                         │   │                   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"                                                         │   │                   │   └─ Or\n" +
			"                                                         │   │                   │       ├─ NOT\n" +
			"                                                         │   │                   │       │   └─ yqif4.id:44!null IS NULL\n" +
			"                                                         │   │                   │       └─ NOT\n" +
			"                                                         │   │                   │           └─ yvhjz.id:54!null IS NULL\n" +
			"                                                         │   │                   └─ LeftOuterHashJoin\n" +
			"                                                         │   │                       ├─ AND\n" +
			"                                                         │   │                       │   ├─ Eq\n" +
			"                                                         │   │                       │   │   ├─ yvhjz.brqp2:55!null\n" +
			"                                                         │   │                       │   │   └─ ism.uj6xy:10!null\n" +
			"                                                         │   │                       │   └─ Eq\n" +
			"                                                         │   │                       │       ├─ yvhjz.fftbj:56!null\n" +
			"                                                         │   │                       │       └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       ├─ LeftOuterHashJoin\n" +
			"                                                         │   │                       │   ├─ AND\n" +
			"                                                         │   │                       │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   ├─ yqif4.brqp2:45!null\n" +
			"                                                         │   │                       │   │   │   └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       │   │   └─ Eq\n" +
			"                                                         │   │                       │   │       ├─ yqif4.fftbj:46!null\n" +
			"                                                         │   │                       │   │       └─ ism.uj6xy:10!null\n" +
			"                                                         │   │                       │   ├─ LeftOuterLookupJoin\n" +
			"                                                         │   │                       │   │   ├─ AND\n" +
			"                                                         │   │                       │   │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   │   ├─ cpmfe.zh72s:34\n" +
			"                                                         │   │                       │   │   │   │   └─ nhmxw.nohhr:18!null\n" +
			"                                                         │   │                       │   │   │   └─ NOT\n" +
			"                                                         │   │                       │   │   │       └─ Eq\n" +
			"                                                         │   │                       │   │   │           ├─ cpmfe.id:27!null\n" +
			"                                                         │   │                       │   │   │           └─ ism.fv24e:9!null\n" +
			"                                                         │   │                       │   │   ├─ LeftOuterHashJoin\n" +
			"                                                         │   │                       │   │   │   ├─ Eq\n" +
			"                                                         │   │                       │   │   │   │   ├─ nhmxw.id:17!null\n" +
			"                                                         │   │                       │   │   │   │   └─ ism.pruv2:14\n" +
			"                                                         │   │                       │   │   │   ├─ MergeJoin\n" +
			"                                                         │   │                       │   │   │   │   ├─ cmp: Eq\n" +
			"                                                         │   │                       │   │   │   │   │   ├─ g3yxs.id:0!null\n" +
			"                                                         │   │                       │   │   │   │   │   └─ ism.nz4mq:12!null\n" +
			"                                                         │   │                       │   │   │   │   ├─ Filter\n" +
			"                                                         │   │                       │   │   │   │   │   ├─ NOT\n" +
			"                                                         │   │                       │   │   │   │   │   │   └─ g3yxs.tuv25:5 IS NULL\n" +
			"                                                         │   │                       │   │   │   │   │   └─ TableAlias(g3yxs)\n" +
			"                                                         │   │                       │   │   │   │   │       └─ IndexedTableAccess(YYBCX)\n" +
			"                                                         │   │                       │   │   │   │   │           ├─ index: [YYBCX.id]\n" +
			"                                                         │   │                       │   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │                       │   │   │   │   │           └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   │   │   └─ TableAlias(ism)\n" +
			"                                                         │   │                       │   │   │   │       └─ IndexedTableAccess(HDDVB)\n" +
			"                                                         │   │                       │   │   │   │           ├─ index: [HDDVB.NZ4MQ]\n" +
			"                                                         │   │                       │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                         │   │                       │   │   │   │           └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   │   └─ HashLookup\n" +
			"                                                         │   │                       │   │   │       ├─ left-key: TUPLE(ism.pruv2:14)\n" +
			"                                                         │   │                       │   │   │       ├─ right-key: TUPLE(nhmxw.id:0!null)\n" +
			"                                                         │   │                       │   │   │       └─ TableAlias(nhmxw)\n" +
			"                                                         │   │                       │   │   │           └─ Table\n" +
			"                                                         │   │                       │   │   │               ├─ name: WGSDC\n" +
			"                                                         │   │                       │   │   │               └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"                                                         │   │                       │   │   └─ TableAlias(cpmfe)\n" +
			"                                                         │   │                       │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"                                                         │   │                       │   │           ├─ index: [E2I7U.ZH72S]\n" +
			"                                                         │   │                       │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                         │   │                       │   └─ HashLookup\n" +
			"                                                         │   │                       │       ├─ left-key: TUPLE(ism.fv24e:9!null, ism.uj6xy:10!null)\n" +
			"                                                         │   │                       │       ├─ right-key: TUPLE(yqif4.brqp2:1!null, yqif4.fftbj:2!null)\n" +
			"                                                         │   │                       │       └─ TableAlias(yqif4)\n" +
			"                                                         │   │                       │           └─ Table\n" +
			"                                                         │   │                       │               ├─ name: NOXN3\n" +
			"                                                         │   │                       │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   │                       └─ HashLookup\n" +
			"                                                         │   │                           ├─ left-key: TUPLE(ism.uj6xy:10!null, ism.fv24e:9!null)\n" +
			"                                                         │   │                           ├─ right-key: TUPLE(yvhjz.brqp2:1!null, yvhjz.fftbj:2!null)\n" +
			"                                                         │   │                           └─ TableAlias(yvhjz)\n" +
			"                                                         │   │                               └─ Table\n" +
			"                                                         │   │                                   ├─ name: NOXN3\n" +
			"                                                         │   │                                   └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                                                         │   └─ TableAlias(aac)\n" +
			"                                                         │       └─ IndexedTableAccess(TPXBU)\n" +
			"                                                         │           ├─ index: [TPXBU.id]\n" +
			"                                                         │           └─ columns: [id btxc5 fhcyt]\n" +
			"                                                         └─ TableAlias(sn)\n" +
			"                                                             └─ Table\n" +
			"                                                                 ├─ name: NOXN3\n" +
			"                                                                 └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
   TW55N
FROM
   E2I7U
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [e2i7u.tw55n:3!null]\n" +
			" └─ IndexedTableAccess(E2I7U)\n" +
			"     ├─ index: [E2I7U.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
SELECT
   TW55N, FGG57
FROM
   E2I7U
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [e2i7u.tw55n:3!null, e2i7u.fgg57:6]\n" +
			" └─ IndexedTableAccess(E2I7U)\n" +
			"     ├─ index: [E2I7U.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
SELECT COUNT(*) FROM E2I7U`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [count(1):0!null as COUNT(*)]\n" +
			" └─ Project\n" +
			"     ├─ columns: [E2I7U.COUNT(1):0!null as COUNT(1)]\n" +
			"     └─ table_count(E2I7U) as COUNT(1)\n" +
			"",
	},
	{
		Query: `
SELECT
   ROW_NUMBER() OVER (ORDER BY id ASC) -1 DICQO,
   TW55N
FROM
   E2I7U`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [DICQO:2!null, e2i7u.tw55n:1!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [row_number() over ( order by e2i7u.id asc):0!null, e2i7u.tw55n:1!null, (row_number() over ( order by e2i7u.id asc):0!null - 1 (tinyint)) as DICQO]\n" +
			"     └─ Window\n" +
			"         ├─ row_number() over ( order by e2i7u.id ASC)\n" +
			"         ├─ e2i7u.tw55n:1!null\n" +
			"         └─ Table\n" +
			"             ├─ name: E2I7U\n" +
			"             └─ columns: [id tw55n]\n" +
			"",
	},
	{
		Query: `
SELECT
   TUSAY.Y3IOU AS Q7H3X
FROM
   (SELECT
       id AS Y46B2,
       HHVLX AS HHVLX,
       HVHRZ AS HVHRZ
   FROM
       QYWQD) XJ2RD
INNER JOIN
   (SELECT
       ROW_NUMBER() OVER (ORDER BY id ASC) Y3IOU,
       id AS XLFIA
   FROM
       NOXN3) TUSAY

   ON XJ2RD.HHVLX = TUSAY.XLFIA
ORDER BY Y46B2 ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [Q7H3X:5!null]\n" +
			" └─ Sort(xj2rd.Y46B2:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [xj2rd.Y46B2:2!null, xj2rd.HHVLX:3!null, xj2rd.HVHRZ:4!null, tusay.Y3IOU:0!null, tusay.XLFIA:1!null, tusay.Y3IOU:0!null as Q7H3X]\n" +
			"         └─ HashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ xj2rd.HHVLX:3!null\n" +
			"             │   └─ tusay.XLFIA:1!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: tusay\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [Y3IOU:2!null, XLFIA:3!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, row_number() over ( order by noxn3.id asc):0!null as Y3IOU, noxn3.id:1!null as XLFIA]\n" +
			"             │           └─ Window\n" +
			"             │               ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"             │               ├─ noxn3.id:0!null\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: NOXN3\n" +
			"             │                   └─ columns: [id]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(tusay.XLFIA:1!null)\n" +
			"                 ├─ right-key: TUPLE(xj2rd.HHVLX:1!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: xj2rd\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [Y46B2:6!null, HHVLX:7!null, HVHRZ:8!null]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [qywqd.id:0!null, qywqd.wnunu:1!null, qywqd.hhvlx:2!null, qywqd.hvhrz:3!null, qywqd.ykssu:4, qywqd.fhcyt:5, qywqd.id:0!null as Y46B2, qywqd.hhvlx:2!null as HHVLX, qywqd.hvhrz:3!null as HVHRZ]\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: QYWQD\n" +
			"                                 └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT 
    I2GJ5.R2SR7
FROM
    (SELECT
        id AS XLFIA,
        BRQP2
    FROM
        NOXN3
    ORDER BY id ASC) sn
    LEFT JOIN
    (SELECT
        nd.LUEVY,
    CASE
        WHEN nma.DZLIM = 'Q5I4E' THEN 1
        ELSE 0
        END AS R2SR7
    FROM
        (SELECT 
            id AS LUEVY, 
            HPCMS AS HPCMS
        FROM 
            E2I7U) nd 
        LEFT JOIN
        (SELECT 
            id AS MLECF, 
            DZLIM
        FROM 
            TNMXI) nma
        ON nd.HPCMS = nma.MLECF) I2GJ5
    ON sn.BRQP2 = I2GJ5.LUEVY
ORDER BY sn.XLFIA ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [i2gj5.R2SR7:3!null]\n" +
			" └─ Sort(sn.XLFIA:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sn.XLFIA:0!null, sn.brqp2:1!null, i2gj5.LUEVY:2!null, i2gj5.R2SR7:3!null]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ sn.brqp2:1!null\n" +
			"             │   └─ i2gj5.LUEVY:2!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: sn\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [XLFIA:10!null, noxn3.brqp2:1!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [noxn3.id:0!null, noxn3.brqp2:1!null, noxn3.fftbj:2!null, noxn3.a7xo2:3, noxn3.kbo7r:4!null, noxn3.ecdkm:5, noxn3.numk2:6!null, noxn3.letoe:7!null, noxn3.ykssu:8, noxn3.fhcyt:9, noxn3.id:0!null as XLFIA]\n" +
			"             │           └─ IndexedTableAccess(NOXN3)\n" +
			"             │               ├─ index: [NOXN3.id]\n" +
			"             │               ├─ static: [{[NULL, ∞)}]\n" +
			"             │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(sn.brqp2:1!null)\n" +
			"                 ├─ right-key: TUPLE(i2gj5.LUEVY:0!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: i2gj5\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [nd.LUEVY:0!null, R2SR7:4!null]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [nd.LUEVY:0!null, nd.HPCMS:1!null, nma.MLECF:2!null, nma.dzlim:3!null, CASE  WHEN Eq\n" +
			"                             │   ├─ nma.dzlim:3!null\n" +
			"                             │   └─ Q5I4E (longtext)\n" +
			"                             │   THEN 1 (tinyint) ELSE 0 (tinyint) END as R2SR7]\n" +
			"                             └─ LeftOuterHashJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ nd.HPCMS:1!null\n" +
			"                                 │   └─ nma.MLECF:2!null\n" +
			"                                 ├─ SubqueryAlias\n" +
			"                                 │   ├─ name: nd\n" +
			"                                 │   ├─ outerVisibility: false\n" +
			"                                 │   ├─ cacheable: true\n" +
			"                                 │   └─ Project\n" +
			"                                 │       ├─ columns: [LUEVY:17!null, HPCMS:18!null]\n" +
			"                                 │       └─ Project\n" +
			"                                 │           ├─ columns: [e2i7u.id:0!null, e2i7u.dkcaj:1!null, e2i7u.kng7t:2, e2i7u.tw55n:3!null, e2i7u.qrqxw:4!null, e2i7u.ecxaj:5!null, e2i7u.fgg57:6, e2i7u.zh72s:7, e2i7u.fsk67:8!null, e2i7u.xqdyt:9!null, e2i7u.tce7a:10, e2i7u.iwv2h:11, e2i7u.hpcms:12!null, e2i7u.n5cc2:13, e2i7u.fhcyt:14, e2i7u.etaq7:15, e2i7u.a75x7:16, e2i7u.id:0!null as LUEVY, e2i7u.hpcms:12!null as HPCMS]\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: E2I7U\n" +
			"                                 │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(nd.HPCMS:1!null)\n" +
			"                                     ├─ right-key: TUPLE(nma.MLECF:0!null)\n" +
			"                                     └─ SubqueryAlias\n" +
			"                                         ├─ name: nma\n" +
			"                                         ├─ outerVisibility: false\n" +
			"                                         ├─ cacheable: true\n" +
			"                                         └─ Project\n" +
			"                                             ├─ columns: [MLECF:3!null, tnmxi.dzlim:1!null]\n" +
			"                                             └─ Project\n" +
			"                                                 ├─ columns: [tnmxi.id:0!null, tnmxi.dzlim:1!null, tnmxi.f3yue:2, tnmxi.id:0!null as MLECF]\n" +
			"                                                 └─ Table\n" +
			"                                                     ├─ name: TNMXI\n" +
			"                                                     └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
SELECT
    QI2IE.DICQO AS DICQO
FROM
    (SELECT 
        id AS XLFIA,
        BRQP2 AS AHMDT
    FROM
        NOXN3) GRRB6
LEFT JOIN
    (SELECT 
        ROW_NUMBER() OVER (ORDER BY id ASC) DICQO, 
        id AS VIBZI
    FROM 
        E2I7U) QI2IE
    ON QI2IE.VIBZI = GRRB6.AHMDT
ORDER BY GRRB6.XLFIA ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [DICQO:4!null]\n" +
			" └─ Sort(grrb6.XLFIA:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [grrb6.XLFIA:0!null, grrb6.AHMDT:1!null, qi2ie.DICQO:2!null, qi2ie.VIBZI:3!null, qi2ie.DICQO:2!null as DICQO]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ qi2ie.VIBZI:3!null\n" +
			"             │   └─ grrb6.AHMDT:1!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: grrb6\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [XLFIA:10!null, AHMDT:11!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [noxn3.id:0!null, noxn3.brqp2:1!null, noxn3.fftbj:2!null, noxn3.a7xo2:3, noxn3.kbo7r:4!null, noxn3.ecdkm:5, noxn3.numk2:6!null, noxn3.letoe:7!null, noxn3.ykssu:8, noxn3.fhcyt:9, noxn3.id:0!null as XLFIA, noxn3.brqp2:1!null as AHMDT]\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: NOXN3\n" +
			"             │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(grrb6.AHMDT:1!null)\n" +
			"                 ├─ right-key: TUPLE(qi2ie.VIBZI:1!null)\n" +
			"                 └─ SubqueryAlias\n" +
			"                     ├─ name: qi2ie\n" +
			"                     ├─ outerVisibility: false\n" +
			"                     ├─ cacheable: true\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [DICQO:2!null, VIBZI:3!null]\n" +
			"                         └─ Project\n" +
			"                             ├─ columns: [row_number() over ( order by e2i7u.id asc):0!null, e2i7u.id:1!null, row_number() over ( order by e2i7u.id asc):0!null as DICQO, e2i7u.id:1!null as VIBZI]\n" +
			"                             └─ Window\n" +
			"                                 ├─ row_number() over ( order by e2i7u.id ASC)\n" +
			"                                 ├─ e2i7u.id:0!null\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: E2I7U\n" +
			"                                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT
    DISTINCT cla.FTQLQ
FROM
    YK2GW cla
WHERE
    cla.id IN (
        SELECT bs.IXUXU
        FROM THNTS bs
        WHERE
            bs.id IN (SELECT GXLUB FROM HGMQ6)
            AND bs.id IN (SELECT GXLUB FROM AMYXQ)
    )
ORDER BY cla.FTQLQ ASC`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [cla.ftqlq:1!null]\n" +
			"     └─ Sort(cla.ftqlq:1!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [cla.id:1!null, cla.FTQLQ:2!null, cla.TUXML:3, cla.PAEF5:4, cla.RUCY4:5, cla.TPNJ6:6!null, cla.LBL53:7, cla.NB3QS:8, cla.EO7IV:9, cla.MUHJF:10, cla.FM34L:11, cla.TY5RF:12, cla.ZHTLH:13, cla.NPB7W:14, cla.SX3HH:15, cla.ISBNF:16, cla.YA7YB:17, cla.C5YKB:18, cla.QK7KT:19, cla.FFGE6:20, cla.FIIGJ:21, cla.SH3NC:22, cla.NTENA:23, cla.M4AUB:24, cla.X5AIR:25, cla.SAB6M:26, cla.G5QI5:27, cla.ZVQVD:28, cla.YKSSU:29, cla.FHCYT:30]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cla.id:1!null\n" +
			"                 │   └─ scalarSubq0.ixuxu:0\n" +
			"                 ├─ Distinct\n" +
			"                 │   └─ Project\n" +
			"                 │       ├─ columns: [scalarSubq0.ixuxu:2]\n" +
			"                 │       └─ Project\n" +
			"                 │           ├─ columns: [scalarSubq0.id:0!null, scalarSubq0.NFRYN:1!null, scalarSubq0.ixuxu:2, scalarSubq0.FHCYT:3]\n" +
			"                 │           └─ HashJoin\n" +
			"                 │               ├─ Eq\n" +
			"                 │               │   ├─ scalarSubq0.id:0!null\n" +
			"                 │               │   └─ scalarSubq2.gxlub:4!null\n" +
			"                 │               ├─ Project\n" +
			"                 │               │   ├─ columns: [scalarSubq0.id:0!null, scalarSubq0.NFRYN:1!null, scalarSubq0.ixuxu:2, scalarSubq0.FHCYT:3]\n" +
			"                 │               │   └─ MergeJoin\n" +
			"                 │               │       ├─ cmp: Eq\n" +
			"                 │               │       │   ├─ scalarSubq0.id:0!null\n" +
			"                 │               │       │   └─ scalarSubq1.gxlub:4!null\n" +
			"                 │               │       ├─ TableAlias(scalarSubq0)\n" +
			"                 │               │       │   └─ IndexedTableAccess(THNTS)\n" +
			"                 │               │       │       ├─ index: [THNTS.id]\n" +
			"                 │               │       │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │               │       │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                 │               │       └─ Distinct\n" +
			"                 │               │           └─ Project\n" +
			"                 │               │               ├─ columns: [scalarSubq1.gxlub:1!null]\n" +
			"                 │               │               └─ TableAlias(scalarSubq1)\n" +
			"                 │               │                   └─ IndexedTableAccess(HGMQ6)\n" +
			"                 │               │                       ├─ index: [HGMQ6.GXLUB]\n" +
			"                 │               │                       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │               │                       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                 │               └─ HashLookup\n" +
			"                 │                   ├─ left-key: TUPLE(scalarSubq0.id:0!null)\n" +
			"                 │                   ├─ right-key: TUPLE(scalarSubq2.gxlub:0!null)\n" +
			"                 │                   └─ Distinct\n" +
			"                 │                       └─ Project\n" +
			"                 │                           ├─ columns: [scalarSubq2.gxlub:1!null]\n" +
			"                 │                           └─ TableAlias(scalarSubq2)\n" +
			"                 │                               └─ Table\n" +
			"                 │                                   ├─ name: AMYXQ\n" +
			"                 │                                   └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(scalarSubq0.ixuxu:0)\n" +
			"                     ├─ right-key: TUPLE(cla.id:0!null)\n" +
			"                     └─ TableAlias(cla)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: YK2GW\n" +
			"                             └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    DISTINCT cla.FTQLQ
FROM HGMQ6 mf
INNER JOIN THNTS bs
    ON mf.GXLUB = bs.id
INNER JOIN YK2GW cla
    ON bs.IXUXU = cla.id
ORDER BY cla.FTQLQ ASC`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [cla.ftqlq:22!null]\n" +
			"     └─ Sort(cla.ftqlq:22!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [mf.id:4!null, mf.gxlub:5!null, mf.luevy:6!null, mf.m22qn:7!null, mf.tjpt7:8!null, mf.arn5p:9!null, mf.xosd4:10!null, mf.ide43:11, mf.hmw4h:12, mf.zbt6r:13, mf.fsdy2:14!null, mf.lt7k6:15, mf.sppyd:16, mf.qcgts:17, mf.teuja:18, mf.qqv4m:19, mf.fhcyt:20, bs.id:0!null, bs.nfryn:1!null, bs.ixuxu:2, bs.fhcyt:3, cla.id:21!null, cla.ftqlq:22!null, cla.tuxml:23, cla.paef5:24, cla.rucy4:25, cla.tpnj6:26!null, cla.lbl53:27, cla.nb3qs:28, cla.eo7iv:29, cla.muhjf:30, cla.fm34l:31, cla.ty5rf:32, cla.zhtlh:33, cla.npb7w:34, cla.sx3hh:35, cla.isbnf:36, cla.ya7yb:37, cla.c5ykb:38, cla.qk7kt:39, cla.ffge6:40, cla.fiigj:41, cla.sh3nc:42, cla.ntena:43, cla.m4aub:44, cla.x5air:45, cla.sab6m:46, cla.g5qi5:47, cla.zvqvd:48, cla.ykssu:49, cla.fhcyt:50]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ bs.ixuxu:2\n" +
			"                 │   └─ cla.id:21!null\n" +
			"                 ├─ MergeJoin\n" +
			"                 │   ├─ cmp: Eq\n" +
			"                 │   │   ├─ bs.id:0!null\n" +
			"                 │   │   └─ mf.gxlub:5!null\n" +
			"                 │   ├─ TableAlias(bs)\n" +
			"                 │   │   └─ IndexedTableAccess(THNTS)\n" +
			"                 │   │       ├─ index: [THNTS.id]\n" +
			"                 │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │   │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                 │   └─ TableAlias(mf)\n" +
			"                 │       └─ IndexedTableAccess(HGMQ6)\n" +
			"                 │           ├─ index: [HGMQ6.GXLUB]\n" +
			"                 │           ├─ static: [{[NULL, ∞)}]\n" +
			"                 │           └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(bs.ixuxu:2)\n" +
			"                     ├─ right-key: TUPLE(cla.id:0!null)\n" +
			"                     └─ TableAlias(cla)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: YK2GW\n" +
			"                             └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    DISTINCT cla.FTQLQ
FROM YK2GW cla
WHERE cla.id IN
    (SELECT IXUXU FROM THNTS bs
        WHERE bs.id IN (SELECT GXLUB FROM AMYXQ))
ORDER BY cla.FTQLQ ASC`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [cla.ftqlq:1!null]\n" +
			"     └─ Sort(cla.ftqlq:1!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [cla.id:1!null, cla.FTQLQ:2!null, cla.TUXML:3, cla.PAEF5:4, cla.RUCY4:5, cla.TPNJ6:6!null, cla.LBL53:7, cla.NB3QS:8, cla.EO7IV:9, cla.MUHJF:10, cla.FM34L:11, cla.TY5RF:12, cla.ZHTLH:13, cla.NPB7W:14, cla.SX3HH:15, cla.ISBNF:16, cla.YA7YB:17, cla.C5YKB:18, cla.QK7KT:19, cla.FFGE6:20, cla.FIIGJ:21, cla.SH3NC:22, cla.NTENA:23, cla.M4AUB:24, cla.X5AIR:25, cla.SAB6M:26, cla.G5QI5:27, cla.ZVQVD:28, cla.YKSSU:29, cla.FHCYT:30]\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cla.id:1!null\n" +
			"                 │   └─ scalarSubq0.ixuxu:0\n" +
			"                 ├─ Distinct\n" +
			"                 │   └─ Project\n" +
			"                 │       ├─ columns: [scalarSubq0.ixuxu:2]\n" +
			"                 │       └─ Project\n" +
			"                 │           ├─ columns: [scalarSubq0.id:0!null, scalarSubq0.NFRYN:1!null, scalarSubq0.ixuxu:2, scalarSubq0.FHCYT:3]\n" +
			"                 │           └─ MergeJoin\n" +
			"                 │               ├─ cmp: Eq\n" +
			"                 │               │   ├─ scalarSubq0.id:0!null\n" +
			"                 │               │   └─ scalarSubq1.gxlub:4!null\n" +
			"                 │               ├─ TableAlias(scalarSubq0)\n" +
			"                 │               │   └─ IndexedTableAccess(THNTS)\n" +
			"                 │               │       ├─ index: [THNTS.id]\n" +
			"                 │               │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │               │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"                 │               └─ Distinct\n" +
			"                 │                   └─ Project\n" +
			"                 │                       ├─ columns: [scalarSubq1.gxlub:1!null]\n" +
			"                 │                       └─ TableAlias(scalarSubq1)\n" +
			"                 │                           └─ IndexedTableAccess(AMYXQ)\n" +
			"                 │                               ├─ index: [AMYXQ.GXLUB]\n" +
			"                 │                               ├─ static: [{[NULL, ∞)}]\n" +
			"                 │                               └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(scalarSubq0.ixuxu:0)\n" +
			"                     ├─ right-key: TUPLE(cla.id:0!null)\n" +
			"                     └─ TableAlias(cla)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: YK2GW\n" +
			"                             └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    DISTINCT ci.FTQLQ
FROM FLQLP ct
INNER JOIN JDLNA ci
    ON ct.FZ2R5 = ci.id
ORDER BY ci.FTQLQ`,
		ExpectedPlan: "Distinct\n" +
			" └─ Project\n" +
			"     ├─ columns: [ci.ftqlq:13!null]\n" +
			"     └─ Sort(ci.ftqlq:13!null ASC nullsFirst)\n" +
			"         └─ Project\n" +
			"             ├─ columns: [ct.id:5!null, ct.fz2r5:6!null, ct.luevy:7!null, ct.m22qn:8!null, ct.ove3e:9!null, ct.nrurt:10, ct.oca7e:11, ct.xmm6q:12, ct.v5dpx:13!null, ct.s3q3y:14!null, ct.zrv3b:15!null, ct.fhcyt:16, ci.id:0!null, ci.ftqlq:1!null, ci.fwwiq:2, ci.o3qxw:3, ci.fhcyt:4]\n" +
			"             └─ MergeJoin\n" +
			"                 ├─ cmp: Eq\n" +
			"                 │   ├─ ci.id:0!null\n" +
			"                 │   └─ ct.fz2r5:6!null\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ IndexedTableAccess(JDLNA)\n" +
			"                 │       ├─ index: [JDLNA.id]\n" +
			"                 │       ├─ static: [{[NULL, ∞)}]\n" +
			"                 │       └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ IndexedTableAccess(FLQLP)\n" +
			"                         ├─ index: [FLQLP.FZ2R5]\n" +
			"                         ├─ static: [{[NULL, ∞)}]\n" +
			"                         └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
        YPGDA.LUEVY AS LUEVY,
        YPGDA.TW55N AS TW55N,
        YPGDA.IYDZV AS IYDZV,
        '' AS IIISV,
        YPGDA.QRQXW AS QRQXW,
        YPGDA.CAECS AS CAECS,
        YPGDA.CJLLY AS CJLLY,
        YPGDA.SHP7H AS SHP7H,
        YPGDA.HARAZ AS HARAZ,
        '' AS ECUWU,
        '' AS LDMO7,
        CASE
            WHEN YBBG5.DZLIM = 'HGUEM' THEN 's30'
            WHEN YBBG5.DZLIM = 'YUHMV' THEN 'r90'
            WHEN YBBG5.DZLIM = 'T3JIU' THEN 'r50'
            WHEN YBBG5.DZLIM = 's' THEN 's'
            WHEN YBBG5.DZLIM = 'AX25H' THEN 'r70'
            WHEN YBBG5.DZLIM IS NULL then ''
            ELSE YBBG5.DZLIM
        END AS UBUYI,
        YPGDA.FUG6J AS FUG6J,
        YPGDA.NF5AM AS NF5AM,
        YPGDA.FRCVC AS FRCVC
FROM
    (SELECT 
        nd.id AS LUEVY,
        nd.TW55N AS TW55N,
        nd.FGG57 AS IYDZV,
        nd.QRQXW AS QRQXW,
        nd.IWV2H AS CAECS,
        nd.ECXAJ AS CJLLY,
        nma.DZLIM AS SHP7H,
        nd.N5CC2 AS HARAZ,
        (SELECT
            XQDYT
            FROM AMYXQ
            WHERE LUEVY = nd.id 
            LIMIT 1) AS I3L5A,
        nd.ETAQ7 AS FUG6J,
        nd.A75X7 AS NF5AM,
        nd.FSK67 AS FRCVC
    FROM E2I7U nd
    LEFT JOIN TNMXI nma
        ON nma.id = nd.HPCMS) YPGDA
LEFT JOIN XGSJM YBBG5
    ON YPGDA.I3L5A = YBBG5.id
ORDER BY LUEVY`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [LUEVY:15!null, TW55N:16!null, IYDZV:17, IIISV:18!null, QRQXW:19!null, CAECS:20, CJLLY:21!null, SHP7H:22!null, HARAZ:23, ECUWU:24!null, LDMO7:25!null, UBUYI:26!null, FUG6J:27, NF5AM:28, FRCVC:29!null]\n" +
			" └─ Sort(ypgda.LUEVY:0!null as LUEVY ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [ypgda.LUEVY:0!null, ypgda.TW55N:1!null, ypgda.IYDZV:2, ypgda.QRQXW:3!null, ypgda.CAECS:4, ypgda.CJLLY:5!null, ypgda.SHP7H:6!null, ypgda.HARAZ:7, ypgda.I3L5A:8, ypgda.FUG6J:9, ypgda.NF5AM:10, ypgda.FRCVC:11!null, ybbg5.id:12!null, ybbg5.dzlim:13!null, ybbg5.f3yue:14, ypgda.LUEVY:0!null as LUEVY, ypgda.TW55N:1!null as TW55N, ypgda.IYDZV:2 as IYDZV,  (longtext) as IIISV, ypgda.QRQXW:3!null as QRQXW, ypgda.CAECS:4 as CAECS, ypgda.CJLLY:5!null as CJLLY, ypgda.SHP7H:6!null as SHP7H, ypgda.HARAZ:7 as HARAZ,  (longtext) as ECUWU,  (longtext) as LDMO7, CASE  WHEN Eq\n" +
			"         │   ├─ ybbg5.dzlim:13!null\n" +
			"         │   └─ HGUEM (longtext)\n" +
			"         │   THEN s30 (longtext) WHEN Eq\n" +
			"         │   ├─ ybbg5.dzlim:13!null\n" +
			"         │   └─ YUHMV (longtext)\n" +
			"         │   THEN r90 (longtext) WHEN Eq\n" +
			"         │   ├─ ybbg5.dzlim:13!null\n" +
			"         │   └─ T3JIU (longtext)\n" +
			"         │   THEN r50 (longtext) WHEN Eq\n" +
			"         │   ├─ ybbg5.dzlim:13!null\n" +
			"         │   └─ s (longtext)\n" +
			"         │   THEN s (longtext) WHEN Eq\n" +
			"         │   ├─ ybbg5.dzlim:13!null\n" +
			"         │   └─ AX25H (longtext)\n" +
			"         │   THEN r70 (longtext) WHEN ybbg5.dzlim:13!null IS NULL THEN  (longtext) ELSE ybbg5.dzlim:13!null END as UBUYI, ypgda.FUG6J:9 as FUG6J, ypgda.NF5AM:10 as NF5AM, ypgda.FRCVC:11!null as FRCVC]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ypgda.I3L5A:8\n" +
			"             │   └─ ybbg5.id:12!null\n" +
			"             ├─ SubqueryAlias\n" +
			"             │   ├─ name: ypgda\n" +
			"             │   ├─ outerVisibility: false\n" +
			"             │   ├─ cacheable: true\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [LUEVY:20!null, TW55N:21!null, IYDZV:22, QRQXW:23!null, CAECS:24, CJLLY:25!null, SHP7H:26!null, HARAZ:27, I3L5A:28, FUG6J:29, NF5AM:30, FRCVC:31!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [nd.id:0!null, nd.dkcaj:1!null, nd.kng7t:2, nd.tw55n:3!null, nd.qrqxw:4!null, nd.ecxaj:5!null, nd.fgg57:6, nd.zh72s:7, nd.fsk67:8!null, nd.xqdyt:9!null, nd.tce7a:10, nd.iwv2h:11, nd.hpcms:12!null, nd.n5cc2:13, nd.fhcyt:14, nd.etaq7:15, nd.a75x7:16, nma.id:17!null, nma.dzlim:18!null, nma.f3yue:19, nd.id:0!null as LUEVY, nd.tw55n:3!null as TW55N, nd.fgg57:6 as IYDZV, nd.qrqxw:4!null as QRQXW, nd.iwv2h:11 as CAECS, nd.ecxaj:5!null as CJLLY, nma.dzlim:18!null as SHP7H, nd.n5cc2:13 as HARAZ, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Limit(1)\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [amyxq.xqdyt:23!null]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ amyxq.luevy:22!null\n" +
			"             │           │               │   └─ nd.id:0!null\n" +
			"             │           │               └─ IndexedTableAccess(AMYXQ)\n" +
			"             │           │                   ├─ index: [AMYXQ.LUEVY]\n" +
			"             │           │                   └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"             │           │   as I3L5A, nd.etaq7:15 as FUG6J, nd.a75x7:16 as NF5AM, nd.fsk67:8!null as FRCVC]\n" +
			"             │           └─ LeftOuterMergeJoin\n" +
			"             │               ├─ cmp: Eq\n" +
			"             │               │   ├─ nd.hpcms:12!null\n" +
			"             │               │   └─ nma.id:17!null\n" +
			"             │               ├─ TableAlias(nd)\n" +
			"             │               │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │               │       ├─ index: [E2I7U.HPCMS]\n" +
			"             │               │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │               │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │               └─ TableAlias(nma)\n" +
			"             │                   └─ IndexedTableAccess(TNMXI)\n" +
			"             │                       ├─ index: [TNMXI.id]\n" +
			"             │                       ├─ static: [{[NULL, ∞)}]\n" +
			"             │                       └─ columns: [id dzlim f3yue]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(ypgda.I3L5A:8)\n" +
			"                 ├─ right-key: TUPLE(ybbg5.id:0!null)\n" +
			"                 └─ TableAlias(ybbg5)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: XGSJM\n" +
			"                         └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
SELECT LUEVY, F6NSZ FROM ARLV5`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [arlv5.luevy:1!null, arlv5.f6nsz:2!null]\n" +
			" └─ Table\n" +
			"     ├─ name: ARLV5\n" +
			"     └─ columns: [id luevy f6nsz]\n" +
			"",
	},
	{
		Query: `
SELECT id, DZLIM FROM IIISV`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [iiisv.id:0!null, iiisv.dzlim:1!null]\n" +
			" └─ Table\n" +
			"     ├─ name: IIISV\n" +
			"     └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
SELECT
    TVQG4.TW55N
        AS FJVD7,
    LSM32.TW55N
        AS KBXXJ,
    sn.NUMK2
        AS NUMK2,
    CASE
        WHEN it.DZLIM IS NULL
        THEN "N/A"
        ELSE it.DZLIM
    END
        AS TP6BK,
    sn.ECDKM
        AS ECDKM,
    sn.KBO7R
        AS KBO7R,
    CASE
        WHEN sn.YKSSU IS NULL
        THEN "N/A"
        ELSE sn.YKSSU
    END
        AS RQI4M,
    CASE
        WHEN sn.FHCYT IS NULL
        THEN "N/A"
        ELSE sn.FHCYT
    END
        AS RNVLS,
    sn.LETOE
        AS LETOE
FROM
    NOXN3 sn
LEFT JOIN
    E2I7U TVQG4
    ON sn.BRQP2 = TVQG4.id
LEFT JOIN
    E2I7U LSM32
    ON sn.FFTBJ = LSM32.id
LEFT JOIN
    FEVH4 it
    ON sn.A7XO2 = it.id
ORDER BY sn.id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [FJVD7:47!null, KBXXJ:48!null, NUMK2:49!null, TP6BK:50!null, ECDKM:51, KBO7R:52!null, RQI4M:53, RNVLS:54, LETOE:55!null]\n" +
			" └─ Sort(sn.id:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, tvqg4.id:10!null, tvqg4.dkcaj:11!null, tvqg4.kng7t:12, tvqg4.tw55n:13!null, tvqg4.qrqxw:14!null, tvqg4.ecxaj:15!null, tvqg4.fgg57:16, tvqg4.zh72s:17, tvqg4.fsk67:18!null, tvqg4.xqdyt:19!null, tvqg4.tce7a:20, tvqg4.iwv2h:21, tvqg4.hpcms:22!null, tvqg4.n5cc2:23, tvqg4.fhcyt:24, tvqg4.etaq7:25, tvqg4.a75x7:26, lsm32.id:27!null, lsm32.dkcaj:28!null, lsm32.kng7t:29, lsm32.tw55n:30!null, lsm32.qrqxw:31!null, lsm32.ecxaj:32!null, lsm32.fgg57:33, lsm32.zh72s:34, lsm32.fsk67:35!null, lsm32.xqdyt:36!null, lsm32.tce7a:37, lsm32.iwv2h:38, lsm32.hpcms:39!null, lsm32.n5cc2:40, lsm32.fhcyt:41, lsm32.etaq7:42, lsm32.a75x7:43, it.id:44!null, it.dzlim:45!null, it.f3yue:46, tvqg4.tw55n:13!null as FJVD7, lsm32.tw55n:30!null as KBXXJ, sn.numk2:6!null as NUMK2, CASE  WHEN it.dzlim:45!null IS NULL THEN N/A (longtext) ELSE it.dzlim:45!null END as TP6BK, sn.ecdkm:5 as ECDKM, sn.kbo7r:4!null as KBO7R, CASE  WHEN sn.ykssu:8 IS NULL THEN N/A (longtext) ELSE sn.ykssu:8 END as RQI4M, CASE  WHEN sn.fhcyt:9 IS NULL THEN N/A (longtext) ELSE sn.fhcyt:9 END as RNVLS, sn.letoe:7!null as LETOE]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ sn.a7xo2:3\n" +
			"             │   └─ it.id:44!null\n" +
			"             ├─ LeftOuterHashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ sn.fftbj:2!null\n" +
			"             │   │   └─ lsm32.id:27!null\n" +
			"             │   ├─ LeftOuterMergeJoin\n" +
			"             │   │   ├─ cmp: Eq\n" +
			"             │   │   │   ├─ sn.brqp2:1!null\n" +
			"             │   │   │   └─ tvqg4.id:10!null\n" +
			"             │   │   ├─ TableAlias(sn)\n" +
			"             │   │   │   └─ IndexedTableAccess(NOXN3)\n" +
			"             │   │   │       ├─ index: [NOXN3.BRQP2]\n" +
			"             │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │       └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   │   └─ TableAlias(tvqg4)\n" +
			"             │   │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │   │           ├─ index: [E2I7U.id]\n" +
			"             │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(sn.fftbj:2!null)\n" +
			"             │       ├─ right-key: TUPLE(lsm32.id:0!null)\n" +
			"             │       └─ TableAlias(lsm32)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: E2I7U\n" +
			"             │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(sn.a7xo2:3)\n" +
			"                 ├─ right-key: TUPLE(it.id:0!null)\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: FEVH4\n" +
			"                         └─ columns: [id dzlim f3yue]\n" +
			"",
	},
	{
		Query: `
SELECT
    KBO7R 
FROM 
    NOXN3 
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [noxn3.kbo7r:4!null]\n" +
			" └─ IndexedTableAccess(NOXN3)\n" +
			"     ├─ index: [NOXN3.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    SDLLR.TW55N
        AS FZX4Y,
    JGT2H.LETOE
        AS QWTOI,
    RIIW6.TW55N
        AS PDX5Y,
    AYFCD.NUMK2
        AS V45YB ,
    AYFCD.LETOE
        AS DAGQN,
    FA75Y.TW55N
        AS SFQTS,
    rn.HVHRZ
        AS HVHRZ,
    CASE
        WHEN rn.YKSSU IS NULL
        THEN "N/A"
        ELSE rn.YKSSU
    END
        AS RQI4M,
    CASE
        WHEN rn.FHCYT IS NULL
        THEN "N/A"
        ELSE rn.FHCYT
    END
        AS RNVLS
FROM
    QYWQD rn
LEFT JOIN
    NOXN3 JGT2H
    ON  rn.WNUNU = JGT2H.id
LEFT JOIN
    NOXN3 AYFCD
    ON  rn.HHVLX = AYFCD.id
LEFT JOIN
    E2I7U SDLLR
    ON JGT2H.BRQP2 = SDLLR.id
LEFT JOIN
    E2I7U RIIW6
    ON JGT2H.FFTBJ = RIIW6.id
LEFT JOIN
    E2I7U FA75Y
    ON AYFCD.FFTBJ = FA75Y.id
ORDER BY rn.id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [FZX4Y:77!null, QWTOI:78!null, PDX5Y:79!null, V45YB:80!null, DAGQN:81!null, SFQTS:82!null, HVHRZ:83!null, RQI4M:84, RNVLS:85]\n" +
			" └─ Sort(rn.id:0!null ASC nullsFirst)\n" +
			"     └─ Project\n" +
			"         ├─ columns: [rn.id:0!null, rn.wnunu:1!null, rn.hhvlx:2!null, rn.hvhrz:3!null, rn.ykssu:4, rn.fhcyt:5, jgt2h.id:6!null, jgt2h.brqp2:7!null, jgt2h.fftbj:8!null, jgt2h.a7xo2:9, jgt2h.kbo7r:10!null, jgt2h.ecdkm:11, jgt2h.numk2:12!null, jgt2h.letoe:13!null, jgt2h.ykssu:14, jgt2h.fhcyt:15, ayfcd.id:16!null, ayfcd.brqp2:17!null, ayfcd.fftbj:18!null, ayfcd.a7xo2:19, ayfcd.kbo7r:20!null, ayfcd.ecdkm:21, ayfcd.numk2:22!null, ayfcd.letoe:23!null, ayfcd.ykssu:24, ayfcd.fhcyt:25, sdllr.id:26!null, sdllr.dkcaj:27!null, sdllr.kng7t:28, sdllr.tw55n:29!null, sdllr.qrqxw:30!null, sdllr.ecxaj:31!null, sdllr.fgg57:32, sdllr.zh72s:33, sdllr.fsk67:34!null, sdllr.xqdyt:35!null, sdllr.tce7a:36, sdllr.iwv2h:37, sdllr.hpcms:38!null, sdllr.n5cc2:39, sdllr.fhcyt:40, sdllr.etaq7:41, sdllr.a75x7:42, riiw6.id:43!null, riiw6.dkcaj:44!null, riiw6.kng7t:45, riiw6.tw55n:46!null, riiw6.qrqxw:47!null, riiw6.ecxaj:48!null, riiw6.fgg57:49, riiw6.zh72s:50, riiw6.fsk67:51!null, riiw6.xqdyt:52!null, riiw6.tce7a:53, riiw6.iwv2h:54, riiw6.hpcms:55!null, riiw6.n5cc2:56, riiw6.fhcyt:57, riiw6.etaq7:58, riiw6.a75x7:59, fa75y.id:60!null, fa75y.dkcaj:61!null, fa75y.kng7t:62, fa75y.tw55n:63!null, fa75y.qrqxw:64!null, fa75y.ecxaj:65!null, fa75y.fgg57:66, fa75y.zh72s:67, fa75y.fsk67:68!null, fa75y.xqdyt:69!null, fa75y.tce7a:70, fa75y.iwv2h:71, fa75y.hpcms:72!null, fa75y.n5cc2:73, fa75y.fhcyt:74, fa75y.etaq7:75, fa75y.a75x7:76, sdllr.tw55n:29!null as FZX4Y, jgt2h.letoe:13!null as QWTOI, riiw6.tw55n:46!null as PDX5Y, ayfcd.numk2:22!null as V45YB, ayfcd.letoe:23!null as DAGQN, fa75y.tw55n:63!null as SFQTS, rn.hvhrz:3!null as HVHRZ, CASE  WHEN rn.ykssu:4 IS NULL THEN N/A (longtext) ELSE rn.ykssu:4 END as RQI4M, CASE  WHEN rn.fhcyt:5 IS NULL THEN N/A (longtext) ELSE rn.fhcyt:5 END as RNVLS]\n" +
			"         └─ LeftOuterHashJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ayfcd.fftbj:18!null\n" +
			"             │   └─ fa75y.id:60!null\n" +
			"             ├─ LeftOuterHashJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ jgt2h.fftbj:8!null\n" +
			"             │   │   └─ riiw6.id:43!null\n" +
			"             │   ├─ LeftOuterHashJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ jgt2h.brqp2:7!null\n" +
			"             │   │   │   └─ sdllr.id:26!null\n" +
			"             │   │   ├─ LeftOuterHashJoin\n" +
			"             │   │   │   ├─ Eq\n" +
			"             │   │   │   │   ├─ rn.hhvlx:2!null\n" +
			"             │   │   │   │   └─ ayfcd.id:16!null\n" +
			"             │   │   │   ├─ LeftOuterMergeJoin\n" +
			"             │   │   │   │   ├─ cmp: Eq\n" +
			"             │   │   │   │   │   ├─ rn.wnunu:1!null\n" +
			"             │   │   │   │   │   └─ jgt2h.id:6!null\n" +
			"             │   │   │   │   ├─ TableAlias(rn)\n" +
			"             │   │   │   │   │   └─ IndexedTableAccess(QYWQD)\n" +
			"             │   │   │   │   │       ├─ index: [QYWQD.WNUNU]\n" +
			"             │   │   │   │   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │   │   │       └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"             │   │   │   │   └─ TableAlias(jgt2h)\n" +
			"             │   │   │   │       └─ IndexedTableAccess(NOXN3)\n" +
			"             │   │   │   │           ├─ index: [NOXN3.id]\n" +
			"             │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │   │   │   │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   │   │   └─ HashLookup\n" +
			"             │   │   │       ├─ left-key: TUPLE(rn.hhvlx:2!null)\n" +
			"             │   │   │       ├─ right-key: TUPLE(ayfcd.id:0!null)\n" +
			"             │   │   │       └─ TableAlias(ayfcd)\n" +
			"             │   │   │           └─ Table\n" +
			"             │   │   │               ├─ name: NOXN3\n" +
			"             │   │   │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │   │   └─ HashLookup\n" +
			"             │   │       ├─ left-key: TUPLE(jgt2h.brqp2:7!null)\n" +
			"             │   │       ├─ right-key: TUPLE(sdllr.id:0!null)\n" +
			"             │   │       └─ TableAlias(sdllr)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: E2I7U\n" +
			"             │   │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │   └─ HashLookup\n" +
			"             │       ├─ left-key: TUPLE(jgt2h.fftbj:8!null)\n" +
			"             │       ├─ right-key: TUPLE(riiw6.id:0!null)\n" +
			"             │       └─ TableAlias(riiw6)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: E2I7U\n" +
			"             │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ HashLookup\n" +
			"                 ├─ left-key: TUPLE(ayfcd.fftbj:18!null)\n" +
			"                 ├─ right-key: TUPLE(fa75y.id:0!null)\n" +
			"                 └─ TableAlias(fa75y)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: E2I7U\n" +
			"                         └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
SELECT
    QRQXW 
FROM 
    E2I7U 
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [e2i7u.qrqxw:4!null]\n" +
			" └─ IndexedTableAccess(E2I7U)\n" +
			"     ├─ index: [E2I7U.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
SELECT 
    sn.Y3IOU,
    sn.ECDKM
FROM 
    (SELECT
        ROW_NUMBER() OVER (ORDER BY id ASC) Y3IOU, 
        id,
        NUMK2,
        ECDKM
    FROM
    NOXN3) sn
WHERE NUMK2 = 4
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [sn.Y3IOU:0!null, sn.ecdkm:3]\n" +
			" └─ Sort(sn.id:1!null ASC nullsFirst)\n" +
			"     └─ SubqueryAlias\n" +
			"         ├─ name: sn\n" +
			"         ├─ outerVisibility: false\n" +
			"         ├─ cacheable: true\n" +
			"         └─ Filter\n" +
			"             ├─ Eq\n" +
			"             │   ├─ noxn3.numk2:2!null\n" +
			"             │   └─ 4 (tinyint)\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [Y3IOU:4!null, noxn3.id:1!null, noxn3.numk2:2!null, noxn3.ecdkm:3]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [row_number() over ( order by noxn3.id asc):0!null, noxn3.id:1!null, noxn3.numk2:2!null, noxn3.ecdkm:3, row_number() over ( order by noxn3.id asc):0!null as Y3IOU]\n" +
			"                     └─ Window\n" +
			"                         ├─ row_number() over ( order by noxn3.id ASC)\n" +
			"                         ├─ noxn3.id:0!null\n" +
			"                         ├─ noxn3.numk2:2!null\n" +
			"                         ├─ noxn3.ecdkm:1\n" +
			"                         └─ Table\n" +
			"                             ├─ name: NOXN3\n" +
			"                             └─ columns: [id ecdkm numk2]\n" +
			"",
	},
	{
		Query: `
SELECT id, NUMK2, ECDKM
FROM NOXN3
ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [noxn3.id:0!null, noxn3.numk2:6!null, noxn3.ecdkm:5]\n" +
			" └─ IndexedTableAccess(NOXN3)\n" +
			"     ├─ index: [NOXN3.id]\n" +
			"     ├─ static: [{[NULL, ∞)}]\n" +
			"     └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    CASE 
        WHEN NUMK2 = 2 THEN ECDKM
        ELSE 0
    END AS RGXLL
    FROM NOXN3
    ORDER BY id ASC`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [RGXLL:10]\n" +
			" └─ Project\n" +
			"     ├─ columns: [noxn3.id:0!null, noxn3.brqp2:1!null, noxn3.fftbj:2!null, noxn3.a7xo2:3, noxn3.kbo7r:4!null, noxn3.ecdkm:5, noxn3.numk2:6!null, noxn3.letoe:7!null, noxn3.ykssu:8, noxn3.fhcyt:9, CASE  WHEN Eq\n" +
			"     │   ├─ noxn3.numk2:6!null\n" +
			"     │   └─ 2 (tinyint)\n" +
			"     │   THEN noxn3.ecdkm:5 ELSE 0 (tinyint) END as RGXLL]\n" +
			"     └─ IndexedTableAccess(NOXN3)\n" +
			"         ├─ index: [NOXN3.id]\n" +
			"         ├─ static: [{[NULL, ∞)}]\n" +
			"         └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
SELECT
    pa.DZLIM as ECUWU,
    nd.TW55N
FROM JJGQT QNRBH
INNER JOIN E2I7U nd
    ON QNRBH.LUEVY = nd.id
INNER JOIN XOAOP pa
    ON QNRBH.CH3FR = pa.id`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [ECUWU:23!null, nd.tw55n:6!null]\n" +
			" └─ Project\n" +
			"     ├─ columns: [qnrbh.id:0!null, qnrbh.ch3fr:1!null, qnrbh.luevy:2!null, nd.id:6!null, nd.dkcaj:7!null, nd.kng7t:8, nd.tw55n:9!null, nd.qrqxw:10!null, nd.ecxaj:11!null, nd.fgg57:12, nd.zh72s:13, nd.fsk67:14!null, nd.xqdyt:15!null, nd.tce7a:16, nd.iwv2h:17, nd.hpcms:18!null, nd.n5cc2:19, nd.fhcyt:20, nd.etaq7:21, nd.a75x7:22, pa.id:3!null, pa.dzlim:4!null, pa.f3yue:5, pa.dzlim:4!null as ECUWU]\n" +
			"     └─ LookupJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ qnrbh.luevy:2!null\n" +
			"         │   └─ nd.id:6!null\n" +
			"         ├─ LookupJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ qnrbh.ch3fr:1!null\n" +
			"         │   │   └─ pa.id:3!null\n" +
			"         │   ├─ TableAlias(qnrbh)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: JJGQT\n" +
			"         │   │       └─ columns: [id ch3fr luevy]\n" +
			"         │   └─ TableAlias(pa)\n" +
			"         │       └─ IndexedTableAccess(XOAOP)\n" +
			"         │           ├─ index: [XOAOP.id]\n" +
			"         │           └─ columns: [id dzlim f3yue]\n" +
			"         └─ TableAlias(nd)\n" +
			"             └─ IndexedTableAccess(E2I7U)\n" +
			"                 ├─ index: [E2I7U.id]\n" +
			"                 └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `-- deletes
DELETE FROM QYWQD
WHERE id IN ('1','2','3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ qywqd.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(QYWQD)\n" +
			"             ├─ index: [QYWQD.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM HDDVB
WHERE
    FV24E IN ('1', '2', '3') OR
    UJ6XY IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ Or\n" +
			"         │   ├─ HashIn\n" +
			"         │   │   ├─ hddvb.fv24e:1!null\n" +
			"         │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         │   └─ HashIn\n" +
			"         │       ├─ hddvb.uj6xy:2!null\n" +
			"         │       └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ Table\n" +
			"             ├─ name: HDDVB\n" +
			"             └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM QYWQD
WHERE id IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ qywqd.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(QYWQD)\n" +
			"             ├─ index: [QYWQD.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM AMYXQ
WHERE LUEVY IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ amyxq.luevy:2!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(AMYXQ)\n" +
			"             ├─ index: [AMYXQ.LUEVY]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"",
	},
	{
		Query: `
DELETE FROM HGMQ6
WHERE id IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ hgmq6.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(HGMQ6)\n" +
			"             ├─ index: [HGMQ6.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM HDDVB
WHERE id IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ hddvb.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(HDDVB)\n" +
			"             ├─ index: [HDDVB.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM FLQLP
WHERE LUEVY IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ flqlp.luevy:2!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(FLQLP)\n" +
			"             ├─ index: [FLQLP.LUEVY]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM FLQLP
WHERE id IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ flqlp.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(FLQLP)\n" +
			"             ├─ index: [FLQLP.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"",
	},
	{
		Query: `
DELETE FROM FLQLP
WHERE id IN ('1', '2', '3')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Delete\n" +
			"     └─ Filter\n" +
			"         ├─ HashIn\n" +
			"         │   ├─ flqlp.id:0!null\n" +
			"         │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"         └─ IndexedTableAccess(FLQLP)\n" +
			"             ├─ index: [FLQLP.id]\n" +
			"             ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"",
	},
	{
		Query: `
-- updates
UPDATE E2I7U nd
SET nd.KNG7T = (SELECT gn.id FROM WE72E gn INNER JOIN TDRVG ltnm ON ltnm.SSHPJ = gn.SSHPJ WHERE ltnm.FGG57 = nd.FGG57)
WHERE nd.FGG57 IS NOT NULL AND nd.KNG7T IS NULL`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Update\n" +
			"     └─ UpdateSource(SET nd.kng7t:2 = Subquery\n" +
			"         ├─ cacheable: false\n" +
			"         └─ Project\n" +
			"             ├─ columns: [gn.id:17!null]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ltnm.fgg57:22!null\n" +
			"                 │   └─ nd.fgg57:6\n" +
			"                 └─ MergeJoin\n" +
			"                     ├─ cmp: Eq\n" +
			"                     │   ├─ gn.sshpj:19!null\n" +
			"                     │   └─ ltnm.sshpj:23!null\n" +
			"                     ├─ TableAlias(gn)\n" +
			"                     │   └─ IndexedTableAccess(WE72E)\n" +
			"                     │       ├─ index: [WE72E.SSHPJ]\n" +
			"                     │       ├─ static: [{[NULL, ∞)}]\n" +
			"                     │       └─ columns: [id qz7e7 sshpj fhcyt]\n" +
			"                     └─ TableAlias(ltnm)\n" +
			"                         └─ IndexedTableAccess(TDRVG)\n" +
			"                             ├─ index: [TDRVG.SSHPJ]\n" +
			"                             ├─ static: [{[NULL, ∞)}]\n" +
			"                             └─ columns: [id fgg57 sshpj sfj6l zh72s]\n" +
			"        )\n" +
			"         └─ Filter\n" +
			"             ├─ AND\n" +
			"             │   ├─ NOT\n" +
			"             │   │   └─ nd.fgg57:6 IS NULL\n" +
			"             │   └─ nd.kng7t:2 IS NULL\n" +
			"             └─ TableAlias(nd)\n" +
			"                 └─ IndexedTableAccess(E2I7U)\n" +
			"                     ├─ index: [E2I7U.KNG7T]\n" +
			"                     ├─ static: [{[NULL, NULL]}]\n" +
			"                     └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `

UPDATE S3FQX SET ADWYM = 0, FPUYA = 0`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Update\n" +
			"         └─ Trigger(CREATE TRIGGER S3FQX_on_update BEFORE UPDATE ON S3FQX\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF NEW.ADWYM NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ADWYM field is an int boolean (0/1).';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ADWYM field is an int boolean (0/1).';\n" +
			"              END IF;\n" +
			"              IF NEW.FPUYA NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The FPUYA field is an int boolean (0/1).';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The FPUYA field is an int boolean (0/1).';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ UpdateSource(SET s3fqx.adwym:1!null = 0 (tinyint),SET s3fqx.fpuya:2!null = 0 (tinyint))\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: S3FQX\n" +
			"             │       └─ columns: [id adwym fpuya]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: new.adwym:4!null\n" +
			"                 │           └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ADWYM field is an int boolean (0/1)., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.fpuya:5!null\n" +
			"                             └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The FPUYA field is an int boolean (0/1)., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
-- inserts
INSERT INTO THNTS
    (id, NFRYN, IXUXU, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT id FROM JMRQL WHERE DZLIM = 'T4IBQ') AS NFRYN,
    id AS IXUXU,
    NULL AS FHCYT
FROM
    YK2GW
WHERE
    id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, NFRYN, IXUXU, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: THNTS\n" +
			"         │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER THNTS_on_insert BEFORE INSERT ON THNTS\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.IXUXU IS NULL\n" +
			"              THEN\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The IXUXU field is mandatory.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, NFRYN:1!null, IXUXU:2, FHCYT:3]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:30!null, NFRYN:31, IXUXU:32!null, FHCYT:33]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [yk2gw.id:0!null, yk2gw.ftqlq:1!null, yk2gw.tuxml:2, yk2gw.paef5:3, yk2gw.rucy4:4, yk2gw.tpnj6:5!null, yk2gw.lbl53:6, yk2gw.nb3qs:7, yk2gw.eo7iv:8, yk2gw.muhjf:9, yk2gw.fm34l:10, yk2gw.ty5rf:11, yk2gw.zhtlh:12, yk2gw.npb7w:13, yk2gw.sx3hh:14, yk2gw.isbnf:15, yk2gw.ya7yb:16, yk2gw.c5ykb:17, yk2gw.qk7kt:18, yk2gw.ffge6:19, yk2gw.fiigj:20, yk2gw.sh3nc:21, yk2gw.ntena:22, yk2gw.m4aub:23, yk2gw.x5air:24, yk2gw.sab6m:25, yk2gw.g5qi5:26, yk2gw.zvqvd:27, yk2gw.ykssu:28, yk2gw.fhcyt:29, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [jmrql.id:30!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ jmrql.dzlim:31!null\n" +
			"             │           │           │   └─ T4IBQ (longtext)\n" +
			"             │           │           └─ IndexedTableAccess(JMRQL)\n" +
			"             │           │               ├─ index: [JMRQL.DZLIM]\n" +
			"             │           │               ├─ static: [{[T4IBQ, T4IBQ]}]\n" +
			"             │           │               └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as NFRYN, yk2gw.id:0!null as IXUXU, NULL (null) as FHCYT]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ yk2gw.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ IndexedTableAccess(YK2GW)\n" +
			"             │                   ├─ index: [YK2GW.id]\n" +
			"             │                   ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(new.ixuxu:2 IS NULL)\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The IXUXU field is mandatory., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO QYWQD
    (id, WNUNU, HHVLX, HVHRZ, YKSSU, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    ITWML.DRIWM AS WNUNU,
    ITWML.JIEVY AS HHVLX,
    1.0 AS HVHRZ,
    NULL AS YKSSU,
    NULL AS FHCYT
FROM
    (
    SELECT
        sn.id AS DRIWM,
        SKPM6.id AS JIEVY,
        sn.ECDKM AS HVHRZ
    FROM
        NOXN3 sn -- Potential upstream VUMUY
    INNER JOIN
        NOXN3 SKPM6 -- We can find a potential downstream edge
    ON
        SKPM6.BRQP2 = sn.FFTBJ
    LEFT JOIN
        QYWQD rn -- Join existing regnet records and keep where no corresponding is found
    ON
            rn.WNUNU = sn.id
        AND
            rn.HHVLX = SKPM6.id
    WHERE
            sn.NUMK2 = 1 -- Potential upstream edge is activity TAFAX
        AND
            rn.WNUNU IS NULL AND rn.HHVLX IS NULL -- Keep only where no corresponding is found
    ) ITWML`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, WNUNU, HHVLX, HVHRZ, YKSSU, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: QYWQD\n" +
			"         │       └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER QYWQD_on_insert BEFORE INSERT ON QYWQD\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT FFTBJ FROM NOXN3 WHERE id = NEW.WNUNU) <> (SELECT BRQP2 FROM NOXN3 WHERE id = NEW.HHVLX)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The target UWBAI of the upstream edge must be the same as the source UWBAI of the downstream edge (the enzyme UWBAI).';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The target UWBAI of the upstream edge must be the same as the source UWBAI of the downstream edge (the enzyme UWBAI).';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, WNUNU:1!null, HHVLX:2!null, HVHRZ:3!null, YKSSU:4, FHCYT:5]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:3!null, WNUNU:4!null, HHVLX:5!null, HVHRZ:6!null, YKSSU:7, FHCYT:8]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [itwml.DRIWM:0!null, itwml.JIEVY:1!null, itwml.HVHRZ:2, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, itwml.DRIWM:0!null as WNUNU, itwml.JIEVY:1!null as HHVLX, 1 (decimal(2,1)) as HVHRZ, NULL (null) as YKSSU, NULL (null) as FHCYT]\n" +
			"             │           └─ SubqueryAlias\n" +
			"             │               ├─ name: itwml\n" +
			"             │               ├─ outerVisibility: false\n" +
			"             │               ├─ cacheable: true\n" +
			"             │               └─ Project\n" +
			"             │                   ├─ columns: [DRIWM:26!null, JIEVY:27!null, HVHRZ:28]\n" +
			"             │                   └─ Project\n" +
			"             │                       ├─ columns: [sn.id:0!null, sn.brqp2:1!null, sn.fftbj:2!null, sn.a7xo2:3, sn.kbo7r:4!null, sn.ecdkm:5, sn.numk2:6!null, sn.letoe:7!null, sn.ykssu:8, sn.fhcyt:9, skpm6.id:10!null, skpm6.brqp2:11!null, skpm6.fftbj:12!null, skpm6.a7xo2:13, skpm6.kbo7r:14!null, skpm6.ecdkm:15, skpm6.numk2:16!null, skpm6.letoe:17!null, skpm6.ykssu:18, skpm6.fhcyt:19, rn.id:20!null, rn.wnunu:21!null, rn.hhvlx:22!null, rn.hvhrz:23!null, rn.ykssu:24, rn.fhcyt:25, sn.id:0!null as DRIWM, skpm6.id:10!null as JIEVY, sn.ecdkm:5 as HVHRZ]\n" +
			"             │                       └─ Filter\n" +
			"             │                           ├─ AND\n" +
			"             │                           │   ├─ rn.wnunu:21!null IS NULL\n" +
			"             │                           │   └─ rn.hhvlx:22!null IS NULL\n" +
			"             │                           └─ LeftOuterHashJoin\n" +
			"             │                               ├─ AND\n" +
			"             │                               │   ├─ Eq\n" +
			"             │                               │   │   ├─ rn.wnunu:21!null\n" +
			"             │                               │   │   └─ sn.id:0!null\n" +
			"             │                               │   └─ Eq\n" +
			"             │                               │       ├─ rn.hhvlx:22!null\n" +
			"             │                               │       └─ skpm6.id:10!null\n" +
			"             │                               ├─ MergeJoin\n" +
			"             │                               │   ├─ cmp: Eq\n" +
			"             │                               │   │   ├─ sn.fftbj:2!null\n" +
			"             │                               │   │   └─ skpm6.brqp2:11!null\n" +
			"             │                               │   ├─ Filter\n" +
			"             │                               │   │   ├─ Eq\n" +
			"             │                               │   │   │   ├─ sn.numk2:6!null\n" +
			"             │                               │   │   │   └─ 1 (tinyint)\n" +
			"             │                               │   │   └─ TableAlias(sn)\n" +
			"             │                               │   │       └─ IndexedTableAccess(NOXN3)\n" +
			"             │                               │   │           ├─ index: [NOXN3.FFTBJ]\n" +
			"             │                               │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                               │   │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │                               │   └─ TableAlias(skpm6)\n" +
			"             │                               │       └─ IndexedTableAccess(NOXN3)\n" +
			"             │                               │           ├─ index: [NOXN3.BRQP2]\n" +
			"             │                               │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                               │           └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"             │                               └─ HashLookup\n" +
			"             │                                   ├─ left-key: TUPLE(sn.id:0!null, skpm6.id:10!null)\n" +
			"             │                                   ├─ right-key: TUPLE(rn.wnunu:1!null, rn.hhvlx:2!null)\n" +
			"             │                                   └─ TableAlias(rn)\n" +
			"             │                                       └─ Table\n" +
			"             │                                           ├─ name: QYWQD\n" +
			"             │                                           └─ columns: [id wnunu hhvlx hvhrz ykssu fhcyt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ Eq\n" +
			"                             ├─ Subquery\n" +
			"                             │   ├─ cacheable: false\n" +
			"                             │   └─ Project\n" +
			"                             │       ├─ columns: [noxn3.fftbj:8!null]\n" +
			"                             │       └─ Filter\n" +
			"                             │           ├─ Eq\n" +
			"                             │           │   ├─ noxn3.id:6!null\n" +
			"                             │           │   └─ new.wnunu:1!null\n" +
			"                             │           └─ IndexedTableAccess(NOXN3)\n" +
			"                             │               ├─ index: [NOXN3.id]\n" +
			"                             │               └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                             └─ Subquery\n" +
			"                                 ├─ cacheable: false\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [noxn3.brqp2:7!null]\n" +
			"                                     └─ Filter\n" +
			"                                         ├─ Eq\n" +
			"                                         │   ├─ noxn3.id:6!null\n" +
			"                                         │   └─ new.hhvlx:2!null\n" +
			"                                         └─ IndexedTableAccess(NOXN3)\n" +
			"                                             ├─ index: [NOXN3.id]\n" +
			"                                             └─ columns: [id brqp2 fftbj a7xo2 kbo7r ecdkm numk2 letoe ykssu fhcyt]\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The target UWBAI of the upstream edge must be the same as the source UWBAI of the downstream edge (the enzyme UWBAI)., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO WE72E
    (id, QZ7E7, SSHPJ, FHCYT)
SELECT
    id,
    SFJ6L,
    SSHPJ,
    NULL AS FHCYT
FROM
    TDRVG
WHERE
    id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, QZ7E7, SSHPJ, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: WE72E\n" +
			"         │       └─ columns: [id qz7e7 sshpj fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER WE72E_on_insert BEFORE INSERT ON WE72E\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.QZ7E7 IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR\n" +
			"                NEW.SSHPJ IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, QZ7E7:1!null, SSHPJ:2!null, FHCYT:3]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [tdrvg.id:0!null, tdrvg.sfj6l:3!null, tdrvg.sshpj:2!null, FHCYT:5]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [tdrvg.id:0!null, tdrvg.fgg57:1!null, tdrvg.sshpj:2!null, tdrvg.sfj6l:3!null, tdrvg.zh72s:4!null, NULL (null) as FHCYT]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ tdrvg.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ IndexedTableAccess(TDRVG)\n" +
			"             │                   ├─ index: [TDRVG.id]\n" +
			"             │                   ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                   └─ columns: [id fgg57 sshpj sfj6l zh72s]\n" +
			"             └─ BEGIN .. END\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(Or\n" +
			"                         ├─ InSubquery\n" +
			"                         │   ├─ left: new.qz7e7:1!null\n" +
			"                         │   └─ right: Subquery\n" +
			"                         │       ├─ cacheable: false\n" +
			"                         │       └─ Project\n" +
			"                         │           ├─ columns: [tpxhz.svaz4:5!null]\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: TPXHZ\n" +
			"                         │               └─ columns: [id svaz4]\n" +
			"                         └─ InSubquery\n" +
			"                             ├─ left: new.sshpj:2!null\n" +
			"                             └─ right: Subquery\n" +
			"                                 ├─ cacheable: false\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [tpxhz.svaz4:5!null]\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: TPXHZ\n" +
			"                                         └─ columns: [id svaz4]\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO AMYXQ
    (id, GXLUB, LUEVY, XQDYT, AMYXQ, OZTQF, Z35GY, KKGN5)
SELECT /*+ JOIN_ORDER(ufc, nd, YBBG5) */
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT /*+ JOIN_ORDER(cla, bs) */ bs.id FROM THNTS bs INNER JOIN YK2GW cla ON cla.id = bs.IXUXU WHERE cla.FTQLQ = ufc.T4IBQ) AS GXLUB,
    nd.id AS LUEVY,
    nd.XQDYT AS XQDYT,
    ufc.AMYXQ + 0.0 AS AMYXQ,
    CASE
        WHEN
            YBBG5.DZLIM = 'KTNZ2'
        THEN ufc.KTNZ2 + 0.0
        WHEN
            YBBG5.DZLIM = 'HIID2'
        THEN ufc.HIID2 + 0.0
        WHEN
            YBBG5.DZLIM = 'SH7TP'
        THEN ufc.SH7TP + 0.0
        WHEN
            YBBG5.DZLIM = 'VVKNB'
        THEN ufc.VVKNB + 0.0
        WHEN
            YBBG5.DZLIM = 'DN3OQ'
        THEN ufc.DN3OQ + 0.0
        ELSE NULL
    END AS OZTQF,
    ufc.SRZZO + 0.0 AS Z35GY,
    ufc.id AS KKGN5
FROM
    SISUT ufc
INNER JOIN
    E2I7U nd
ON
    nd.ZH72S = ufc.ZH72S
INNER JOIN
    XGSJM YBBG5
ON
    YBBG5.id = nd.XQDYT
WHERE
    ufc.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, LUEVY, XQDYT, AMYXQ, OZTQF, Z35GY, KKGN5)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: AMYXQ\n" +
			"         │       └─ columns: [id gxlub luevy xqdyt amyxq oztqf z35gy kkgn5]\n" +
			"         └─ Trigger(CREATE TRIGGER AMYXQ_on_insert BEFORE INSERT ON AMYXQ\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT FGG57 FROM E2I7U WHERE id = NEW.LUEVY) IS NULL\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The given UWBAI can not be connected to a AMYXQ record as it does not have IYDZV.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The given UWBAI can not be connected to a AMYXQ record as it does not have IYDZV.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.AMYXQ < 0 OR NEW.OZTQF < 0 OR NEW.Z35GY < 0\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'All values in AMYXQ must ne non-negative.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'All values in AMYXQ must ne non-negative.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, LUEVY:2!null, XQDYT:3!null, AMYXQ:4!null, OZTQF:5!null, Z35GY:6!null, KKGN5:7]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:31!null, GXLUB:32, LUEVY:33!null, XQDYT:34!null, AMYXQ:35, OZTQF:36, Z35GY:37, KKGN5:38!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ufc.id:0!null, ufc.t4ibq:1, ufc.zh72s:2, ufc.amyxq:3, ufc.ktnz2:4, ufc.hiid2:5, ufc.dn3oq:6, ufc.vvknb:7, ufc.sh7tp:8, ufc.srzzo:9, ufc.qz6vt:10, nd.id:11!null, nd.dkcaj:12!null, nd.kng7t:13, nd.tw55n:14!null, nd.qrqxw:15!null, nd.ecxaj:16!null, nd.fgg57:17, nd.zh72s:18, nd.fsk67:19!null, nd.xqdyt:20!null, nd.tce7a:21, nd.iwv2h:22, nd.hpcms:23!null, nd.n5cc2:24, nd.fhcyt:25, nd.etaq7:26, nd.a75x7:27, ybbg5.id:28!null, ybbg5.dzlim:29!null, ybbg5.f3yue:30, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [bs.id:31!null]\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [bs.id:61!null, bs.nfryn:62!null, bs.ixuxu:63, bs.fhcyt:64, cla.id:31!null, cla.ftqlq:32!null, cla.tuxml:33, cla.paef5:34, cla.rucy4:35, cla.tpnj6:36!null, cla.lbl53:37, cla.nb3qs:38, cla.eo7iv:39, cla.muhjf:40, cla.fm34l:41, cla.ty5rf:42, cla.zhtlh:43, cla.npb7w:44, cla.sx3hh:45, cla.isbnf:46, cla.ya7yb:47, cla.c5ykb:48, cla.qk7kt:49, cla.ffge6:50, cla.fiigj:51, cla.sh3nc:52, cla.ntena:53, cla.m4aub:54, cla.x5air:55, cla.sab6m:56, cla.g5qi5:57, cla.zvqvd:58, cla.ykssu:59, cla.fhcyt:60]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ cla.ftqlq:32!null\n" +
			"             │           │               │   └─ ufc.t4ibq:1\n" +
			"             │           │               └─ MergeJoin\n" +
			"             │           │                   ├─ cmp: Eq\n" +
			"             │           │                   │   ├─ cla.id:31!null\n" +
			"             │           │                   │   └─ bs.ixuxu:63\n" +
			"             │           │                   ├─ TableAlias(cla)\n" +
			"             │           │                   │   └─ IndexedTableAccess(YK2GW)\n" +
			"             │           │                   │       ├─ index: [YK2GW.id]\n" +
			"             │           │                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                   │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │           │                   └─ TableAlias(bs)\n" +
			"             │           │                       └─ IndexedTableAccess(THNTS)\n" +
			"             │           │                           ├─ index: [THNTS.IXUXU]\n" +
			"             │           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │           │   as GXLUB, nd.id:11!null as LUEVY, nd.xqdyt:20!null as XQDYT, (ufc.amyxq:3 + 0 (decimal(2,1))) as AMYXQ, CASE  WHEN Eq\n" +
			"             │           │   ├─ ybbg5.dzlim:29!null\n" +
			"             │           │   └─ KTNZ2 (longtext)\n" +
			"             │           │   THEN (ufc.ktnz2:4 + 0 (decimal(2,1))) WHEN Eq\n" +
			"             │           │   ├─ ybbg5.dzlim:29!null\n" +
			"             │           │   └─ HIID2 (longtext)\n" +
			"             │           │   THEN (ufc.hiid2:5 + 0 (decimal(2,1))) WHEN Eq\n" +
			"             │           │   ├─ ybbg5.dzlim:29!null\n" +
			"             │           │   └─ SH7TP (longtext)\n" +
			"             │           │   THEN (ufc.sh7tp:8 + 0 (decimal(2,1))) WHEN Eq\n" +
			"             │           │   ├─ ybbg5.dzlim:29!null\n" +
			"             │           │   └─ VVKNB (longtext)\n" +
			"             │           │   THEN (ufc.vvknb:7 + 0 (decimal(2,1))) WHEN Eq\n" +
			"             │           │   ├─ ybbg5.dzlim:29!null\n" +
			"             │           │   └─ DN3OQ (longtext)\n" +
			"             │           │   THEN (ufc.dn3oq:6 + 0 (decimal(2,1))) ELSE NULL (null) END as OZTQF, (ufc.srzzo:9 + 0 (decimal(2,1))) as Z35GY, ufc.id:0!null as KKGN5]\n" +
			"             │           └─ HashJoin\n" +
			"             │               ├─ Eq\n" +
			"             │               │   ├─ nd.zh72s:18\n" +
			"             │               │   └─ ufc.zh72s:2\n" +
			"             │               ├─ Filter\n" +
			"             │               │   ├─ HashIn\n" +
			"             │               │   │   ├─ ufc.id:0!null\n" +
			"             │               │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               │   └─ TableAlias(ufc)\n" +
			"             │               │       └─ IndexedTableAccess(SISUT)\n" +
			"             │               │           ├─ index: [SISUT.id]\n" +
			"             │               │           ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │               │           └─ columns: [id t4ibq zh72s amyxq ktnz2 hiid2 dn3oq vvknb sh7tp srzzo qz6vt]\n" +
			"             │               └─ HashLookup\n" +
			"             │                   ├─ left-key: TUPLE(ufc.zh72s:2)\n" +
			"             │                   ├─ right-key: TUPLE(nd.zh72s:7)\n" +
			"             │                   └─ MergeJoin\n" +
			"             │                       ├─ cmp: Eq\n" +
			"             │                       │   ├─ nd.xqdyt:20!null\n" +
			"             │                       │   └─ ybbg5.id:28!null\n" +
			"             │                       ├─ TableAlias(nd)\n" +
			"             │                       │   └─ IndexedTableAccess(E2I7U)\n" +
			"             │                       │       ├─ index: [E2I7U.XQDYT]\n" +
			"             │                       │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │                       │       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                       └─ TableAlias(ybbg5)\n" +
			"             │                           └─ IndexedTableAccess(XGSJM)\n" +
			"             │                               ├─ index: [XGSJM.id]\n" +
			"             │                               ├─ static: [{[NULL, ∞)}]\n" +
			"             │                               └─ columns: [id dzlim f3yue]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(Subquery\n" +
			"                 │       ├─ cacheable: false\n" +
			"                 │       └─ Project\n" +
			"                 │           ├─ columns: [e2i7u.fgg57:14]\n" +
			"                 │           └─ Filter\n" +
			"                 │               ├─ Eq\n" +
			"                 │               │   ├─ e2i7u.id:8!null\n" +
			"                 │               │   └─ new.luevy:2!null\n" +
			"                 │               └─ IndexedTableAccess(E2I7U)\n" +
			"                 │                   ├─ index: [E2I7U.id]\n" +
			"                 │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                 │       IS NULL)\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The given UWBAI can not be connected to a AMYXQ record as it does not have IYDZV., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(Or\n" +
			"                         ├─ Or\n" +
			"                         │   ├─ LessThan\n" +
			"                         │   │   ├─ new.amyxq:4!null\n" +
			"                         │   │   └─ 0 (tinyint)\n" +
			"                         │   └─ LessThan\n" +
			"                         │       ├─ new.oztqf:5!null\n" +
			"                         │       └─ 0 (tinyint)\n" +
			"                         └─ LessThan\n" +
			"                             ├─ new.z35gy:6!null\n" +
			"                             └─ 0 (tinyint)\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = All values in AMYXQ must ne non-negative., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO SZQWJ
    (id, GXLUB, CH3FR, D237E, JOGI6)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT bs.id FROM THNTS bs INNER JOIN YK2GW cla ON cla.id = bs.IXUXU WHERE cla.FTQLQ = ums.T4IBQ) AS GXLUB,
    (SELECT id FROM XOAOP WHERE DZLIM = 'NER') AS CH3FR,
    CASE -- This ugly thing is because of Dolt's problematic conversion handling at insertions
        WHEN ums.ner > 0.5 THEN 1
        WHEN ums.ner < 0.5 THEN 0
        ELSE NULL
    END AS D237E,
    ums.id AS JOGI6
FROM
    FG26Y ums
WHERE
    ums.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, CH3FR, D237E, JOGI6)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SZQWJ\n" +
			"         │       └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"         └─ Trigger(CREATE TRIGGER SZQWJ_on_insert BEFORE INSERT ON SZQWJ\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT DZLIM FROM XOAOP WHERE id = NEW.CH3FR) NOT IN ('NER', 'BER', 'HR', 'MMR')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.D237E NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The D237E field must be either 0 or 1.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The D237E field must be either 0 or 1.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, CH3FR:2!null, D237E:3!null, JOGI6:4]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:7!null, GXLUB:8, CH3FR:9, D237E:10, JOGI6:11!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.qz6vt:6, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [bs.id:7!null]\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [bs.id:37!null, bs.nfryn:38!null, bs.ixuxu:39, bs.fhcyt:40, cla.id:7!null, cla.ftqlq:8!null, cla.tuxml:9, cla.paef5:10, cla.rucy4:11, cla.tpnj6:12!null, cla.lbl53:13, cla.nb3qs:14, cla.eo7iv:15, cla.muhjf:16, cla.fm34l:17, cla.ty5rf:18, cla.zhtlh:19, cla.npb7w:20, cla.sx3hh:21, cla.isbnf:22, cla.ya7yb:23, cla.c5ykb:24, cla.qk7kt:25, cla.ffge6:26, cla.fiigj:27, cla.sh3nc:28, cla.ntena:29, cla.m4aub:30, cla.x5air:31, cla.sab6m:32, cla.g5qi5:33, cla.zvqvd:34, cla.ykssu:35, cla.fhcyt:36]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ cla.ftqlq:8!null\n" +
			"             │           │               │   └─ ums.t4ibq:1\n" +
			"             │           │               └─ MergeJoin\n" +
			"             │           │                   ├─ cmp: Eq\n" +
			"             │           │                   │   ├─ cla.id:7!null\n" +
			"             │           │                   │   └─ bs.ixuxu:39\n" +
			"             │           │                   ├─ TableAlias(cla)\n" +
			"             │           │                   │   └─ IndexedTableAccess(YK2GW)\n" +
			"             │           │                   │       ├─ index: [YK2GW.id]\n" +
			"             │           │                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                   │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │           │                   └─ TableAlias(bs)\n" +
			"             │           │                       └─ IndexedTableAccess(THNTS)\n" +
			"             │           │                           ├─ index: [THNTS.IXUXU]\n" +
			"             │           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │           │   as GXLUB, Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [xoaop.id:7!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ xoaop.dzlim:8!null\n" +
			"             │           │           │   └─ NER (longtext)\n" +
			"             │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"             │           │               ├─ index: [XOAOP.DZLIM]\n" +
			"             │           │               ├─ static: [{[NER, NER]}]\n" +
			"             │           │               └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as CH3FR, CASE  WHEN GreaterThan\n" +
			"             │           │   ├─ ums.ner:2\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 1 (tinyint) WHEN LessThan\n" +
			"             │           │   ├─ ums.ner:2\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 0 (tinyint) ELSE NULL (null) END as D237E, ums.id:0!null as JOGI6]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ ums.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ TableAlias(ums)\n" +
			"             │                   └─ IndexedTableAccess(FG26Y)\n" +
			"             │                       ├─ index: [FG26Y.id]\n" +
			"             │                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                       └─ columns: [id t4ibq ner ber hr mmr qz6vt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: Subquery\n" +
			"                 │           │   ├─ cacheable: false\n" +
			"                 │           │   └─ Project\n" +
			"                 │           │       ├─ columns: [xoaop.dzlim:6!null]\n" +
			"                 │           │       └─ Filter\n" +
			"                 │           │           ├─ Eq\n" +
			"                 │           │           │   ├─ xoaop.id:5!null\n" +
			"                 │           │           │   └─ new.ch3fr:2!null\n" +
			"                 │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"                 │           │               ├─ index: [XOAOP.id]\n" +
			"                 │           │               └─ columns: [id dzlim f3yue]\n" +
			"                 │           └─ right: TUPLE(NER (longtext), BER (longtext), HR (longtext), MMR (longtext))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ECUWU must be one of the following: 'NER', 'BER', 'HR', 'MMR'., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.d237e:3!null\n" +
			"                             └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The D237E field must be either 0 or 1., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO SZQWJ
    (id, GXLUB, CH3FR, D237E, JOGI6)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT bs.id FROM THNTS bs INNER JOIN YK2GW cla ON cla.id = bs.IXUXU WHERE cla.FTQLQ = ums.T4IBQ) AS GXLUB,
    (SELECT id FROM XOAOP WHERE DZLIM = 'BER') AS CH3FR,
    CASE -- This ugly thing is because of Dolt's problematic conversion handling at insertions
        WHEN ums.ber > 0.5 THEN 1
        WHEN ums.ber < 0.5 THEN 0
        ELSE NULL
    END AS D237E,
    ums.id AS JOGI6
FROM
    FG26Y ums
WHERE
    ums.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, CH3FR, D237E, JOGI6)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SZQWJ\n" +
			"         │       └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"         └─ Trigger(CREATE TRIGGER SZQWJ_on_insert BEFORE INSERT ON SZQWJ\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT DZLIM FROM XOAOP WHERE id = NEW.CH3FR) NOT IN ('NER', 'BER', 'HR', 'MMR')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.D237E NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The D237E field must be either 0 or 1.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The D237E field must be either 0 or 1.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, CH3FR:2!null, D237E:3!null, JOGI6:4]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:7!null, GXLUB:8, CH3FR:9, D237E:10, JOGI6:11!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.qz6vt:6, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [bs.id:7!null]\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [bs.id:37!null, bs.nfryn:38!null, bs.ixuxu:39, bs.fhcyt:40, cla.id:7!null, cla.ftqlq:8!null, cla.tuxml:9, cla.paef5:10, cla.rucy4:11, cla.tpnj6:12!null, cla.lbl53:13, cla.nb3qs:14, cla.eo7iv:15, cla.muhjf:16, cla.fm34l:17, cla.ty5rf:18, cla.zhtlh:19, cla.npb7w:20, cla.sx3hh:21, cla.isbnf:22, cla.ya7yb:23, cla.c5ykb:24, cla.qk7kt:25, cla.ffge6:26, cla.fiigj:27, cla.sh3nc:28, cla.ntena:29, cla.m4aub:30, cla.x5air:31, cla.sab6m:32, cla.g5qi5:33, cla.zvqvd:34, cla.ykssu:35, cla.fhcyt:36]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ cla.ftqlq:8!null\n" +
			"             │           │               │   └─ ums.t4ibq:1\n" +
			"             │           │               └─ MergeJoin\n" +
			"             │           │                   ├─ cmp: Eq\n" +
			"             │           │                   │   ├─ cla.id:7!null\n" +
			"             │           │                   │   └─ bs.ixuxu:39\n" +
			"             │           │                   ├─ TableAlias(cla)\n" +
			"             │           │                   │   └─ IndexedTableAccess(YK2GW)\n" +
			"             │           │                   │       ├─ index: [YK2GW.id]\n" +
			"             │           │                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                   │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │           │                   └─ TableAlias(bs)\n" +
			"             │           │                       └─ IndexedTableAccess(THNTS)\n" +
			"             │           │                           ├─ index: [THNTS.IXUXU]\n" +
			"             │           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │           │   as GXLUB, Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [xoaop.id:7!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ xoaop.dzlim:8!null\n" +
			"             │           │           │   └─ BER (longtext)\n" +
			"             │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"             │           │               ├─ index: [XOAOP.DZLIM]\n" +
			"             │           │               ├─ static: [{[BER, BER]}]\n" +
			"             │           │               └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as CH3FR, CASE  WHEN GreaterThan\n" +
			"             │           │   ├─ ums.ber:3\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 1 (tinyint) WHEN LessThan\n" +
			"             │           │   ├─ ums.ber:3\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 0 (tinyint) ELSE NULL (null) END as D237E, ums.id:0!null as JOGI6]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ ums.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ TableAlias(ums)\n" +
			"             │                   └─ IndexedTableAccess(FG26Y)\n" +
			"             │                       ├─ index: [FG26Y.id]\n" +
			"             │                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                       └─ columns: [id t4ibq ner ber hr mmr qz6vt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: Subquery\n" +
			"                 │           │   ├─ cacheable: false\n" +
			"                 │           │   └─ Project\n" +
			"                 │           │       ├─ columns: [xoaop.dzlim:6!null]\n" +
			"                 │           │       └─ Filter\n" +
			"                 │           │           ├─ Eq\n" +
			"                 │           │           │   ├─ xoaop.id:5!null\n" +
			"                 │           │           │   └─ new.ch3fr:2!null\n" +
			"                 │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"                 │           │               ├─ index: [XOAOP.id]\n" +
			"                 │           │               └─ columns: [id dzlim f3yue]\n" +
			"                 │           └─ right: TUPLE(NER (longtext), BER (longtext), HR (longtext), MMR (longtext))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ECUWU must be one of the following: 'NER', 'BER', 'HR', 'MMR'., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.d237e:3!null\n" +
			"                             └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The D237E field must be either 0 or 1., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO SZQWJ
    (id, GXLUB, CH3FR, D237E, JOGI6)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT bs.id FROM THNTS bs INNER JOIN YK2GW cla ON cla.id = bs.IXUXU WHERE cla.FTQLQ = ums.T4IBQ) AS GXLUB,
    (SELECT id FROM XOAOP WHERE DZLIM = 'HR') AS CH3FR,
    CASE -- This ugly thing is because of Dolt's problematic conversion handling at insertions
        WHEN ums.hr > 0.5 THEN 1
        WHEN ums.hr < 0.5 THEN 0
        ELSE NULL
    END AS D237E,
    ums.id AS JOGI6
FROM
    FG26Y ums
WHERE
    ums.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, CH3FR, D237E, JOGI6)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SZQWJ\n" +
			"         │       └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"         └─ Trigger(CREATE TRIGGER SZQWJ_on_insert BEFORE INSERT ON SZQWJ\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT DZLIM FROM XOAOP WHERE id = NEW.CH3FR) NOT IN ('NER', 'BER', 'HR', 'MMR')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.D237E NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The D237E field must be either 0 or 1.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The D237E field must be either 0 or 1.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, CH3FR:2!null, D237E:3!null, JOGI6:4]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:7!null, GXLUB:8, CH3FR:9, D237E:10, JOGI6:11!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.qz6vt:6, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [bs.id:7!null]\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [bs.id:37!null, bs.nfryn:38!null, bs.ixuxu:39, bs.fhcyt:40, cla.id:7!null, cla.ftqlq:8!null, cla.tuxml:9, cla.paef5:10, cla.rucy4:11, cla.tpnj6:12!null, cla.lbl53:13, cla.nb3qs:14, cla.eo7iv:15, cla.muhjf:16, cla.fm34l:17, cla.ty5rf:18, cla.zhtlh:19, cla.npb7w:20, cla.sx3hh:21, cla.isbnf:22, cla.ya7yb:23, cla.c5ykb:24, cla.qk7kt:25, cla.ffge6:26, cla.fiigj:27, cla.sh3nc:28, cla.ntena:29, cla.m4aub:30, cla.x5air:31, cla.sab6m:32, cla.g5qi5:33, cla.zvqvd:34, cla.ykssu:35, cla.fhcyt:36]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ cla.ftqlq:8!null\n" +
			"             │           │               │   └─ ums.t4ibq:1\n" +
			"             │           │               └─ MergeJoin\n" +
			"             │           │                   ├─ cmp: Eq\n" +
			"             │           │                   │   ├─ cla.id:7!null\n" +
			"             │           │                   │   └─ bs.ixuxu:39\n" +
			"             │           │                   ├─ TableAlias(cla)\n" +
			"             │           │                   │   └─ IndexedTableAccess(YK2GW)\n" +
			"             │           │                   │       ├─ index: [YK2GW.id]\n" +
			"             │           │                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                   │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │           │                   └─ TableAlias(bs)\n" +
			"             │           │                       └─ IndexedTableAccess(THNTS)\n" +
			"             │           │                           ├─ index: [THNTS.IXUXU]\n" +
			"             │           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │           │   as GXLUB, Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [xoaop.id:7!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ xoaop.dzlim:8!null\n" +
			"             │           │           │   └─ HR (longtext)\n" +
			"             │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"             │           │               ├─ index: [XOAOP.DZLIM]\n" +
			"             │           │               ├─ static: [{[HR, HR]}]\n" +
			"             │           │               └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as CH3FR, CASE  WHEN GreaterThan\n" +
			"             │           │   ├─ ums.hr:4\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 1 (tinyint) WHEN LessThan\n" +
			"             │           │   ├─ ums.hr:4\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 0 (tinyint) ELSE NULL (null) END as D237E, ums.id:0!null as JOGI6]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ ums.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ TableAlias(ums)\n" +
			"             │                   └─ IndexedTableAccess(FG26Y)\n" +
			"             │                       ├─ index: [FG26Y.id]\n" +
			"             │                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                       └─ columns: [id t4ibq ner ber hr mmr qz6vt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: Subquery\n" +
			"                 │           │   ├─ cacheable: false\n" +
			"                 │           │   └─ Project\n" +
			"                 │           │       ├─ columns: [xoaop.dzlim:6!null]\n" +
			"                 │           │       └─ Filter\n" +
			"                 │           │           ├─ Eq\n" +
			"                 │           │           │   ├─ xoaop.id:5!null\n" +
			"                 │           │           │   └─ new.ch3fr:2!null\n" +
			"                 │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"                 │           │               ├─ index: [XOAOP.id]\n" +
			"                 │           │               └─ columns: [id dzlim f3yue]\n" +
			"                 │           └─ right: TUPLE(NER (longtext), BER (longtext), HR (longtext), MMR (longtext))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ECUWU must be one of the following: 'NER', 'BER', 'HR', 'MMR'., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.d237e:3!null\n" +
			"                             └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The D237E field must be either 0 or 1., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO SZQWJ
    (id, GXLUB, CH3FR, D237E, JOGI6)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT bs.id FROM THNTS bs INNER JOIN YK2GW cla ON cla.id = bs.IXUXU WHERE cla.FTQLQ = ums.T4IBQ) AS GXLUB,
    (SELECT id FROM XOAOP WHERE DZLIM = 'MMR') AS CH3FR,
    CASE -- This ugly thing is because of Dolt's problematic conversion handling at insertions
        WHEN ums.mmr > 0.5 THEN 1
        WHEN ums.mmr < 0.5 THEN 0
        ELSE NULL
    END AS D237E,
    ums.id AS JOGI6
FROM
    FG26Y ums
WHERE
    ums.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, CH3FR, D237E, JOGI6)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SZQWJ\n" +
			"         │       └─ columns: [id gxlub ch3fr d237e jogi6]\n" +
			"         └─ Trigger(CREATE TRIGGER SZQWJ_on_insert BEFORE INSERT ON SZQWJ\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                (SELECT DZLIM FROM XOAOP WHERE id = NEW.CH3FR) NOT IN ('NER', 'BER', 'HR', 'MMR')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ECUWU must be one of the following: ''NER'', ''BER'', ''HR'', ''MMR''.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.D237E NOT IN (0, 1)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The D237E field must be either 0 or 1.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The D237E field must be either 0 or 1.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, CH3FR:2!null, D237E:3!null, JOGI6:4]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:7!null, GXLUB:8, CH3FR:9, D237E:10, JOGI6:11!null]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ums.id:0!null, ums.t4ibq:1, ums.ner:2, ums.ber:3, ums.hr:4, ums.mmr:5, ums.qz6vt:6, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [bs.id:7!null]\n" +
			"             │           │       └─ Project\n" +
			"             │           │           ├─ columns: [bs.id:37!null, bs.nfryn:38!null, bs.ixuxu:39, bs.fhcyt:40, cla.id:7!null, cla.ftqlq:8!null, cla.tuxml:9, cla.paef5:10, cla.rucy4:11, cla.tpnj6:12!null, cla.lbl53:13, cla.nb3qs:14, cla.eo7iv:15, cla.muhjf:16, cla.fm34l:17, cla.ty5rf:18, cla.zhtlh:19, cla.npb7w:20, cla.sx3hh:21, cla.isbnf:22, cla.ya7yb:23, cla.c5ykb:24, cla.qk7kt:25, cla.ffge6:26, cla.fiigj:27, cla.sh3nc:28, cla.ntena:29, cla.m4aub:30, cla.x5air:31, cla.sab6m:32, cla.g5qi5:33, cla.zvqvd:34, cla.ykssu:35, cla.fhcyt:36]\n" +
			"             │           │           └─ Filter\n" +
			"             │           │               ├─ Eq\n" +
			"             │           │               │   ├─ cla.ftqlq:8!null\n" +
			"             │           │               │   └─ ums.t4ibq:1\n" +
			"             │           │               └─ MergeJoin\n" +
			"             │           │                   ├─ cmp: Eq\n" +
			"             │           │                   │   ├─ cla.id:7!null\n" +
			"             │           │                   │   └─ bs.ixuxu:39\n" +
			"             │           │                   ├─ TableAlias(cla)\n" +
			"             │           │                   │   └─ IndexedTableAccess(YK2GW)\n" +
			"             │           │                   │       ├─ index: [YK2GW.id]\n" +
			"             │           │                   │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                   │       └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │           │                   └─ TableAlias(bs)\n" +
			"             │           │                       └─ IndexedTableAccess(THNTS)\n" +
			"             │           │                           ├─ index: [THNTS.IXUXU]\n" +
			"             │           │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │           │                           └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │           │   as GXLUB, Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [xoaop.id:7!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ xoaop.dzlim:8!null\n" +
			"             │           │           │   └─ MMR (longtext)\n" +
			"             │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"             │           │               ├─ index: [XOAOP.DZLIM]\n" +
			"             │           │               ├─ static: [{[MMR, MMR]}]\n" +
			"             │           │               └─ columns: [id dzlim f3yue]\n" +
			"             │           │   as CH3FR, CASE  WHEN GreaterThan\n" +
			"             │           │   ├─ ums.mmr:5\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 1 (tinyint) WHEN LessThan\n" +
			"             │           │   ├─ ums.mmr:5\n" +
			"             │           │   └─ 0.500000 (double)\n" +
			"             │           │   THEN 0 (tinyint) ELSE NULL (null) END as D237E, ums.id:0!null as JOGI6]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ ums.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ TableAlias(ums)\n" +
			"             │                   └─ IndexedTableAccess(FG26Y)\n" +
			"             │                       ├─ index: [FG26Y.id]\n" +
			"             │                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                       └─ columns: [id t4ibq ner ber hr mmr qz6vt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: Subquery\n" +
			"                 │           │   ├─ cacheable: false\n" +
			"                 │           │   └─ Project\n" +
			"                 │           │       ├─ columns: [xoaop.dzlim:6!null]\n" +
			"                 │           │       └─ Filter\n" +
			"                 │           │           ├─ Eq\n" +
			"                 │           │           │   ├─ xoaop.id:5!null\n" +
			"                 │           │           │   └─ new.ch3fr:2!null\n" +
			"                 │           │           └─ IndexedTableAccess(XOAOP)\n" +
			"                 │           │               ├─ index: [XOAOP.id]\n" +
			"                 │           │               └─ columns: [id dzlim f3yue]\n" +
			"                 │           └─ right: TUPLE(NER (longtext), BER (longtext), HR (longtext), MMR (longtext))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ECUWU must be one of the following: 'NER', 'BER', 'HR', 'MMR'., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.d237e:3!null\n" +
			"                             └─ right: TUPLE(0 (tinyint), 1 (tinyint))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The D237E field must be either 0 or 1., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO TPXBU
    (id, BTXC5, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    NCVD2.BTXC5 AS BTXC5,
    NULL AS FHCYT
FROM
(
SELECT DISTINCT
    umf.SYPKF AS BTXC5
FROM
    NZKPM umf
WHERE
        umf.SYPKF NOT IN (SELECT BTXC5 FROM TPXBU WHERE BTXC5 IS NOT NULL)
    AND
        umf.SYPKF IS NOT NULL
    AND
        umf.SYPKF <> 'N/A'
    AND
        umf.id IN ('1','2','3')
) NCVD2`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, BTXC5, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: TPXBU\n" +
			"         │       └─ columns: [id btxc5 fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER TPXBU_on_insert BEFORE INSERT ON TPXBU\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.BTXC5 IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, BTXC5:1, FHCYT:2]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:1!null, BTXC5:2, FHCYT:3]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [ncvd2.BTXC5:0, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, ncvd2.BTXC5:0 as BTXC5, NULL (null) as FHCYT]\n" +
			"             │           └─ SubqueryAlias\n" +
			"             │               ├─ name: ncvd2\n" +
			"             │               ├─ outerVisibility: false\n" +
			"             │               ├─ cacheable: true\n" +
			"             │               └─ Distinct\n" +
			"             │                   └─ Project\n" +
			"             │                       ├─ columns: [BTXC5:25]\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [umf.id:0!null, umf.t4ibq:1, umf.fgg57:2, umf.sshpj:3, umf.nla6o:4, umf.sfj6l:5, umf.tjpt7:6, umf.arn5p:7, umf.sypkf:8, umf.ivfmk:9, umf.ide43:10, umf.az6sp:11, umf.fsdy2:12, umf.xosd4:13, umf.hmw4h:14, umf.s76om:15, umf.vaf:16, umf.zroh6:17, umf.qcgts:18, umf.lnfm6:19, umf.tvawl:20, umf.hdlcl:21, umf.bhhw6:22, umf.fhcyt:23, umf.qz6vt:24, umf.sypkf:8 as BTXC5]\n" +
			"             │                           └─ Filter\n" +
			"             │                               ├─ AND\n" +
			"             │                               │   ├─ AND\n" +
			"             │                               │   │   ├─ AND\n" +
			"             │                               │   │   │   ├─ NOT\n" +
			"             │                               │   │   │   │   └─ InSubquery\n" +
			"             │                               │   │   │   │       ├─ left: umf.sypkf:8\n" +
			"             │                               │   │   │   │       └─ right: Subquery\n" +
			"             │                               │   │   │   │           ├─ cacheable: true\n" +
			"             │                               │   │   │   │           └─ Project\n" +
			"             │                               │   │   │   │               ├─ columns: [tpxbu.btxc5:26]\n" +
			"             │                               │   │   │   │               └─ Filter\n" +
			"             │                               │   │   │   │                   ├─ NOT\n" +
			"             │                               │   │   │   │                   │   └─ tpxbu.btxc5:26 IS NULL\n" +
			"             │                               │   │   │   │                   └─ IndexedTableAccess(TPXBU)\n" +
			"             │                               │   │   │   │                       ├─ index: [TPXBU.BTXC5]\n" +
			"             │                               │   │   │   │                       ├─ static: [{(NULL, ∞)}]\n" +
			"             │                               │   │   │   │                       └─ columns: [id btxc5 fhcyt]\n" +
			"             │                               │   │   │   └─ NOT\n" +
			"             │                               │   │   │       └─ umf.sypkf:8 IS NULL\n" +
			"             │                               │   │   └─ NOT\n" +
			"             │                               │   │       └─ Eq\n" +
			"             │                               │   │           ├─ umf.sypkf:8\n" +
			"             │                               │   │           └─ N/A (longtext)\n" +
			"             │                               │   └─ HashIn\n" +
			"             │                               │       ├─ umf.id:0!null\n" +
			"             │                               │       └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │                               └─ TableAlias(umf)\n" +
			"             │                                   └─ IndexedTableAccess(NZKPM)\n" +
			"             │                                       ├─ index: [NZKPM.id]\n" +
			"             │                                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                                       └─ columns: [id t4ibq fgg57 sshpj nla6o sfj6l tjpt7 arn5p sypkf ivfmk ide43 az6sp fsdy2 xosd4 hmw4h s76om vaf zroh6 qcgts lnfm6 tvawl hdlcl bhhw6 fhcyt qz6vt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(InSubquery\n" +
			"                         ├─ left: new.btxc5:1\n" +
			"                         └─ right: Subquery\n" +
			"                             ├─ cacheable: false\n" +
			"                             └─ Project\n" +
			"                                 ├─ columns: [tpxhz.svaz4:4!null]\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: TPXHZ\n" +
			"                                     └─ columns: [id svaz4]\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO HGMQ6
    (id, GXLUB, LUEVY, M22QN, TJPT7, ARN5P, XOSD4, IDE43, HMW4H, ZBT6R, FSDY2, LT7K6, SPPYD, QCGTS, TEUJA, QQV4M, FHCYT)
SELECT
    umf.id AS id,
    bs.id AS GXLUB,
    CASE
        WHEN TJ5D2.id IS NOT NULL THEN (SELECT nd_for_id_overridden.id FROM E2I7U nd_for_id_overridden WHERE nd_for_id_overridden.TW55N = TJ5D2.H4DMT)
        ELSE (SELECT nd_for_id.id FROM E2I7U nd_for_id WHERE nd_for_id.FGG57 IS NOT NULL AND nd_for_id.FGG57 = umf.FGG57)
    END AS LUEVY,
    CASE
        WHEN umf.SYPKF = 'N/A' THEN (SELECT id FROM TPXBU WHERE BTXC5 IS NULL)
        ELSE (SELECT aac.id FROM TPXBU aac WHERE aac.BTXC5 = umf.SYPKF)
    END AS M22QN,
    umf.TJPT7 AS TJPT7,
    umf.ARN5P AS ARN5P,
    umf.XOSD4 AS XOSD4,
    umf.IDE43 AS IDE43,
    CASE
        WHEN umf.HMW4H <> 'N/A' THEN umf.HMW4H
        ELSE NULL
    END AS HMW4H,
    CASE
        WHEN umf.S76OM <> 'N/A' THEN (umf.S76OM + 0)
        ELSE NULL
    END AS ZBT6R,
    CASE
        WHEN umf.FSDY2 <> 'N/A' THEN umf.FSDY2
        ELSE 'VUS'
    END AS FSDY2,
    CASE
        WHEN umf.vaf <> '' THEN (umf.vaf + 0.0)
        ELSE NULL
    END AS LT7K6,
    CASE
        WHEN umf.ZROH6 <> '' THEN (umf.ZROH6 + 0.0)
        ELSE NULL
    END AS SPPYD,
    CASE
        WHEN umf.QCGTS <> '' THEN (umf.QCGTS + 0.0)
        ELSE NULL
    END AS QCGTS,
    umf.id AS TEUJA,
    TJ5D2.id AS QQV4M,
    umf.FHCYT AS FHCYT
FROM
    (SELECT
        *
    FROM
        NZKPM
    WHERE
        id IN ('1','2','3')
        AND ARN5P <> 'N/A'
        AND T4IBQ IN (SELECT FTQLQ FROM YK2GW)
        AND FGG57 IN (SELECT FGG57 FROM E2I7U WHERE FGG57 IS NOT NULL)
    ) umf
LEFT JOIN
    SZW6V TJ5D2
ON
        TJ5D2.SWCQV = 0 -- Override is turned on
    AND
        TJ5D2.T4IBQ = umf.T4IBQ
    AND
        TJ5D2.V7UFH = umf.FGG57
    AND
        TJ5D2.SYPKF = umf.SYPKF
INNER JOIN YK2GW cla ON umf.T4IBQ = cla.FTQLQ
INNER JOIN THNTS bs ON cla.id = bs.IXUXU`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, GXLUB, LUEVY, M22QN, TJPT7, ARN5P, XOSD4, IDE43, HMW4H, ZBT6R, FSDY2, LT7K6, SPPYD, QCGTS, TEUJA, QQV4M, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: HGMQ6\n" +
			"         │       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER HGMQ6_on_insert BEFORE INSERT ON HGMQ6\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.TJPT7 IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR\n" +
			"                NEW.ARN5P IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR\n" +
			"                NEW.XOSD4 IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR\n" +
			"                NEW.IDE43 IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR\n" +
			"                NEW.HMW4H IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.FSDY2 NOT IN ('benign', 'VUS', 'SRARY', 'UBQWG')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'FSDY2 must be either ''benign'', ''VUS'', ''SRARY'' or ''UBQWG''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'FSDY2 must be either ''benign'', ''VUS'', ''SRARY'' or ''UBQWG''.';\n" +
			"              END IF;\n" +
			"              IF NEW.LT7K6 IS NOT NULL AND NEW.SPPYD IS NOT NULL\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'If LT7K6 has value, SPPYD must be NULL.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'If LT7K6 has value, SPPYD must be NULL.';\n" +
			"              END IF;\n" +
			"              IF NEW.LT7K6 IS NULL AND (NEW.SPPYD IS NULL OR NEW.SPPYD <> 0.5)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'If LT7K6 does not have value, SPPYD must be 0.5.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'If LT7K6 does not have value, SPPYD must be 0.5.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, GXLUB:1!null, LUEVY:2!null, M22QN:3!null, TJPT7:4!null, ARN5P:5!null, XOSD4:6!null, IDE43:7, HMW4H:8, ZBT6R:9, FSDY2:10!null, LT7K6:11, SPPYD:12, QCGTS:13, TEUJA:14, QQV4M:15, FHCYT:16]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:67!null, GXLUB:68!null, LUEVY:69, M22QN:70, TJPT7:71, ARN5P:72, XOSD4:73, IDE43:74, HMW4H:75, ZBT6R:76, FSDY2:77, LT7K6:78, SPPYD:79, QCGTS:80, TEUJA:81!null, QQV4M:82!null, FHCYT:83]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [umf.id:4!null, umf.t4ibq:5, umf.fgg57:6, umf.sshpj:7, umf.nla6o:8, umf.sfj6l:9, umf.tjpt7:10, umf.arn5p:11, umf.sypkf:12, umf.ivfmk:13, umf.ide43:14, umf.az6sp:15, umf.fsdy2:16, umf.xosd4:17, umf.hmw4h:18, umf.s76om:19, umf.vaf:20, umf.zroh6:21, umf.qcgts:22, umf.lnfm6:23, umf.tvawl:24, umf.hdlcl:25, umf.bhhw6:26, umf.fhcyt:27, umf.qz6vt:28, tj5d2.id:59!null, tj5d2.t4ibq:60!null, tj5d2.v7ufh:61!null, tj5d2.sypkf:62!null, tj5d2.h4dmt:63!null, tj5d2.swcqv:64!null, tj5d2.ykssu:65, tj5d2.fhcyt:66, cla.id:29!null, cla.ftqlq:30!null, cla.tuxml:31, cla.paef5:32, cla.rucy4:33, cla.tpnj6:34!null, cla.lbl53:35, cla.nb3qs:36, cla.eo7iv:37, cla.muhjf:38, cla.fm34l:39, cla.ty5rf:40, cla.zhtlh:41, cla.npb7w:42, cla.sx3hh:43, cla.isbnf:44, cla.ya7yb:45, cla.c5ykb:46, cla.qk7kt:47, cla.ffge6:48, cla.fiigj:49, cla.sh3nc:50, cla.ntena:51, cla.m4aub:52, cla.x5air:53, cla.sab6m:54, cla.g5qi5:55, cla.zvqvd:56, cla.ykssu:57, cla.fhcyt:58, bs.id:0!null, bs.nfryn:1!null, bs.ixuxu:2, bs.fhcyt:3, umf.id:4!null as id, bs.id:0!null as GXLUB, CASE  WHEN NOT\n" +
			"             │           │   └─ tj5d2.id:59!null IS NULL\n" +
			"             │           │   THEN Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [nd_for_id_overridden.id:67!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ nd_for_id_overridden.tw55n:70!null\n" +
			"             │           │           │   └─ tj5d2.h4dmt:63!null\n" +
			"             │           │           └─ TableAlias(nd_for_id_overridden)\n" +
			"             │           │               └─ IndexedTableAccess(E2I7U)\n" +
			"             │           │                   ├─ index: [E2I7U.TW55N]\n" +
			"             │           │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │           │   ELSE Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [nd_for_id.id:67!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ AND\n" +
			"             │           │           │   ├─ NOT\n" +
			"             │           │           │   │   └─ nd_for_id.fgg57:73 IS NULL\n" +
			"             │           │           │   └─ Eq\n" +
			"             │           │           │       ├─ nd_for_id.fgg57:73\n" +
			"             │           │           │       └─ umf.fgg57:6\n" +
			"             │           │           └─ TableAlias(nd_for_id)\n" +
			"             │           │               └─ IndexedTableAccess(E2I7U)\n" +
			"             │           │                   ├─ index: [E2I7U.FGG57]\n" +
			"             │           │                   ├─ static: [{(NULL, ∞)}]\n" +
			"             │           │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │           │   END as LUEVY, CASE  WHEN Eq\n" +
			"             │           │   ├─ umf.sypkf:12\n" +
			"             │           │   └─ N/A (longtext)\n" +
			"             │           │   THEN Subquery\n" +
			"             │           │   ├─ cacheable: true\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [tpxbu.id:67!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ tpxbu.btxc5:68 IS NULL\n" +
			"             │           │           └─ IndexedTableAccess(TPXBU)\n" +
			"             │           │               ├─ index: [TPXBU.BTXC5]\n" +
			"             │           │               ├─ static: [{[NULL, NULL]}]\n" +
			"             │           │               └─ columns: [id btxc5 fhcyt]\n" +
			"             │           │   ELSE Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [aac.id:67!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ aac.btxc5:68\n" +
			"             │           │           │   └─ umf.sypkf:12\n" +
			"             │           │           └─ TableAlias(aac)\n" +
			"             │           │               └─ IndexedTableAccess(TPXBU)\n" +
			"             │           │                   ├─ index: [TPXBU.BTXC5]\n" +
			"             │           │                   └─ columns: [id btxc5 fhcyt]\n" +
			"             │           │   END as M22QN, umf.tjpt7:10 as TJPT7, umf.arn5p:11 as ARN5P, umf.xosd4:17 as XOSD4, umf.ide43:14 as IDE43, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.hmw4h:18\n" +
			"             │           │       └─ N/A (longtext)\n" +
			"             │           │   THEN umf.hmw4h:18 ELSE NULL (null) END as HMW4H, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.s76om:19\n" +
			"             │           │       └─ N/A (longtext)\n" +
			"             │           │   THEN (umf.s76om:19 + 0 (tinyint)) ELSE NULL (null) END as ZBT6R, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.fsdy2:16\n" +
			"             │           │       └─ N/A (longtext)\n" +
			"             │           │   THEN umf.fsdy2:16 ELSE VUS (longtext) END as FSDY2, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.vaf:20\n" +
			"             │           │       └─  (longtext)\n" +
			"             │           │   THEN (umf.vaf:20 + 0 (decimal(2,1))) ELSE NULL (null) END as LT7K6, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.zroh6:21\n" +
			"             │           │       └─  (longtext)\n" +
			"             │           │   THEN (umf.zroh6:21 + 0 (decimal(2,1))) ELSE NULL (null) END as SPPYD, CASE  WHEN NOT\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ umf.qcgts:22\n" +
			"             │           │       └─  (longtext)\n" +
			"             │           │   THEN (umf.qcgts:22 + 0 (decimal(2,1))) ELSE NULL (null) END as QCGTS, umf.id:4!null as TEUJA, tj5d2.id:59!null as QQV4M, umf.fhcyt:27 as FHCYT]\n" +
			"             │           └─ LeftOuterJoin\n" +
			"             │               ├─ AND\n" +
			"             │               │   ├─ AND\n" +
			"             │               │   │   ├─ AND\n" +
			"             │               │   │   │   ├─ Eq\n" +
			"             │               │   │   │   │   ├─ tj5d2.swcqv:64!null\n" +
			"             │               │   │   │   │   └─ 0 (tinyint)\n" +
			"             │               │   │   │   └─ Eq\n" +
			"             │               │   │   │       ├─ tj5d2.t4ibq:60!null\n" +
			"             │               │   │   │       └─ umf.t4ibq:5\n" +
			"             │               │   │   └─ Eq\n" +
			"             │               │   │       ├─ tj5d2.v7ufh:61!null\n" +
			"             │               │   │       └─ umf.fgg57:6\n" +
			"             │               │   └─ Eq\n" +
			"             │               │       ├─ tj5d2.sypkf:62!null\n" +
			"             │               │       └─ umf.sypkf:12\n" +
			"             │               ├─ HashJoin\n" +
			"             │               │   ├─ Eq\n" +
			"             │               │   │   ├─ cla.id:29!null\n" +
			"             │               │   │   └─ bs.ixuxu:2\n" +
			"             │               │   ├─ TableAlias(bs)\n" +
			"             │               │   │   └─ Table\n" +
			"             │               │   │       ├─ name: THNTS\n" +
			"             │               │   │       └─ columns: [id nfryn ixuxu fhcyt]\n" +
			"             │               │   └─ HashLookup\n" +
			"             │               │       ├─ left-key: TUPLE(bs.ixuxu:2)\n" +
			"             │               │       ├─ right-key: TUPLE(cla.id:25!null)\n" +
			"             │               │       └─ LookupJoin\n" +
			"             │               │           ├─ Eq\n" +
			"             │               │           │   ├─ umf.t4ibq:5\n" +
			"             │               │           │   └─ cla.ftqlq:30!null\n" +
			"             │               │           ├─ SubqueryAlias\n" +
			"             │               │           │   ├─ name: umf\n" +
			"             │               │           │   ├─ outerVisibility: false\n" +
			"             │               │           │   ├─ cacheable: true\n" +
			"             │               │           │   └─ Filter\n" +
			"             │               │           │       ├─ AND\n" +
			"             │               │           │       │   ├─ AND\n" +
			"             │               │           │       │   │   ├─ AND\n" +
			"             │               │           │       │   │   │   ├─ HashIn\n" +
			"             │               │           │       │   │   │   │   ├─ nzkpm.id:0!null\n" +
			"             │               │           │       │   │   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               │           │       │   │   │   └─ NOT\n" +
			"             │               │           │       │   │   │       └─ Eq\n" +
			"             │               │           │       │   │   │           ├─ nzkpm.arn5p:7\n" +
			"             │               │           │       │   │   │           └─ N/A (longtext)\n" +
			"             │               │           │       │   │   └─ InSubquery\n" +
			"             │               │           │       │   │       ├─ left: nzkpm.t4ibq:1\n" +
			"             │               │           │       │   │       └─ right: Subquery\n" +
			"             │               │           │       │   │           ├─ cacheable: true\n" +
			"             │               │           │       │   │           └─ Project\n" +
			"             │               │           │       │   │               ├─ columns: [yk2gw.ftqlq:26!null]\n" +
			"             │               │           │       │   │               └─ Table\n" +
			"             │               │           │       │   │                   ├─ name: YK2GW\n" +
			"             │               │           │       │   │                   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │               │           │       │   └─ InSubquery\n" +
			"             │               │           │       │       ├─ left: nzkpm.fgg57:2\n" +
			"             │               │           │       │       └─ right: Subquery\n" +
			"             │               │           │       │           ├─ cacheable: true\n" +
			"             │               │           │       │           └─ Project\n" +
			"             │               │           │       │               ├─ columns: [e2i7u.fgg57:31]\n" +
			"             │               │           │       │               └─ Filter\n" +
			"             │               │           │       │                   ├─ NOT\n" +
			"             │               │           │       │                   │   └─ e2i7u.fgg57:31 IS NULL\n" +
			"             │               │           │       │                   └─ IndexedTableAccess(E2I7U)\n" +
			"             │               │           │       │                       ├─ index: [E2I7U.FGG57]\n" +
			"             │               │           │       │                       ├─ static: [{(NULL, ∞)}]\n" +
			"             │               │           │       │                       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │               │           │       └─ IndexedTableAccess(NZKPM)\n" +
			"             │               │           │           ├─ index: [NZKPM.id]\n" +
			"             │               │           │           ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │               │           │           └─ columns: [id t4ibq fgg57 sshpj nla6o sfj6l tjpt7 arn5p sypkf ivfmk ide43 az6sp fsdy2 xosd4 hmw4h s76om vaf zroh6 qcgts lnfm6 tvawl hdlcl bhhw6 fhcyt qz6vt]\n" +
			"             │               │           └─ TableAlias(cla)\n" +
			"             │               │               └─ IndexedTableAccess(YK2GW)\n" +
			"             │               │                   ├─ index: [YK2GW.FTQLQ]\n" +
			"             │               │                   └─ columns: [id ftqlq tuxml paef5 rucy4 tpnj6 lbl53 nb3qs eo7iv muhjf fm34l ty5rf zhtlh npb7w sx3hh isbnf ya7yb c5ykb qk7kt ffge6 fiigj sh3nc ntena m4aub x5air sab6m g5qi5 zvqvd ykssu fhcyt]\n" +
			"             │               └─ TableAlias(tj5d2)\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: SZW6V\n" +
			"             │                       └─ columns: [id t4ibq v7ufh sypkf h4dmt swcqv ykssu fhcyt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(Or\n" +
			"                 │       ├─ Or\n" +
			"                 │       │   ├─ Or\n" +
			"                 │       │   │   ├─ Or\n" +
			"                 │       │   │   │   ├─ InSubquery\n" +
			"                 │       │   │   │   │   ├─ left: new.tjpt7:4!null\n" +
			"                 │       │   │   │   │   └─ right: Subquery\n" +
			"                 │       │   │   │   │       ├─ cacheable: false\n" +
			"                 │       │   │   │   │       └─ Project\n" +
			"                 │       │   │   │   │           ├─ columns: [tpxhz.svaz4:18!null]\n" +
			"                 │       │   │   │   │           └─ Table\n" +
			"                 │       │   │   │   │               ├─ name: TPXHZ\n" +
			"                 │       │   │   │   │               └─ columns: [id svaz4]\n" +
			"                 │       │   │   │   └─ InSubquery\n" +
			"                 │       │   │   │       ├─ left: new.arn5p:5!null\n" +
			"                 │       │   │   │       └─ right: Subquery\n" +
			"                 │       │   │   │           ├─ cacheable: false\n" +
			"                 │       │   │   │           └─ Project\n" +
			"                 │       │   │   │               ├─ columns: [tpxhz.svaz4:18!null]\n" +
			"                 │       │   │   │               └─ Table\n" +
			"                 │       │   │   │                   ├─ name: TPXHZ\n" +
			"                 │       │   │   │                   └─ columns: [id svaz4]\n" +
			"                 │       │   │   └─ InSubquery\n" +
			"                 │       │   │       ├─ left: new.xosd4:6!null\n" +
			"                 │       │   │       └─ right: Subquery\n" +
			"                 │       │   │           ├─ cacheable: false\n" +
			"                 │       │   │           └─ Project\n" +
			"                 │       │   │               ├─ columns: [tpxhz.svaz4:18!null]\n" +
			"                 │       │   │               └─ Table\n" +
			"                 │       │   │                   ├─ name: TPXHZ\n" +
			"                 │       │   │                   └─ columns: [id svaz4]\n" +
			"                 │       │   └─ InSubquery\n" +
			"                 │       │       ├─ left: new.ide43:7\n" +
			"                 │       │       └─ right: Subquery\n" +
			"                 │       │           ├─ cacheable: false\n" +
			"                 │       │           └─ Project\n" +
			"                 │       │               ├─ columns: [tpxhz.svaz4:18!null]\n" +
			"                 │       │               └─ Table\n" +
			"                 │       │                   ├─ name: TPXHZ\n" +
			"                 │       │                   └─ columns: [id svaz4]\n" +
			"                 │       └─ InSubquery\n" +
			"                 │           ├─ left: new.hmw4h:8\n" +
			"                 │           └─ right: Subquery\n" +
			"                 │               ├─ cacheable: false\n" +
			"                 │               └─ Project\n" +
			"                 │                   ├─ columns: [tpxhz.svaz4:18!null]\n" +
			"                 │                   └─ Table\n" +
			"                 │                       ├─ name: TPXHZ\n" +
			"                 │                       └─ columns: [id svaz4]\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(NOT\n" +
			"                 │       └─ IN\n" +
			"                 │           ├─ left: new.fsdy2:10!null\n" +
			"                 │           └─ right: TUPLE(benign (longtext), VUS (longtext), SRARY (longtext), UBQWG (longtext))\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = FSDY2 must be either 'benign', 'VUS', 'SRARY' or 'UBQWG'., MYSQL_ERRNO = 1644\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(AND\n" +
			"                 │       ├─ NOT\n" +
			"                 │       │   └─ new.lt7k6:11 IS NULL\n" +
			"                 │       └─ NOT\n" +
			"                 │           └─ new.sppyd:12 IS NULL\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = If LT7K6 has value, SPPYD must be NULL., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(AND\n" +
			"                         ├─ new.lt7k6:11 IS NULL\n" +
			"                         └─ Or\n" +
			"                             ├─ new.sppyd:12 IS NULL\n" +
			"                             └─ NOT\n" +
			"                                 └─ Eq\n" +
			"                                     ├─ new.sppyd:12\n" +
			"                                     └─ 0.500000 (double)\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = If LT7K6 does not have value, SPPYD must be 0.5., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO SEQS3
    (id, Z7CP5, YH4XB)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    C6PUD.id AS Z7CP5,
    vc.id AS YH4XB
FROM (
    SELECT
        mf.id AS id,
        umf.AZ6SP AS AZ6SP
    FROM
        HGMQ6 mf
    INNER JOIN NZKPM umf ON umf.id = mf.TEUJA
    WHERE
        umf.id IN ('1','2','3')
) C6PUD
INNER JOIN D34QP vc ON C6PUD.AZ6SP LIKE CONCAT(CONCAT('%', vc.TWMSR), '%')`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Insert(id, Z7CP5, YH4XB)\n" +
			"     ├─ InsertDestination\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: SEQS3\n" +
			"     │       └─ columns: [id z7cp5 yh4xb]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [id:0!null, Z7CP5:1!null, YH4XB:2!null]\n" +
			"         └─ Project\n" +
			"             ├─ columns: [id:8!null, Z7CP5:9!null, YH4XB:10!null]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [c6pud.id:0!null, c6pud.AZ6SP:1, vc.id:2!null, vc.twmsr:3!null, vc.qhmge:4, vc.mlnpu:5!null, vc.fi3ga:6!null, vc.znp4p:7!null, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, c6pud.id:0!null as Z7CP5, vc.id:2!null as YH4XB]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ c6pud.AZ6SP LIKE concat(concat('%',vc.twmsr),'%')\n" +
			"                     ├─ SubqueryAlias\n" +
			"                     │   ├─ name: c6pud\n" +
			"                     │   ├─ outerVisibility: false\n" +
			"                     │   ├─ cacheable: true\n" +
			"                     │   └─ Project\n" +
			"                     │       ├─ columns: [id:42!null, AZ6SP:43]\n" +
			"                     │       └─ Project\n" +
			"                     │           ├─ columns: [mf.id:0!null, mf.gxlub:1!null, mf.luevy:2!null, mf.m22qn:3!null, mf.tjpt7:4!null, mf.arn5p:5!null, mf.xosd4:6!null, mf.ide43:7, mf.hmw4h:8, mf.zbt6r:9, mf.fsdy2:10!null, mf.lt7k6:11, mf.sppyd:12, mf.qcgts:13, mf.teuja:14, mf.qqv4m:15, mf.fhcyt:16, umf.id:17!null, umf.t4ibq:18, umf.fgg57:19, umf.sshpj:20, umf.nla6o:21, umf.sfj6l:22, umf.tjpt7:23, umf.arn5p:24, umf.sypkf:25, umf.ivfmk:26, umf.ide43:27, umf.az6sp:28, umf.fsdy2:29, umf.xosd4:30, umf.hmw4h:31, umf.s76om:32, umf.vaf:33, umf.zroh6:34, umf.qcgts:35, umf.lnfm6:36, umf.tvawl:37, umf.hdlcl:38, umf.bhhw6:39, umf.fhcyt:40, umf.qz6vt:41, mf.id:0!null as id, umf.az6sp:28 as AZ6SP]\n" +
			"                     │           └─ Filter\n" +
			"                     │               ├─ HashIn\n" +
			"                     │               │   ├─ umf.id:17!null\n" +
			"                     │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"                     │               └─ LookupJoin\n" +
			"                     │                   ├─ Eq\n" +
			"                     │                   │   ├─ umf.id:17!null\n" +
			"                     │                   │   └─ mf.teuja:14\n" +
			"                     │                   ├─ TableAlias(mf)\n" +
			"                     │                   │   └─ Table\n" +
			"                     │                   │       ├─ name: HGMQ6\n" +
			"                     │                   │       └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"                     │                   └─ Filter\n" +
			"                     │                       ├─ HashIn\n" +
			"                     │                       │   ├─ umf.id:0!null\n" +
			"                     │                       │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"                     │                       └─ TableAlias(umf)\n" +
			"                     │                           └─ IndexedTableAccess(NZKPM)\n" +
			"                     │                               ├─ index: [NZKPM.id]\n" +
			"                     │                               └─ columns: [id t4ibq fgg57 sshpj nla6o sfj6l tjpt7 arn5p sypkf ivfmk ide43 az6sp fsdy2 xosd4 hmw4h s76om vaf zroh6 qcgts lnfm6 tvawl hdlcl bhhw6 fhcyt qz6vt]\n" +
			"                     └─ TableAlias(vc)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: D34QP\n" +
			"                             └─ columns: [id twmsr qhmge mlnpu fi3ga znp4p]\n" +
			"",
	},
	{
		Query: `
INSERT INTO HDDVB(id, FV24E, UJ6XY, M22QN, NZ4MQ, ETPQV, PRUV2, YKSSU, FHCYT)
-- The ones without overrides - mutfunc check is necessary
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    BPNW2.FV24E AS FV24E,
    BPNW2.UJ6XY AS UJ6XY,
    BPNW2.M22QN AS M22QN,
    BPNW2.NZ4MQ AS NZ4MQ,
    BPNW2.MU3KG AS ETPQV,
    NULL AS PRUV2,
    BPNW2.YKSSU AS YKSSU,
    BPNW2.FHCYT AS FHCYT
FROM
    (
    SELECT DISTINCT
        TIZHK.id AS MU3KG,
        J4JYP.id AS FV24E,
        RHUZN.id AS UJ6XY,
        aac.id AS M22QN,
        (SELECT G3YXS.id FROM YYBCX G3YXS WHERE CONCAT(G3YXS.ESFVY, '(MI:', G3YXS.SL76B, ')') = TIZHK.IDUT2) AS NZ4MQ,
        NULL AS FHCYT,
        NULL AS YKSSU
    FROM
        WRZVO TIZHK
    LEFT JOIN
        WGSDC NHMXW
    ON
            NHMXW.SWCQV = 0 -- Override is turned on
        AND
            NHMXW.NOHHR = TIZHK.TVNW2
        AND
            NHMXW.AVPYF = TIZHK.ZHITY
        AND
            NHMXW.SYPKF = TIZHK.SYPKF
        AND
            NHMXW.IDUT2 = TIZHK.IDUT2
    INNER JOIN
        E2I7U J4JYP ON J4JYP.ZH72S = TIZHK.TVNW2
    INNER JOIN
        E2I7U RHUZN ON RHUZN.ZH72S = TIZHK.ZHITY
    INNER JOIN
        HGMQ6 mf ON mf.LUEVY = J4JYP.id
    INNER JOIN
        TPXBU aac ON aac.id = mf.M22QN
    WHERE
            TIZHK.id IN ('1','2','3')
        AND
            aac.BTXC5 = TIZHK.SYPKF
        AND
            NHMXW.id IS NULL -- No overrides here
    ) BPNW2
UNION
-- The ones with overrides - no mutfunc check is necessary
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    BPNW2.FV24E AS FV24E,
    BPNW2.UJ6XY AS UJ6XY,
    (SELECT aac.id FROM TPXBU aac WHERE aac.BTXC5 = BPNW2.SYPKF) AS M22QN,
    BPNW2.NZ4MQ AS NZ4MQ,
    BPNW2.MU3KG AS ETPQV,
    BPNW2.I4NDZ AS PRUV2,
    BPNW2.YKSSU AS YKSSU,
    BPNW2.FHCYT AS FHCYT
FROM
    (
    SELECT DISTINCT
        TIZHK.id AS MU3KG,
        CASE
            WHEN NHMXW.FZXV5 IS NOT NULL
                THEN (SELECT overridden_nd_mutant.id FROM E2I7U overridden_nd_mutant WHERE overridden_nd_mutant.TW55N = NHMXW.FZXV5)
            ELSE J4JYP.id
        END AS FV24E,
        CASE
            WHEN NHMXW.DQYGV IS NOT NULL
                THEN (SELECT overridden_QI2IEner.id FROM E2I7U overridden_QI2IEner WHERE overridden_QI2IEner.TW55N = NHMXW.DQYGV)
            ELSE RHUZN.id
        END AS UJ6XY,
        TIZHK.SYPKF AS SYPKF,
        (SELECT G3YXS.id FROM YYBCX G3YXS WHERE CONCAT(G3YXS.ESFVY, '(MI:', G3YXS.SL76B, ')') = TIZHK.IDUT2) AS NZ4MQ,
        NULL AS FHCYT,
        NULL AS YKSSU,
        NHMXW.id AS I4NDZ
    FROM
        WRZVO TIZHK
    LEFT JOIN
        WGSDC NHMXW
    ON
            NHMXW.SWCQV = 0 -- Override is turned on
        AND
            NHMXW.NOHHR = TIZHK.TVNW2
        AND
            NHMXW.AVPYF = TIZHK.ZHITY
        AND
            NHMXW.SYPKF = TIZHK.SYPKF
        AND
            NHMXW.IDUT2 = TIZHK.IDUT2
    LEFT JOIN
        E2I7U J4JYP ON J4JYP.ZH72S = TIZHK.TVNW2
    LEFT JOIN
        E2I7U RHUZN ON RHUZN.ZH72S = TIZHK.ZHITY
    WHERE
            TIZHK.id IN ('1','2','3')
        AND
            NHMXW.id IS NOT NULL -- Only overrides here
    ) BPNW2`,
		ExpectedPlan: "RowUpdateAccumulator\n" +
			" └─ Insert(id, FV24E, UJ6XY, M22QN, NZ4MQ, ETPQV, PRUV2, YKSSU, FHCYT)\n" +
			"     ├─ InsertDestination\n" +
			"     │   └─ Table\n" +
			"     │       ├─ name: HDDVB\n" +
			"     │       └─ columns: [id fv24e uj6xy m22qn nz4mq etpqv pruv2 ykssu fhcyt]\n" +
			"     └─ Project\n" +
			"         ├─ columns: [id:0!null, FV24E:1!null, UJ6XY:2!null, M22QN:3!null, NZ4MQ:4!null, ETPQV:5, PRUV2:6, YKSSU:7, FHCYT:8]\n" +
			"         └─ Union distinct\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, convert\n" +
			"             │   │   ├─ type: char\n" +
			"             │   │   └─ FV24E:1!null\n" +
			"             │   │   as FV24E, convert\n" +
			"             │   │   ├─ type: char\n" +
			"             │   │   └─ UJ6XY:2!null\n" +
			"             │   │   as UJ6XY, M22QN:3!null, NZ4MQ:4, ETPQV:5!null, convert\n" +
			"             │   │   ├─ type: char\n" +
			"             │   │   └─ PRUV2:6\n" +
			"             │   │   as PRUV2, YKSSU:7, FHCYT:8]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:7!null, FV24E:8!null, UJ6XY:9!null, M22QN:10!null, NZ4MQ:11, ETPQV:12!null, PRUV2:13, YKSSU:14, FHCYT:15]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [bpnw2.MU3KG:0!null, bpnw2.FV24E:1!null, bpnw2.UJ6XY:2!null, bpnw2.M22QN:3!null, bpnw2.NZ4MQ:4, bpnw2.FHCYT:5, bpnw2.YKSSU:6, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, bpnw2.FV24E:1!null as FV24E, bpnw2.UJ6XY:2!null as UJ6XY, bpnw2.M22QN:3!null as M22QN, bpnw2.NZ4MQ:4 as NZ4MQ, bpnw2.MU3KG:0!null as ETPQV, NULL (null) as PRUV2, bpnw2.YKSSU:6 as YKSSU, bpnw2.FHCYT:5 as FHCYT]\n" +
			"             │           └─ SubqueryAlias\n" +
			"             │               ├─ name: bpnw2\n" +
			"             │               ├─ outerVisibility: false\n" +
			"             │               ├─ cacheable: true\n" +
			"             │               └─ Distinct\n" +
			"             │                   └─ Project\n" +
			"             │                       ├─ columns: [MU3KG:74!null, FV24E:75!null, UJ6XY:76!null, M22QN:77!null, NZ4MQ:78, FHCYT:79, YKSSU:80]\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [tizhk.id:0!null, tizhk.tvnw2:1, tizhk.zhity:2, tizhk.sypkf:3, tizhk.idut2:4, tizhk.o6qj3:5, tizhk.no2ja:6, tizhk.ykssu:7, tizhk.fhcyt:8, tizhk.qz6vt:9, nhmxw.id:10!null, nhmxw.nohhr:11!null, nhmxw.avpyf:12!null, nhmxw.sypkf:13!null, nhmxw.idut2:14!null, nhmxw.fzxv5:15, nhmxw.dqygv:16, nhmxw.swcqv:17!null, nhmxw.ykssu:18, nhmxw.fhcyt:19, j4jyp.id:37!null, j4jyp.dkcaj:38!null, j4jyp.kng7t:39, j4jyp.tw55n:40!null, j4jyp.qrqxw:41!null, j4jyp.ecxaj:42!null, j4jyp.fgg57:43, j4jyp.zh72s:44, j4jyp.fsk67:45!null, j4jyp.xqdyt:46!null, j4jyp.tce7a:47, j4jyp.iwv2h:48, j4jyp.hpcms:49!null, j4jyp.n5cc2:50, j4jyp.fhcyt:51, j4jyp.etaq7:52, j4jyp.a75x7:53, rhuzn.id:20!null, rhuzn.dkcaj:21!null, rhuzn.kng7t:22, rhuzn.tw55n:23!null, rhuzn.qrqxw:24!null, rhuzn.ecxaj:25!null, rhuzn.fgg57:26, rhuzn.zh72s:27, rhuzn.fsk67:28!null, rhuzn.xqdyt:29!null, rhuzn.tce7a:30, rhuzn.iwv2h:31, rhuzn.hpcms:32!null, rhuzn.n5cc2:33, rhuzn.fhcyt:34, rhuzn.etaq7:35, rhuzn.a75x7:36, mf.id:57!null, mf.gxlub:58!null, mf.luevy:59!null, mf.m22qn:60!null, mf.tjpt7:61!null, mf.arn5p:62!null, mf.xosd4:63!null, mf.ide43:64, mf.hmw4h:65, mf.zbt6r:66, mf.fsdy2:67!null, mf.lt7k6:68, mf.sppyd:69, mf.qcgts:70, mf.teuja:71, mf.qqv4m:72, mf.fhcyt:73, aac.id:54!null, aac.btxc5:55, aac.fhcyt:56, tizhk.id:0!null as MU3KG, j4jyp.id:37!null as FV24E, rhuzn.id:20!null as UJ6XY, aac.id:54!null as M22QN, Subquery\n" +
			"             │                           │   ├─ cacheable: false\n" +
			"             │                           │   └─ Project\n" +
			"             │                           │       ├─ columns: [g3yxs.id:74!null]\n" +
			"             │                           │       └─ Filter\n" +
			"             │                           │           ├─ Eq\n" +
			"             │                           │           │   ├─ concat(g3yxs.esfvy:75!null,(MI: (longtext),g3yxs.sl76b:76!null,) (longtext))\n" +
			"             │                           │           │   └─ tizhk.idut2:4\n" +
			"             │                           │           └─ TableAlias(g3yxs)\n" +
			"             │                           │               └─ Table\n" +
			"             │                           │                   ├─ name: YYBCX\n" +
			"             │                           │                   └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"             │                           │   as NZ4MQ, NULL (null) as FHCYT, NULL (null) as YKSSU]\n" +
			"             │                           └─ Filter\n" +
			"             │                               ├─ AND\n" +
			"             │                               │   ├─ Eq\n" +
			"             │                               │   │   ├─ aac.btxc5:55\n" +
			"             │                               │   │   └─ tizhk.sypkf:3\n" +
			"             │                               │   └─ nhmxw.id:10!null IS NULL\n" +
			"             │                               └─ HashJoin\n" +
			"             │                                   ├─ Eq\n" +
			"             │                                   │   ├─ mf.luevy:59!null\n" +
			"             │                                   │   └─ j4jyp.id:37!null\n" +
			"             │                                   ├─ HashJoin\n" +
			"             │                                   │   ├─ Eq\n" +
			"             │                                   │   │   ├─ j4jyp.zh72s:44\n" +
			"             │                                   │   │   └─ tizhk.tvnw2:1\n" +
			"             │                                   │   ├─ HashJoin\n" +
			"             │                                   │   │   ├─ Eq\n" +
			"             │                                   │   │   │   ├─ rhuzn.zh72s:27\n" +
			"             │                                   │   │   │   └─ tizhk.zhity:2\n" +
			"             │                                   │   │   ├─ LeftOuterMergeJoin\n" +
			"             │                                   │   │   │   ├─ cmp: Eq\n" +
			"             │                                   │   │   │   │   ├─ tizhk.tvnw2:1\n" +
			"             │                                   │   │   │   │   └─ nhmxw.nohhr:11!null\n" +
			"             │                                   │   │   │   ├─ sel: AND\n" +
			"             │                                   │   │   │   │   ├─ AND\n" +
			"             │                                   │   │   │   │   │   ├─ AND\n" +
			"             │                                   │   │   │   │   │   │   ├─ Eq\n" +
			"             │                                   │   │   │   │   │   │   │   ├─ nhmxw.swcqv:17!null\n" +
			"             │                                   │   │   │   │   │   │   │   └─ 0 (tinyint)\n" +
			"             │                                   │   │   │   │   │   │   └─ Eq\n" +
			"             │                                   │   │   │   │   │   │       ├─ nhmxw.avpyf:12!null\n" +
			"             │                                   │   │   │   │   │   │       └─ tizhk.zhity:2\n" +
			"             │                                   │   │   │   │   │   └─ Eq\n" +
			"             │                                   │   │   │   │   │       ├─ nhmxw.sypkf:13!null\n" +
			"             │                                   │   │   │   │   │       └─ tizhk.sypkf:3\n" +
			"             │                                   │   │   │   │   └─ Eq\n" +
			"             │                                   │   │   │   │       ├─ nhmxw.idut2:14!null\n" +
			"             │                                   │   │   │   │       └─ tizhk.idut2:4\n" +
			"             │                                   │   │   │   ├─ Filter\n" +
			"             │                                   │   │   │   │   ├─ HashIn\n" +
			"             │                                   │   │   │   │   │   ├─ tizhk.id:0!null\n" +
			"             │                                   │   │   │   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │                                   │   │   │   │   └─ TableAlias(tizhk)\n" +
			"             │                                   │   │   │   │       └─ IndexedTableAccess(WRZVO)\n" +
			"             │                                   │   │   │   │           ├─ index: [WRZVO.TVNW2]\n" +
			"             │                                   │   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                   │   │   │   │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"             │                                   │   │   │   └─ TableAlias(nhmxw)\n" +
			"             │                                   │   │   │       └─ IndexedTableAccess(WGSDC)\n" +
			"             │                                   │   │   │           ├─ index: [WGSDC.NOHHR]\n" +
			"             │                                   │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                   │   │   │           └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"             │                                   │   │   └─ HashLookup\n" +
			"             │                                   │   │       ├─ left-key: TUPLE(tizhk.zhity:2)\n" +
			"             │                                   │   │       ├─ right-key: TUPLE(rhuzn.zh72s:7)\n" +
			"             │                                   │   │       └─ TableAlias(rhuzn)\n" +
			"             │                                   │   │           └─ Table\n" +
			"             │                                   │   │               ├─ name: E2I7U\n" +
			"             │                                   │   │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                                   │   └─ HashLookup\n" +
			"             │                                   │       ├─ left-key: TUPLE(tizhk.tvnw2:1)\n" +
			"             │                                   │       ├─ right-key: TUPLE(j4jyp.zh72s:7)\n" +
			"             │                                   │       └─ TableAlias(j4jyp)\n" +
			"             │                                   │           └─ Table\n" +
			"             │                                   │               ├─ name: E2I7U\n" +
			"             │                                   │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                                   └─ HashLookup\n" +
			"             │                                       ├─ left-key: TUPLE(j4jyp.id:37!null)\n" +
			"             │                                       ├─ right-key: TUPLE(mf.luevy:5!null)\n" +
			"             │                                       └─ MergeJoin\n" +
			"             │                                           ├─ cmp: Eq\n" +
			"             │                                           │   ├─ aac.id:54!null\n" +
			"             │                                           │   └─ mf.m22qn:60!null\n" +
			"             │                                           ├─ TableAlias(aac)\n" +
			"             │                                           │   └─ IndexedTableAccess(TPXBU)\n" +
			"             │                                           │       ├─ index: [TPXBU.id]\n" +
			"             │                                           │       ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                           │       └─ columns: [id btxc5 fhcyt]\n" +
			"             │                                           └─ TableAlias(mf)\n" +
			"             │                                               └─ IndexedTableAccess(HGMQ6)\n" +
			"             │                                                   ├─ index: [HGMQ6.M22QN]\n" +
			"             │                                                   ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                                   └─ columns: [id gxlub luevy m22qn tjpt7 arn5p xosd4 ide43 hmw4h zbt6r fsdy2 lt7k6 sppyd qcgts teuja qqv4m fhcyt]\n" +
			"             └─ Project\n" +
			"                 ├─ columns: [id:0!null, FV24E:1 as FV24E, UJ6XY:2 as UJ6XY, M22QN:3, NZ4MQ:4, ETPQV:5!null, convert\n" +
			"                 │   ├─ type: char\n" +
			"                 │   └─ PRUV2:6!null\n" +
			"                 │   as PRUV2, YKSSU:7, FHCYT:8]\n" +
			"                 └─ Project\n" +
			"                     ├─ columns: [id:8!null, FV24E:9, UJ6XY:10, M22QN:11, NZ4MQ:12, ETPQV:13!null, PRUV2:14!null, YKSSU:15, FHCYT:16]\n" +
			"                     └─ Project\n" +
			"                         ├─ columns: [bpnw2.MU3KG:0!null, bpnw2.FV24E:1, bpnw2.UJ6XY:2, bpnw2.SYPKF:3, bpnw2.NZ4MQ:4, bpnw2.FHCYT:5, bpnw2.YKSSU:6, bpnw2.I4NDZ:7!null, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, bpnw2.FV24E:1 as FV24E, bpnw2.UJ6XY:2 as UJ6XY, Subquery\n" +
			"                         │   ├─ cacheable: false\n" +
			"                         │   └─ Project\n" +
			"                         │       ├─ columns: [aac.id:8!null]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ Eq\n" +
			"                         │           │   ├─ aac.btxc5:9\n" +
			"                         │           │   └─ bpnw2.SYPKF:3\n" +
			"                         │           └─ TableAlias(aac)\n" +
			"                         │               └─ IndexedTableAccess(TPXBU)\n" +
			"                         │                   ├─ index: [TPXBU.BTXC5]\n" +
			"                         │                   └─ columns: [id btxc5 fhcyt]\n" +
			"                         │   as M22QN, bpnw2.NZ4MQ:4 as NZ4MQ, bpnw2.MU3KG:0!null as ETPQV, bpnw2.I4NDZ:7!null as PRUV2, bpnw2.YKSSU:6 as YKSSU, bpnw2.FHCYT:5 as FHCYT]\n" +
			"                         └─ SubqueryAlias\n" +
			"                             ├─ name: bpnw2\n" +
			"                             ├─ outerVisibility: false\n" +
			"                             ├─ cacheable: true\n" +
			"                             └─ Distinct\n" +
			"                                 └─ Project\n" +
			"                                     ├─ columns: [MU3KG:54!null, FV24E:55, UJ6XY:56, SYPKF:57, NZ4MQ:58, FHCYT:59, YKSSU:60, I4NDZ:61!null]\n" +
			"                                     └─ Project\n" +
			"                                         ├─ columns: [tizhk.id:0!null, tizhk.tvnw2:1, tizhk.zhity:2, tizhk.sypkf:3, tizhk.idut2:4, tizhk.o6qj3:5, tizhk.no2ja:6, tizhk.ykssu:7, tizhk.fhcyt:8, tizhk.qz6vt:9, nhmxw.id:10!null, nhmxw.nohhr:11!null, nhmxw.avpyf:12!null, nhmxw.sypkf:13!null, nhmxw.idut2:14!null, nhmxw.fzxv5:15, nhmxw.dqygv:16, nhmxw.swcqv:17!null, nhmxw.ykssu:18, nhmxw.fhcyt:19, j4jyp.id:20!null, j4jyp.dkcaj:21!null, j4jyp.kng7t:22, j4jyp.tw55n:23!null, j4jyp.qrqxw:24!null, j4jyp.ecxaj:25!null, j4jyp.fgg57:26, j4jyp.zh72s:27, j4jyp.fsk67:28!null, j4jyp.xqdyt:29!null, j4jyp.tce7a:30, j4jyp.iwv2h:31, j4jyp.hpcms:32!null, j4jyp.n5cc2:33, j4jyp.fhcyt:34, j4jyp.etaq7:35, j4jyp.a75x7:36, rhuzn.id:37!null, rhuzn.dkcaj:38!null, rhuzn.kng7t:39, rhuzn.tw55n:40!null, rhuzn.qrqxw:41!null, rhuzn.ecxaj:42!null, rhuzn.fgg57:43, rhuzn.zh72s:44, rhuzn.fsk67:45!null, rhuzn.xqdyt:46!null, rhuzn.tce7a:47, rhuzn.iwv2h:48, rhuzn.hpcms:49!null, rhuzn.n5cc2:50, rhuzn.fhcyt:51, rhuzn.etaq7:52, rhuzn.a75x7:53, tizhk.id:0!null as MU3KG, CASE  WHEN NOT\n" +
			"                                         │   └─ nhmxw.fzxv5:15 IS NULL\n" +
			"                                         │   THEN Subquery\n" +
			"                                         │   ├─ cacheable: false\n" +
			"                                         │   └─ Project\n" +
			"                                         │       ├─ columns: [overridden_nd_mutant.id:54!null]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ Eq\n" +
			"                                         │           │   ├─ overridden_nd_mutant.tw55n:57!null\n" +
			"                                         │           │   └─ nhmxw.fzxv5:15\n" +
			"                                         │           └─ TableAlias(overridden_nd_mutant)\n" +
			"                                         │               └─ IndexedTableAccess(E2I7U)\n" +
			"                                         │                   ├─ index: [E2I7U.TW55N]\n" +
			"                                         │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                         │   ELSE j4jyp.id:20!null END as FV24E, CASE  WHEN NOT\n" +
			"                                         │   └─ nhmxw.dqygv:16 IS NULL\n" +
			"                                         │   THEN Subquery\n" +
			"                                         │   ├─ cacheable: false\n" +
			"                                         │   └─ Project\n" +
			"                                         │       ├─ columns: [overridden_qi2iener.id:54!null]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ Eq\n" +
			"                                         │           │   ├─ overridden_qi2iener.tw55n:57!null\n" +
			"                                         │           │   └─ nhmxw.dqygv:16\n" +
			"                                         │           └─ TableAlias(overridden_qi2iener)\n" +
			"                                         │               └─ IndexedTableAccess(E2I7U)\n" +
			"                                         │                   ├─ index: [E2I7U.TW55N]\n" +
			"                                         │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                         │   ELSE rhuzn.id:37!null END as UJ6XY, tizhk.sypkf:3 as SYPKF, Subquery\n" +
			"                                         │   ├─ cacheable: false\n" +
			"                                         │   └─ Project\n" +
			"                                         │       ├─ columns: [g3yxs.id:54!null]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ Eq\n" +
			"                                         │           │   ├─ concat(g3yxs.esfvy:55!null,(MI: (longtext),g3yxs.sl76b:56!null,) (longtext))\n" +
			"                                         │           │   └─ tizhk.idut2:4\n" +
			"                                         │           └─ TableAlias(g3yxs)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: YYBCX\n" +
			"                                         │                   └─ columns: [id esfvy sl76b ge5el f7a4q tuv25 ykssu fhcyt]\n" +
			"                                         │   as NZ4MQ, NULL (null) as FHCYT, NULL (null) as YKSSU, nhmxw.id:10!null as I4NDZ]\n" +
			"                                         └─ Filter\n" +
			"                                             ├─ NOT\n" +
			"                                             │   └─ nhmxw.id:10!null IS NULL\n" +
			"                                             └─ LeftOuterHashJoin\n" +
			"                                                 ├─ Eq\n" +
			"                                                 │   ├─ rhuzn.zh72s:44\n" +
			"                                                 │   └─ tizhk.zhity:2\n" +
			"                                                 ├─ LeftOuterHashJoin\n" +
			"                                                 │   ├─ Eq\n" +
			"                                                 │   │   ├─ j4jyp.zh72s:27\n" +
			"                                                 │   │   └─ tizhk.tvnw2:1\n" +
			"                                                 │   ├─ LeftOuterMergeJoin\n" +
			"                                                 │   │   ├─ cmp: Eq\n" +
			"                                                 │   │   │   ├─ tizhk.tvnw2:1\n" +
			"                                                 │   │   │   └─ nhmxw.nohhr:11!null\n" +
			"                                                 │   │   ├─ sel: AND\n" +
			"                                                 │   │   │   ├─ AND\n" +
			"                                                 │   │   │   │   ├─ AND\n" +
			"                                                 │   │   │   │   │   ├─ Eq\n" +
			"                                                 │   │   │   │   │   │   ├─ nhmxw.swcqv:17!null\n" +
			"                                                 │   │   │   │   │   │   └─ 0 (tinyint)\n" +
			"                                                 │   │   │   │   │   └─ Eq\n" +
			"                                                 │   │   │   │   │       ├─ nhmxw.avpyf:12!null\n" +
			"                                                 │   │   │   │   │       └─ tizhk.zhity:2\n" +
			"                                                 │   │   │   │   └─ Eq\n" +
			"                                                 │   │   │   │       ├─ nhmxw.sypkf:13!null\n" +
			"                                                 │   │   │   │       └─ tizhk.sypkf:3\n" +
			"                                                 │   │   │   └─ Eq\n" +
			"                                                 │   │   │       ├─ nhmxw.idut2:14!null\n" +
			"                                                 │   │   │       └─ tizhk.idut2:4\n" +
			"                                                 │   │   ├─ Filter\n" +
			"                                                 │   │   │   ├─ HashIn\n" +
			"                                                 │   │   │   │   ├─ tizhk.id:0!null\n" +
			"                                                 │   │   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"                                                 │   │   │   └─ TableAlias(tizhk)\n" +
			"                                                 │   │   │       └─ IndexedTableAccess(WRZVO)\n" +
			"                                                 │   │   │           ├─ index: [WRZVO.TVNW2]\n" +
			"                                                 │   │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                 │   │   │           └─ columns: [id tvnw2 zhity sypkf idut2 o6qj3 no2ja ykssu fhcyt qz6vt]\n" +
			"                                                 │   │   └─ TableAlias(nhmxw)\n" +
			"                                                 │   │       └─ IndexedTableAccess(WGSDC)\n" +
			"                                                 │   │           ├─ index: [WGSDC.NOHHR]\n" +
			"                                                 │   │           ├─ static: [{[NULL, ∞)}]\n" +
			"                                                 │   │           └─ columns: [id nohhr avpyf sypkf idut2 fzxv5 dqygv swcqv ykssu fhcyt]\n" +
			"                                                 │   └─ HashLookup\n" +
			"                                                 │       ├─ left-key: TUPLE(tizhk.tvnw2:1)\n" +
			"                                                 │       ├─ right-key: TUPLE(j4jyp.zh72s:7)\n" +
			"                                                 │       └─ TableAlias(j4jyp)\n" +
			"                                                 │           └─ Table\n" +
			"                                                 │               ├─ name: E2I7U\n" +
			"                                                 │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"                                                 └─ HashLookup\n" +
			"                                                     ├─ left-key: TUPLE(tizhk.zhity:2)\n" +
			"                                                     ├─ right-key: TUPLE(rhuzn.zh72s:7)\n" +
			"                                                     └─ TableAlias(rhuzn)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: E2I7U\n" +
			"                                                             └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"",
	},
	{
		Query: `
INSERT INTO
    SFEGG(id, NO52D, VYO5E, DKCAJ, ADURZ, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    rs.NO52D AS NO52D,
    rs.VYO5E AS VYO5E,
    rs.DKCAJ AS DKCAJ,
    CASE
        WHEN rs.NO52D = 'FZB3D' AND rs.F35MI = 'SUZTA' THEN 1
        WHEN rs.NO52D = 'FZB3D' AND rs.F35MI <> 'SUZTA' THEN 3
        WHEN rs.NO52D LIKE 'AC%' OR rs.NO52D LIKE 'EC%' THEN 3
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E IS NULL THEN 2
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E = 'CF' THEN 1
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E IS NOT NULL AND NOT(rs.VYO5E = 'CF') THEN 4
        WHEN rs.NO52D = 'Ki' THEN 1
        WHEN rs.NO52D = 'Kd' THEN 2
        ELSE NULL
    END AS ADURZ,
    NULL AS FHCYT
FROM
    (
    SELECT DISTINCT
        NK7FP.NO52D AS NO52D,
        CASE
            WHEN NK7FP.VYO5E = 'N/A' THEN NULL
            ELSE NK7FP.VYO5E
        END AS VYO5E,
        nt.id AS DKCAJ,
        nt.DZLIM AS F35MI
    FROM
        (
        SELECT DISTINCT
            uct.NO52D,
            uct.VYO5E,
            uct.ZH72S,
            I7HCR.FVUCX
        FROM
            OUBDL uct
        LEFT JOIN -- Joining overrides, we need the overridden UWBAI TAFAX in this case
            EPZU6 I7HCR
        ON
                I7HCR.SWCQV = 0 -- Override is turned on
            AND
                I7HCR.TOFPN = uct.FTQLQ
            AND
                I7HCR.SJYN2 = uct.ZH72S
            AND
                I7HCR.BTXC5 = uct.LJLUM
        WHERE
            uct.id IN ('1','2','3')
        ) NK7FP
    INNER JOIN
        E2I7U nd
    ON
            (
                NK7FP.FVUCX IS NULL
            AND
                nd.ZH72S = NK7FP.ZH72S
            )
        OR
            (
                NK7FP.FVUCX IS NOT NULL
            AND
                nd.TW55N = NK7FP.FVUCX
            )
    INNER JOIN
        F35MI nt ON nt.id = nd.DKCAJ
    ) rs
WHERE
        (
            rs.VYO5E IS NOT NULL
        AND
            (rs.NO52D, rs.VYO5E, rs.DKCAJ) NOT IN (SELECT DISTINCT NO52D, VYO5E, DKCAJ FROM SFEGG WHERE VYO5E IS NOT NULL)
        )
    OR
        (
            rs.VYO5E IS NULL
        AND
            (rs.NO52D, rs.DKCAJ) NOT IN (SELECT DISTINCT NO52D, DKCAJ FROM SFEGG WHERE VYO5E IS NULL)
        )`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, NO52D, VYO5E, DKCAJ, ADURZ, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SFEGG\n" +
			"         │       └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER SFEGG_on_insert BEFORE INSERT ON SFEGG\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.NO52D IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR NEW.VYO5E IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.ADURZ <= 0\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'ADURZ must be positive.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'ADURZ must be positive.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, NO52D:1!null, VYO5E:2, DKCAJ:3!null, ADURZ:4!null, FHCYT:5]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:4!null, NO52D:5, VYO5E:6, DKCAJ:7!null, ADURZ:8, FHCYT:9]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [rs.NO52D:0, rs.VYO5E:1, rs.DKCAJ:2!null, rs.F35MI:3!null, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, rs.NO52D:0 as NO52D, rs.VYO5E:1 as VYO5E, rs.DKCAJ:2!null as DKCAJ, CASE  WHEN AND\n" +
			"             │           │   ├─ Eq\n" +
			"             │           │   │   ├─ rs.NO52D:0\n" +
			"             │           │   │   └─ FZB3D (longtext)\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ rs.F35MI:3!null\n" +
			"             │           │       └─ SUZTA (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN AND\n" +
			"             │           │   ├─ Eq\n" +
			"             │           │   │   ├─ rs.NO52D:0\n" +
			"             │           │   │   └─ FZB3D (longtext)\n" +
			"             │           │   └─ NOT\n" +
			"             │           │       └─ Eq\n" +
			"             │           │           ├─ rs.F35MI:3!null\n" +
			"             │           │           └─ SUZTA (longtext)\n" +
			"             │           │   THEN 3 (tinyint) WHEN Or\n" +
			"             │           │   ├─ rs.NO52D LIKE 'AC%'\n" +
			"             │           │   └─ rs.NO52D LIKE 'EC%'\n" +
			"             │           │   THEN 3 (tinyint) WHEN AND\n" +
			"             │           │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   └─ rs.VYO5E:1 IS NULL\n" +
			"             │           │   THEN 2 (tinyint) WHEN AND\n" +
			"             │           │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ rs.VYO5E:1\n" +
			"             │           │       └─ CF (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN AND\n" +
			"             │           │   ├─ AND\n" +
			"             │           │   │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   │   └─ NOT\n" +
			"             │           │   │       └─ rs.VYO5E:1 IS NULL\n" +
			"             │           │   └─ NOT\n" +
			"             │           │       └─ Eq\n" +
			"             │           │           ├─ rs.VYO5E:1\n" +
			"             │           │           └─ CF (longtext)\n" +
			"             │           │   THEN 4 (tinyint) WHEN Eq\n" +
			"             │           │   ├─ rs.NO52D:0\n" +
			"             │           │   └─ Ki (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN Eq\n" +
			"             │           │   ├─ rs.NO52D:0\n" +
			"             │           │   └─ Kd (longtext)\n" +
			"             │           │   THEN 2 (tinyint) ELSE NULL (null) END as ADURZ, NULL (null) as FHCYT]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ Or\n" +
			"             │               │   ├─ AND\n" +
			"             │               │   │   ├─ NOT\n" +
			"             │               │   │   │   └─ rs.VYO5E:1 IS NULL\n" +
			"             │               │   │   └─ NOT\n" +
			"             │               │   │       └─ InSubquery\n" +
			"             │               │   │           ├─ left: TUPLE(rs.NO52D:0, rs.VYO5E:1, rs.DKCAJ:2!null)\n" +
			"             │               │   │           └─ right: Subquery\n" +
			"             │               │   │               ├─ cacheable: true\n" +
			"             │               │   │               └─ Distinct\n" +
			"             │               │   │                   └─ Project\n" +
			"             │               │   │                       ├─ columns: [sfegg.no52d:5!null, sfegg.vyo5e:6, sfegg.dkcaj:7!null]\n" +
			"             │               │   │                       └─ Filter\n" +
			"             │               │   │                           ├─ NOT\n" +
			"             │               │   │                           │   └─ sfegg.vyo5e:6 IS NULL\n" +
			"             │               │   │                           └─ Table\n" +
			"             │               │   │                               ├─ name: SFEGG\n" +
			"             │               │   │                               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │               │   └─ AND\n" +
			"             │               │       ├─ rs.VYO5E:1 IS NULL\n" +
			"             │               │       └─ NOT\n" +
			"             │               │           └─ InSubquery\n" +
			"             │               │               ├─ left: TUPLE(rs.NO52D:0, rs.DKCAJ:2!null)\n" +
			"             │               │               └─ right: Subquery\n" +
			"             │               │                   ├─ cacheable: true\n" +
			"             │               │                   └─ Distinct\n" +
			"             │               │                       └─ Project\n" +
			"             │               │                           ├─ columns: [sfegg.no52d:5!null, sfegg.dkcaj:7!null]\n" +
			"             │               │                           └─ Filter\n" +
			"             │               │                               ├─ sfegg.vyo5e:6 IS NULL\n" +
			"             │               │                               └─ Table\n" +
			"             │               │                                   ├─ name: SFEGG\n" +
			"             │               │                                   └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │               └─ SubqueryAlias\n" +
			"             │                   ├─ name: rs\n" +
			"             │                   ├─ outerVisibility: false\n" +
			"             │                   ├─ cacheable: true\n" +
			"             │                   └─ Distinct\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [NO52D:24, VYO5E:25, DKCAJ:26!null, F35MI:27!null]\n" +
			"             │                           └─ Project\n" +
			"             │                               ├─ columns: [nk7fp.no52d:0, nk7fp.vyo5e:1, nk7fp.zh72s:2, nk7fp.fvucx:3!null, nd.id:4!null, nd.dkcaj:5!null, nd.kng7t:6, nd.tw55n:7!null, nd.qrqxw:8!null, nd.ecxaj:9!null, nd.fgg57:10, nd.zh72s:11, nd.fsk67:12!null, nd.xqdyt:13!null, nd.tce7a:14, nd.iwv2h:15, nd.hpcms:16!null, nd.n5cc2:17, nd.fhcyt:18, nd.etaq7:19, nd.a75x7:20, nt.id:21!null, nt.dzlim:22!null, nt.f3yue:23, nk7fp.no52d:0 as NO52D, CASE  WHEN Eq\n" +
			"             │                               │   ├─ nk7fp.vyo5e:1\n" +
			"             │                               │   └─ N/A (longtext)\n" +
			"             │                               │   THEN NULL (null) ELSE nk7fp.vyo5e:1 END as VYO5E, nt.id:21!null as DKCAJ, nt.dzlim:22!null as F35MI]\n" +
			"             │                               └─ HashJoin\n" +
			"             │                                   ├─ Eq\n" +
			"             │                                   │   ├─ nt.id:21!null\n" +
			"             │                                   │   └─ nd.dkcaj:5!null\n" +
			"             │                                   ├─ LookupJoin\n" +
			"             │                                   │   ├─ Or\n" +
			"             │                                   │   │   ├─ AND\n" +
			"             │                                   │   │   │   ├─ nk7fp.fvucx:3!null IS NULL\n" +
			"             │                                   │   │   │   └─ Eq\n" +
			"             │                                   │   │   │       ├─ nd.zh72s:11\n" +
			"             │                                   │   │   │       └─ nk7fp.zh72s:2\n" +
			"             │                                   │   │   └─ AND\n" +
			"             │                                   │   │       ├─ NOT\n" +
			"             │                                   │   │       │   └─ nk7fp.fvucx:3!null IS NULL\n" +
			"             │                                   │   │       └─ Eq\n" +
			"             │                                   │   │           ├─ nd.tw55n:7!null\n" +
			"             │                                   │   │           └─ nk7fp.fvucx:3!null\n" +
			"             │                                   │   ├─ SubqueryAlias\n" +
			"             │                                   │   │   ├─ name: nk7fp\n" +
			"             │                                   │   │   ├─ outerVisibility: false\n" +
			"             │                                   │   │   ├─ cacheable: true\n" +
			"             │                                   │   │   └─ Distinct\n" +
			"             │                                   │   │       └─ Project\n" +
			"             │                                   │   │           ├─ columns: [uct.no52d:7, uct.vyo5e:9, uct.zh72s:2, i7hcr.fvucx:17!null]\n" +
			"             │                                   │   │           └─ Project\n" +
			"             │                                   │   │               ├─ columns: [uct.id:0!null, uct.ftqlq:1, uct.zh72s:2, uct.sfj6l:3, uct.v5dpx:4, uct.ljlum:5, uct.idpk7:6, uct.no52d:7, uct.zrv3b:8, uct.vyo5e:9, uct.ykssu:10, uct.fhcyt:11, uct.qz6vt:12, i7hcr.id:13!null, i7hcr.tofpn:14!null, i7hcr.sjyn2:15!null, i7hcr.btxc5:16!null, i7hcr.fvucx:17!null, i7hcr.swcqv:18!null, i7hcr.ykssu:19, i7hcr.fhcyt:20]\n" +
			"             │                                   │   │               └─ LeftOuterMergeJoin\n" +
			"             │                                   │   │                   ├─ cmp: Eq\n" +
			"             │                                   │   │                   │   ├─ uct.ftqlq:1\n" +
			"             │                                   │   │                   │   └─ i7hcr.tofpn:14!null\n" +
			"             │                                   │   │                   ├─ sel: AND\n" +
			"             │                                   │   │                   │   ├─ AND\n" +
			"             │                                   │   │                   │   │   ├─ Eq\n" +
			"             │                                   │   │                   │   │   │   ├─ i7hcr.swcqv:18!null\n" +
			"             │                                   │   │                   │   │   │   └─ 0 (tinyint)\n" +
			"             │                                   │   │                   │   │   └─ Eq\n" +
			"             │                                   │   │                   │   │       ├─ i7hcr.sjyn2:15!null\n" +
			"             │                                   │   │                   │   │       └─ uct.zh72s:2\n" +
			"             │                                   │   │                   │   └─ Eq\n" +
			"             │                                   │   │                   │       ├─ i7hcr.btxc5:16!null\n" +
			"             │                                   │   │                   │       └─ uct.ljlum:5\n" +
			"             │                                   │   │                   ├─ Filter\n" +
			"             │                                   │   │                   │   ├─ HashIn\n" +
			"             │                                   │   │                   │   │   ├─ uct.id:0!null\n" +
			"             │                                   │   │                   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │                                   │   │                   │   └─ TableAlias(uct)\n" +
			"             │                                   │   │                   │       └─ IndexedTableAccess(OUBDL)\n" +
			"             │                                   │   │                   │           ├─ index: [OUBDL.FTQLQ]\n" +
			"             │                                   │   │                   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                   │   │                   │           └─ columns: [id ftqlq zh72s sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e ykssu fhcyt qz6vt]\n" +
			"             │                                   │   │                   └─ TableAlias(i7hcr)\n" +
			"             │                                   │   │                       └─ IndexedTableAccess(EPZU6)\n" +
			"             │                                   │   │                           ├─ index: [EPZU6.TOFPN]\n" +
			"             │                                   │   │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │                                   │   │                           └─ columns: [id tofpn sjyn2 btxc5 fvucx swcqv ykssu fhcyt]\n" +
			"             │                                   │   └─ TableAlias(nd)\n" +
			"             │                                   │       └─ Concat\n" +
			"             │                                   │           ├─ IndexedTableAccess(E2I7U)\n" +
			"             │                                   │           │   ├─ index: [E2I7U.TW55N]\n" +
			"             │                                   │           │   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                                   │           └─ IndexedTableAccess(E2I7U)\n" +
			"             │                                   │               ├─ index: [E2I7U.ZH72S]\n" +
			"             │                                   │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                                   └─ HashLookup\n" +
			"             │                                       ├─ left-key: TUPLE(nd.dkcaj:5!null)\n" +
			"             │                                       ├─ right-key: TUPLE(nt.id:0!null)\n" +
			"             │                                       └─ TableAlias(nt)\n" +
			"             │                                           └─ Table\n" +
			"             │                                               ├─ name: F35MI\n" +
			"             │                                               └─ columns: [id dzlim f3yue]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(Or\n" +
			"                 │       ├─ InSubquery\n" +
			"                 │       │   ├─ left: new.no52d:1!null\n" +
			"                 │       │   └─ right: Subquery\n" +
			"                 │       │       ├─ cacheable: false\n" +
			"                 │       │       └─ Project\n" +
			"                 │       │           ├─ columns: [tpxhz.svaz4:7!null]\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: TPXHZ\n" +
			"                 │       │               └─ columns: [id svaz4]\n" +
			"                 │       └─ InSubquery\n" +
			"                 │           ├─ left: new.vyo5e:2\n" +
			"                 │           └─ right: Subquery\n" +
			"                 │               ├─ cacheable: false\n" +
			"                 │               └─ Project\n" +
			"                 │                   ├─ columns: [tpxhz.svaz4:7!null]\n" +
			"                 │                   └─ Table\n" +
			"                 │                       ├─ name: TPXHZ\n" +
			"                 │                       └─ columns: [id svaz4]\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(LessThanOrEqual\n" +
			"                         ├─ new.adurz:4!null\n" +
			"                         └─ 0 (tinyint)\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = ADURZ must be positive., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO FLQLP
    (id, FZ2R5, LUEVY, M22QN, OVE3E, NRURT, OCA7E, XMM6Q, V5DPX, S3Q3Y, ZRV3B, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    PQSXB.FZ2R5 AS FZ2R5,
    nd.id AS LUEVY,
    (SELECT aac.id FROM TPXBU aac WHERE aac.BTXC5 = PQSXB.BTXC5) AS M22QN,
    PQSXB.OVE3E AS OVE3E,
    PQSXB.NRURT AS NRURT,
    PQSXB.OCA7E AS OCA7E,
    PQSXB.XMM6Q AS XMM6Q,
    PQSXB.V5DPX AS V5DPX,
    PQSXB.S3Q3Y AS S3Q3Y,
    PQSXB.ZRV3B AS ZRV3B,
    PQSXB.FHCYT AS FHCYT
FROM
    (
    SELECT
        -- Base fields to insert to FLQLP
        (SELECT id FROM JDLNA WHERE JDLNA.FTQLQ = uct.FTQLQ) AS FZ2R5,
        (SELECT id FROM SFEGG WHERE
            SFEGG.NO52D = uct.NO52D AND
            (
                SFEGG.VYO5E = uct.VYO5E OR
                (SFEGG.VYO5E IS NULL AND (uct.VYO5E IS NULL OR uct.VYO5E = 'N/A' OR uct.VYO5E = 'NA'))
            ) AND
            SFEGG.DKCAJ = (
                SELECT
                    CASE
                        WHEN I7HCR.FVUCX IS NULL
                            THEN (SELECT nd.DKCAJ FROM E2I7U nd WHERE nd.ZH72S = uct.ZH72S LIMIT 1)
                        ELSE
                            (SELECT nd.DKCAJ FROM E2I7U nd WHERE nd.TW55N = I7HCR.FVUCX)
                    END
            )
        ) AS OVE3E,
        uct.id AS NRURT,
        I7HCR.id AS OCA7E,
        NULL AS XMM6Q, -- Here we do not care with additionals
        uct.V5DPX AS V5DPX,
        uct.IDPK7 + 0.0 AS S3Q3Y,
        uct.ZRV3B AS ZRV3B,
        CASE
            WHEN uct.FHCYT <> 'N/A' THEN uct.FHCYT
            ELSE NULL
        END AS FHCYT,
        -- Extra fields to use
        uct.ZH72S AS K3B6V,
        uct.LJLUM AS BTXC5,
        I7HCR.FVUCX AS H4DMT
    FROM
        OUBDL uct
    LEFT JOIN -- Joining overrides
        EPZU6 I7HCR
    ON
            I7HCR.SWCQV = 0 -- Override is turned on
        AND
            I7HCR.TOFPN = uct.FTQLQ
        AND
            I7HCR.SJYN2 = uct.ZH72S
        AND
            I7HCR.BTXC5 = uct.LJLUM
    WHERE
        uct.id IN ('1','2','3')
    ) PQSXB
INNER JOIN
    E2I7U nd
ON
    (
            PQSXB.H4DMT IS NOT NULL
        AND
            nd.TW55N = PQSXB.H4DMT
    )
    OR
    (
            PQSXB.H4DMT IS NULL
        AND
            nd.ZH72S = PQSXB.K3B6V
    )
WHERE
        -- In the case we could not build-in evidence class for some
        PQSXB.OVE3E IS NOT NULL`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, FZ2R5, LUEVY, M22QN, OVE3E, NRURT, OCA7E, XMM6Q, V5DPX, S3Q3Y, ZRV3B, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: FLQLP\n" +
			"         │       └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER FLQLP_on_insert BEFORE INSERT ON FLQLP\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.V5DPX IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.ZRV3B NOT IN ('=', '<=', '>=', '<', '>')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ZRV3B must be on of the following: ''='', ''<='', ''>='', ''<'', ''>''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ZRV3B must be on of the following: ''='', ''<='', ''>='', ''<'', ''>''.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, FZ2R5:1!null, LUEVY:2!null, M22QN:3!null, OVE3E:4!null, NRURT:5, OCA7E:6, XMM6Q:7, V5DPX:8!null, S3Q3Y:9!null, ZRV3B:10!null, FHCYT:11]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:29!null, FZ2R5:30, LUEVY:31!null, M22QN:32, OVE3E:33, NRURT:34!null, OCA7E:35!null, XMM6Q:36, V5DPX:37, S3Q3Y:38, ZRV3B:39, FHCYT:40]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [pqsxb.FZ2R5:0, pqsxb.OVE3E:1, pqsxb.NRURT:2!null, pqsxb.OCA7E:3!null, pqsxb.XMM6Q:4, pqsxb.V5DPX:5, pqsxb.S3Q3Y:6, pqsxb.ZRV3B:7, pqsxb.FHCYT:8, pqsxb.K3B6V:9, pqsxb.BTXC5:10, pqsxb.H4DMT:11!null, nd.id:12!null, nd.dkcaj:13!null, nd.kng7t:14, nd.tw55n:15!null, nd.qrqxw:16!null, nd.ecxaj:17!null, nd.fgg57:18, nd.zh72s:19, nd.fsk67:20!null, nd.xqdyt:21!null, nd.tce7a:22, nd.iwv2h:23, nd.hpcms:24!null, nd.n5cc2:25, nd.fhcyt:26, nd.etaq7:27, nd.a75x7:28, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, pqsxb.FZ2R5:0 as FZ2R5, nd.id:12!null as LUEVY, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [aac.id:29!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ aac.btxc5:30\n" +
			"             │           │           │   └─ pqsxb.BTXC5:10\n" +
			"             │           │           └─ TableAlias(aac)\n" +
			"             │           │               └─ IndexedTableAccess(TPXBU)\n" +
			"             │           │                   ├─ index: [TPXBU.BTXC5]\n" +
			"             │           │                   └─ columns: [id btxc5 fhcyt]\n" +
			"             │           │   as M22QN, pqsxb.OVE3E:1 as OVE3E, pqsxb.NRURT:2!null as NRURT, pqsxb.OCA7E:3!null as OCA7E, pqsxb.XMM6Q:4 as XMM6Q, pqsxb.V5DPX:5 as V5DPX, pqsxb.S3Q3Y:6 as S3Q3Y, pqsxb.ZRV3B:7 as ZRV3B, pqsxb.FHCYT:8 as FHCYT]\n" +
			"             │           └─ LookupJoin\n" +
			"             │               ├─ Or\n" +
			"             │               │   ├─ AND\n" +
			"             │               │   │   ├─ NOT\n" +
			"             │               │   │   │   └─ pqsxb.H4DMT:11!null IS NULL\n" +
			"             │               │   │   └─ Eq\n" +
			"             │               │   │       ├─ nd.tw55n:15!null\n" +
			"             │               │   │       └─ pqsxb.H4DMT:11!null\n" +
			"             │               │   └─ AND\n" +
			"             │               │       ├─ pqsxb.H4DMT:11!null IS NULL\n" +
			"             │               │       └─ Eq\n" +
			"             │               │           ├─ nd.zh72s:19\n" +
			"             │               │           └─ pqsxb.K3B6V:9\n" +
			"             │               ├─ SubqueryAlias\n" +
			"             │               │   ├─ name: pqsxb\n" +
			"             │               │   ├─ outerVisibility: false\n" +
			"             │               │   ├─ cacheable: true\n" +
			"             │               │   └─ Filter\n" +
			"             │               │       ├─ NOT\n" +
			"             │               │       │   └─ OVE3E:1 IS NULL\n" +
			"             │               │       └─ Project\n" +
			"             │               │           ├─ columns: [FZ2R5:21, OVE3E:22, NRURT:23!null, OCA7E:24!null, XMM6Q:25, V5DPX:26, S3Q3Y:27, ZRV3B:28, FHCYT:29, K3B6V:30, BTXC5:31, H4DMT:32!null]\n" +
			"             │               │           └─ Project\n" +
			"             │               │               ├─ columns: [uct.id:0!null, uct.ftqlq:1, uct.zh72s:2, uct.sfj6l:3, uct.v5dpx:4, uct.ljlum:5, uct.idpk7:6, uct.no52d:7, uct.zrv3b:8, uct.vyo5e:9, uct.ykssu:10, uct.fhcyt:11, uct.qz6vt:12, i7hcr.id:13!null, i7hcr.tofpn:14!null, i7hcr.sjyn2:15!null, i7hcr.btxc5:16!null, i7hcr.fvucx:17!null, i7hcr.swcqv:18!null, i7hcr.ykssu:19, i7hcr.fhcyt:20, Subquery\n" +
			"             │               │               │   ├─ cacheable: false\n" +
			"             │               │               │   └─ Project\n" +
			"             │               │               │       ├─ columns: [jdlna.id:21!null]\n" +
			"             │               │               │       └─ Filter\n" +
			"             │               │               │           ├─ Eq\n" +
			"             │               │               │           │   ├─ jdlna.ftqlq:22!null\n" +
			"             │               │               │           │   └─ uct.ftqlq:1\n" +
			"             │               │               │           └─ IndexedTableAccess(JDLNA)\n" +
			"             │               │               │               ├─ index: [JDLNA.FTQLQ]\n" +
			"             │               │               │               └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"             │               │               │   as FZ2R5, Subquery\n" +
			"             │               │               │   ├─ cacheable: false\n" +
			"             │               │               │   └─ Project\n" +
			"             │               │               │       ├─ columns: [sfegg.id:21!null]\n" +
			"             │               │               │       └─ Filter\n" +
			"             │               │               │           ├─ AND\n" +
			"             │               │               │           │   ├─ AND\n" +
			"             │               │               │           │   │   ├─ Eq\n" +
			"             │               │               │           │   │   │   ├─ sfegg.no52d:22!null\n" +
			"             │               │               │           │   │   │   └─ uct.no52d:7\n" +
			"             │               │               │           │   │   └─ Or\n" +
			"             │               │               │           │   │       ├─ Eq\n" +
			"             │               │               │           │   │       │   ├─ sfegg.vyo5e:23\n" +
			"             │               │               │           │   │       │   └─ uct.vyo5e:9\n" +
			"             │               │               │           │   │       └─ AND\n" +
			"             │               │               │           │   │           ├─ sfegg.vyo5e:23 IS NULL\n" +
			"             │               │               │           │   │           └─ Or\n" +
			"             │               │               │           │   │               ├─ Or\n" +
			"             │               │               │           │   │               │   ├─ uct.vyo5e:9 IS NULL\n" +
			"             │               │               │           │   │               │   └─ Eq\n" +
			"             │               │               │           │   │               │       ├─ uct.vyo5e:9\n" +
			"             │               │               │           │   │               │       └─ N/A (longtext)\n" +
			"             │               │               │           │   │               └─ Eq\n" +
			"             │               │               │           │   │                   ├─ uct.vyo5e:9\n" +
			"             │               │               │           │   │                   └─ NA (longtext)\n" +
			"             │               │               │           │   └─ Eq\n" +
			"             │               │               │           │       ├─ sfegg.dkcaj:24!null\n" +
			"             │               │               │           │       └─ Subquery\n" +
			"             │               │               │           │           ├─ cacheable: false\n" +
			"             │               │               │           │           └─ Project\n" +
			"             │               │               │           │               ├─ columns: [CASE  WHEN i7hcr.fvucx:17!null IS NULL THEN Subquery\n" +
			"             │               │               │           │               │   ├─ cacheable: false\n" +
			"             │               │               │           │               │   └─ Limit(1)\n" +
			"             │               │               │           │               │       └─ Project\n" +
			"             │               │               │           │               │           ├─ columns: [nd.dkcaj:29!null]\n" +
			"             │               │               │           │               │           └─ Filter\n" +
			"             │               │               │           │               │               ├─ Eq\n" +
			"             │               │               │           │               │               │   ├─ nd.zh72s:35\n" +
			"             │               │               │           │               │               │   └─ uct.zh72s:2\n" +
			"             │               │               │           │               │               └─ TableAlias(nd)\n" +
			"             │               │               │           │               │                   └─ IndexedTableAccess(E2I7U)\n" +
			"             │               │               │           │               │                       ├─ index: [E2I7U.ZH72S]\n" +
			"             │               │               │           │               │                       └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │               │               │           │               │   ELSE Subquery\n" +
			"             │               │               │           │               │   ├─ cacheable: false\n" +
			"             │               │               │           │               │   └─ Project\n" +
			"             │               │               │           │               │       ├─ columns: [nd.dkcaj:29!null]\n" +
			"             │               │               │           │               │       └─ Filter\n" +
			"             │               │               │           │               │           ├─ Eq\n" +
			"             │               │               │           │               │           │   ├─ nd.tw55n:31!null\n" +
			"             │               │               │           │               │           │   └─ i7hcr.fvucx:17!null\n" +
			"             │               │               │           │               │           └─ TableAlias(nd)\n" +
			"             │               │               │           │               │               └─ IndexedTableAccess(E2I7U)\n" +
			"             │               │               │           │               │                   ├─ index: [E2I7U.TW55N]\n" +
			"             │               │               │           │               │                   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │               │               │           │               │   END]\n" +
			"             │               │               │           │               └─ Table\n" +
			"             │               │               │           │                   ├─ name: \n" +
			"             │               │               │           │                   └─ columns: []\n" +
			"             │               │               │           └─ IndexedTableAccess(SFEGG)\n" +
			"             │               │               │               ├─ index: [SFEGG.NO52D,SFEGG.VYO5E,SFEGG.DKCAJ]\n" +
			"             │               │               │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │               │               │   as OVE3E, uct.id:0!null as NRURT, i7hcr.id:13!null as OCA7E, NULL (null) as XMM6Q, uct.v5dpx:4 as V5DPX, (uct.idpk7:6 + 0 (decimal(2,1))) as S3Q3Y, uct.zrv3b:8 as ZRV3B, CASE  WHEN NOT\n" +
			"             │               │               │   └─ Eq\n" +
			"             │               │               │       ├─ uct.fhcyt:11\n" +
			"             │               │               │       └─ N/A (longtext)\n" +
			"             │               │               │   THEN uct.fhcyt:11 ELSE NULL (null) END as FHCYT, uct.zh72s:2 as K3B6V, uct.ljlum:5 as BTXC5, i7hcr.fvucx:17!null as H4DMT]\n" +
			"             │               │               └─ LeftOuterMergeJoin\n" +
			"             │               │                   ├─ cmp: Eq\n" +
			"             │               │                   │   ├─ uct.ftqlq:1\n" +
			"             │               │                   │   └─ i7hcr.tofpn:14!null\n" +
			"             │               │                   ├─ sel: AND\n" +
			"             │               │                   │   ├─ AND\n" +
			"             │               │                   │   │   ├─ Eq\n" +
			"             │               │                   │   │   │   ├─ i7hcr.swcqv:18!null\n" +
			"             │               │                   │   │   │   └─ 0 (tinyint)\n" +
			"             │               │                   │   │   └─ Eq\n" +
			"             │               │                   │   │       ├─ i7hcr.sjyn2:15!null\n" +
			"             │               │                   │   │       └─ uct.zh72s:2\n" +
			"             │               │                   │   └─ Eq\n" +
			"             │               │                   │       ├─ i7hcr.btxc5:16!null\n" +
			"             │               │                   │       └─ uct.ljlum:5\n" +
			"             │               │                   ├─ Filter\n" +
			"             │               │                   │   ├─ HashIn\n" +
			"             │               │                   │   │   ├─ uct.id:0!null\n" +
			"             │               │                   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               │                   │   └─ TableAlias(uct)\n" +
			"             │               │                   │       └─ IndexedTableAccess(OUBDL)\n" +
			"             │               │                   │           ├─ index: [OUBDL.FTQLQ]\n" +
			"             │               │                   │           ├─ static: [{[NULL, ∞)}]\n" +
			"             │               │                   │           └─ columns: [id ftqlq zh72s sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e ykssu fhcyt qz6vt]\n" +
			"             │               │                   └─ TableAlias(i7hcr)\n" +
			"             │               │                       └─ IndexedTableAccess(EPZU6)\n" +
			"             │               │                           ├─ index: [EPZU6.TOFPN]\n" +
			"             │               │                           ├─ static: [{[NULL, ∞)}]\n" +
			"             │               │                           └─ columns: [id tofpn sjyn2 btxc5 fvucx swcqv ykssu fhcyt]\n" +
			"             │               └─ TableAlias(nd)\n" +
			"             │                   └─ Concat\n" +
			"             │                       ├─ IndexedTableAccess(E2I7U)\n" +
			"             │                       │   ├─ index: [E2I7U.ZH72S]\n" +
			"             │                       │   └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                       └─ IndexedTableAccess(E2I7U)\n" +
			"             │                           ├─ index: [E2I7U.TW55N]\n" +
			"             │                           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(InSubquery\n" +
			"                 │       ├─ left: new.v5dpx:8!null\n" +
			"                 │       └─ right: Subquery\n" +
			"                 │           ├─ cacheable: false\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [tpxhz.svaz4:13!null]\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: TPXHZ\n" +
			"                 │                   └─ columns: [id svaz4]\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.zrv3b:10!null\n" +
			"                             └─ right: TUPLE(= (longtext), <= (longtext), >= (longtext), < (longtext), > (longtext))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ZRV3B must be on of the following: '=', '<=', '>=', '<', '>'., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO
    SFEGG(id, NO52D, VYO5E, DKCAJ, ADURZ, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    rs.NO52D AS NO52D,
    rs.VYO5E AS VYO5E,
    rs.DKCAJ AS DKCAJ,
    CASE
        WHEN rs.NO52D = 'FZB3D' AND rs.F35MI = 'SUZTA' THEN 1
        WHEN rs.NO52D = 'FZB3D' AND rs.F35MI <> 'SUZTA' THEN 3
        WHEN rs.NO52D LIKE 'AC%' OR rs.NO52D LIKE 'EC%' THEN 3
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E IS NULL THEN 2
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E = 'CF' THEN 1
        WHEN rs.NO52D LIKE 'IC%' AND rs.VYO5E IS NOT NULL AND NOT(rs.VYO5E = 'CF') THEN 4
        WHEN rs.NO52D = 'Ki' THEN 1
        WHEN rs.NO52D = 'Kd' THEN 2
        ELSE NULL
    END AS ADURZ,
    NULL AS FHCYT
FROM
    (
    SELECT DISTINCT
        TVTJS.NO52D AS NO52D,
        TVTJS.VYO5E AS VYO5E,
        nt.id AS DKCAJ,
        nt.DZLIM AS F35MI
    FROM
        HU5A5 TVTJS
    INNER JOIN
        E2I7U nd ON nd.TW55N = TVTJS.I3VTA
    INNER JOIN
        F35MI nt ON nt.id = nd.DKCAJ
    WHERE
        TVTJS.id IN ('1','2','3')
    ) rs
WHERE
        (
            rs.VYO5E IS NOT NULL
        AND
            (rs.NO52D, rs.VYO5E, rs.DKCAJ) NOT IN (SELECT DISTINCT NO52D, VYO5E, DKCAJ FROM SFEGG WHERE VYO5E IS NOT NULL)
        )
    OR
        (
            rs.VYO5E IS NULL
        AND
            (rs.NO52D, rs.DKCAJ) NOT IN (SELECT DISTINCT NO52D, DKCAJ FROM SFEGG WHERE VYO5E IS NULL)
        )`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, NO52D, VYO5E, DKCAJ, ADURZ, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: SFEGG\n" +
			"         │       └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER SFEGG_on_insert BEFORE INSERT ON SFEGG\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.NO52D IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"                OR NEW.VYO5E IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.ADURZ <= 0\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'ADURZ must be positive.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'ADURZ must be positive.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, NO52D:1!null, VYO5E:2, DKCAJ:3!null, ADURZ:4!null, FHCYT:5]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:4!null, NO52D:5!null, VYO5E:6, DKCAJ:7!null, ADURZ:8, FHCYT:9]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [rs.NO52D:0!null, rs.VYO5E:1, rs.DKCAJ:2!null, rs.F35MI:3!null, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, rs.NO52D:0!null as NO52D, rs.VYO5E:1 as VYO5E, rs.DKCAJ:2!null as DKCAJ, CASE  WHEN AND\n" +
			"             │           │   ├─ Eq\n" +
			"             │           │   │   ├─ rs.NO52D:0!null\n" +
			"             │           │   │   └─ FZB3D (longtext)\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ rs.F35MI:3!null\n" +
			"             │           │       └─ SUZTA (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN AND\n" +
			"             │           │   ├─ Eq\n" +
			"             │           │   │   ├─ rs.NO52D:0!null\n" +
			"             │           │   │   └─ FZB3D (longtext)\n" +
			"             │           │   └─ NOT\n" +
			"             │           │       └─ Eq\n" +
			"             │           │           ├─ rs.F35MI:3!null\n" +
			"             │           │           └─ SUZTA (longtext)\n" +
			"             │           │   THEN 3 (tinyint) WHEN Or\n" +
			"             │           │   ├─ rs.NO52D LIKE 'AC%'\n" +
			"             │           │   └─ rs.NO52D LIKE 'EC%'\n" +
			"             │           │   THEN 3 (tinyint) WHEN AND\n" +
			"             │           │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   └─ rs.VYO5E:1 IS NULL\n" +
			"             │           │   THEN 2 (tinyint) WHEN AND\n" +
			"             │           │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   └─ Eq\n" +
			"             │           │       ├─ rs.VYO5E:1\n" +
			"             │           │       └─ CF (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN AND\n" +
			"             │           │   ├─ AND\n" +
			"             │           │   │   ├─ rs.NO52D LIKE 'IC%'\n" +
			"             │           │   │   └─ NOT\n" +
			"             │           │   │       └─ rs.VYO5E:1 IS NULL\n" +
			"             │           │   └─ NOT\n" +
			"             │           │       └─ Eq\n" +
			"             │           │           ├─ rs.VYO5E:1\n" +
			"             │           │           └─ CF (longtext)\n" +
			"             │           │   THEN 4 (tinyint) WHEN Eq\n" +
			"             │           │   ├─ rs.NO52D:0!null\n" +
			"             │           │   └─ Ki (longtext)\n" +
			"             │           │   THEN 1 (tinyint) WHEN Eq\n" +
			"             │           │   ├─ rs.NO52D:0!null\n" +
			"             │           │   └─ Kd (longtext)\n" +
			"             │           │   THEN 2 (tinyint) ELSE NULL (null) END as ADURZ, NULL (null) as FHCYT]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ Or\n" +
			"             │               │   ├─ AND\n" +
			"             │               │   │   ├─ NOT\n" +
			"             │               │   │   │   └─ rs.VYO5E:1 IS NULL\n" +
			"             │               │   │   └─ NOT\n" +
			"             │               │   │       └─ InSubquery\n" +
			"             │               │   │           ├─ left: TUPLE(rs.NO52D:0!null, rs.VYO5E:1, rs.DKCAJ:2!null)\n" +
			"             │               │   │           └─ right: Subquery\n" +
			"             │               │   │               ├─ cacheable: true\n" +
			"             │               │   │               └─ Distinct\n" +
			"             │               │   │                   └─ Project\n" +
			"             │               │   │                       ├─ columns: [sfegg.no52d:5!null, sfegg.vyo5e:6, sfegg.dkcaj:7!null]\n" +
			"             │               │   │                       └─ Filter\n" +
			"             │               │   │                           ├─ NOT\n" +
			"             │               │   │                           │   └─ sfegg.vyo5e:6 IS NULL\n" +
			"             │               │   │                           └─ Table\n" +
			"             │               │   │                               ├─ name: SFEGG\n" +
			"             │               │   │                               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │               │   └─ AND\n" +
			"             │               │       ├─ rs.VYO5E:1 IS NULL\n" +
			"             │               │       └─ NOT\n" +
			"             │               │           └─ InSubquery\n" +
			"             │               │               ├─ left: TUPLE(rs.NO52D:0!null, rs.DKCAJ:2!null)\n" +
			"             │               │               └─ right: Subquery\n" +
			"             │               │                   ├─ cacheable: true\n" +
			"             │               │                   └─ Distinct\n" +
			"             │               │                       └─ Project\n" +
			"             │               │                           ├─ columns: [sfegg.no52d:5!null, sfegg.dkcaj:7!null]\n" +
			"             │               │                           └─ Filter\n" +
			"             │               │                               ├─ sfegg.vyo5e:6 IS NULL\n" +
			"             │               │                               └─ Table\n" +
			"             │               │                                   ├─ name: SFEGG\n" +
			"             │               │                                   └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │               └─ SubqueryAlias\n" +
			"             │                   ├─ name: rs\n" +
			"             │                   ├─ outerVisibility: false\n" +
			"             │                   ├─ cacheable: true\n" +
			"             │                   └─ Distinct\n" +
			"             │                       └─ Project\n" +
			"             │                           ├─ columns: [NO52D:33!null, VYO5E:34, DKCAJ:35!null, F35MI:36!null]\n" +
			"             │                           └─ Project\n" +
			"             │                               ├─ columns: [tvtjs.id:0!null, tvtjs.tofpn:1!null, tvtjs.i3vta:2!null, tvtjs.sfj6l:3, tvtjs.v5dpx:4!null, tvtjs.ljlum:5!null, tvtjs.idpk7:6!null, tvtjs.no52d:7!null, tvtjs.zrv3b:8!null, tvtjs.vyo5e:9, tvtjs.swcqv:10!null, tvtjs.ykssu:11, tvtjs.fhcyt:12, nd.id:13!null, nd.dkcaj:14!null, nd.kng7t:15, nd.tw55n:16!null, nd.qrqxw:17!null, nd.ecxaj:18!null, nd.fgg57:19, nd.zh72s:20, nd.fsk67:21!null, nd.xqdyt:22!null, nd.tce7a:23, nd.iwv2h:24, nd.hpcms:25!null, nd.n5cc2:26, nd.fhcyt:27, nd.etaq7:28, nd.a75x7:29, nt.id:30!null, nt.dzlim:31!null, nt.f3yue:32, tvtjs.no52d:7!null as NO52D, tvtjs.vyo5e:9 as VYO5E, nt.id:30!null as DKCAJ, nt.dzlim:31!null as F35MI]\n" +
			"             │                               └─ HashJoin\n" +
			"             │                                   ├─ Eq\n" +
			"             │                                   │   ├─ nt.id:30!null\n" +
			"             │                                   │   └─ nd.dkcaj:14!null\n" +
			"             │                                   ├─ LookupJoin\n" +
			"             │                                   │   ├─ Eq\n" +
			"             │                                   │   │   ├─ nd.tw55n:16!null\n" +
			"             │                                   │   │   └─ tvtjs.i3vta:2!null\n" +
			"             │                                   │   ├─ Filter\n" +
			"             │                                   │   │   ├─ HashIn\n" +
			"             │                                   │   │   │   ├─ tvtjs.id:0!null\n" +
			"             │                                   │   │   │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │                                   │   │   └─ TableAlias(tvtjs)\n" +
			"             │                                   │   │       └─ IndexedTableAccess(HU5A5)\n" +
			"             │                                   │   │           ├─ index: [HU5A5.id]\n" +
			"             │                                   │   │           ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                                   │   │           └─ columns: [id tofpn i3vta sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e swcqv ykssu fhcyt]\n" +
			"             │                                   │   └─ TableAlias(nd)\n" +
			"             │                                   │       └─ IndexedTableAccess(E2I7U)\n" +
			"             │                                   │           ├─ index: [E2I7U.TW55N]\n" +
			"             │                                   │           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │                                   └─ HashLookup\n" +
			"             │                                       ├─ left-key: TUPLE(nd.dkcaj:14!null)\n" +
			"             │                                       ├─ right-key: TUPLE(nt.id:0!null)\n" +
			"             │                                       └─ TableAlias(nt)\n" +
			"             │                                           └─ Table\n" +
			"             │                                               ├─ name: F35MI\n" +
			"             │                                               └─ columns: [id dzlim f3yue]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(Or\n" +
			"                 │       ├─ InSubquery\n" +
			"                 │       │   ├─ left: new.no52d:1!null\n" +
			"                 │       │   └─ right: Subquery\n" +
			"                 │       │       ├─ cacheable: false\n" +
			"                 │       │       └─ Project\n" +
			"                 │       │           ├─ columns: [tpxhz.svaz4:7!null]\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: TPXHZ\n" +
			"                 │       │               └─ columns: [id svaz4]\n" +
			"                 │       └─ InSubquery\n" +
			"                 │           ├─ left: new.vyo5e:2\n" +
			"                 │           └─ right: Subquery\n" +
			"                 │               ├─ cacheable: false\n" +
			"                 │               └─ Project\n" +
			"                 │                   ├─ columns: [tpxhz.svaz4:7!null]\n" +
			"                 │                   └─ Table\n" +
			"                 │                       ├─ name: TPXHZ\n" +
			"                 │                       └─ columns: [id svaz4]\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(LessThanOrEqual\n" +
			"                         ├─ new.adurz:4!null\n" +
			"                         └─ 0 (tinyint)\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = ADURZ must be positive., MYSQL_ERRNO = 1644\n" +
			"",
	},
	{
		Query: `
INSERT INTO FLQLP
    (id, FZ2R5, LUEVY, M22QN, OVE3E, NRURT, OCA7E, XMM6Q, V5DPX, S3Q3Y, ZRV3B, FHCYT)
SELECT
    LPAD(LOWER(CONCAT(CONCAT(HEX(RAND()*4294967296),LOWER(HEX(RAND()*4294967296)),LOWER(HEX(RAND()*4294967296))))), 24, '0') AS id,
    (SELECT id FROM JDLNA WHERE JDLNA.FTQLQ = TVTJS.TOFPN) AS FZ2R5,
    (SELECT id FROM E2I7U WHERE TW55N = TVTJS.I3VTA) AS LUEVY,
    (SELECT id FROM TPXBU WHERE BTXC5 = TVTJS.LJLUM) AS M22QN,
    (SELECT id FROM SFEGG WHERE
        SFEGG.NO52D = TVTJS.NO52D AND
        (
            SFEGG.VYO5E = TVTJS.VYO5E OR
            (SFEGG.VYO5E IS NULL AND (TVTJS.VYO5E IS NULL OR TVTJS.VYO5E = 'N/A' OR TVTJS.VYO5E = 'NA'))
        ) AND
        SFEGG.DKCAJ = (
            SELECT nd.DKCAJ FROM E2I7U nd WHERE nd.TW55N = TVTJS.I3VTA
        )
    ) AS OVE3E,
    NULL AS NRURT, -- Not coming from unprocessed
    NULL AS OCA7E, -- Can not be overridden
    TVTJS.id AS XMM6Q, -- It is an additional
    TVTJS.V5DPX AS V5DPX,
    TVTJS.IDPK7 + 0.0 AS S3Q3Y,
    TVTJS.ZRV3B AS ZRV3B,
    TVTJS.FHCYT AS FHCYT
FROM
    HU5A5 TVTJS
WHERE
    TVTJS.id IN ('1','2','3')`,
		ExpectedPlan: "TriggerRollback\n" +
			" └─ RowUpdateAccumulator\n" +
			"     └─ Insert(id, FZ2R5, LUEVY, M22QN, OVE3E, NRURT, OCA7E, XMM6Q, V5DPX, S3Q3Y, ZRV3B, FHCYT)\n" +
			"         ├─ InsertDestination\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: FLQLP\n" +
			"         │       └─ columns: [id fz2r5 luevy m22qn ove3e nrurt oca7e xmm6q v5dpx s3q3y zrv3b fhcyt]\n" +
			"         └─ Trigger(CREATE TRIGGER FLQLP_on_insert BEFORE INSERT ON FLQLP\n" +
			"            FOR EACH ROW\n" +
			"            BEGIN\n" +
			"              IF\n" +
			"                NEW.V5DPX IN (SELECT SVAZ4 FROM TPXHZ)\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = (SELECT error_message FROM trigger_helper_error_message WHERE DZLIM = 'SVAZ4');\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'String field contains invalid value, like empty string, ''none'', ''null'', ''n/a'', ''nan'' etc.';\n" +
			"              END IF;\n" +
			"              IF\n" +
			"                NEW.ZRV3B NOT IN ('=', '<=', '>=', '<', '>')\n" +
			"              THEN\n" +
			"                -- SET @custom_error_message = 'The ZRV3B must be on of the following: ''='', ''<='', ''>='', ''<'', ''>''.';\n" +
			"                -- SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = @custom_error_message;\n" +
			"                SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'The ZRV3B must be on of the following: ''='', ''<='', ''>='', ''<'', ''>''.';\n" +
			"              END IF;\n" +
			"            END//)\n" +
			"             ├─ Project\n" +
			"             │   ├─ columns: [id:0!null, FZ2R5:1!null, LUEVY:2!null, M22QN:3!null, OVE3E:4!null, NRURT:5, OCA7E:6, XMM6Q:7, V5DPX:8!null, S3Q3Y:9!null, ZRV3B:10!null, FHCYT:11]\n" +
			"             │   └─ Project\n" +
			"             │       ├─ columns: [id:13!null, FZ2R5:14, LUEVY:15, M22QN:16, OVE3E:17, NRURT:18, OCA7E:19, XMM6Q:20!null, V5DPX:21!null, S3Q3Y:22!null, ZRV3B:23!null, FHCYT:24]\n" +
			"             │       └─ Project\n" +
			"             │           ├─ columns: [tvtjs.id:0!null, tvtjs.tofpn:1!null, tvtjs.i3vta:2!null, tvtjs.sfj6l:3, tvtjs.v5dpx:4!null, tvtjs.ljlum:5!null, tvtjs.idpk7:6!null, tvtjs.no52d:7!null, tvtjs.zrv3b:8!null, tvtjs.vyo5e:9, tvtjs.swcqv:10!null, tvtjs.ykssu:11, tvtjs.fhcyt:12, lpad(lower(concat(concat(hex((rand() * 4294967296)),lower(hex((rand() * 4294967296))),lower(hex((rand() * 4294967296)))))), 24, '0') as id, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [jdlna.id:13!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ jdlna.ftqlq:14!null\n" +
			"             │           │           │   └─ tvtjs.tofpn:1!null\n" +
			"             │           │           └─ IndexedTableAccess(JDLNA)\n" +
			"             │           │               ├─ index: [JDLNA.FTQLQ]\n" +
			"             │           │               └─ columns: [id ftqlq fwwiq o3qxw fhcyt]\n" +
			"             │           │   as FZ2R5, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [e2i7u.id:13!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ e2i7u.tw55n:16!null\n" +
			"             │           │           │   └─ tvtjs.i3vta:2!null\n" +
			"             │           │           └─ IndexedTableAccess(E2I7U)\n" +
			"             │           │               ├─ index: [E2I7U.TW55N]\n" +
			"             │           │               └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │           │   as LUEVY, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [tpxbu.id:13!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ Eq\n" +
			"             │           │           │   ├─ tpxbu.btxc5:14\n" +
			"             │           │           │   └─ tvtjs.ljlum:5!null\n" +
			"             │           │           └─ IndexedTableAccess(TPXBU)\n" +
			"             │           │               ├─ index: [TPXBU.BTXC5]\n" +
			"             │           │               └─ columns: [id btxc5 fhcyt]\n" +
			"             │           │   as M22QN, Subquery\n" +
			"             │           │   ├─ cacheable: false\n" +
			"             │           │   └─ Project\n" +
			"             │           │       ├─ columns: [sfegg.id:13!null]\n" +
			"             │           │       └─ Filter\n" +
			"             │           │           ├─ AND\n" +
			"             │           │           │   ├─ AND\n" +
			"             │           │           │   │   ├─ Eq\n" +
			"             │           │           │   │   │   ├─ sfegg.no52d:14!null\n" +
			"             │           │           │   │   │   └─ tvtjs.no52d:7!null\n" +
			"             │           │           │   │   └─ Or\n" +
			"             │           │           │   │       ├─ Eq\n" +
			"             │           │           │   │       │   ├─ sfegg.vyo5e:15\n" +
			"             │           │           │   │       │   └─ tvtjs.vyo5e:9\n" +
			"             │           │           │   │       └─ AND\n" +
			"             │           │           │   │           ├─ sfegg.vyo5e:15 IS NULL\n" +
			"             │           │           │   │           └─ Or\n" +
			"             │           │           │   │               ├─ Or\n" +
			"             │           │           │   │               │   ├─ tvtjs.vyo5e:9 IS NULL\n" +
			"             │           │           │   │               │   └─ Eq\n" +
			"             │           │           │   │               │       ├─ tvtjs.vyo5e:9\n" +
			"             │           │           │   │               │       └─ N/A (longtext)\n" +
			"             │           │           │   │               └─ Eq\n" +
			"             │           │           │   │                   ├─ tvtjs.vyo5e:9\n" +
			"             │           │           │   │                   └─ NA (longtext)\n" +
			"             │           │           │   └─ Eq\n" +
			"             │           │           │       ├─ sfegg.dkcaj:16!null\n" +
			"             │           │           │       └─ Subquery\n" +
			"             │           │           │           ├─ cacheable: false\n" +
			"             │           │           │           └─ Project\n" +
			"             │           │           │               ├─ columns: [nd.dkcaj:20!null]\n" +
			"             │           │           │               └─ Filter\n" +
			"             │           │           │                   ├─ Eq\n" +
			"             │           │           │                   │   ├─ nd.tw55n:22!null\n" +
			"             │           │           │                   │   └─ tvtjs.i3vta:2!null\n" +
			"             │           │           │                   └─ TableAlias(nd)\n" +
			"             │           │           │                       └─ IndexedTableAccess(E2I7U)\n" +
			"             │           │           │                           ├─ index: [E2I7U.TW55N]\n" +
			"             │           │           │                           └─ columns: [id dkcaj kng7t tw55n qrqxw ecxaj fgg57 zh72s fsk67 xqdyt tce7a iwv2h hpcms n5cc2 fhcyt etaq7 a75x7]\n" +
			"             │           │           └─ IndexedTableAccess(SFEGG)\n" +
			"             │           │               ├─ index: [SFEGG.NO52D,SFEGG.VYO5E,SFEGG.DKCAJ]\n" +
			"             │           │               └─ columns: [id no52d vyo5e dkcaj adurz fhcyt]\n" +
			"             │           │   as OVE3E, NULL (null) as NRURT, NULL (null) as OCA7E, tvtjs.id:0!null as XMM6Q, tvtjs.v5dpx:4!null as V5DPX, (tvtjs.idpk7:6!null + 0 (decimal(2,1))) as S3Q3Y, tvtjs.zrv3b:8!null as ZRV3B, tvtjs.fhcyt:12 as FHCYT]\n" +
			"             │           └─ Filter\n" +
			"             │               ├─ HashIn\n" +
			"             │               │   ├─ tvtjs.id:0!null\n" +
			"             │               │   └─ TUPLE(1 (longtext), 2 (longtext), 3 (longtext))\n" +
			"             │               └─ TableAlias(tvtjs)\n" +
			"             │                   └─ IndexedTableAccess(HU5A5)\n" +
			"             │                       ├─ index: [HU5A5.id]\n" +
			"             │                       ├─ static: [{[1, 1]}, {[2, 2]}, {[3, 3]}]\n" +
			"             │                       └─ columns: [id tofpn i3vta sfj6l v5dpx ljlum idpk7 no52d zrv3b vyo5e swcqv ykssu fhcyt]\n" +
			"             └─ BEGIN .. END\n" +
			"                 ├─ IF BLOCK\n" +
			"                 │   └─ IF(InSubquery\n" +
			"                 │       ├─ left: new.v5dpx:8!null\n" +
			"                 │       └─ right: Subquery\n" +
			"                 │           ├─ cacheable: false\n" +
			"                 │           └─ Project\n" +
			"                 │               ├─ columns: [tpxhz.svaz4:13!null]\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: TPXHZ\n" +
			"                 │                   └─ columns: [id svaz4]\n" +
			"                 │      )\n" +
			"                 │       └─ BLOCK\n" +
			"                 │           └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = String field contains invalid value, like empty string, 'none', 'null', 'n/a', 'nan' etc., MYSQL_ERRNO = 1644\n" +
			"                 └─ IF BLOCK\n" +
			"                     └─ IF(NOT\n" +
			"                         └─ IN\n" +
			"                             ├─ left: new.zrv3b:10!null\n" +
			"                             └─ right: TUPLE(= (longtext), <= (longtext), >= (longtext), < (longtext), > (longtext))\n" +
			"                        )\n" +
			"                         └─ BLOCK\n" +
			"                             └─ SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = The ZRV3B must be on of the following: '=', '<=', '>=', '<', '>'., MYSQL_ERRNO = 1644\n" +
			"",
	},
}
