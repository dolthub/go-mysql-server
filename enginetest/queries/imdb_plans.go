// Code generated by plangen.

// Copyright 2024 Dolthub, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package queries

var ImdbPlanTests = []QueryPlanTest{
	{
		Query: `
SELECT MIN(chn.name) AS uncredited_voiced_character,
       MIN(t.title) AS russian_movie
FROM char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     company_type AS ct,
     movie_companies AS mc,
     role_type AS rt,
     title AS t
WHERE ci.note LIKE '%(voice)%'
  AND ci.note LIKE '%(uncredited)%'
  AND cn.country_code = '[ru]'
  AND rt.role = 'actor'
  AND t.production_year > 2005
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mc.movie_id
  AND chn.id = ci.person_role_id
  AND rt.id = ci.role_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as uncredited_voiced_character, min(t.title):1!null as russian_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:16!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:11!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:8!null\n" +
			"         │       │   └─ mc.company_type_id:5!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:6!null\n" +
			"         │       │   │   └─ mc.company_id:4!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [ru] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:9!null\n" +
			"             │   └─ ci.role_id:14!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actor (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:15!null\n" +
			"                 │   └─ ci.person_role_id:12\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ ci.note LIKE '%(voice)%'\n" +
			"                 │   │   └─ ci.note LIKE '%(uncredited)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: cast_info\n" +
			"                 │               └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as uncredited_voiced_character, min(t.title) as russian_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[ru]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actor')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (ci.note LIKE '%(voice)%' AND ci.note LIKE '%(uncredited)%')\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as uncredited_voiced_character, min(t.title) as russian_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[ru]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actor')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (ci.note LIKE '%(voice)%' AND ci.note LIKE '%(uncredited)%')\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
	},
	{
		Query: "SELECT MIN(chn.name) AS `character`,\n" +
			"       MIN(t.title) AS russian_mov_with_actor_producer\n" +
			"FROM char_name AS chn,\n" +
			"     cast_info AS ci,\n" +
			"     company_name AS cn,\n" +
			"     company_type AS ct,\n" +
			"     movie_companies AS mc,\n" +
			"     role_type AS rt,\n" +
			"     title AS t\n" +
			"WHERE ci.note LIKE '%(producer)%'\n" +
			"  AND cn.country_code = '[ru]'\n" +
			"  AND rt.role = 'actor'\n" +
			"  AND t.production_year > 2010\n" +
			"  AND t.id = mc.movie_id\n" +
			"  AND t.id = ci.movie_id\n" +
			"  AND ci.movie_id = mc.movie_id\n" +
			"  AND chn.id = ci.person_role_id\n" +
			"  AND rt.id = ci.role_id\n" +
			"  AND cn.id = mc.company_id\n" +
			"  AND ct.id = mc.company_type_id;\n" +
			"",

		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as character, min(t.title):1!null as russian_mov_with_actor_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:16!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:11!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:8!null\n" +
			"         │       │   └─ mc.company_type_id:5!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:6!null\n" +
			"         │       │   │   └─ mc.company_id:4!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [ru] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:9!null\n" +
			"             │   └─ ci.role_id:14!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actor (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:15!null\n" +
			"                 │   └─ ci.person_role_id:12\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: cast_info\n" +
			"                 │               └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as character, min(t.title) as russian_mov_with_actor_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[ru]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actor')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as character, min(t.title) as russian_mov_with_actor_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[ru]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actor')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
	},
	{
		Query: "SELECT MIN(chn.name) AS `character`,\n" +
			"       MIN(t.title) AS movie_with_american_producer\n" +
			"FROM char_name AS chn,\n" +
			"     cast_info AS ci,\n" +
			"     company_name AS cn,\n" +
			"     company_type AS ct,\n" +
			"     movie_companies AS mc,\n" +
			"     role_type AS rt,\n" +
			"     title AS t\n" +
			"WHERE ci.note LIKE '%(producer)%'\n" +
			"  AND cn.country_code = '[us]'\n" +
			"  AND t.production_year > 1990\n" +
			"  AND t.id = mc.movie_id\n" +
			"  AND t.id = ci.movie_id\n" +
			"  AND ci.movie_id = mc.movie_id\n" +
			"  AND chn.id = ci.person_role_id\n" +
			"  AND rt.id = ci.role_id\n" +
			"  AND cn.id = mc.company_id\n" +
			"  AND ct.id = mc.company_type_id;\n" +
			"",

		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as character, min(t.title):1!null as movie_with_american_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1990 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:8!null\n" +
			"         │       │   └─ mc.company_type_id:5!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:6!null\n" +
			"         │       │   │   └─ mc.company_id:4!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [us] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:9!null\n" +
			"             │   └─ ci.role_id:13!null\n" +
			"             ├─ TableAlias(rt)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:14!null\n" +
			"                 │   └─ ci.person_role_id:11\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: cast_info\n" +
			"                 │               └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as character, min(t.title) as movie_with_american_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ TableAlias(rt)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: role_type\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as character, min(t.title) as movie_with_american_producer]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mc.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ TableAlias(rt)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: role_type\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ci.note LIKE '%(producer)%'\n" +
			"                 │   └─ TableAlias(ci)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [movie_id person_role_id note role_id]\n" +
			"                 └─ TableAlias(chn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: char_name\n" +
			"                         └─ columns: [id name]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS from_company,
       MIN(lt.link) AS movie_link_type,
       MIN(t.title) AS non_polish_sequel_movie
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND t.production_year BETWEEN 1950 AND 2000
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as from_company, min(lt.link):1!null as movie_link_type, min(t.title):2!null as non_polish_sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(lt.link:5!null), MIN(t.title:18!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   │   └─ t.id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:17!null\n" +
			"         │   │       └─ mk.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:17!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.keyword_id:16!null\n" +
			"         │   │   └─ k.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   └─ sequel (longtext)\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: keyword\n" +
			"         │   │               └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:14!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ml.movie_id:2!null\n" +
			"         │           │   └─ mk.movie_id:15!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ ml.movie_id:2!null\n" +
			"         │           │   │   └─ mc.movie_id:6!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ lt.id:4!null\n" +
			"         │           │   │   │   └─ ml.link_type_id:3!null\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ ProcessTable\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_link\n" +
			"         │           │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follow%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ ProcessTable\n" +
			"         │           │   │               └─ Table\n" +
			"         │           │   │                   ├─ name: link_type\n" +
			"         │           │   │                   └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ mc.company_type_id:8!null\n" +
			"         │           │       │   └─ ct.id:13!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ mc.company_id:7!null\n" +
			"         │           │       │   │   └─ cn.id:10!null\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note:3 IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ ProcessTable\n" +
			"         │           │       │   │           └─ Table\n" +
			"         │           │       │   │               ├─ name: movie_companies\n" +
			"         │           │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ AND\n" +
			"         │           │       │       │   ├─ NOT\n" +
			"         │           │       │       │   │   └─ Eq\n" +
			"         │           │       │       │   │       ├─ cn.country_code:2\n" +
			"         │           │       │       │   │       └─ [pl] (longtext)\n" +
			"         │           │       │       │   └─ Or\n" +
			"         │           │       │       │       ├─ cn.name LIKE '%Film%'\n" +
			"         │           │       │       │       └─ cn.name LIKE '%Warner%'\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ Eq\n" +
			"         │           │           │   ├─ ct.kind:1!null\n" +
			"         │           │           │   └─ production companies (longtext)\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ keys: [mc.movie_id:6!null]\n" +
			"         │                   ├─ colSet: (20-22)\n" +
			"         │                   ├─ tableId: 6\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: movie_keyword\n" +
			"         │                       └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:2!null, mk.movie_id:15!null, mc.movie_id:6!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 1950 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2000 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(lt.link) as movie_link_type, min(t.title) as non_polish_sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword = 'sequel')\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follow%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(lt.link) as movie_link_type, min(t.title) as non_polish_sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword = 'sequel')\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follow%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS from_company,
       MIN(lt.link) AS movie_link_type,
       MIN(t.title) AS sequel_movie
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follows%'
  AND mc.note IS NULL
  AND t.production_year = 1998
  AND t.title LIKE '%Money%'
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as from_company, min(lt.link):1!null as movie_link_type, min(t.title):2!null as sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(lt.link:5!null), MIN(t.title:18!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   │   └─ t.id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:17!null\n" +
			"         │   │       └─ mk.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:17!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.keyword_id:16!null\n" +
			"         │   │   └─ k.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   └─ sequel (longtext)\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: keyword\n" +
			"         │   │               └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:14!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ml.movie_id:2!null\n" +
			"         │           │   └─ mk.movie_id:15!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ ml.movie_id:2!null\n" +
			"         │           │   │   └─ mc.movie_id:6!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ lt.id:4!null\n" +
			"         │           │   │   │   └─ ml.link_type_id:3!null\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ ProcessTable\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_link\n" +
			"         │           │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follows%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ ProcessTable\n" +
			"         │           │   │               └─ Table\n" +
			"         │           │   │                   ├─ name: link_type\n" +
			"         │           │   │                   └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ mc.company_type_id:8!null\n" +
			"         │           │       │   └─ ct.id:13!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ mc.company_id:7!null\n" +
			"         │           │       │   │   └─ cn.id:10!null\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note:3 IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ ProcessTable\n" +
			"         │           │       │   │           └─ Table\n" +
			"         │           │       │   │               ├─ name: movie_companies\n" +
			"         │           │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ AND\n" +
			"         │           │       │       │   ├─ NOT\n" +
			"         │           │       │       │   │   └─ Eq\n" +
			"         │           │       │       │   │       ├─ cn.country_code:2\n" +
			"         │           │       │       │   │       └─ [pl] (longtext)\n" +
			"         │           │       │       │   └─ Or\n" +
			"         │           │       │       │       ├─ cn.name LIKE '%Film%'\n" +
			"         │           │       │       │       └─ cn.name LIKE '%Warner%'\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ Eq\n" +
			"         │           │           │   ├─ ct.kind:1!null\n" +
			"         │           │           │   └─ production companies (longtext)\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ keys: [mc.movie_id:6!null]\n" +
			"         │                   ├─ colSet: (20-22)\n" +
			"         │                   ├─ tableId: 6\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: movie_keyword\n" +
			"         │                       └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:2!null, mk.movie_id:15!null, mc.movie_id:6!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 1998 (smallint)\n" +
			"                 │   └─ t.title LIKE '%Money%'\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(lt.link) as movie_link_type, min(t.title) as sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword = 'sequel')\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follows%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year = 1998) AND t.title LIKE '%Money%')\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(lt.link) as movie_link_type, min(t.title) as sequel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword = 'sequel')\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ lt.link LIKE '%follows%'\n" +
			"         │           │   │       └─ TableAlias(lt)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id link]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ mc.note IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year = 1998) AND t.title LIKE '%Money%')\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS from_company,
       MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_based_on_book
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '20th Century Fox%'
       OR cn.name LIKE 'Twentieth Century Fox%')
  AND ct.kind != 'production companies'
  AND ct.kind IS NOT NULL
  AND k.keyword IN ('sequel',
                    'revenge',
                    'based-on-novel')
  AND mc.note IS NOT NULL
  AND t.production_year > 1950
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as from_company, min(mc.note):1!null as production_note, min(t.title):2!null as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:10!null), MIN(mc.note:8), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   │   └─ t.id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.keyword_id:15!null\n" +
			"         │   │   └─ k.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ HashIn\n" +
			"         │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   └─ TUPLE(sequel (longtext), revenge (longtext), based-on-novel (longtext))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: keyword\n" +
			"         │   │               └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:13!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ml.movie_id:2!null\n" +
			"         │           │   └─ mk.movie_id:14!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ ml.movie_id:2!null\n" +
			"         │           │   │   └─ mc.movie_id:5!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ lt.id:4!null\n" +
			"         │           │   │   │   └─ ml.link_type_id:3!null\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ ProcessTable\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_link\n" +
			"         │           │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ ProcessTable\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ mc.company_type_id:7!null\n" +
			"         │           │       │   └─ ct.id:12!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ mc.company_id:6!null\n" +
			"         │           │       │   │   └─ cn.id:9!null\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ NOT\n" +
			"         │           │       │   │   │   └─ mc.note:3 IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ ProcessTable\n" +
			"         │           │       │   │           └─ Table\n" +
			"         │           │       │   │               ├─ name: movie_companies\n" +
			"         │           │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ AND\n" +
			"         │           │       │       │   ├─ NOT\n" +
			"         │           │       │       │   │   └─ Eq\n" +
			"         │           │       │       │   │       ├─ cn.country_code:2\n" +
			"         │           │       │       │   │       └─ [pl] (longtext)\n" +
			"         │           │       │       │   └─ Or\n" +
			"         │           │       │       │       ├─ AND\n" +
			"         │           │       │       │       │   ├─ GreaterThanOrEqual\n" +
			"         │           │       │       │       │   │   ├─ cn.name:1!null\n" +
			"         │           │       │       │       │   │   └─ 20th Century Fox (longtext)\n" +
			"         │           │       │       │       │   └─ LessThanOrEqual\n" +
			"         │           │       │       │       │       ├─ cn.name:1!null\n" +
			"         │           │       │       │       │       └─ 20th Century Foxÿ (longtext)\n" +
			"         │           │       │       │       └─ AND\n" +
			"         │           │       │       │           ├─ GreaterThanOrEqual\n" +
			"         │           │       │       │           │   ├─ cn.name:1!null\n" +
			"         │           │       │       │           │   └─ Twentieth Century Fox (longtext)\n" +
			"         │           │       │       │           └─ LessThanOrEqual\n" +
			"         │           │       │       │               ├─ cn.name:1!null\n" +
			"         │           │       │       │               └─ Twentieth Century Foxÿ (longtext)\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ AND\n" +
			"         │           │           │   ├─ NOT\n" +
			"         │           │           │   │   └─ Eq\n" +
			"         │           │           │   │       ├─ ct.kind:1!null\n" +
			"         │           │           │   │       └─ production companies (longtext)\n" +
			"         │           │           │   └─ NOT\n" +
			"         │           │           │       └─ ct.kind:1!null IS NULL\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ keys: [mc.movie_id:5!null]\n" +
			"         │                   ├─ colSet: (20-22)\n" +
			"         │                   ├─ tableId: 6\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: movie_keyword\n" +
			"         │                       └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:2!null, mk.movie_id:14!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThan\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 1950 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(mc.note) as production_note, min(t.title) as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mc.note), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword HASH IN ('sequel', 'revenge', 'based-on-novel'))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ Table\n" +
			"         │           │   │           ├─ name: link_type\n" +
			"         │           │   │           └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ (NOT(mc.note IS NULL))\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (((cn.name >= '20th Century Fox') AND (cn.name <= '20th Century Foxÿ')) OR ((cn.name >= 'Twentieth Century Fox') AND (cn.name <= 'Twentieth Century Foxÿ'))))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT((ct.kind = 'production companies'))) AND (NOT(ct.kind IS NULL)))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1950)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(mc.note) as production_note, min(t.title) as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mc.note), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword HASH IN ('sequel', 'revenge', 'based-on-novel'))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ Table\n" +
			"         │           │   │           ├─ name: link_type\n" +
			"         │           │   │           └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ (NOT(mc.note IS NULL))\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (((cn.name >= '20th Century Fox') AND (cn.name <= '20th Century Foxÿ')) OR ((cn.name >= 'Twentieth Century Fox') AND (cn.name <= 'Twentieth Century Foxÿ'))))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT((ct.kind = 'production companies'))) AND (NOT(ct.kind IS NULL)))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1950)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS from_company,
       MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_based_on_book
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND ct.kind != 'production companies'
  AND ct.kind IS NOT NULL
  AND k.keyword IN ('sequel',
                    'revenge',
                    'based-on-novel')
  AND mc.note IS NOT NULL
  AND t.production_year > 1950
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as from_company, min(mc.note):1!null as production_note, min(t.title):2!null as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:10!null), MIN(mc.note:8), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   │   └─ t.id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.keyword_id:15!null\n" +
			"         │   │   └─ k.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ HashIn\n" +
			"         │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   └─ TUPLE(sequel (longtext), revenge (longtext), based-on-novel (longtext))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: keyword\n" +
			"         │   │               └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:13!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ml.movie_id:2!null\n" +
			"         │           │   └─ mk.movie_id:14!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ ml.movie_id:2!null\n" +
			"         │           │   │   └─ mc.movie_id:5!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ lt.id:4!null\n" +
			"         │           │   │   │   └─ ml.link_type_id:3!null\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ ProcessTable\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_link\n" +
			"         │           │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ ProcessTable\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: link_type\n" +
			"         │           │   │               └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ mc.company_type_id:7!null\n" +
			"         │           │       │   └─ ct.id:12!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ mc.company_id:6!null\n" +
			"         │           │       │   │   └─ cn.id:9!null\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ NOT\n" +
			"         │           │       │   │   │   └─ mc.note:3 IS NULL\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ ProcessTable\n" +
			"         │           │       │   │           └─ Table\n" +
			"         │           │       │   │               ├─ name: movie_companies\n" +
			"         │           │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ NOT\n" +
			"         │           │       │       │   └─ Eq\n" +
			"         │           │       │       │       ├─ cn.country_code:2\n" +
			"         │           │       │       │       └─ [pl] (longtext)\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ AND\n" +
			"         │           │           │   ├─ NOT\n" +
			"         │           │           │   │   └─ Eq\n" +
			"         │           │           │   │       ├─ ct.kind:1!null\n" +
			"         │           │           │   │       └─ production companies (longtext)\n" +
			"         │           │           │   └─ NOT\n" +
			"         │           │           │       └─ ct.kind:1!null IS NULL\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ keys: [mc.movie_id:5!null]\n" +
			"         │                   ├─ colSet: (20-22)\n" +
			"         │                   ├─ tableId: 6\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: movie_keyword\n" +
			"         │                       └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:2!null, mk.movie_id:14!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThan\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 1950 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(mc.note) as production_note, min(t.title) as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mc.note), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword HASH IN ('sequel', 'revenge', 'based-on-novel'))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ Table\n" +
			"         │           │   │           ├─ name: link_type\n" +
			"         │           │   │           └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ (NOT(mc.note IS NULL))\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (NOT((cn.country_code = '[pl]')))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT((ct.kind = 'production companies'))) AND (NOT(ct.kind IS NULL)))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1950)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as from_company, min(mc.note) as production_note, min(t.title) as movie_based_on_book]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mc.note), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (k.keyword HASH IN ('sequel', 'revenge', 'based-on-novel'))\n" +
			"         │   │   └─ TableAlias(k)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id keyword]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (ml.movie_id = mc.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"         │           │   │   ├─ TableAlias(ml)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_link\n" +
			"         │           │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │           │   │   └─ TableAlias(lt)\n" +
			"         │           │   │       └─ Table\n" +
			"         │           │   │           ├─ name: link_type\n" +
			"         │           │   │           └─ columns: [id]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │           │       │   ├─ Filter\n" +
			"         │           │       │   │   ├─ (NOT(mc.note IS NULL))\n" +
			"         │           │       │   │   └─ TableAlias(mc)\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (NOT((cn.country_code = '[pl]')))\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT((ct.kind = 'production companies'))) AND (NOT(ct.kind IS NULL)))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mk)\n" +
			"         │               └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                   ├─ index: [movie_keyword.movie_id]\n" +
			"         │                   ├─ columns: [movie_id keyword_id]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1950)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS drama_horror_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     title AS t
WHERE cn.country_code = '[us]'
  AND ct.kind = 'production companies'
  AND it1.info = 'genres'
  AND it2.info = 'rating'
  AND mi.info IN ('Drama',
                  'Horror')
  AND mi_idx.info > '8.0'
  AND t.production_year BETWEEN 2005 AND 2008
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND mi.info_type_id = it1.id
  AND mi_idx.info_type_id = it2.id
  AND t.id = mc.movie_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as drama_horror_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(mi_idx.info:4!null), MIN(t.title:19!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:18!null\n" +
			"         │   │   │   └─ mi.movie_id:15!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:18!null\n" +
			"         │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:18!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mi.info_type_id:16!null\n" +
			"         │   │   └─ it1.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it1.info:1!null\n" +
			"         │   │   │   └─ genres (longtext)\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: info_type\n" +
			"         │   │               └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(it1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mi.info_type_id:14!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ mi.movie_id:15!null\n" +
			"         │           │   └─ mi_idx.movie_id:2!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ mc.movie_id:7!null\n" +
			"         │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mi_idx.info_type_id:3!null\n" +
			"         │           │   │   │   └─ it2.id:5!null\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ GreaterThan\n" +
			"         │           │   │   │   │   ├─ mi_idx.info:2!null\n" +
			"         │           │   │   │   │   └─ 8.0 (longtext)\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ ProcessTable\n" +
			"         │           │   │   │           └─ Table\n" +
			"         │           │   │   │               ├─ name: movie_info_idx\n" +
			"         │           │   │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ Eq\n" +
			"         │           │   │       │   ├─ it2.info:1!null\n" +
			"         │           │   │       │   └─ rating (longtext)\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               ├─ columns: [id info]\n" +
			"         │           │   │               ├─ colSet: (12,13)\n" +
			"         │           │   │               └─ tableId: 4\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ ct.id:13!null\n" +
			"         │           │       │   └─ mc.company_type_id:9!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ cn.id:10!null\n" +
			"         │           │       │   │   └─ mc.company_id:8!null\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ ProcessTable\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ Eq\n" +
			"         │           │       │       │   ├─ cn.country_code:2\n" +
			"         │           │       │       │   └─ [us] (longtext)\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ Eq\n" +
			"         │           │           │   ├─ ct.kind:1!null\n" +
			"         │           │           │   └─ production companies (longtext)\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ HashIn\n" +
			"         │               │   ├─ mi.info:2!null\n" +
			"         │               │   └─ TUPLE(Drama (longtext), Horror (longtext))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ keys: [mc.movie_id:7!null]\n" +
			"         │                       ├─ colSet: (19-23)\n" +
			"         │                       ├─ tableId: 6\n" +
			"         │                       └─ Table\n" +
			"         │                           ├─ name: movie_info\n" +
			"         │                           └─ columns: [movie_id info_type_id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:15!null, mi_idx.movie_id:2!null, mc.movie_id:7!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2005 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2008 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as drama_horror_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'genres')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ (mi_idx.info > '8.0')\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_info_idx\n" +
			"         │           │   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'rating')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ (mi.info HASH IN ('Drama', 'Horror'))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ columns: [movie_id info_type_id info]\n" +
			"         │                       └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2005) AND (t.production_year <= 2008))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as drama_horror_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'genres')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ (mi_idx.info > '8.0')\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_info_idx\n" +
			"         │           │   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'rating')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ (mi.info HASH IN ('Drama', 'Horror'))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ columns: [movie_id info_type_id info]\n" +
			"         │                       └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2005) AND (t.production_year <= 2008))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS budget,
       MIN(t.title) AS unsuccsessful_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     title AS t
WHERE cn.country_code ='[us]'
  AND ct.kind IS NOT NULL
  AND (ct.kind ='production companies'
       OR ct.kind = 'distributors')
  AND it1.info ='budget'
  AND it2.info ='bottom 10 rank'
  AND t.production_year >2000
  AND (t.title LIKE 'Birdemic%'
       OR t.title LIKE '%Movie%')
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND mi.info_type_id = it1.id
  AND mi_idx.info_type_id = it2.id
  AND t.id = mc.movie_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as budget, min(t.title):1!null as unsuccsessful_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:15!null), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:16!null\n" +
			"         │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mi.info_type_id:14!null\n" +
			"         │   │   └─ it1.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it1.info:1!null\n" +
			"         │   │   │   └─ budget (longtext)\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: info_type\n" +
			"         │   │               └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(it1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mi.info_type_id:12!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ mi.movie_id:13!null\n" +
			"         │           │   └─ mi_idx.movie_id:2!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ mc.movie_id:6!null\n" +
			"         │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mi_idx.info_type_id:3!null\n" +
			"         │           │   │   │   └─ it2.id:4!null\n" +
			"         │           │   │   ├─ TableAlias(mi_idx)\n" +
			"         │           │   │   │   └─ ProcessTable\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_info_idx\n" +
			"         │           │   │   │           └─ columns: [movie_id info_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ Eq\n" +
			"         │           │   │       │   ├─ it2.info:1!null\n" +
			"         │           │   │       │   └─ bottom 10 rank (longtext)\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               ├─ columns: [id info]\n" +
			"         │           │   │               ├─ colSet: (12,13)\n" +
			"         │           │   │               └─ tableId: 4\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ ct.id:11!null\n" +
			"         │           │       │   └─ mc.company_type_id:8!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ cn.id:9!null\n" +
			"         │           │       │   │   └─ mc.company_id:7!null\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ ProcessTable\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ Eq\n" +
			"         │           │       │       │   ├─ cn.country_code:1\n" +
			"         │           │       │       │   └─ [us] (longtext)\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ AND\n" +
			"         │           │           │   ├─ NOT\n" +
			"         │           │           │   │   └─ ct.kind:1!null IS NULL\n" +
			"         │           │           │   └─ Or\n" +
			"         │           │           │       ├─ Eq\n" +
			"         │           │           │       │   ├─ ct.kind:1!null\n" +
			"         │           │           │       │   └─ production companies (longtext)\n" +
			"         │           │           │       └─ Eq\n" +
			"         │           │           │           ├─ ct.kind:1!null\n" +
			"         │           │           │           └─ distributors (longtext)\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mi)\n" +
			"         │               └─ IndexedTableAccess(movie_info)\n" +
			"         │                   ├─ index: [movie_info.movie_id]\n" +
			"         │                   ├─ keys: [mc.movie_id:6!null]\n" +
			"         │                   ├─ colSet: (19-23)\n" +
			"         │                   ├─ tableId: 6\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: movie_info\n" +
			"         │                       └─ columns: [movie_id info_type_id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:13!null, mi_idx.movie_id:2!null, mc.movie_id:6!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThan\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2000 (smallint)\n" +
			"                 │   └─ Or\n" +
			"                 │       ├─ AND\n" +
			"                 │       │   ├─ GreaterThanOrEqual\n" +
			"                 │       │   │   ├─ t.title:1!null\n" +
			"                 │       │   │   └─ Birdemic (longtext)\n" +
			"                 │       │   └─ LessThanOrEqual\n" +
			"                 │       │       ├─ t.title:1!null\n" +
			"                 │       │       └─ Birdemicÿ (longtext)\n" +
			"                 │       └─ t.title LIKE '%Movie%'\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as budget, min(t.title) as unsuccsessful_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'budget')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ TableAlias(mi_idx)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_info_idx\n" +
			"         │           │   │   │       └─ columns: [movie_id info_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'bottom 10 rank')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT(ct.kind IS NULL)) AND ((ct.kind = 'production companies') OR (ct.kind = 'distributors')))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mi)\n" +
			"         │               └─ IndexedTableAccess(movie_info)\n" +
			"         │                   ├─ index: [movie_info.movie_id]\n" +
			"         │                   ├─ columns: [movie_id info_type_id info]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year > 2000) AND (((t.title >= 'Birdemic') AND (t.title <= 'Birdemicÿ')) OR t.title LIKE '%Movie%'))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as budget, min(t.title) as unsuccsessful_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'budget')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ TableAlias(mi_idx)\n" +
			"         │           │   │   │   └─ Table\n" +
			"         │           │   │   │       ├─ name: movie_info_idx\n" +
			"         │           │   │   │       └─ columns: [movie_id info_type_id]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'bottom 10 rank')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ ((NOT(ct.kind IS NULL)) AND ((ct.kind = 'production companies') OR (ct.kind = 'distributors')))\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ TableAlias(mi)\n" +
			"         │               └─ IndexedTableAccess(movie_info)\n" +
			"         │                   ├─ index: [movie_info.movie_id]\n" +
			"         │                   ├─ columns: [movie_id info_type_id info]\n" +
			"         │                   └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year > 2000) AND (((t.title >= 'Birdemic') AND (t.title <= 'Birdemicÿ')) OR t.title LIKE '%Movie%'))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS mainstream_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     title AS t
WHERE cn.country_code = '[us]'
  AND ct.kind = 'production companies'
  AND it1.info = 'genres'
  AND it2.info = 'rating'
  AND mi.info IN ('Drama',
                  'Horror',
                  'Western',
                  'Family')
  AND mi_idx.info > '7.0'
  AND t.production_year BETWEEN 2000 AND 2010
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND mi.info_type_id = it1.id
  AND mi_idx.info_type_id = it2.id
  AND t.id = mc.movie_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as mainstream_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(mi_idx.info:4!null), MIN(t.title:19!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:18!null\n" +
			"         │   │   │   └─ mi.movie_id:15!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:18!null\n" +
			"         │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:18!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mi.info_type_id:16!null\n" +
			"         │   │   └─ it1.id:0!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it1.info:1!null\n" +
			"         │   │   │   └─ genres (longtext)\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: info_type\n" +
			"         │   │               └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(it1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mi.info_type_id:14!null)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ mi.movie_id:15!null\n" +
			"         │           │   └─ mi_idx.movie_id:2!null\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ mc.movie_id:7!null\n" +
			"         │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mi_idx.info_type_id:3!null\n" +
			"         │           │   │   │   └─ it2.id:5!null\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ GreaterThan\n" +
			"         │           │   │   │   │   ├─ mi_idx.info:2!null\n" +
			"         │           │   │   │   │   └─ 7.0 (longtext)\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ ProcessTable\n" +
			"         │           │   │   │           └─ Table\n" +
			"         │           │   │   │               ├─ name: movie_info_idx\n" +
			"         │           │   │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ Eq\n" +
			"         │           │   │       │   ├─ it2.info:1!null\n" +
			"         │           │   │       │   └─ rating (longtext)\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               ├─ columns: [id info]\n" +
			"         │           │   │               ├─ colSet: (12,13)\n" +
			"         │           │   │               └─ tableId: 4\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ Eq\n" +
			"         │           │       │   ├─ ct.id:13!null\n" +
			"         │           │       │   └─ mc.company_type_id:9!null\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ Eq\n" +
			"         │           │       │   │   ├─ cn.id:10!null\n" +
			"         │           │       │   │   └─ mc.company_id:8!null\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ ProcessTable\n" +
			"         │           │       │   │       └─ Table\n" +
			"         │           │       │   │           ├─ name: movie_companies\n" +
			"         │           │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ Eq\n" +
			"         │           │       │       │   ├─ cn.country_code:2\n" +
			"         │           │       │       │   └─ [us] (longtext)\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ ProcessTable\n" +
			"         │           │       │               └─ Table\n" +
			"         │           │       │                   ├─ name: company_name\n" +
			"         │           │       │                   └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ Eq\n" +
			"         │           │           │   ├─ ct.kind:1!null\n" +
			"         │           │           │   └─ production companies (longtext)\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ ProcessTable\n" +
			"         │           │                   └─ Table\n" +
			"         │           │                       ├─ name: company_type\n" +
			"         │           │                       └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ HashIn\n" +
			"         │               │   ├─ mi.info:2!null\n" +
			"         │               │   └─ TUPLE(Drama (longtext), Horror (longtext), Western (longtext), Family (longtext))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ keys: [mc.movie_id:7!null]\n" +
			"         │                       ├─ colSet: (19-23)\n" +
			"         │                       ├─ tableId: 6\n" +
			"         │                       └─ Table\n" +
			"         │                           ├─ name: movie_info\n" +
			"         │                           └─ columns: [movie_id info_type_id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:15!null, mi_idx.movie_id:2!null, mc.movie_id:7!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2000 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2010 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as mainstream_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'genres')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ (mi_idx.info > '7.0')\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_info_idx\n" +
			"         │           │   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'rating')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ (mi.info HASH IN ('Drama', 'Horror', 'Western', 'Family'))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ columns: [movie_id info_type_id info]\n" +
			"         │                       └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as mainstream_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (mi.info_type_id = it1.id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (it1.info = 'genres')\n" +
			"         │   │   └─ TableAlias(it1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: info_type\n" +
			"         │   │           └─ columns: [id info]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (it1.id)\n" +
			"         │       ├─ right-key: (mi.info_type_id)\n" +
			"         │       └─ LookupJoin\n" +
			"         │           ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │           ├─ InnerJoin\n" +
			"         │           │   ├─ (mc.movie_id = mi_idx.movie_id)\n" +
			"         │           │   ├─ InnerJoin\n" +
			"         │           │   │   ├─ (mi_idx.info_type_id = it2.id)\n" +
			"         │           │   │   ├─ Filter\n" +
			"         │           │   │   │   ├─ (mi_idx.info > '7.0')\n" +
			"         │           │   │   │   └─ TableAlias(mi_idx)\n" +
			"         │           │   │   │       └─ Table\n" +
			"         │           │   │   │           ├─ name: movie_info_idx\n" +
			"         │           │   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │           │   │   └─ Filter\n" +
			"         │           │   │       ├─ (it2.info = 'rating')\n" +
			"         │           │   │       └─ TableAlias(it2)\n" +
			"         │           │   │           └─ Table\n" +
			"         │           │   │               ├─ name: info_type\n" +
			"         │           │   │               └─ columns: [id info]\n" +
			"         │           │   └─ InnerJoin\n" +
			"         │           │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │           │       ├─ InnerJoin\n" +
			"         │           │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │           │       │   ├─ TableAlias(mc)\n" +
			"         │           │       │   │   └─ Table\n" +
			"         │           │       │   │       ├─ name: movie_companies\n" +
			"         │           │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │           │       │   └─ Filter\n" +
			"         │           │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │           │       │       └─ TableAlias(cn)\n" +
			"         │           │       │           └─ Table\n" +
			"         │           │       │               ├─ name: company_name\n" +
			"         │           │       │               └─ columns: [id name country_code]\n" +
			"         │           │       └─ Filter\n" +
			"         │           │           ├─ (ct.kind = 'production companies')\n" +
			"         │           │           └─ TableAlias(ct)\n" +
			"         │           │               └─ Table\n" +
			"         │           │                   ├─ name: company_type\n" +
			"         │           │                   └─ columns: [id kind]\n" +
			"         │           └─ Filter\n" +
			"         │               ├─ (mi.info HASH IN ('Drama', 'Horror', 'Western', 'Family'))\n" +
			"         │               └─ TableAlias(mi)\n" +
			"         │                   └─ IndexedTableAccess(movie_info)\n" +
			"         │                       ├─ index: [movie_info.movie_id]\n" +
			"         │                       ├─ columns: [movie_id info_type_id info]\n" +
			"         │                       └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS release_date,
       MIN(miidx.info) AS rating,
       MIN(t.title) AS german_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it,
     info_type AS it2,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS miidx,
     title AS t
WHERE cn.country_code ='[de]'
  AND ct.kind ='production companies'
  AND it.info ='rating'
  AND it2.info ='release dates'
  AND kt.kind ='movie'
  AND mi.movie_id = t.id
  AND it2.id = mi.info_type_id
  AND kt.id = t.kind_id
  AND mc.movie_id = t.id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND miidx.movie_id = t.id
  AND it.id = miidx.info_type_id
  AND mi.movie_id = miidx.movie_id
  AND mi.movie_id = mc.movie_id
  AND miidx.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as release_date, min(miidx.info):1!null as rating, min(t.title):2!null as german_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:16!null), MIN(miidx.info:21!null), MIN(t.title:10!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ it.id:0!null\n" +
			"         │   └─ miidx.info_type_id:20!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ it.info:1!null\n" +
			"         │   │   └─ rating (longtext)\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: info_type\n" +
			"         │               └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(it.id:0!null)\n" +
			"             ├─ right-key: TUPLE(miidx.info_type_id:18!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi.movie_id:14!null\n" +
			"                 │   │   └─ mc.movie_id:2!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ miidx.movie_id:19!null\n" +
			"                 │       └─ mc.movie_id:2!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ct.id:7!null\n" +
			"                 │   │   └─ mc.company_type_id:4!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ cn.id:5!null\n" +
			"                 │   │   │   └─ mc.company_id:3!null\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_companies\n" +
			"                 │   │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ cn.country_code:1\n" +
			"                 │   │       │   └─ [de] (longtext)\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: company_name\n" +
			"                 │   │                   └─ columns: [id country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ ct.kind:1!null\n" +
			"                 │       │   └─ production companies (longtext)\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: company_type\n" +
			"                 │                   └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(mc.movie_id:2!null, mc.movie_id:2!null)\n" +
			"                     ├─ right-key: TUPLE(mi.movie_id:5!null, miidx.movie_id:10!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ miidx.movie_id:19!null\n" +
			"                         │   └─ t.id:9!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mi.movie_id:14!null\n" +
			"                         │   │   └─ t.id:9!null\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ kt.id:12!null\n" +
			"                         │   │   │   └─ t.kind_id:11!null\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ ProcessTable\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ Eq\n" +
			"                         │   │       │   ├─ kt.kind:1!null\n" +
			"                         │   │       │   └─ movie (longtext)\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ ProcessTable\n" +
			"                         │   │               └─ Table\n" +
			"                         │   │                   ├─ name: kind_type\n" +
			"                         │   │                   └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it2.id:17!null\n" +
			"                         │       │   └─ mi.info_type_id:15!null\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ ProcessTable\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: movie_info\n" +
			"                         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ Eq\n" +
			"                         │           │   ├─ it2.info:1!null\n" +
			"                         │           │   └─ release dates (longtext)\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   ├─ columns: [id info]\n" +
			"                         │                   ├─ colSet: (12,13)\n" +
			"                         │                   └─ tableId: 4\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ keys: [mi.movie_id:14!null]\n" +
			"                                 ├─ colSet: (26-30)\n" +
			"                                 ├─ tableId: 8\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: movie_info_idx\n" +
			"                                     └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(miidx.info) as rating, min(t.title) as german_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[de]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ Table\n" +
			"                         │   │   │       ├─ name: title\n" +
			"                         │   │   │       └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id info]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(miidx.info) as rating, min(t.title) as german_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[de]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ Table\n" +
			"                         │   │   │       ├─ name: title\n" +
			"                         │   │   │       └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id info]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(miidx.info) AS rating,
       MIN(t.title) AS movie_about_winning
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it,
     info_type AS it2,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS miidx,
     title AS t
WHERE cn.country_code ='[us]'
  AND ct.kind ='production companies'
  AND it.info ='rating'
  AND it2.info ='release dates'
  AND kt.kind ='movie'
  AND t.title != ''
  AND (t.title LIKE '%Champion%'
       OR t.title LIKE '%Loser%')
  AND mi.movie_id = t.id
  AND it2.id = mi.info_type_id
  AND kt.id = t.kind_id
  AND mc.movie_id = t.id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND miidx.movie_id = t.id
  AND it.id = miidx.info_type_id
  AND mi.movie_id = miidx.movie_id
  AND mi.movie_id = mc.movie_id
  AND miidx.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(miidx.info):1!null as rating, min(t.title):2!null as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:6!null), MIN(miidx.info:21!null), MIN(t.title:11!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ it.id:0!null\n" +
			"         │   └─ miidx.info_type_id:20!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ it.info:1!null\n" +
			"         │   │   └─ rating (longtext)\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: info_type\n" +
			"         │               └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(it.id:0!null)\n" +
			"             ├─ right-key: TUPLE(miidx.info_type_id:18!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi.movie_id:15!null\n" +
			"                 │   │   └─ mc.movie_id:2!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ miidx.movie_id:19!null\n" +
			"                 │       └─ mc.movie_id:2!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ct.id:8!null\n" +
			"                 │   │   └─ mc.company_type_id:4!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ cn.id:5!null\n" +
			"                 │   │   │   └─ mc.company_id:3!null\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_companies\n" +
			"                 │   │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ cn.country_code:2\n" +
			"                 │   │       │   └─ [us] (longtext)\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: company_name\n" +
			"                 │   │                   └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ ct.kind:1!null\n" +
			"                 │       │   └─ production companies (longtext)\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: company_type\n" +
			"                 │                   └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(mc.movie_id:2!null, mc.movie_id:2!null)\n" +
			"                     ├─ right-key: TUPLE(mi.movie_id:5!null, miidx.movie_id:9!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ miidx.movie_id:19!null\n" +
			"                         │   └─ t.id:10!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mi.movie_id:15!null\n" +
			"                         │   │   └─ t.id:10!null\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ kt.id:13!null\n" +
			"                         │   │   │   └─ t.kind_id:12!null\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ AND\n" +
			"                         │   │   │   │   ├─ NOT\n" +
			"                         │   │   │   │   │   └─ Eq\n" +
			"                         │   │   │   │   │       ├─ t.title:1!null\n" +
			"                         │   │   │   │   │       └─  (longtext)\n" +
			"                         │   │   │   │   └─ Or\n" +
			"                         │   │   │   │       ├─ t.title LIKE '%Champion%'\n" +
			"                         │   │   │   │       └─ t.title LIKE '%Loser%'\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ ProcessTable\n" +
			"                         │   │   │           └─ Table\n" +
			"                         │   │   │               ├─ name: title\n" +
			"                         │   │   │               └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ Eq\n" +
			"                         │   │       │   ├─ kt.kind:1!null\n" +
			"                         │   │       │   └─ movie (longtext)\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ ProcessTable\n" +
			"                         │   │               └─ Table\n" +
			"                         │   │                   ├─ name: kind_type\n" +
			"                         │   │                   └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it2.id:17!null\n" +
			"                         │       │   └─ mi.info_type_id:16!null\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ ProcessTable\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: movie_info\n" +
			"                         │       │           └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ Eq\n" +
			"                         │           │   ├─ it2.info:1!null\n" +
			"                         │           │   └─ release dates (longtext)\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   ├─ columns: [id info]\n" +
			"                         │                   ├─ colSet: (12,13)\n" +
			"                         │                   └─ tableId: 4\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ keys: [mi.movie_id:15!null]\n" +
			"                                 ├─ colSet: (26-30)\n" +
			"                                 ├─ tableId: 8\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: movie_info_idx\n" +
			"                                     └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ ((NOT((t.title = ''))) AND (t.title LIKE '%Champion%' OR t.title LIKE '%Loser%'))\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ ((NOT((t.title = ''))) AND (t.title LIKE '%Champion%' OR t.title LIKE '%Loser%'))\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(miidx.info) AS rating,
       MIN(t.title) AS movie_about_winning
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it,
     info_type AS it2,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS miidx,
     title AS t
WHERE cn.country_code ='[us]'
  AND ct.kind ='production companies'
  AND it.info ='rating'
  AND it2.info ='release dates'
  AND kt.kind ='movie'
  AND t.title != ''
  AND (t.title LIKE 'Champion%'
       OR t.title LIKE 'Loser%')
  AND mi.movie_id = t.id
  AND it2.id = mi.info_type_id
  AND kt.id = t.kind_id
  AND mc.movie_id = t.id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND miidx.movie_id = t.id
  AND it.id = miidx.info_type_id
  AND mi.movie_id = miidx.movie_id
  AND mi.movie_id = mc.movie_id
  AND miidx.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(miidx.info):1!null as rating, min(t.title):2!null as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:6!null), MIN(miidx.info:21!null), MIN(t.title:11!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ it.id:0!null\n" +
			"         │   └─ miidx.info_type_id:20!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ it.info:1!null\n" +
			"         │   │   └─ rating (longtext)\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: info_type\n" +
			"         │               └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(it.id:0!null)\n" +
			"             ├─ right-key: TUPLE(miidx.info_type_id:18!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi.movie_id:15!null\n" +
			"                 │   │   └─ mc.movie_id:2!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ miidx.movie_id:19!null\n" +
			"                 │       └─ mc.movie_id:2!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ct.id:8!null\n" +
			"                 │   │   └─ mc.company_type_id:4!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ cn.id:5!null\n" +
			"                 │   │   │   └─ mc.company_id:3!null\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_companies\n" +
			"                 │   │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ cn.country_code:2\n" +
			"                 │   │       │   └─ [us] (longtext)\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: company_name\n" +
			"                 │   │                   └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ ct.kind:1!null\n" +
			"                 │       │   └─ production companies (longtext)\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: company_type\n" +
			"                 │                   └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(mc.movie_id:2!null, mc.movie_id:2!null)\n" +
			"                     ├─ right-key: TUPLE(mi.movie_id:5!null, miidx.movie_id:9!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ miidx.movie_id:19!null\n" +
			"                         │   └─ t.id:10!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mi.movie_id:15!null\n" +
			"                         │   │   └─ t.id:10!null\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ kt.id:13!null\n" +
			"                         │   │   │   └─ t.kind_id:12!null\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ AND\n" +
			"                         │   │   │   │   ├─ NOT\n" +
			"                         │   │   │   │   │   └─ Eq\n" +
			"                         │   │   │   │   │       ├─ t.title:1!null\n" +
			"                         │   │   │   │   │       └─  (longtext)\n" +
			"                         │   │   │   │   └─ Or\n" +
			"                         │   │   │   │       ├─ AND\n" +
			"                         │   │   │   │       │   ├─ GreaterThanOrEqual\n" +
			"                         │   │   │   │       │   │   ├─ t.title:1!null\n" +
			"                         │   │   │   │       │   │   └─ Champion (longtext)\n" +
			"                         │   │   │   │       │   └─ LessThanOrEqual\n" +
			"                         │   │   │   │       │       ├─ t.title:1!null\n" +
			"                         │   │   │   │       │       └─ Championÿ (longtext)\n" +
			"                         │   │   │   │       └─ AND\n" +
			"                         │   │   │   │           ├─ GreaterThanOrEqual\n" +
			"                         │   │   │   │           │   ├─ t.title:1!null\n" +
			"                         │   │   │   │           │   └─ Loser (longtext)\n" +
			"                         │   │   │   │           └─ LessThanOrEqual\n" +
			"                         │   │   │   │               ├─ t.title:1!null\n" +
			"                         │   │   │   │               └─ Loserÿ (longtext)\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ ProcessTable\n" +
			"                         │   │   │           └─ Table\n" +
			"                         │   │   │               ├─ name: title\n" +
			"                         │   │   │               └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ Eq\n" +
			"                         │   │       │   ├─ kt.kind:1!null\n" +
			"                         │   │       │   └─ movie (longtext)\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ ProcessTable\n" +
			"                         │   │               └─ Table\n" +
			"                         │   │                   ├─ name: kind_type\n" +
			"                         │   │                   └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it2.id:17!null\n" +
			"                         │       │   └─ mi.info_type_id:16!null\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ ProcessTable\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: movie_info\n" +
			"                         │       │           └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ Eq\n" +
			"                         │           │   ├─ it2.info:1!null\n" +
			"                         │           │   └─ release dates (longtext)\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   ├─ columns: [id info]\n" +
			"                         │                   ├─ colSet: (12,13)\n" +
			"                         │                   └─ tableId: 4\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ keys: [mi.movie_id:15!null]\n" +
			"                                 ├─ colSet: (26-30)\n" +
			"                                 ├─ tableId: 8\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: movie_info_idx\n" +
			"                                     └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ ((NOT((t.title = ''))) AND (((t.title >= 'Champion') AND (t.title <= 'Championÿ')) OR ((t.title >= 'Loser') AND (t.title <= 'Loserÿ'))))\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie_about_winning]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ Filter\n" +
			"                         │   │   │   ├─ ((NOT((t.title = ''))) AND (((t.title >= 'Champion') AND (t.title <= 'Championÿ')) OR ((t.title >= 'Loser') AND (t.title <= 'Loserÿ'))))\n" +
			"                         │   │   │   └─ TableAlias(t)\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(miidx.info) AS rating,
       MIN(t.title) AS movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it,
     info_type AS it2,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS miidx,
     title AS t
WHERE cn.country_code ='[us]'
  AND ct.kind ='production companies'
  AND it.info ='rating'
  AND it2.info ='release dates'
  AND kt.kind ='movie'
  AND mi.movie_id = t.id
  AND it2.id = mi.info_type_id
  AND kt.id = t.kind_id
  AND mc.movie_id = t.id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND miidx.movie_id = t.id
  AND it.id = miidx.info_type_id
  AND mi.movie_id = miidx.movie_id
  AND mi.movie_id = mc.movie_id
  AND miidx.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(miidx.info):1!null as rating, min(t.title):2!null as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:6!null), MIN(miidx.info:21!null), MIN(t.title:11!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ it.id:0!null\n" +
			"         │   └─ miidx.info_type_id:20!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ it.info:1!null\n" +
			"         │   │   └─ rating (longtext)\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: info_type\n" +
			"         │               └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(it.id:0!null)\n" +
			"             ├─ right-key: TUPLE(miidx.info_type_id:18!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi.movie_id:15!null\n" +
			"                 │   │   └─ mc.movie_id:2!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ miidx.movie_id:19!null\n" +
			"                 │       └─ mc.movie_id:2!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ct.id:8!null\n" +
			"                 │   │   └─ mc.company_type_id:4!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ cn.id:5!null\n" +
			"                 │   │   │   └─ mc.company_id:3!null\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_companies\n" +
			"                 │   │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ Eq\n" +
			"                 │   │       │   ├─ cn.country_code:2\n" +
			"                 │   │       │   └─ [us] (longtext)\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: company_name\n" +
			"                 │   │                   └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ ct.kind:1!null\n" +
			"                 │       │   └─ production companies (longtext)\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: company_type\n" +
			"                 │                   └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(mc.movie_id:2!null, mc.movie_id:2!null)\n" +
			"                     ├─ right-key: TUPLE(mi.movie_id:5!null, miidx.movie_id:9!null)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ miidx.movie_id:19!null\n" +
			"                         │   └─ t.id:10!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mi.movie_id:15!null\n" +
			"                         │   │   └─ t.id:10!null\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ Eq\n" +
			"                         │   │   │   ├─ kt.id:13!null\n" +
			"                         │   │   │   └─ t.kind_id:12!null\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ ProcessTable\n" +
			"                         │   │   │       └─ Table\n" +
			"                         │   │   │           ├─ name: title\n" +
			"                         │   │   │           └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ Eq\n" +
			"                         │   │       │   ├─ kt.kind:1!null\n" +
			"                         │   │       │   └─ movie (longtext)\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ ProcessTable\n" +
			"                         │   │               └─ Table\n" +
			"                         │   │                   ├─ name: kind_type\n" +
			"                         │   │                   └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it2.id:17!null\n" +
			"                         │       │   └─ mi.info_type_id:16!null\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ ProcessTable\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: movie_info\n" +
			"                         │       │           └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ Eq\n" +
			"                         │           │   ├─ it2.info:1!null\n" +
			"                         │           │   └─ release dates (longtext)\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   ├─ columns: [id info]\n" +
			"                         │                   ├─ colSet: (12,13)\n" +
			"                         │                   └─ tableId: 4\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ keys: [mi.movie_id:15!null]\n" +
			"                                 ├─ colSet: (26-30)\n" +
			"                                 ├─ tableId: 8\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: movie_info_idx\n" +
			"                                     └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ Table\n" +
			"                         │   │   │       ├─ name: title\n" +
			"                         │   │   │       └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(miidx.info) as rating, min(t.title) as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(miidx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (it.id = miidx.info_type_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (it.info = 'rating')\n" +
			"         │   └─ TableAlias(it)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: info_type\n" +
			"         │           └─ columns: [id info]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (it.id)\n" +
			"             ├─ right-key: (miidx.info_type_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ ((mi.movie_id = mc.movie_id) AND (miidx.movie_id = mc.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ct.id = mc.company_type_id)\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (cn.id = mc.company_id)\n" +
			"                 │   │   ├─ TableAlias(mc)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_companies\n" +
			"                 │   │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (cn.country_code = '[us]')\n" +
			"                 │   │       └─ TableAlias(cn)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: company_name\n" +
			"                 │   │               └─ columns: [id name country_code]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (ct.kind = 'production companies')\n" +
			"                 │       └─ TableAlias(ct)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: company_type\n" +
			"                 │               └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (mc.movie_id, mc.movie_id)\n" +
			"                     ├─ right-key: (mi.movie_id, miidx.movie_id)\n" +
			"                     └─ LookupJoin\n" +
			"                         ├─ (miidx.movie_id = t.id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mi.movie_id = t.id)\n" +
			"                         │   ├─ InnerJoin\n" +
			"                         │   │   ├─ (kt.id = t.kind_id)\n" +
			"                         │   │   ├─ TableAlias(t)\n" +
			"                         │   │   │   └─ Table\n" +
			"                         │   │   │       ├─ name: title\n" +
			"                         │   │   │       └─ columns: [id title kind_id]\n" +
			"                         │   │   └─ Filter\n" +
			"                         │   │       ├─ (kt.kind = 'movie')\n" +
			"                         │   │       └─ TableAlias(kt)\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: kind_type\n" +
			"                         │   │               └─ columns: [id kind]\n" +
			"                         │   └─ InnerJoin\n" +
			"                         │       ├─ (it2.id = mi.info_type_id)\n" +
			"                         │       ├─ TableAlias(mi)\n" +
			"                         │       │   └─ Table\n" +
			"                         │       │       ├─ name: movie_info\n" +
			"                         │       │       └─ columns: [movie_id info_type_id]\n" +
			"                         │       └─ Filter\n" +
			"                         │           ├─ (it2.info = 'release dates')\n" +
			"                         │           └─ TableAlias(it2)\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ TableAlias(miidx)\n" +
			"                             └─ IndexedTableAccess(movie_info_idx)\n" +
			"                                 ├─ index: [movie_info_idx.movie_id]\n" +
			"                                 ├─ columns: [movie_id info_type_id info]\n" +
			"                                 └─ keys: mi.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS northern_dark_movie
FROM info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind = 'movie'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2010
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as northern_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:12!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt.id:4!null\n" +
			"         │   │   └─ t.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ kt.kind:1!null\n" +
			"         │       │   └─ movie (longtext)\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ it1.id:15!null\n" +
			"             │   │   │   └─ mi.info_type_id:18!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ mi.movie_id:17!null\n" +
			"             │   │       └─ mi_idx.movie_id:10!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ mk.movie_id:6!null\n" +
			"             │       └─ mi.movie_id:17!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.movie_id:6!null\n" +
			"             │   │   └─ mi_idx.movie_id:10!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ k.id:8!null\n" +
			"             │   │   │   └─ mk.keyword_id:7!null\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_keyword\n" +
			"             │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ HashIn\n" +
			"             │   │       │   ├─ k.keyword:1!null\n" +
			"             │   │       │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: keyword\n" +
			"             │   │                   └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ Eq\n" +
			"             │       │   │   ├─ it2.id:13!null\n" +
			"             │       │   │   └─ mi_idx.info_type_id:11!null\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ LessThan\n" +
			"             │       │   │   │   ├─ mi_idx.info:2!null\n" +
			"             │       │   │   │   └─ 8.5 (longtext)\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ ProcessTable\n" +
			"             │       │   │           └─ Table\n" +
			"             │       │   │               ├─ name: movie_info_idx\n" +
			"             │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ Eq\n" +
			"             │       │       │   ├─ it2.info:1!null\n" +
			"             │       │       │   └─ rating (longtext)\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ ProcessTable\n" +
			"             │       │               └─ Table\n" +
			"             │       │                   ├─ name: info_type\n" +
			"             │       │                   └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ it1.info:1!null\n" +
			"             │           │   └─ countries (longtext)\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   ├─ columns: [id info]\n" +
			"             │                   ├─ colSet: (1,2)\n" +
			"             │                   └─ tableId: 1\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:2!null\n" +
			"                 │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as northern_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind = 'movie')\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info < '8.5')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as northern_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind = 'movie')\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info < '8.5')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS western_dark_production
FROM info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title')
  AND kt.kind = 'movie'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info > '6.0'
  AND t.production_year > 2010
  AND (t.title LIKE '%murder%'
       OR t.title LIKE '%Murder%'
       OR t.title LIKE '%Mord%')
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as western_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:12!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt.id:4!null\n" +
			"         │   │   └─ t.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   │   └─ Or\n" +
			"         │   │   │       ├─ Or\n" +
			"         │   │   │       │   ├─ t.title LIKE '%murder%'\n" +
			"         │   │   │       │   └─ t.title LIKE '%Murder%'\n" +
			"         │   │   │       └─ t.title LIKE '%Mord%'\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ kt.kind:1!null\n" +
			"         │       │   └─ movie (longtext)\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ it1.id:15!null\n" +
			"             │   │   │   └─ mi.info_type_id:18!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ mi.movie_id:17!null\n" +
			"             │   │       └─ mi_idx.movie_id:10!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ mk.movie_id:6!null\n" +
			"             │       └─ mi.movie_id:17!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.movie_id:6!null\n" +
			"             │   │   └─ mi_idx.movie_id:10!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ k.id:8!null\n" +
			"             │   │   │   └─ mk.keyword_id:7!null\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_keyword\n" +
			"             │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ HashIn\n" +
			"             │   │       │   ├─ k.keyword:1!null\n" +
			"             │   │       │   └─ TUPLE(murder (longtext), murder-in-title (longtext))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: keyword\n" +
			"             │   │                   └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ Eq\n" +
			"             │       │   │   ├─ it2.id:13!null\n" +
			"             │       │   │   └─ mi_idx.info_type_id:11!null\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ GreaterThan\n" +
			"             │       │   │   │   ├─ mi_idx.info:2!null\n" +
			"             │       │   │   │   └─ 6.0 (longtext)\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ ProcessTable\n" +
			"             │       │   │           └─ Table\n" +
			"             │       │   │               ├─ name: movie_info_idx\n" +
			"             │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ Eq\n" +
			"             │       │       │   ├─ it2.info:1!null\n" +
			"             │       │       │   └─ rating (longtext)\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ ProcessTable\n" +
			"             │       │               └─ Table\n" +
			"             │       │                   ├─ name: info_type\n" +
			"             │       │                   └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ it1.info:1!null\n" +
			"             │           │   └─ countries (longtext)\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   ├─ columns: [id info]\n" +
			"             │                   ├─ colSet: (1,2)\n" +
			"             │                   └─ tableId: 1\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:2!null\n" +
			"                 │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as western_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year > 2010) AND ((t.title LIKE '%murder%' OR t.title LIKE '%Murder%') OR t.title LIKE '%Mord%'))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind = 'movie')\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ (k.keyword HASH IN ('murder', 'murder-in-title'))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info > '6.0')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as western_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year > 2010) AND ((t.title LIKE '%murder%' OR t.title LIKE '%Murder%') OR t.title LIKE '%Mord%'))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind = 'movie')\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ (k.keyword HASH IN ('murder', 'murder-in-title'))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info > '6.0')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS north_european_dark_production
FROM info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IS NOT NULL
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Danish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as north_european_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:12!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt.id:4!null\n" +
			"         │   │   └─ t.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ kt.kind:1!null\n" +
			"         │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ it1.id:15!null\n" +
			"             │   │   │   └─ mi.info_type_id:18!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ mi.movie_id:17!null\n" +
			"             │   │       └─ mi_idx.movie_id:10!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ mk.movie_id:6!null\n" +
			"             │       └─ mi.movie_id:17!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.movie_id:6!null\n" +
			"             │   │   └─ mi_idx.movie_id:10!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ k.id:8!null\n" +
			"             │   │   │   └─ mk.keyword_id:7!null\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_keyword\n" +
			"             │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ AND\n" +
			"             │   │       │   ├─ NOT\n" +
			"             │   │       │   │   └─ k.keyword:1!null IS NULL\n" +
			"             │   │       │   └─ HashIn\n" +
			"             │   │       │       ├─ k.keyword:1!null\n" +
			"             │   │       │       └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: keyword\n" +
			"             │   │                   └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ Eq\n" +
			"             │       │   │   ├─ it2.id:13!null\n" +
			"             │       │   │   └─ mi_idx.info_type_id:11!null\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ LessThan\n" +
			"             │       │   │   │   ├─ mi_idx.info:2!null\n" +
			"             │       │   │   │   └─ 8.5 (longtext)\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ ProcessTable\n" +
			"             │       │   │           └─ Table\n" +
			"             │       │   │               ├─ name: movie_info_idx\n" +
			"             │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ Eq\n" +
			"             │       │       │   ├─ it2.info:1!null\n" +
			"             │       │       │   └─ rating (longtext)\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ ProcessTable\n" +
			"             │       │               └─ Table\n" +
			"             │       │                   ├─ name: info_type\n" +
			"             │       │                   └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ it1.info:1!null\n" +
			"             │           │   └─ countries (longtext)\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   ├─ columns: [id info]\n" +
			"             │                   ├─ colSet: (1,2)\n" +
			"             │                   └─ tableId: 1\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:2!null\n" +
			"                 │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Danish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as north_european_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ ((NOT(k.keyword IS NULL)) AND (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence')))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info < '8.5')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as north_european_dark_production]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mk.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt.id = t.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │       └─ TableAlias(kt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((it1.id = mi.info_type_id) AND (mi.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mi.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.movie_id = mi_idx.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   │   ├─ TableAlias(mk)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_keyword\n" +
			"             │   │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ ((NOT(k.keyword IS NULL)) AND (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence')))\n" +
			"             │   │       └─ TableAlias(k)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: keyword\n" +
			"             │   │               └─ columns: [id keyword]\n" +
			"             │   └─ CrossJoin\n" +
			"             │       ├─ InnerJoin\n" +
			"             │       │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             │       │   ├─ Filter\n" +
			"             │       │   │   ├─ (mi_idx.info < '8.5')\n" +
			"             │       │   │   └─ TableAlias(mi_idx)\n" +
			"             │       │   │       └─ Table\n" +
			"             │       │   │           ├─ name: movie_info_idx\n" +
			"             │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │       │   └─ Filter\n" +
			"             │       │       ├─ (it2.info = 'rating')\n" +
			"             │       │       └─ TableAlias(it2)\n" +
			"             │       │           └─ Table\n" +
			"             │       │               ├─ name: info_type\n" +
			"             │       │               └─ columns: [id info]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (it1.info = 'countries')\n" +
			"             │           └─ TableAlias(it1)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_info\n" +
			"                         └─ columns: [movie_id info_type_id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS release_date,
       MIN(t.title) AS internet_movie
FROM aka_title AS at,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND mc.note LIKE '%(200%)%'
  AND mc.note LIKE '%(worldwide)%'
  AND mi.note LIKE '%internet%'
  AND mi.info LIKE 'USA:% 200%'
  AND t.production_year > 2000
  AND t.id = at.movie_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = at.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = at.movie_id
  AND mc.movie_id = at.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as release_date, min(t.title):1!null as internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(t.title:18!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:17!null\n" +
			"         │   │   │   │   └─ at.movie_id:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:17!null\n" +
			"         │   │   │       └─ mi.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:17!null\n" +
			"         │   │       └─ mk.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:17!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ k.id:0!null\n" +
			"         │   │   └─ mk.keyword_id:16!null\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:15!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ AND\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mc.movie_id:8!null\n" +
			"         │           │   │   │   └─ at.movie_id:1!null\n" +
			"         │           │   │   └─ Eq\n" +
			"         │           │   │       ├─ mi.movie_id:2!null\n" +
			"         │           │   │       └─ at.movie_id:1!null\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ mk.movie_id:15!null\n" +
			"         │           │       └─ at.movie_id:1!null\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ ProcessTable\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: aka_title\n" +
			"         │           │           └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(at.movie_id:1!null, at.movie_id:1!null, at.movie_id:1!null)\n" +
			"         │               ├─ right-key: TUPLE(mc.movie_id:6!null, mi.movie_id:0!null, mk.movie_id:13!null)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ Eq\n" +
			"         │                   │   │   ├─ mi.movie_id:2!null\n" +
			"         │                   │   │   └─ mc.movie_id:8!null\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ Eq\n" +
			"         │                   │   │   │   ├─ it1.id:6!null\n" +
			"         │                   │   │   │   └─ mi.info_type_id:3!null\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ AND\n" +
			"         │                   │   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   │   └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ ProcessTable\n" +
			"         │                   │   │   │           └─ Table\n" +
			"         │                   │   │   │               ├─ name: movie_info\n" +
			"         │                   │   │   │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ Eq\n" +
			"         │                   │   │       │   ├─ it1.info:1!null\n" +
			"         │                   │   │       │   └─ release dates (longtext)\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ ProcessTable\n" +
			"         │                   │   │               └─ Table\n" +
			"         │                   │   │                   ├─ name: info_type\n" +
			"         │                   │   │                   └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ Eq\n" +
			"         │                   │       │   ├─ ct.id:14!null\n" +
			"         │                   │       │   └─ mc.company_type_id:10!null\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ Eq\n" +
			"         │                   │       │   │   ├─ cn.id:12!null\n" +
			"         │                   │       │   │   └─ mc.company_id:9!null\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ AND\n" +
			"         │                   │       │   │   │   ├─ mc.note LIKE '%(200%)%'\n" +
			"         │                   │       │   │   │   └─ mc.note LIKE '%(worldwide)%'\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ ProcessTable\n" +
			"         │                   │       │   │           └─ Table\n" +
			"         │                   │       │   │               ├─ name: movie_companies\n" +
			"         │                   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ Eq\n" +
			"         │                   │       │       │   ├─ cn.country_code:1\n" +
			"         │                   │       │       │   └─ [us] (longtext)\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ ProcessTable\n" +
			"         │                   │       │               └─ Table\n" +
			"         │                   │       │                   ├─ name: company_name\n" +
			"         │                   │       │                   └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ ProcessTable\n" +
			"         │                   │               └─ Table\n" +
			"         │                   │                   ├─ name: company_type\n" +
			"         │                   │                   └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ keys: [mi.movie_id:2!null]\n" +
			"         │                           ├─ colSet: (37-39)\n" +
			"         │                           ├─ tableId: 8\n" +
			"         │                           └─ Table\n" +
			"         │                               ├─ name: movie_keyword\n" +
			"         │                               └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(at.movie_id:1!null, mi.movie_id:2!null, mk.movie_id:15!null, mc.movie_id:8!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThan\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 2000 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ (mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%')\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 2000)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ (mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%')\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 2000)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS release_date,
       MIN(t.title) AS youtube_movie
FROM aka_title AS at,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code = '[us]'
  AND cn.name = 'YouTube'
  AND it1.info = 'release dates'
  AND mc.note LIKE '%(200%)%'
  AND mc.note LIKE '%(worldwide)%'
  AND mi.note LIKE '%internet%'
  AND mi.info LIKE 'USA:% 200%'
  AND t.production_year BETWEEN 2005 AND 2010
  AND t.id = at.movie_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = at.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = at.movie_id
  AND mc.movie_id = at.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as release_date, min(t.title):1!null as youtube_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(t.title:19!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:18!null\n" +
			"         │   │   │   │   └─ at.movie_id:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:18!null\n" +
			"         │   │   │       └─ mi.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:18!null\n" +
			"         │   │       └─ mk.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:18!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ k.id:0!null\n" +
			"         │   │   └─ mk.keyword_id:17!null\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:16!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ AND\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mc.movie_id:8!null\n" +
			"         │           │   │   │   └─ at.movie_id:1!null\n" +
			"         │           │   │   └─ Eq\n" +
			"         │           │   │       ├─ mi.movie_id:2!null\n" +
			"         │           │   │       └─ at.movie_id:1!null\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ mk.movie_id:16!null\n" +
			"         │           │       └─ at.movie_id:1!null\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ ProcessTable\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: aka_title\n" +
			"         │           │           └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(at.movie_id:1!null, at.movie_id:1!null, at.movie_id:1!null)\n" +
			"         │               ├─ right-key: TUPLE(mc.movie_id:6!null, mi.movie_id:0!null, mk.movie_id:14!null)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ Eq\n" +
			"         │                   │   │   ├─ mi.movie_id:2!null\n" +
			"         │                   │   │   └─ mc.movie_id:8!null\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ Eq\n" +
			"         │                   │   │   │   ├─ it1.id:6!null\n" +
			"         │                   │   │   │   └─ mi.info_type_id:3!null\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ AND\n" +
			"         │                   │   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   │   └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ ProcessTable\n" +
			"         │                   │   │   │           └─ Table\n" +
			"         │                   │   │   │               ├─ name: movie_info\n" +
			"         │                   │   │   │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ Eq\n" +
			"         │                   │   │       │   ├─ it1.info:1!null\n" +
			"         │                   │   │       │   └─ release dates (longtext)\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ ProcessTable\n" +
			"         │                   │   │               └─ Table\n" +
			"         │                   │   │                   ├─ name: info_type\n" +
			"         │                   │   │                   └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ Eq\n" +
			"         │                   │       │   ├─ ct.id:15!null\n" +
			"         │                   │       │   └─ mc.company_type_id:10!null\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ Eq\n" +
			"         │                   │       │   │   ├─ cn.id:12!null\n" +
			"         │                   │       │   │   └─ mc.company_id:9!null\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ AND\n" +
			"         │                   │       │   │   │   ├─ mc.note LIKE '%(200%)%'\n" +
			"         │                   │       │   │   │   └─ mc.note LIKE '%(worldwide)%'\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ ProcessTable\n" +
			"         │                   │       │   │           └─ Table\n" +
			"         │                   │       │   │               ├─ name: movie_companies\n" +
			"         │                   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ AND\n" +
			"         │                   │       │       │   ├─ Eq\n" +
			"         │                   │       │       │   │   ├─ cn.country_code:2\n" +
			"         │                   │       │       │   │   └─ [us] (longtext)\n" +
			"         │                   │       │       │   └─ Eq\n" +
			"         │                   │       │       │       ├─ cn.name:1!null\n" +
			"         │                   │       │       │       └─ YouTube (longtext)\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ ProcessTable\n" +
			"         │                   │       │               └─ Table\n" +
			"         │                   │       │                   ├─ name: company_name\n" +
			"         │                   │       │                   └─ columns: [id name country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ ProcessTable\n" +
			"         │                   │               └─ Table\n" +
			"         │                   │                   ├─ name: company_type\n" +
			"         │                   │                   └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ keys: [mi.movie_id:2!null]\n" +
			"         │                           ├─ colSet: (37-39)\n" +
			"         │                           ├─ tableId: 8\n" +
			"         │                           └─ Table\n" +
			"         │                               ├─ name: movie_keyword\n" +
			"         │                               └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(at.movie_id:1!null, mi.movie_id:2!null, mk.movie_id:16!null, mc.movie_id:8!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2005 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2010 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as youtube_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ (mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%')\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ ((cn.country_code = '[us]') AND (cn.name = 'YouTube'))\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id name country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2005) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as youtube_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ Filter\n" +
			"         │                   │       │   │   ├─ (mc.note LIKE '%(200%)%' AND mc.note LIKE '%(worldwide)%')\n" +
			"         │                   │       │   │   └─ TableAlias(mc)\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ ((cn.country_code = '[us]') AND (cn.name = 'YouTube'))\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id name country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2005) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS release_date,
       MIN(t.title) AS modern_american_internet_movie
FROM aka_title AS at,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND mi.note LIKE '%internet%'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'USA:% 199%'
       OR mi.info LIKE 'USA:% 200%')
  AND t.production_year > 1990
  AND t.id = at.movie_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = at.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = at.movie_id
  AND mc.movie_id = at.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as release_date, min(t.title):1!null as modern_american_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:16!null\n" +
			"         │   │   │   │   └─ at.movie_id:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:16!null\n" +
			"         │   │   │       └─ mi.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ k.id:0!null\n" +
			"         │   │   └─ mk.keyword_id:15!null\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:14!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ AND\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mc.movie_id:8!null\n" +
			"         │           │   │   │   └─ at.movie_id:1!null\n" +
			"         │           │   │   └─ Eq\n" +
			"         │           │   │       ├─ mi.movie_id:2!null\n" +
			"         │           │   │       └─ at.movie_id:1!null\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ mk.movie_id:14!null\n" +
			"         │           │       └─ at.movie_id:1!null\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ ProcessTable\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: aka_title\n" +
			"         │           │           └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(at.movie_id:1!null, at.movie_id:1!null, at.movie_id:1!null)\n" +
			"         │               ├─ right-key: TUPLE(mc.movie_id:6!null, mi.movie_id:0!null, mk.movie_id:12!null)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ Eq\n" +
			"         │                   │   │   ├─ mi.movie_id:2!null\n" +
			"         │                   │   │   └─ mc.movie_id:8!null\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ Eq\n" +
			"         │                   │   │   │   ├─ it1.id:6!null\n" +
			"         │                   │   │   │   └─ mi.info_type_id:3!null\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ AND\n" +
			"         │                   │   │   │   │   ├─ AND\n" +
			"         │                   │   │   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   │   │   └─ NOT\n" +
			"         │                   │   │   │   │   │       └─ mi.info:2!null IS NULL\n" +
			"         │                   │   │   │   │   └─ Or\n" +
			"         │                   │   │   │   │       ├─ mi.info LIKE 'USA:% 199%'\n" +
			"         │                   │   │   │   │       └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ ProcessTable\n" +
			"         │                   │   │   │           └─ Table\n" +
			"         │                   │   │   │               ├─ name: movie_info\n" +
			"         │                   │   │   │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ Eq\n" +
			"         │                   │   │       │   ├─ it1.info:1!null\n" +
			"         │                   │   │       │   └─ release dates (longtext)\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ ProcessTable\n" +
			"         │                   │   │               └─ Table\n" +
			"         │                   │   │                   ├─ name: info_type\n" +
			"         │                   │   │                   └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ Eq\n" +
			"         │                   │       │   ├─ ct.id:13!null\n" +
			"         │                   │       │   └─ mc.company_type_id:10!null\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ Eq\n" +
			"         │                   │       │   │   ├─ cn.id:11!null\n" +
			"         │                   │       │   │   └─ mc.company_id:9!null\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ ProcessTable\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ Eq\n" +
			"         │                   │       │       │   ├─ cn.country_code:1\n" +
			"         │                   │       │       │   └─ [us] (longtext)\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ ProcessTable\n" +
			"         │                   │       │               └─ Table\n" +
			"         │                   │       │                   ├─ name: company_name\n" +
			"         │                   │       │                   └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ ProcessTable\n" +
			"         │                   │               └─ Table\n" +
			"         │                   │                   ├─ name: company_type\n" +
			"         │                   │                   └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ keys: [mi.movie_id:2!null]\n" +
			"         │                           ├─ colSet: (37-39)\n" +
			"         │                           ├─ tableId: 8\n" +
			"         │                           └─ Table\n" +
			"         │                               ├─ name: movie_keyword\n" +
			"         │                               └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(at.movie_id:1!null, mi.movie_id:2!null, mk.movie_id:14!null, mc.movie_id:8!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThan\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 1990 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as modern_american_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ Table\n" +
			"         │                   │       │   │       ├─ name: movie_companies\n" +
			"         │                   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1990)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as release_date, min(t.title) as modern_american_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ Table\n" +
			"         │                   │       │   │       ├─ name: movie_companies\n" +
			"         │                   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1990)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(at.title) AS aka_title,
       MIN(t.title) AS internet_movie_title
FROM aka_title AS at,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND mi.note LIKE '%internet%'
  AND t.production_year > 1990
  AND t.id = at.movie_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = at.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = at.movie_id
  AND mc.movie_id = at.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(at.title):0!null as aka_title, min(t.title):1!null as internet_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(at.title:2!null), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:16!null\n" +
			"         │   │   │   │   └─ at.movie_id:1!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:16!null\n" +
			"         │   │   │       └─ mi.movie_id:3!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ k.id:0!null\n" +
			"         │   │   └─ mk.keyword_id:15!null\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: keyword\n" +
			"         │   │           └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(mk.keyword_id:14!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ AND\n" +
			"         │           │   │   ├─ Eq\n" +
			"         │           │   │   │   ├─ mc.movie_id:8!null\n" +
			"         │           │   │   │   └─ at.movie_id:1!null\n" +
			"         │           │   │   └─ Eq\n" +
			"         │           │   │       ├─ mi.movie_id:3!null\n" +
			"         │           │   │       └─ at.movie_id:1!null\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ mk.movie_id:14!null\n" +
			"         │           │       └─ at.movie_id:1!null\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ ProcessTable\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: aka_title\n" +
			"         │           │           └─ columns: [movie_id title]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(at.movie_id:1!null, at.movie_id:1!null, at.movie_id:1!null)\n" +
			"         │               ├─ right-key: TUPLE(mc.movie_id:5!null, mi.movie_id:0!null, mk.movie_id:11!null)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ Eq\n" +
			"         │                   │   │   ├─ mi.movie_id:3!null\n" +
			"         │                   │   │   └─ mc.movie_id:8!null\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ Eq\n" +
			"         │                   │   │   │   ├─ it1.id:6!null\n" +
			"         │                   │   │   │   └─ mi.info_type_id:4!null\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ ProcessTable\n" +
			"         │                   │   │   │           └─ Table\n" +
			"         │                   │   │   │               ├─ name: movie_info\n" +
			"         │                   │   │   │               └─ columns: [movie_id info_type_id note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ Eq\n" +
			"         │                   │   │       │   ├─ it1.info:1!null\n" +
			"         │                   │   │       │   └─ release dates (longtext)\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ ProcessTable\n" +
			"         │                   │   │               └─ Table\n" +
			"         │                   │   │                   ├─ name: info_type\n" +
			"         │                   │   │                   └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ Eq\n" +
			"         │                   │       │   ├─ ct.id:13!null\n" +
			"         │                   │       │   └─ mc.company_type_id:10!null\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ Eq\n" +
			"         │                   │       │   │   ├─ cn.id:11!null\n" +
			"         │                   │       │   │   └─ mc.company_id:9!null\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ ProcessTable\n" +
			"         │                   │       │   │       └─ Table\n" +
			"         │                   │       │   │           ├─ name: movie_companies\n" +
			"         │                   │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ Eq\n" +
			"         │                   │       │       │   ├─ cn.country_code:1\n" +
			"         │                   │       │       │   └─ [us] (longtext)\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ ProcessTable\n" +
			"         │                   │       │               └─ Table\n" +
			"         │                   │       │                   ├─ name: company_name\n" +
			"         │                   │       │                   └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ ProcessTable\n" +
			"         │                   │               └─ Table\n" +
			"         │                   │                   ├─ name: company_type\n" +
			"         │                   │                   └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ keys: [mi.movie_id:3!null]\n" +
			"         │                           ├─ colSet: (37-39)\n" +
			"         │                           ├─ tableId: 8\n" +
			"         │                           └─ Table\n" +
			"         │                               ├─ name: movie_keyword\n" +
			"         │                               └─ columns: [movie_id keyword_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(at.movie_id:1!null, mi.movie_id:3!null, mk.movie_id:14!null, mc.movie_id:8!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ GreaterThan\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 1990 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(at.title) as aka_title, min(t.title) as internet_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(at.title), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id title]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ Table\n" +
			"         │                   │       │   │       ├─ name: movie_companies\n" +
			"         │                   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1990)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(at.title) as aka_title, min(t.title) as internet_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(at.title), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = at.movie_id) AND (t.id = mi.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (k.id = mk.keyword_id)\n" +
			"         │   ├─ TableAlias(k)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: keyword\n" +
			"         │   │       └─ columns: [id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (k.id)\n" +
			"         │       ├─ right-key: (mk.keyword_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (((mc.movie_id = at.movie_id) AND (mi.movie_id = at.movie_id)) AND (mk.movie_id = at.movie_id))\n" +
			"         │           ├─ TableAlias(at)\n" +
			"         │           │   └─ Table\n" +
			"         │           │       ├─ name: aka_title\n" +
			"         │           │       └─ columns: [movie_id title]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (at.movie_id, at.movie_id, at.movie_id)\n" +
			"         │               ├─ right-key: (mc.movie_id, mi.movie_id, mk.movie_id)\n" +
			"         │               └─ LookupJoin\n" +
			"         │                   ├─ InnerJoin\n" +
			"         │                   │   ├─ (mi.movie_id = mc.movie_id)\n" +
			"         │                   │   ├─ InnerJoin\n" +
			"         │                   │   │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │                   │   │   ├─ Filter\n" +
			"         │                   │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │                   │   │   │   └─ TableAlias(mi)\n" +
			"         │                   │   │   │       └─ Table\n" +
			"         │                   │   │   │           ├─ name: movie_info\n" +
			"         │                   │   │   │           └─ columns: [movie_id info_type_id note]\n" +
			"         │                   │   │   └─ Filter\n" +
			"         │                   │   │       ├─ (it1.info = 'release dates')\n" +
			"         │                   │   │       └─ TableAlias(it1)\n" +
			"         │                   │   │           └─ Table\n" +
			"         │                   │   │               ├─ name: info_type\n" +
			"         │                   │   │               └─ columns: [id info]\n" +
			"         │                   │   └─ InnerJoin\n" +
			"         │                   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │                   │       ├─ InnerJoin\n" +
			"         │                   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │                   │       │   ├─ TableAlias(mc)\n" +
			"         │                   │       │   │   └─ Table\n" +
			"         │                   │       │   │       ├─ name: movie_companies\n" +
			"         │                   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │                   │       │   └─ Filter\n" +
			"         │                   │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │                   │       │       └─ TableAlias(cn)\n" +
			"         │                   │       │           └─ Table\n" +
			"         │                   │       │               ├─ name: company_name\n" +
			"         │                   │       │               └─ columns: [id country_code]\n" +
			"         │                   │       └─ TableAlias(ct)\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: company_type\n" +
			"         │                   │               └─ columns: [id]\n" +
			"         │                   └─ TableAlias(mk)\n" +
			"         │                       └─ IndexedTableAccess(movie_keyword)\n" +
			"         │                           ├─ index: [movie_keyword.movie_id]\n" +
			"         │                           ├─ columns: [movie_id keyword_id]\n" +
			"         │                           └─ keys: mi.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (at.movie_id, mi.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year > 1990)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS cool_actor_pseudonym,
       MIN(t.title) AS series_named_after_char
FROM aka_name AS an,
     cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND t.episode_nr >= 50
  AND t.episode_nr < 100
  AND an.person_id = n.id
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND an.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as cool_actor_pseudonym, min(t.title):1!null as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:13!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.episode_nr:2\n" +
			"         │   │   │   └─ 50 (tinyint)\n" +
			"         │   │   └─ LessThan\n" +
			"         │   │       ├─ t.episode_nr:2\n" +
			"         │   │       └─ 100 (tinyint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ an.person_id:12!null\n" +
			"             │   │   └─ n.id:3!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ n.id:3!null\n" +
			"             │       └─ ci.person_id:10!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:11!null\n" +
			"                 │   │   └─ mk.movie_id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ mc.movie_id:8!null\n" +
			"                 │       └─ mk.movie_id:4!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mk.keyword_id:5!null\n" +
			"                 │   │   └─ k.id:6!null\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ ProcessTable\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: movie_keyword\n" +
			"                 │   │           └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ k.keyword:1!null\n" +
			"                 │       │   └─ character-name-in-title (longtext)\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: keyword\n" +
			"                 │                   └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:9!null\n" +
			"                     │   └─ cn.id:14!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:11!null\n" +
			"                     │   │   └─ mc.movie_id:8!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:10!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.episode_nr >= 50) AND (t.episode_nr < 100))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.episode_nr >= 50) AND (t.episode_nr < 100))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS cool_actor_pseudonym,
       MIN(t.title) AS series_named_after_char
FROM aka_name AS an,
     cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND an.person_id = n.id
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND an.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as cool_actor_pseudonym, min(t.title):1!null as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:12!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   │   └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ an.person_id:11!null\n" +
			"             │   │   └─ n.id:2!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ n.id:2!null\n" +
			"             │       └─ ci.person_id:9!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:10!null\n" +
			"                 │   │   └─ mk.movie_id:3!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ mc.movie_id:7!null\n" +
			"                 │       └─ mk.movie_id:3!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mk.keyword_id:4!null\n" +
			"                 │   │   └─ k.id:5!null\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ ProcessTable\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: movie_keyword\n" +
			"                 │   │           └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ k.keyword:1!null\n" +
			"                 │       │   └─ character-name-in-title (longtext)\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: keyword\n" +
			"                 │                   └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:8!null\n" +
			"                     │   └─ cn.id:13!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:10!null\n" +
			"                     │   │   └─ mc.movie_id:7!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:9!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS cool_actor_pseudonym,
       MIN(t.title) AS series_named_after_char
FROM aka_name AS an,
     cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND t.episode_nr < 100
  AND an.person_id = n.id
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND an.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as cool_actor_pseudonym, min(t.title):1!null as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:13!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ LessThan\n" +
			"         │   │   ├─ t.episode_nr:2\n" +
			"         │   │   └─ 100 (tinyint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ an.person_id:12!null\n" +
			"             │   │   └─ n.id:3!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ n.id:3!null\n" +
			"             │       └─ ci.person_id:10!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:11!null\n" +
			"                 │   │   └─ mk.movie_id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ mc.movie_id:8!null\n" +
			"                 │       └─ mk.movie_id:4!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mk.keyword_id:5!null\n" +
			"                 │   │   └─ k.id:6!null\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ ProcessTable\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: movie_keyword\n" +
			"                 │   │           └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ k.keyword:1!null\n" +
			"                 │       │   └─ character-name-in-title (longtext)\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: keyword\n" +
			"                 │                   └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:9!null\n" +
			"                     │   └─ cn.id:14!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:11!null\n" +
			"                     │   │   └─ mc.movie_id:8!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:10!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.episode_nr < 100)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.episode_nr < 100)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS cool_actor_pseudonym,
       MIN(t.title) AS series_named_after_char
FROM aka_name AS an,
     cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND t.episode_nr >= 5
  AND t.episode_nr < 100
  AND an.person_id = n.id
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND an.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as cool_actor_pseudonym, min(t.title):1!null as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:13!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.episode_nr:2\n" +
			"         │   │   │   └─ 5 (tinyint)\n" +
			"         │   │   └─ LessThan\n" +
			"         │   │       ├─ t.episode_nr:2\n" +
			"         │   │       └─ 100 (tinyint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ an.person_id:12!null\n" +
			"             │   │   └─ n.id:3!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ n.id:3!null\n" +
			"             │       └─ ci.person_id:10!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:11!null\n" +
			"                 │   │   └─ mk.movie_id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ mc.movie_id:8!null\n" +
			"                 │       └─ mk.movie_id:4!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mk.keyword_id:5!null\n" +
			"                 │   │   └─ k.id:6!null\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ ProcessTable\n" +
			"                 │   │       └─ Table\n" +
			"                 │   │           ├─ name: movie_keyword\n" +
			"                 │   │           └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ Eq\n" +
			"                 │       │   ├─ k.keyword:1!null\n" +
			"                 │       │   └─ character-name-in-title (longtext)\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ ProcessTable\n" +
			"                 │               └─ Table\n" +
			"                 │                   ├─ name: keyword\n" +
			"                 │                   └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:9!null\n" +
			"                     │   └─ cn.id:14!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:11!null\n" +
			"                     │   │   └─ mc.movie_id:8!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:10!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.episode_nr >= 5) AND (t.episode_nr < 100))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as cool_actor_pseudonym, min(t.title) as series_named_after_char]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.episode_nr >= 5) AND (t.episode_nr < 100))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title episode_nr]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((ci.movie_id = mk.movie_id) AND (mc.movie_id = mk.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (mk.keyword_id = k.id)\n" +
			"                 │   ├─ TableAlias(mk)\n" +
			"                 │   │   └─ Table\n" +
			"                 │   │       ├─ name: movie_keyword\n" +
			"                 │   │       └─ columns: [movie_id keyword_id]\n" +
			"                 │   └─ Filter\n" +
			"                 │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"                 │       └─ TableAlias(k)\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: keyword\n" +
			"                 │               └─ columns: [id keyword]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_american_movie,
       MIN(n.name) AS a1
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND n.name LIKE 'B%'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_american_movie, min(n.name):0!null as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:11!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:9!null\n" +
			"         │   │   │   └─ t.id:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:12!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:12!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:10!null\n" +
			"         │   │   └─ ci.person_id:8!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:5!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:7!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ cn.country_code:1\n" +
			"         │   │           │   │   └─ [us] (longtext)\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ ProcessTable\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: company_name\n" +
			"         │   │           │               └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:4!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:6!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:8!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ GreaterThanOrEqual\n" +
			"         │           │   │   ├─ n.name:1!null\n" +
			"         │           │   │   └─ B (longtext)\n" +
			"         │           │   └─ LessThanOrEqual\n" +
			"         │           │       ├─ n.name:1!null\n" +
			"         │           │       └─ Bÿ (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:9!null, mk.movie_id:4!null, mc.movie_id:6!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_american_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (cn.country_code = '[us]')\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'B') AND (n.name <= 'Bÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_american_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (cn.country_code = '[us]')\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'B') AND (n.name <= 'Bÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_movie,
       MIN(n.name) AS a1
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword ='character-name-in-title'
  AND n.name LIKE 'Z%'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_movie, min(n.name):0!null as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:10!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   │   └─ t.id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:11!null\n" +
			"         │   │       └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:11!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:9!null\n" +
			"         │   │   └─ ci.person_id:7!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:4!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:2!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:6!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:5!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:3!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:5!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:7!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ GreaterThanOrEqual\n" +
			"         │           │   │   ├─ n.name:1!null\n" +
			"         │           │   │   └─ Z (longtext)\n" +
			"         │           │   └─ LessThanOrEqual\n" +
			"         │           │       ├─ n.name:1!null\n" +
			"         │           │       └─ Zÿ (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:8!null, mk.movie_id:3!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'Z') AND (n.name <= 'Zÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'Z') AND (n.name <= 'Zÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_movie,
       MIN(n.name) AS a1
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword ='character-name-in-title'
  AND n.name LIKE 'X%'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_movie, min(n.name):0!null as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:10!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   │   └─ t.id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:11!null\n" +
			"         │   │       └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:11!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:9!null\n" +
			"         │   │   └─ ci.person_id:7!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:4!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:2!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:6!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:5!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:3!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:5!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:7!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ GreaterThanOrEqual\n" +
			"         │           │   │   ├─ n.name:1!null\n" +
			"         │           │   │   └─ X (longtext)\n" +
			"         │           │   └─ LessThanOrEqual\n" +
			"         │           │       ├─ n.name:1!null\n" +
			"         │           │       └─ Xÿ (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:8!null, mk.movie_id:3!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'X') AND (n.name <= 'Xÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie, min(n.name) as a1]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.name >= 'X') AND (n.name <= 'Xÿ'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_movie
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword ='character-name-in-title'
  AND n.name LIKE '%Bert%'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:10!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   │   └─ t.id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:11!null\n" +
			"         │   │       └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:11!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:9!null\n" +
			"         │   │   └─ ci.person_id:7!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:4!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:2!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:6!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:5!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:3!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:5!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:7!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%Bert%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:8!null, mk.movie_id:3!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%Bert%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%Bert%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_movie
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:11!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:9!null\n" +
			"         │   │   │   └─ t.id:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:12!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:12!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:10!null\n" +
			"         │   │   └─ ci.person_id:8!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:5!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:7!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ cn.country_code:1\n" +
			"         │   │           │   │   └─ [us] (longtext)\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ ProcessTable\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: company_name\n" +
			"         │   │           │               └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:4!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:6!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:8!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:9!null, mk.movie_id:4!null, mc.movie_id:6!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (cn.country_code = '[us]')\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: name\n" +
			"         │               └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (cn.country_code = '[us]')\n" +
			"         │   │           │   └─ TableAlias(cn)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id country_code]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: name\n" +
			"         │               └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS member_in_charnamed_movie
FROM cast_info AS ci,
     company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword ='character-name-in-title'
  AND n.name LIKE '%B%'
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.movie_id = mc.movie_id
  AND ci.movie_id = mk.movie_id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:10!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   │   └─ t.id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:11!null\n" +
			"         │   │       └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:11!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:9!null\n" +
			"         │   │   └─ ci.person_id:7!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mk.keyword_id:4!null\n" +
			"         │   │   │   └─ k.id:0!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   └─ character-name-in-title (longtext)\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: keyword\n" +
			"         │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(k.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mk.keyword_id:2!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ mc.company_id:6!null\n" +
			"         │   │           │   └─ cn.id:2!null\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: company_name\n" +
			"         │   │           │           └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(cn.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mc.movie_id:5!null\n" +
			"         │   │                   │   │   └─ mk.movie_id:3!null\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_companies\n" +
			"         │   │                   │               └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ keys: [mc.movie_id:5!null]\n" +
			"         │   │                           ├─ colSet: (1-7)\n" +
			"         │   │                           ├─ tableId: 1\n" +
			"         │   │                           └─ Table\n" +
			"         │   │                               ├─ name: cast_info\n" +
			"         │   │                               └─ columns: [person_id movie_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:7!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%B%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ci.movie_id:8!null, mk.movie_id:3!null, mc.movie_id:5!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%B%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as member_in_charnamed_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((ci.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (mk.keyword_id = k.id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (k.keyword = 'character-name-in-title')\n" +
			"         │   │   │   └─ TableAlias(k)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: keyword\n" +
			"         │   │   │           └─ columns: [id keyword]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (k.id)\n" +
			"         │   │       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (mc.company_id = cn.id)\n" +
			"         │   │           ├─ TableAlias(cn)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: company_name\n" +
			"         │   │           │       └─ columns: [id]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (cn.id)\n" +
			"         │   │               ├─ right-key: (mc.company_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mc.movie_id = mk.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mk)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                   │   └─ TableAlias(mc)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_companies\n" +
			"         │   │                   │           └─ columns: [movie_id company_id]\n" +
			"         │   │                   └─ TableAlias(ci)\n" +
			"         │   │                       └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                           ├─ index: [cast_info.movie_id]\n" +
			"         │   │                           ├─ columns: [person_id movie_id]\n" +
			"         │   │                           └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ n.name LIKE '%B%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(t.title) AS movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     name AS n,
     title AS t
WHERE ci.note IN ('(producer)',
                  '(executive producer)')
  AND it1.info = 'budget'
  AND it2.info = 'votes'
  AND n.gender = 'm'
  AND n.name LIKE '%Tim%'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(t.title):2!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:6!null), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:16!null\n" +
			"         │   │   │   └─ mi.movie_id:7!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mi_idx.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ ci.movie_id:11!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:13!null\n" +
			"         │   │   └─ ci.person_id:10!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:5!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:3!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.id:2!null\n" +
			"         │   │           │   └─ mi.info_type_id:8!null\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.info:1!null\n" +
			"         │   │           │   │   └─ budget (longtext)\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           ├─ columns: [id info]\n" +
			"         │   │           │           ├─ colSet: (8,9)\n" +
			"         │   │           │           └─ tableId: 2\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(it1.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.info_type_id:4!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mi_idx.movie_id:4!null\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ TableAlias(mi)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_info\n" +
			"         │   │                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ HashIn\n" +
			"         │   │                       │   ├─ ci.note:2\n" +
			"         │   │                       │   └─ TUPLE((producer) (longtext), (executive producer) (longtext))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ keys: [mi.movie_id:7!null]\n" +
			"         │   │                               ├─ colSet: (1-7)\n" +
			"         │   │                               ├─ tableId: 1\n" +
			"         │   │                               └─ Table\n" +
			"         │   │                                   ├─ name: cast_info\n" +
			"         │   │                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:10!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ n.gender:2\n" +
			"         │           │   │   └─ m (longtext)\n" +
			"         │           │   └─ n.name LIKE '%Tim%'\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:7!null, mi_idx.movie_id:4!null, ci.movie_id:11!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'budget')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ TableAlias(mi)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_info\n" +
			"         │   │                   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(producer)', '(executive producer)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.gender = 'm') AND n.name LIKE '%Tim%')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'budget')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ TableAlias(mi)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_info\n" +
			"         │   │                   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(producer)', '(executive producer)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((n.gender = 'm') AND n.name LIKE '%Tim%')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(t.title) AS movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'rating'
  AND mi.info IN ('Horror',
                  'Thriller')
  AND mi.note IS NULL
  AND mi_idx.info > '8.0'
  AND n.gender IS NOT NULL
  AND n.gender = 'f'
  AND t.production_year BETWEEN 2008 AND 2014
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(t.title):2!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:6!null), MIN(t.title:17!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:16!null\n" +
			"         │   │   │   └─ mi.movie_id:7!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:16!null\n" +
			"         │   │       └─ mi_idx.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:16!null\n" +
			"         │       └─ ci.movie_id:12!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:14!null\n" +
			"         │   │   └─ ci.person_id:11!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:5!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ rating (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:3!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.id:2!null\n" +
			"         │   │           │   └─ mi.info_type_id:8!null\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.info:1!null\n" +
			"         │   │           │   │   └─ genres (longtext)\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           ├─ columns: [id info]\n" +
			"         │   │           │           ├─ colSet: (8,9)\n" +
			"         │   │           │           └─ tableId: 2\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(it1.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.info_type_id:4!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mi_idx.movie_id:4!null\n" +
			"         │   │                   │   ├─ Filter\n" +
			"         │   │                   │   │   ├─ GreaterThan\n" +
			"         │   │                   │   │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │                   │   │   │   └─ 8.0 (longtext)\n" +
			"         │   │                   │   │   └─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │       └─ ProcessTable\n" +
			"         │   │                   │   │           └─ Table\n" +
			"         │   │                   │   │               ├─ name: movie_info_idx\n" +
			"         │   │                   │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ AND\n" +
			"         │   │                   │       │   ├─ HashIn\n" +
			"         │   │                   │       │   │   ├─ mi.info:2!null\n" +
			"         │   │                   │       │   │   └─ TUPLE(Horror (longtext), Thriller (longtext))\n" +
			"         │   │                   │       │   └─ mi.note:3 IS NULL\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ ProcessTable\n" +
			"         │   │                   │               └─ Table\n" +
			"         │   │                   │                   ├─ name: movie_info\n" +
			"         │   │                   │                   └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ HashIn\n" +
			"         │   │                       │   ├─ ci.note:2\n" +
			"         │   │                       │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ keys: [mi.movie_id:7!null]\n" +
			"         │   │                               ├─ colSet: (1-7)\n" +
			"         │   │                               ├─ tableId: 1\n" +
			"         │   │                               └─ Table\n" +
			"         │   │                                   ├─ name: cast_info\n" +
			"         │   │                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:11!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ AND\n" +
			"         │           │   ├─ NOT\n" +
			"         │           │   │   └─ n.gender:1 IS NULL\n" +
			"         │           │   └─ Eq\n" +
			"         │           │       ├─ n.gender:1\n" +
			"         │           │       └─ f (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:7!null, mi_idx.movie_id:4!null, ci.movie_id:12!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2008 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2014 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'rating')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'genres')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ Filter\n" +
			"         │   │                   │   │   ├─ (mi_idx.info > '8.0')\n" +
			"         │   │                   │   │   └─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ ((mi.info HASH IN ('Horror', 'Thriller')) AND mi.note IS NULL)\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_info\n" +
			"         │   │                   │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((NOT(n.gender IS NULL)) AND (n.gender = 'f'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2008) AND (t.production_year <= 2014))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'rating')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'genres')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ Filter\n" +
			"         │   │                   │   │   ├─ (mi_idx.info > '8.0')\n" +
			"         │   │                   │   │   └─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ ((mi.info HASH IN ('Horror', 'Thriller')) AND mi.note IS NULL)\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_info\n" +
			"         │   │                   │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ ((NOT(n.gender IS NULL)) AND (n.gender = 'f'))\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2008) AND (t.production_year <= 2014))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(t.title) AS movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND mi.info IN ('Horror',
                  'Action',
                  'Sci-Fi',
                  'Thriller',
                  'Crime',
                  'War')
  AND n.gender = 'm'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(t.title):2!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:6!null), MIN(t.title:16!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:15!null\n" +
			"         │   │   │   └─ mi.movie_id:7!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:15!null\n" +
			"         │   │       └─ mi_idx.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:15!null\n" +
			"         │       └─ ci.movie_id:11!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:13!null\n" +
			"         │   │   └─ ci.person_id:10!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:5!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:3!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.id:2!null\n" +
			"         │   │           │   └─ mi.info_type_id:8!null\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.info:1!null\n" +
			"         │   │           │   │   └─ genres (longtext)\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           ├─ columns: [id info]\n" +
			"         │   │           │           ├─ colSet: (8,9)\n" +
			"         │   │           │           └─ tableId: 2\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(it1.id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.info_type_id:4!null)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mi_idx.movie_id:4!null\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ ProcessTable\n" +
			"         │   │                   │   │       └─ Table\n" +
			"         │   │                   │   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ HashIn\n" +
			"         │   │                   │       │   ├─ mi.info:2!null\n" +
			"         │   │                   │       │   └─ TUPLE(Horror (longtext), Action (longtext), Sci-Fi (longtext), Thriller (longtext), Crime (longtext), War (longtext))\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ ProcessTable\n" +
			"         │   │                   │               └─ Table\n" +
			"         │   │                   │                   ├─ name: movie_info\n" +
			"         │   │                   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ HashIn\n" +
			"         │   │                       │   ├─ ci.note:2\n" +
			"         │   │                       │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ keys: [mi.movie_id:7!null]\n" +
			"         │   │                               ├─ colSet: (1-7)\n" +
			"         │   │                               ├─ tableId: 1\n" +
			"         │   │                               └─ Table\n" +
			"         │   │                                   ├─ name: cast_info\n" +
			"         │   │                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:10!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:1\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:7!null, mi_idx.movie_id:4!null, ci.movie_id:11!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'genres')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_info\n" +
			"         │   │                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           ├─ Filter\n" +
			"         │   │           │   ├─ (it1.info = 'genres')\n" +
			"         │   │           │   └─ TableAlias(it1)\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: info_type\n" +
			"         │   │           │           └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (it1.id)\n" +
			"         │   │               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │               └─ LookupJoin\n" +
			"         │   │                   ├─ InnerJoin\n" +
			"         │   │                   │   ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"         │   │                   │   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   │   └─ Table\n" +
			"         │   │                   │   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   │   └─ Filter\n" +
			"         │   │                   │       ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │                   │       └─ TableAlias(mi)\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: movie_info\n" +
			"         │   │                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ Filter\n" +
			"         │   │                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                       └─ TableAlias(ci)\n" +
			"         │   │                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS voicing_actress,
       MIN(t.title) AS voiced_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND mc.note IS NOT NULL
  AND (mc.note LIKE '%(USA)%'
       OR mc.note LIKE '%(worldwide)%')
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%200%'
       OR mi.info LIKE 'USA:%200%')
  AND n.gender ='f'
  AND n.name LIKE '%Ang%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2005 AND 2009
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mi.movie_id = ci.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as voicing_actress, min(t.title):1!null as voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:8!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:17!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:2\n" +
			"         │   │       └─ 2009 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:20!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:16!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:22!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%Ang%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ mc.movie_id:13!null\n" +
			"                     │   │   └─ mi.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ mi.movie_id:8!null\n" +
			"                     │       └─ ci.movie_id:17!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ it.id:11!null\n" +
			"                     │   │   └─ mi.info_type_id:9!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ NOT\n" +
			"                     │   │   │   │   └─ mi.info:2!null IS NULL\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mi.info LIKE 'Japan:%200%'\n" +
			"                     │   │   │       └─ mi.info LIKE 'USA:%200%'\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_info\n" +
			"                     │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ it.info:1!null\n" +
			"                     │       │   └─ release dates (longtext)\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: info_type\n" +
			"                     │                   └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.id:23!null\n" +
			"                         │   └─ mc.company_id:14!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:13!null\n" +
			"                         │   │   └─ ci.movie_id:17!null\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ AND\n" +
			"                         │   │   │   ├─ NOT\n" +
			"                         │   │   │   │   └─ mc.note:2 IS NULL\n" +
			"                         │   │   │   └─ Or\n" +
			"                         │   │   │       ├─ mc.note LIKE '%(USA)%'\n" +
			"                         │   │   │       └─ mc.note LIKE '%(worldwide)%'\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ ProcessTable\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: movie_companies\n" +
			"                         │   │               └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ Eq\n" +
			"                         │       │   │   ├─ chn.id:21!null\n" +
			"                         │       │   │   └─ ci.person_role_id:18\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ HashIn\n" +
			"                         │       │   │   │   ├─ ci.note:3\n" +
			"                         │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ ProcessTable\n" +
			"                         │       │   │           └─ Table\n" +
			"                         │       │   │               ├─ name: cast_info\n" +
			"                         │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ ProcessTable\n" +
			"                         │       │           └─ Table\n" +
			"                         │       │               ├─ name: char_name\n" +
			"                         │       │               └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ keys: [ci.person_id:16!null]\n" +
			"                         │               ├─ colSet: (1-8)\n" +
			"                         │               ├─ tableId: 1\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: aka_name\n" +
			"                         │                   └─ columns: [person_id]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.country_code:1\n" +
			"                             │   └─ [us] (longtext)\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ ProcessTable\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2009))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Ang%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mc.note IS NULL)) AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2009))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Ang%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mc.note IS NULL)) AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS voicing_actress,
       MIN(t.title) AS kung_fu_panda
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note = '(voice)'
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND mc.note LIKE '%(200%)%'
  AND (mc.note LIKE '%(USA)%'
       OR mc.note LIKE '%(worldwide)%')
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%2007%'
       OR mi.info LIKE 'USA:%2008%')
  AND n.gender ='f'
  AND n.name LIKE '%Angel%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2007 AND 2008
  AND t.title LIKE '%Kung%Fu%Panda%'
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mi.movie_id = ci.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as voicing_actress, min(t.title):1!null as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:8!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:17!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 2007 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2008 (smallint)\n" +
			"         │   │   └─ t.title LIKE '%Kung%Fu%Panda%'\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:20!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:16!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:22!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%Angel%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ mc.movie_id:13!null\n" +
			"                     │   │   └─ mi.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ mi.movie_id:8!null\n" +
			"                     │       └─ ci.movie_id:17!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ it.id:11!null\n" +
			"                     │   │   └─ mi.info_type_id:9!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ NOT\n" +
			"                     │   │   │   │   └─ mi.info:2!null IS NULL\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mi.info LIKE 'Japan:%2007%'\n" +
			"                     │   │   │       └─ mi.info LIKE 'USA:%2008%'\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_info\n" +
			"                     │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ it.info:1!null\n" +
			"                     │       │   └─ release dates (longtext)\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: info_type\n" +
			"                     │                   └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.id:23!null\n" +
			"                         │   └─ mc.company_id:14!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:13!null\n" +
			"                         │   │   └─ ci.movie_id:17!null\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ AND\n" +
			"                         │   │   │   ├─ mc.note LIKE '%(200%)%'\n" +
			"                         │   │   │   └─ Or\n" +
			"                         │   │   │       ├─ mc.note LIKE '%(USA)%'\n" +
			"                         │   │   │       └─ mc.note LIKE '%(worldwide)%'\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ ProcessTable\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: movie_companies\n" +
			"                         │   │               └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ Eq\n" +
			"                         │       │   │   ├─ chn.id:21!null\n" +
			"                         │       │   │   └─ ci.person_role_id:18\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ Eq\n" +
			"                         │       │   │   │   ├─ ci.note:3\n" +
			"                         │       │   │   │   └─ (voice) (longtext)\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ ProcessTable\n" +
			"                         │       │   │           └─ Table\n" +
			"                         │       │   │               ├─ name: cast_info\n" +
			"                         │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ ProcessTable\n" +
			"                         │       │           └─ Table\n" +
			"                         │       │               ├─ name: char_name\n" +
			"                         │       │               └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ keys: [ci.person_id:16!null]\n" +
			"                         │               ├─ colSet: (1-8)\n" +
			"                         │               ├─ tableId: 1\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: aka_name\n" +
			"                         │                   └─ columns: [person_id]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.country_code:1\n" +
			"                             │   └─ [us] (longtext)\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ ProcessTable\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year >= 2007) AND (t.production_year <= 2008)) AND t.title LIKE '%Kung%Fu%Panda%')\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Angel%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%2007%' OR mi.info LIKE 'USA:%2008%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ (mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note = '(voice)')\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year >= 2007) AND (t.production_year <= 2008)) AND t.title LIKE '%Kung%Fu%Panda%')\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Angel%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%2007%' OR mi.info LIKE 'USA:%2008%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ (mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                         │   │   └─ TableAlias(mc)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id note]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note = '(voice)')\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS voicing_actress,
       MIN(t.title) AS jap_engl_voiced_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%200%'
       OR mi.info LIKE 'USA:%200%')
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.production_year > 2000
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mi.movie_id = ci.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as voicing_actress, min(t.title):1!null as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:8!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:16!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ t.production_year:2\n" +
			"         │   │   └─ 2000 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:19!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:15!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:21!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%An%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ mc.movie_id:13!null\n" +
			"                     │   │   └─ mi.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ mi.movie_id:8!null\n" +
			"                     │       └─ ci.movie_id:16!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ it.id:11!null\n" +
			"                     │   │   └─ mi.info_type_id:9!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ NOT\n" +
			"                     │   │   │   │   └─ mi.info:2!null IS NULL\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mi.info LIKE 'Japan:%200%'\n" +
			"                     │   │   │       └─ mi.info LIKE 'USA:%200%'\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_info\n" +
			"                     │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ it.info:1!null\n" +
			"                     │       │   └─ release dates (longtext)\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: info_type\n" +
			"                     │                   └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.id:22!null\n" +
			"                         │   └─ mc.company_id:14!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:13!null\n" +
			"                         │   │   └─ ci.movie_id:16!null\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ ProcessTable\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ Eq\n" +
			"                         │       │   │   ├─ chn.id:20!null\n" +
			"                         │       │   │   └─ ci.person_role_id:17\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ HashIn\n" +
			"                         │       │   │   │   ├─ ci.note:3\n" +
			"                         │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ ProcessTable\n" +
			"                         │       │   │           └─ Table\n" +
			"                         │       │   │               ├─ name: cast_info\n" +
			"                         │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ ProcessTable\n" +
			"                         │       │           └─ Table\n" +
			"                         │       │               ├─ name: char_name\n" +
			"                         │       │               └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ keys: [ci.person_id:15!null]\n" +
			"                         │               ├─ colSet: (1-8)\n" +
			"                         │               ├─ tableId: 1\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: aka_name\n" +
			"                         │                   └─ columns: [person_id]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.country_code:1\n" +
			"                             │   └─ [us] (longtext)\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ ProcessTable\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2000)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ Table\n" +
			"                         │   │       ├─ name: movie_companies\n" +
			"                         │   │       └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2000)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"                     │   │   └─ TableAlias(mi)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ Table\n" +
			"                         │   │       ├─ name: movie_companies\n" +
			"                         │   │       └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS voicing_actress,
       MIN(t.title) AS jap_engl_voiced_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND n.gender ='f'
  AND rt.role ='actress'
  AND t.production_year > 2000
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mi.movie_id = ci.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as voicing_actress, min(t.title):1!null as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:8!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:12!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:15!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ t.production_year:2\n" +
			"         │   │   └─ 2000 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:18!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:14!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:20!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.gender:2\n" +
			"                 │   │   └─ f (longtext)\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ mc.movie_id:12!null\n" +
			"                     │   │   └─ mi.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ mi.movie_id:8!null\n" +
			"                     │       └─ ci.movie_id:15!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ it.id:10!null\n" +
			"                     │   │   └─ mi.info_type_id:9!null\n" +
			"                     │   ├─ TableAlias(mi)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_info\n" +
			"                     │   │           └─ columns: [movie_id info_type_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ Eq\n" +
			"                     │       │   ├─ it.info:1!null\n" +
			"                     │       │   └─ release dates (longtext)\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: info_type\n" +
			"                     │                   └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.id:21!null\n" +
			"                         │   └─ mc.company_id:13!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:12!null\n" +
			"                         │   │   └─ ci.movie_id:15!null\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ ProcessTable\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_companies\n" +
			"                         │   │           └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ Eq\n" +
			"                         │       │   │   ├─ chn.id:19!null\n" +
			"                         │       │   │   └─ ci.person_role_id:16\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ HashIn\n" +
			"                         │       │   │   │   ├─ ci.note:3\n" +
			"                         │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ ProcessTable\n" +
			"                         │       │   │           └─ Table\n" +
			"                         │       │   │               ├─ name: cast_info\n" +
			"                         │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ ProcessTable\n" +
			"                         │       │           └─ Table\n" +
			"                         │       │               ├─ name: char_name\n" +
			"                         │       │               └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ keys: [ci.person_id:14!null]\n" +
			"                         │               ├─ colSet: (1-8)\n" +
			"                         │               ├─ tableId: 1\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: aka_name\n" +
			"                         │                   └─ columns: [person_id]\n" +
			"                         └─ Filter\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.country_code:1\n" +
			"                             │   └─ [us] (longtext)\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ ProcessTable\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2000)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.gender = 'f')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ TableAlias(mi)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_info\n" +
			"                     │   │       └─ columns: [movie_id info_type_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ Table\n" +
			"                         │   │       ├─ name: movie_companies\n" +
			"                         │   │       └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as voicing_actress, min(t.title) as jap_engl_voiced_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2000)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.gender = 'f')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (it.id = mi.info_type_id)\n" +
			"                     │   ├─ TableAlias(mi)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_info\n" +
			"                     │   │       └─ columns: [movie_id info_type_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (it.info = 'release dates')\n" +
			"                     │       └─ TableAlias(it)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: info_type\n" +
			"                     │               └─ columns: [id info]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ (cn.id = mc.company_id)\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                         │   ├─ TableAlias(mc)\n" +
			"                         │   │   └─ Table\n" +
			"                         │   │       ├─ name: movie_companies\n" +
			"                         │   │       └─ columns: [movie_id company_id]\n" +
			"                         │   └─ LookupJoin\n" +
			"                         │       ├─ InnerJoin\n" +
			"                         │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                         │       │   ├─ Filter\n" +
			"                         │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                         │       │   │   └─ TableAlias(ci)\n" +
			"                         │       │   │       └─ Table\n" +
			"                         │       │   │           ├─ name: cast_info\n" +
			"                         │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                         │       │   └─ TableAlias(chn)\n" +
			"                         │       │       └─ Table\n" +
			"                         │       │           ├─ name: char_name\n" +
			"                         │       │           └─ columns: [id]\n" +
			"                         │       └─ TableAlias(an)\n" +
			"                         │           └─ IndexedTableAccess(aka_name)\n" +
			"                         │               ├─ index: [aka_name.person_id]\n" +
			"                         │               ├─ columns: [person_id]\n" +
			"                         │               └─ keys: ci.person_id\n" +
			"                         └─ Filter\n" +
			"                             ├─ (cn.country_code = '[us]')\n" +
			"                             └─ TableAlias(cn)\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_title,
       MIN(t.production_year) AS movie_year
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info_idx AS mi_idx,
     title AS t
WHERE ct.kind = 'production companies'
  AND it.info = 'top 250 rank'
  AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'
  AND (mc.note LIKE '%(co-production)%'
       OR mc.note LIKE '%(presents)%')
  AND ct.id = mc.company_type_id
  AND t.id = mc.movie_id
  AND t.id = mi_idx.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mc.note):0!null as production_note, min(t.title):2!null as movie_title, min(t.production_year):1!null as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mc.note:5), MIN(t.production_year:2), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi_idx.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ NOT\n" +
			"         │       │   │   └─ mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\n" +
			"         │       │   └─ Or\n" +
			"         │       │       ├─ mc.note LIKE '%(co-production)%'\n" +
			"         │       │       └─ mc.note LIKE '%(presents)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:8!null\n" +
			"             │   │   └─ mi_idx.info_type_id:7!null\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info_idx\n" +
			"             │   │           └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ top 250 rank (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%')) AND (mc.note LIKE '%(co-production)%' OR mc.note LIKE '%(presents)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'top 250 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%')) AND (mc.note LIKE '%(co-production)%' OR mc.note LIKE '%(presents)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'top 250 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_title,
       MIN(t.production_year) AS movie_year
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info_idx AS mi_idx,
     title AS t
WHERE ct.kind = 'production companies'
  AND it.info = 'bottom 10 rank'
  AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'
  AND t.production_year BETWEEN 2005 AND 2010
  AND ct.id = mc.company_type_id
  AND t.id = mc.movie_id
  AND t.id = mi_idx.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mc.note):0!null as production_note, min(t.title):2!null as movie_title, min(t.production_year):1!null as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mc.note:5), MIN(t.production_year:2), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi_idx.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ NOT\n" +
			"         │       │   └─ mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:8!null\n" +
			"             │   │   └─ mi_idx.info_type_id:7!null\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info_idx\n" +
			"             │   │           └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ bottom 10 rank (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'bottom 10 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'bottom 10 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_title,
       MIN(t.production_year) AS movie_year
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info_idx AS mi_idx,
     title AS t
WHERE ct.kind = 'production companies'
  AND it.info = 'top 250 rank'
  AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'
  AND (mc.note LIKE '%(co-production)%')
  AND t.production_year >2010
  AND ct.id = mc.company_type_id
  AND t.id = mc.movie_id
  AND t.id = mi_idx.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mc.note):0!null as production_note, min(t.title):2!null as movie_title, min(t.production_year):1!null as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mc.note:5), MIN(t.production_year:2), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi_idx.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ NOT\n" +
			"         │       │   │   └─ mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\n" +
			"         │       │   └─ mc.note LIKE '%(co-production)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:8!null\n" +
			"             │   │   └─ mi_idx.info_type_id:7!null\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info_idx\n" +
			"             │   │           └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ top 250 rank (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%')) AND mc.note LIKE '%(co-production)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'top 250 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%')) AND mc.note LIKE '%(co-production)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'top 250 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mc.note) AS production_note,
       MIN(t.title) AS movie_title,
       MIN(t.production_year) AS movie_year
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info_idx AS mi_idx,
     title AS t
WHERE ct.kind = 'production companies'
  AND it.info = 'bottom 10 rank'
  AND mc.note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'
  AND t.production_year >2000
  AND ct.id = mc.company_type_id
  AND t.id = mc.movie_id
  AND t.id = mi_idx.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mc.note):0!null as production_note, min(t.title):2!null as movie_title, min(t.production_year):1!null as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mc.note:5), MIN(t.production_year:2), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi_idx.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ NOT\n" +
			"         │       │   └─ mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:8!null\n" +
			"             │   │   └─ mi_idx.info_type_id:7!null\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info_idx\n" +
			"             │   │           └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ bottom 10 rank (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'bottom 10 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mc.note) as production_note, min(t.title) as movie_title, min(t.production_year) as movie_year]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mc.note), MIN(t.production_year), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (NOT(mc.note LIKE '%(as Metro-Goldwyn-Mayer Pictures)%'))\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi_idx.info_type_id)\n" +
			"             │   ├─ TableAlias(mi_idx)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_info_idx\n" +
			"             │   │       └─ columns: [movie_id info_type_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'bottom 10 rank')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS complete_downey_ironman_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     keyword AS k,
     kind_type AS kt,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name NOT LIKE '%Sherlock%'
  AND (chn.name LIKE '%Tony%Stark%'
       OR chn.name LIKE '%Iron%Man%')
  AND k.keyword IN ('superhero',
                    'sequel',
                    'second-part',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence')
  AND kt.kind = 'movie'
  AND t.production_year > 1950
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND ci.movie_id = cc.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:19!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:13!null\n" +
			"         │   │       └─ ci.movie_id:19!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:19!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:13!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   └─ 1950 (smallint)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ Eq\n" +
			"         │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │       │   └─ movie (longtext)\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: kind_type\n" +
			"         │   │                   └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:15!null\n" +
			"         │       │   └─ mk.keyword_id:14!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), sequel (longtext), second-part (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:17!null\n" +
			"             │   └─ ci.person_id:18!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:21!null\n" +
			"                 │   └─ ci.person_role_id:20\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ NOT\n" +
			"                     │   │   └─ chn.name LIKE '%Sherlock%'\n" +
			"                     │   └─ Or\n" +
			"                     │       ├─ chn.name LIKE '%Tony%Stark%'\n" +
			"                     │       └─ chn.name LIKE '%Iron%Man%'\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: char_name\n" +
			"                                 └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 1950)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name LIKE '%Sherlock%')) AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 1950)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name LIKE '%Sherlock%')) AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS complete_downey_ironman_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     keyword AS k,
     kind_type AS kt,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name NOT LIKE '%Sherlock%'
  AND (chn.name LIKE '%Tony%Stark%'
       OR chn.name LIKE '%Iron%Man%')
  AND k.keyword IN ('superhero',
                    'sequel',
                    'second-part',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence')
  AND kt.kind = 'movie'
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND ci.movie_id = cc.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:20!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:13!null\n" +
			"         │   │       └─ ci.movie_id:20!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:20!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:13!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ Eq\n" +
			"         │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │       │   └─ movie (longtext)\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: kind_type\n" +
			"         │   │                   └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:15!null\n" +
			"         │       │   └─ mk.keyword_id:14!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), sequel (longtext), second-part (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:17!null\n" +
			"             │   └─ ci.person_id:19!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:22!null\n" +
			"                 │   └─ ci.person_role_id:21\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ NOT\n" +
			"                     │   │   └─ chn.name LIKE '%Sherlock%'\n" +
			"                     │   └─ Or\n" +
			"                     │       ├─ chn.name LIKE '%Tony%Stark%'\n" +
			"                     │       └─ chn.name LIKE '%Iron%Man%'\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: char_name\n" +
			"                                 └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name LIKE '%Sherlock%')) AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as complete_downey_ironman_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name LIKE '%Sherlock%')) AND (chn.name LIKE '%Tony%Stark%' OR chn.name LIKE '%Iron%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS cast_member,
       MIN(t.title) AS complete_dynamic_hero_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     keyword AS k,
     kind_type AS kt,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name IS NOT NULL
  AND (chn.name LIKE '%man%'
       OR chn.name LIKE '%Man%')
  AND k.keyword IN ('superhero',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence',
                    'magnet',
                    'web',
                    'claw',
                    'laser')
  AND kt.kind = 'movie'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND ci.movie_id = cc.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as cast_member, min(t.title):1!null as complete_dynamic_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:18!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:20!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:13!null\n" +
			"         │   │       └─ ci.movie_id:20!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:20!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:13!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ Eq\n" +
			"         │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │       │   └─ movie (longtext)\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: kind_type\n" +
			"         │   │                   └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:15!null\n" +
			"         │       │   └─ mk.keyword_id:14!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext), magnet (longtext), web (longtext), claw (longtext), laser (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:17!null\n" +
			"             │   └─ ci.person_id:19!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ chn.id:22!null\n" +
			"                 │   └─ ci.person_role_id:21\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: cast_info\n" +
			"                 │           └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ NOT\n" +
			"                     │   │   └─ chn.name:1!null IS NULL\n" +
			"                     │   └─ Or\n" +
			"                     │       ├─ chn.name LIKE '%man%'\n" +
			"                     │       └─ chn.name LIKE '%Man%'\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: char_name\n" +
			"                                 └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as cast_member, min(t.title) as complete_dynamic_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as cast_member, min(t.title) as complete_dynamic_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ci.movie_id = cc.movie_id) AND (mk.movie_id = ci.movie_id)) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   ├─ Filter\n" +
			"         │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │       └─ InnerJoin\n" +
			"         │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │           ├─ Filter\n" +
			"         │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │           │       └─ Table\n" +
			"         │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   └─ Filter\n" +
			"         │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │       └─ TableAlias(kt)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: kind_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id name]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (chn.id = ci.person_role_id)\n" +
			"                 ├─ TableAlias(ci)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: cast_info\n" +
			"                 │       └─ columns: [person_id movie_id person_role_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"                     └─ TableAlias(chn)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: char_name\n" +
			"                             └─ columns: [id name]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS company_name,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS western_follow_up
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German')
  AND t.production_year BETWEEN 1950 AND 2000
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as company_name, min(lt.link):1!null as link_type, min(t.title):2!null as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:8!null), MIN(lt.link:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ mc.movie_id:3!null\n" +
			"         │   │   │   │   │   │   └─ mi.movie_id:20!null\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ mk.movie_id:16!null\n" +
			"         │   │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │       └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mi.movie_id:20!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 1950 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2000 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ mc.company_type_id:5!null\n" +
			"         │       │   └─ ct.id:10!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ mc.company_id:4!null\n" +
			"         │       │   │   └─ cn.id:7!null\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note:3 IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ ProcessTable\n" +
			"         │       │   │           └─ Table\n" +
			"         │       │   │               ├─ name: movie_companies\n" +
			"         │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ AND\n" +
			"         │       │       │   ├─ NOT\n" +
			"         │       │       │   │   └─ Eq\n" +
			"         │       │       │   │       ├─ cn.country_code:2\n" +
			"         │       │       │   │       └─ [pl] (longtext)\n" +
			"         │       │       │   └─ Or\n" +
			"         │       │       │       ├─ cn.name LIKE '%Film%'\n" +
			"         │       │       │       └─ cn.name LIKE '%Warner%'\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ct.kind:1!null\n" +
			"         │           │   └─ production companies (longtext)\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: company_type\n" +
			"         │                       └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ ml.movie_id:12!null\n" +
			"             │   │   └─ mk.movie_id:16!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ lt.id:14!null\n" +
			"             │   │   │   └─ ml.link_type_id:13!null\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_link\n" +
			"             │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: link_type\n" +
			"             │   │                   └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ mk.keyword_id:17!null\n" +
			"             │       │   └─ k.id:18!null\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ ProcessTable\n" +
			"             │       │       └─ Table\n" +
			"             │       │           ├─ name: movie_keyword\n" +
			"             │       │           └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ k.keyword:1!null\n" +
			"             │           │   └─ sequel (longtext)\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ ProcessTable\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: keyword\n" +
			"             │                       └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:1!null\n" +
			"                 │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ keys: [mk.movie_id:16!null]\n" +
			"                         ├─ colSet: (20-24)\n" +
			"                         ├─ tableId: 6\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS company_name,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS german_follow_up
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Germany',
                  'German')
  AND t.production_year BETWEEN 2000 AND 2010
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as company_name, min(lt.link):1!null as link_type, min(t.title):2!null as german_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:8!null), MIN(lt.link:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ mc.movie_id:3!null\n" +
			"         │   │   │   │   │   │   └─ mi.movie_id:20!null\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ mk.movie_id:16!null\n" +
			"         │   │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │       └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mi.movie_id:20!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ mc.company_type_id:5!null\n" +
			"         │       │   └─ ct.id:10!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ mc.company_id:4!null\n" +
			"         │       │   │   └─ cn.id:7!null\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note:3 IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ ProcessTable\n" +
			"         │       │   │           └─ Table\n" +
			"         │       │   │               ├─ name: movie_companies\n" +
			"         │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ AND\n" +
			"         │       │       │   ├─ NOT\n" +
			"         │       │       │   │   └─ Eq\n" +
			"         │       │       │   │       ├─ cn.country_code:2\n" +
			"         │       │       │   │       └─ [pl] (longtext)\n" +
			"         │       │       │   └─ Or\n" +
			"         │       │       │       ├─ cn.name LIKE '%Film%'\n" +
			"         │       │       │       └─ cn.name LIKE '%Warner%'\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ct.kind:1!null\n" +
			"         │           │   └─ production companies (longtext)\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: company_type\n" +
			"         │                       └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ ml.movie_id:12!null\n" +
			"             │   │   └─ mk.movie_id:16!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ lt.id:14!null\n" +
			"             │   │   │   └─ ml.link_type_id:13!null\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_link\n" +
			"             │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: link_type\n" +
			"             │   │                   └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ mk.keyword_id:17!null\n" +
			"             │       │   └─ k.id:18!null\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ ProcessTable\n" +
			"             │       │       └─ Table\n" +
			"             │       │           ├─ name: movie_keyword\n" +
			"             │       │           └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ k.keyword:1!null\n" +
			"             │           │   └─ sequel (longtext)\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ ProcessTable\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: keyword\n" +
			"             │                       └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:1!null\n" +
			"                 │   └─ TUPLE(Germany (longtext), German (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ keys: [mk.movie_id:16!null]\n" +
			"                         ├─ colSet: (20-24)\n" +
			"                         ├─ tableId: 6\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as german_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Germany', 'German'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as german_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Germany', 'German'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS company_name,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS western_follow_up
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'English')
  AND t.production_year BETWEEN 1950 AND 2010
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as company_name, min(lt.link):1!null as link_type, min(t.title):2!null as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:8!null), MIN(lt.link:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ mc.movie_id:3!null\n" +
			"         │   │   │   │   │   │   └─ mi.movie_id:20!null\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ mk.movie_id:16!null\n" +
			"         │   │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │   │       └─ mc.movie_id:3!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ ml.movie_id:12!null\n" +
			"         │   │   │       └─ t.id:0!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mi.movie_id:20!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 1950 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ mc.company_type_id:5!null\n" +
			"         │       │   └─ ct.id:10!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ mc.company_id:4!null\n" +
			"         │       │   │   └─ cn.id:7!null\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note:3 IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ ProcessTable\n" +
			"         │       │   │           └─ Table\n" +
			"         │       │   │               ├─ name: movie_companies\n" +
			"         │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ AND\n" +
			"         │       │       │   ├─ NOT\n" +
			"         │       │       │   │   └─ Eq\n" +
			"         │       │       │   │       ├─ cn.country_code:2\n" +
			"         │       │       │   │       └─ [pl] (longtext)\n" +
			"         │       │       │   └─ Or\n" +
			"         │       │       │       ├─ cn.name LIKE '%Film%'\n" +
			"         │       │       │       └─ cn.name LIKE '%Warner%'\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ ct.kind:1!null\n" +
			"         │           │   └─ production companies (longtext)\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: company_type\n" +
			"         │                       └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ ml.movie_id:12!null\n" +
			"             │   │   └─ mk.movie_id:16!null\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ lt.id:14!null\n" +
			"             │   │   │   └─ ml.link_type_id:13!null\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ ProcessTable\n" +
			"             │   │   │       └─ Table\n" +
			"             │   │   │           ├─ name: movie_link\n" +
			"             │   │   │           └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ ProcessTable\n" +
			"             │   │               └─ Table\n" +
			"             │   │                   ├─ name: link_type\n" +
			"             │   │                   └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ mk.keyword_id:17!null\n" +
			"             │       │   └─ k.id:18!null\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ ProcessTable\n" +
			"             │       │       └─ Table\n" +
			"             │       │           ├─ name: movie_keyword\n" +
			"             │       │           └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ Eq\n" +
			"             │           │   ├─ k.keyword:1!null\n" +
			"             │           │   └─ sequel (longtext)\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ ProcessTable\n" +
			"             │                   └─ Table\n" +
			"             │                       ├─ name: keyword\n" +
			"             │                       └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ mi.info:1!null\n" +
			"                 │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), English (longtext))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ keys: [mk.movie_id:16!null]\n" +
			"                         ├─ colSet: (20-24)\n" +
			"                         ├─ tableId: 6\n" +
			"                         └─ Table\n" +
			"                             ├─ name: movie_info\n" +
			"                             └─ columns: [movie_id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 1950) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as company_name, min(lt.link) as link_type, min(t.title) as western_follow_up]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((((mc.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (ml.movie_id = mc.movie_id)) AND (ml.movie_id = t.id)) AND (t.id = mk.movie_id)) AND (mi.movie_id = t.id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t.production_year >= 1950) AND (t.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (mc.company_type_id = ct.id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (mc.company_id = cn.id)\n" +
			"         │       │   ├─ Filter\n" +
			"         │       │   │   ├─ mc.note IS NULL\n" +
			"         │       │   │   └─ TableAlias(mc)\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id name country_code]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (ct.kind = 'production companies')\n" +
			"         │           └─ TableAlias(ct)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ LookupJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"             │   ├─ InnerJoin\n" +
			"             │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"             │   │   ├─ TableAlias(ml)\n" +
			"             │   │   │   └─ Table\n" +
			"             │   │   │       ├─ name: movie_link\n" +
			"             │   │   │       └─ columns: [movie_id link_type_id]\n" +
			"             │   │   └─ Filter\n" +
			"             │   │       ├─ lt.link LIKE '%follow%'\n" +
			"             │   │       └─ TableAlias(lt)\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: link_type\n" +
			"             │   │               └─ columns: [id link]\n" +
			"             │   └─ InnerJoin\n" +
			"             │       ├─ (mk.keyword_id = k.id)\n" +
			"             │       ├─ TableAlias(mk)\n" +
			"             │       │   └─ Table\n" +
			"             │       │       ├─ name: movie_keyword\n" +
			"             │       │       └─ columns: [movie_id keyword_id]\n" +
			"             │       └─ Filter\n" +
			"             │           ├─ (k.keyword = 'sequel')\n" +
			"             │           └─ TableAlias(k)\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English'))\n" +
			"                 └─ TableAlias(mi)\n" +
			"                     └─ IndexedTableAccess(movie_info)\n" +
			"                         ├─ index: [movie_info.movie_id]\n" +
			"                         ├─ columns: [movie_id info]\n" +
			"                         └─ keys: mk.movie_id\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS western_violent_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Germany',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '7.0'
  AND t.production_year > 2008
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(mi_idx.info:16!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:24!null\n" +
			"         │   │   │   │   └─ mi.movie_id:19!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │       └─ mc.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:24!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:19!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi.movie_id:19!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mi.movie_id:19!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:14!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:4!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2008 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ ct.id:13!null\n" +
			"         │   │   │       │   └─ mc.company_type_id:8!null\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ cn.id:10!null\n" +
			"         │   │   │       │   │   └─ mc.company_id:7!null\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ AND\n" +
			"         │   │   │       │   │   │   ├─ NOT\n" +
			"         │   │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ ProcessTable\n" +
			"         │   │   │       │   │           └─ Table\n" +
			"         │   │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ NOT\n" +
			"         │   │   │       │       │   └─ Eq\n" +
			"         │   │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ ProcessTable\n" +
			"         │   │   │       │               └─ Table\n" +
			"         │   │   │       │                   ├─ name: company_name\n" +
			"         │   │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: company_type\n" +
			"         │   │   │                   └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it2.id:17!null\n" +
			"         │   │       │   └─ mi_idx.info_type_id:15!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ LessThan\n" +
			"         │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │       │   │   └─ 7.0 (longtext)\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it2.info:1!null\n" +
			"         │   │           │   └─ rating (longtext)\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ it1.id:22!null\n" +
			"         │       │   └─ mi.info_type_id:20!null\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ HashIn\n" +
			"         │       │   │   ├─ mi.info:2!null\n" +
			"         │       │   │   └─ TUPLE(Germany (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ ProcessTable\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: movie_info\n" +
			"         │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ it1.info:1!null\n" +
			"         │           │   └─ countries (longtext)\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   ├─ columns: [id info]\n" +
			"         │                   ├─ colSet: (10,11)\n" +
			"         │                   └─ tableId: 3\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:26!null\n" +
			"             │   └─ mk.keyword_id:25!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ k.keyword:1!null\n" +
			"                 │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2008)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '7.0')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Germany', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2008)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '7.0')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Germany', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS western_violent_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Germany',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '7.0'
  AND t.production_year > 2009
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(mi_idx.info:16!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:24!null\n" +
			"         │   │   │   │   └─ mi.movie_id:19!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │       └─ mc.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:24!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:19!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi.movie_id:19!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mi.movie_id:19!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:14!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:4!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2009 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ ct.id:13!null\n" +
			"         │   │   │       │   └─ mc.company_type_id:8!null\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ cn.id:10!null\n" +
			"         │   │   │       │   │   └─ mc.company_id:7!null\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ AND\n" +
			"         │   │   │       │   │   │   ├─ NOT\n" +
			"         │   │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ ProcessTable\n" +
			"         │   │   │       │   │           └─ Table\n" +
			"         │   │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ NOT\n" +
			"         │   │   │       │       │   └─ Eq\n" +
			"         │   │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ ProcessTable\n" +
			"         │   │   │       │               └─ Table\n" +
			"         │   │   │       │                   ├─ name: company_name\n" +
			"         │   │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: company_type\n" +
			"         │   │   │                   └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it2.id:17!null\n" +
			"         │   │       │   └─ mi_idx.info_type_id:15!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ LessThan\n" +
			"         │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │       │   │   └─ 7.0 (longtext)\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it2.info:1!null\n" +
			"         │   │           │   └─ rating (longtext)\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ it1.id:22!null\n" +
			"         │       │   └─ mi.info_type_id:20!null\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ HashIn\n" +
			"         │       │   │   ├─ mi.info:2!null\n" +
			"         │       │   │   └─ TUPLE(Germany (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ ProcessTable\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: movie_info\n" +
			"         │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ it1.info:1!null\n" +
			"         │           │   └─ countries (longtext)\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   ├─ columns: [id info]\n" +
			"         │                   ├─ colSet: (10,11)\n" +
			"         │                   └─ tableId: 3\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:26!null\n" +
			"             │   └─ mk.keyword_id:25!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ k.keyword:1!null\n" +
			"                 │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2009)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '7.0')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Germany', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2009)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '7.0')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Germany', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS western_violent_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Danish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(mi_idx.info:16!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:24!null\n" +
			"         │   │   │   │   └─ mi.movie_id:19!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:24!null\n" +
			"         │   │       └─ mc.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:24!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:19!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi.movie_id:19!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mi.movie_id:19!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:14!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:14!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:4!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ ct.id:13!null\n" +
			"         │   │   │       │   └─ mc.company_type_id:8!null\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ cn.id:10!null\n" +
			"         │   │   │       │   │   └─ mc.company_id:7!null\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ AND\n" +
			"         │   │   │       │   │   │   ├─ NOT\n" +
			"         │   │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ ProcessTable\n" +
			"         │   │   │       │   │           └─ Table\n" +
			"         │   │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ NOT\n" +
			"         │   │   │       │       │   └─ Eq\n" +
			"         │   │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ ProcessTable\n" +
			"         │   │   │       │               └─ Table\n" +
			"         │   │   │       │                   ├─ name: company_name\n" +
			"         │   │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: company_type\n" +
			"         │   │   │                   └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it2.id:17!null\n" +
			"         │   │       │   └─ mi_idx.info_type_id:15!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ LessThan\n" +
			"         │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │       │   │   └─ 8.5 (longtext)\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it2.info:1!null\n" +
			"         │   │           │   └─ rating (longtext)\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ it1.id:22!null\n" +
			"         │       │   └─ mi.info_type_id:20!null\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ HashIn\n" +
			"         │       │   │   ├─ mi.info:2!null\n" +
			"         │       │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Danish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ ProcessTable\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: movie_info\n" +
			"         │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ it1.info:1!null\n" +
			"         │           │   └─ countries (longtext)\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   ├─ columns: [id info]\n" +
			"         │                   ├─ colSet: (10,11)\n" +
			"         │                   └─ tableId: 3\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:26!null\n" +
			"             │   └─ mk.keyword_id:25!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ k.keyword:1!null\n" +
			"                 │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '8.5')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ Filter\n" +
			"         │   │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '8.5')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS western_violent_movie
FROM company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Danish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:10!null), MIN(mi_idx.info:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │   └─ mi.movie_id:18!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │       └─ mc.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:23!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:18!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi.movie_id:18!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mi.movie_id:18!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mc.movie_id:6!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:13!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mc.movie_id:6!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:4!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ ct.id:12!null\n" +
			"         │   │   │       │   └─ mc.company_type_id:8!null\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ cn.id:9!null\n" +
			"         │   │   │       │   │   └─ mc.company_id:7!null\n" +
			"         │   │   │       │   ├─ TableAlias(mc)\n" +
			"         │   │   │       │   │   └─ ProcessTable\n" +
			"         │   │   │       │   │       └─ Table\n" +
			"         │   │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │   │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ NOT\n" +
			"         │   │   │       │       │   └─ Eq\n" +
			"         │   │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ ProcessTable\n" +
			"         │   │   │       │               └─ Table\n" +
			"         │   │   │       │                   ├─ name: company_name\n" +
			"         │   │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: company_type\n" +
			"         │   │   │                   └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it2.id:16!null\n" +
			"         │   │       │   └─ mi_idx.info_type_id:14!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ LessThan\n" +
			"         │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │       │   │   └─ 8.5 (longtext)\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it2.info:1!null\n" +
			"         │   │           │   └─ rating (longtext)\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ it1.id:21!null\n" +
			"         │       │   └─ mi.info_type_id:19!null\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ HashIn\n" +
			"         │       │   │   ├─ mi.info:2!null\n" +
			"         │       │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Danish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ ProcessTable\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: movie_info\n" +
			"         │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ it1.info:1!null\n" +
			"         │           │   └─ countries (longtext)\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   ├─ columns: [id info]\n" +
			"         │                   ├─ colSet: (10,11)\n" +
			"         │                   └─ tableId: 3\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:25!null\n" +
			"             │   └─ mk.keyword_id:24!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ k.keyword:1!null\n" +
			"                 │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ TableAlias(mc)\n" +
			"         │   │   │       │   │   └─ Table\n" +
			"         │   │   │       │   │       ├─ name: movie_companies\n" +
			"         │   │   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '8.5')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as western_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mi_idx.movie_id)) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mc.movie_id = mi_idx.movie_id) AND (t.id = mi_idx.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mc.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │   │       ├─ InnerJoin\n" +
			"         │   │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │   │       │   ├─ TableAlias(mc)\n" +
			"         │   │   │       │   │   └─ Table\n" +
			"         │   │   │       │   │       ├─ name: movie_companies\n" +
			"         │   │   │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │   │   │       │   └─ Filter\n" +
			"         │   │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │   │       │       └─ TableAlias(cn)\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: company_name\n" +
			"         │   │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │   │       └─ TableAlias(ct)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: company_type\n" +
			"         │   │   │               └─ columns: [id]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi_idx.info < '8.5')\n" +
			"         │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │           └─ TableAlias(it2)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │       ├─ Filter\n" +
			"         │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       │   └─ TableAlias(mi)\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_info\n" +
			"         │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (it1.info = 'countries')\n" +
			"         │           └─ TableAlias(it1)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: info_type\n" +
			"         │                   └─ columns: [id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(kt.kind) AS movie_kind,
       MIN(t.title) AS complete_us_internet_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'complete+verified'
  AND cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND kt.kind IN ('movie')
  AND mi.note LIKE '%internet%'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'USA:% 199%'
       OR mi.info LIKE 'USA:% 200%')
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND cct1.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(kt.kind):0!null as movie_kind, min(t.title):1!null as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(kt.kind:9!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:22!null\n" +
			"         │   │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │   │       └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │       └─ cc.movie_id:6\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:22!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:16!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ kt.id:8!null\n" +
			"         │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   └─ cc.movie_id:6\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │       │   └─ cc.status_id:7!null\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ Eq\n" +
			"         │   │   │   │       │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │       │   │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │                   └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ HashIn\n" +
			"         │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │       │   └─ TUPLE(movie (longtext))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it1.id:14!null\n" +
			"         │   │       │   └─ mi.info_type_id:11!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ AND\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │   │       │   │   │   └─ NOT\n" +
			"         │   │       │   │   │       └─ mi.info:2!null IS NULL\n" +
			"         │   │       │   │   └─ Or\n" +
			"         │   │       │   │       ├─ mi.info LIKE 'USA:% 199%'\n" +
			"         │   │       │   │       └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.info:1!null\n" +
			"         │   │           │   └─ release dates (longtext)\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:21!null\n" +
			"         │       │   └─ mc.company_type_id:18!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:19!null\n" +
			"         │       │   │   └─ mc.company_id:17!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [us] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:24!null\n" +
			"             │   └─ mk.keyword_id:23!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: keyword\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: keyword\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(kt.kind) AS movie_kind,
       MIN(t.title) AS complete_nerdy_internet_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'complete+verified'
  AND cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND k.keyword IN ('nerd',
                    'loner',
                    'alienation',
                    'dignity')
  AND kt.kind IN ('movie')
  AND mi.note LIKE '%internet%'
  AND mi.info LIKE 'USA:% 200%'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND cct1.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(kt.kind):0!null as movie_kind, min(t.title):1!null as complete_nerdy_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(kt.kind:9!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:22!null\n" +
			"         │   │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │   │       └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │       └─ cc.movie_id:6\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:22!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:16!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ kt.id:8!null\n" +
			"         │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   └─ cc.movie_id:6\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │       │   └─ cc.status_id:7!null\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ Eq\n" +
			"         │   │   │   │       │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │       │   │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │                   └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ HashIn\n" +
			"         │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │       │   └─ TUPLE(movie (longtext))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it1.id:14!null\n" +
			"         │   │       │   └─ mi.info_type_id:11!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ AND\n" +
			"         │   │       │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │   │       │   │   └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.info:1!null\n" +
			"         │   │           │   └─ release dates (longtext)\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:21!null\n" +
			"         │       │   └─ mc.company_type_id:18!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:19!null\n" +
			"         │       │   │   └─ mc.company_id:17!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [us] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:24!null\n" +
			"             │   └─ mk.keyword_id:23!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ HashIn\n" +
			"                 │   ├─ k.keyword:1!null\n" +
			"                 │   └─ TUPLE(nerd (longtext), loner (longtext), alienation (longtext), dignity (longtext))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_nerdy_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('nerd', 'loner', 'alienation', 'dignity'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_nerdy_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ (mi.note LIKE '%internet%' AND mi.info LIKE 'USA:% 200%')\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (k.keyword HASH IN ('nerd', 'loner', 'alienation', 'dignity'))\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(kt.kind) AS movie_kind,
       MIN(t.title) AS complete_us_internet_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'complete+verified'
  AND cn.country_code = '[us]'
  AND it1.info = 'release dates'
  AND kt.kind IN ('movie',
                  'tv movie',
                  'video movie',
                  'video game')
  AND mi.note LIKE '%internet%'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'USA:% 199%'
       OR mi.info LIKE 'USA:% 200%')
  AND t.production_year > 1990
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND cn.id = mc.company_id
  AND ct.id = mc.company_type_id
  AND cct1.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(kt.kind):0!null as movie_kind, min(t.title):1!null as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(kt.kind:9!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:22!null\n" +
			"         │   │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │   │       └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:22!null\n" +
			"         │   │       └─ cc.movie_id:6\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:22!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ mi.movie_id:10!null\n" +
			"         │   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mc.movie_id:16!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   └─ mi.movie_id:10!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ kt.id:8!null\n" +
			"         │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   └─ cc.movie_id:6\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   └─ 1990 (smallint)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │       │   └─ cc.status_id:7!null\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ Eq\n" +
			"         │   │   │   │       │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │       │   │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │                   └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ HashIn\n" +
			"         │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │       │   └─ TUPLE(movie (longtext), tv movie (longtext), video movie (longtext), video game (longtext))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ it1.id:14!null\n" +
			"         │   │       │   └─ mi.info_type_id:11!null\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ AND\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ mi.note LIKE '%internet%'\n" +
			"         │   │       │   │   │   └─ NOT\n" +
			"         │   │       │   │   │       └─ mi.info:2!null IS NULL\n" +
			"         │   │       │   │   └─ Or\n" +
			"         │   │       │   │       ├─ mi.info LIKE 'USA:% 199%'\n" +
			"         │   │       │   │       └─ mi.info LIKE 'USA:% 200%'\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ ProcessTable\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: movie_info\n" +
			"         │   │       │               └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ Eq\n" +
			"         │   │           │   ├─ it1.info:1!null\n" +
			"         │   │           │   └─ release dates (longtext)\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: info_type\n" +
			"         │   │                       └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ ct.id:21!null\n" +
			"         │       │   └─ mc.company_type_id:18!null\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ Eq\n" +
			"         │       │   │   ├─ cn.id:19!null\n" +
			"         │       │   │   └─ mc.company_id:17!null\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ ProcessTable\n" +
			"         │       │   │       └─ Table\n" +
			"         │       │   │           ├─ name: movie_companies\n" +
			"         │       │   │           └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ Eq\n" +
			"         │       │       │   ├─ cn.country_code:1\n" +
			"         │       │       │   └─ [us] (longtext)\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ ProcessTable\n" +
			"         │       │               └─ Table\n" +
			"         │       │                   ├─ name: company_name\n" +
			"         │       │                   └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: company_type\n" +
			"         │                   └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:24!null\n" +
			"             │   └─ mk.keyword_id:23!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie', 'tv movie', 'video movie', 'video game'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: keyword\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(kt.kind) as movie_kind, min(t.title) as complete_us_internet_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(kt.kind), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │       ├─ (cct1.id = cc.status_id)\n" +
			"         │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │       │   ├─ (cct1.kind = 'complete+verified')\n" +
			"         │   │   │   │       │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │       └─ TableAlias(cc)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │               └─ columns: [movie_id status_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ (kt.kind HASH IN ('movie', 'tv movie', 'video movie', 'video game'))\n" +
			"         │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: kind_type\n" +
			"         │   │   │               └─ columns: [id kind]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │       ├─ Filter\n" +
			"         │   │       │   ├─ ((mi.note LIKE '%internet%' AND (NOT(mi.info IS NULL))) AND (mi.info LIKE 'USA:% 199%' OR mi.info LIKE 'USA:% 200%'))\n" +
			"         │   │       │   └─ TableAlias(mi)\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: movie_info\n" +
			"         │   │       │           └─ columns: [movie_id info_type_id info note]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ (it1.info = 'release dates')\n" +
			"         │   │           └─ TableAlias(it1)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: info_type\n" +
			"         │   │                   └─ columns: [id info]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │       ├─ InnerJoin\n" +
			"         │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │       │   ├─ TableAlias(mc)\n" +
			"         │       │   │   └─ Table\n" +
			"         │       │   │       ├─ name: movie_companies\n" +
			"         │       │   │       └─ columns: [movie_id company_id company_type_id]\n" +
			"         │       │   └─ Filter\n" +
			"         │       │       ├─ (cn.country_code = '[us]')\n" +
			"         │       │       └─ TableAlias(cn)\n" +
			"         │       │           └─ Table\n" +
			"         │       │               ├─ name: company_name\n" +
			"         │       │               └─ columns: [id country_code]\n" +
			"         │       └─ TableAlias(ct)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: company_type\n" +
			"         │               └─ columns: [id]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ TableAlias(k)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: keyword\n" +
			"                     └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS voiced_char_name,
       MIN(n.name) AS voicing_actress_name,
       MIN(t.title) AS voiced_action_movie_jap_eng
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND k.keyword IN ('hero',
                    'martial-arts',
                    'hand-to-hand-combat')
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%201%'
       OR mi.info LIKE 'USA:%201%')
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.production_year > 2010
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mk.movie_id
  AND mi.movie_id = ci.movie_id
  AND mi.movie_id = mk.movie_id
  AND ci.movie_id = mk.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as voiced_char_name, min(n.name):1!null as voicing_actress_name, min(t.title):2!null as voiced_action_movie_jap_eng]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:25!null), MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi.movie_id:12!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mc.movie_id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ ci.movie_id:20!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ GreaterThan\n" +
			"         │   │   ├─ t.production_year:2\n" +
			"         │   │   └─ 2010 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:23!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:19!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:26!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%An%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ AND\n" +
			"                     │   │   ├─ Eq\n" +
			"                     │   │   │   ├─ mc.movie_id:17!null\n" +
			"                     │   │   │   └─ mk.movie_id:8!null\n" +
			"                     │   │   └─ Eq\n" +
			"                     │   │       ├─ mi.movie_id:12!null\n" +
			"                     │   │       └─ mk.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ ci.movie_id:20!null\n" +
			"                     │       └─ mk.movie_id:8!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ k.id:10!null\n" +
			"                     │   │   └─ mk.keyword_id:9!null\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_keyword\n" +
			"                     │   │           └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ HashIn\n" +
			"                     │       │   ├─ k.keyword:1!null\n" +
			"                     │       │   └─ TUPLE(hero (longtext), martial-arts (longtext), hand-to-hand-combat (longtext))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: keyword\n" +
			"                     │                   └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:17!null\n" +
			"                         │   │   └─ mi.movie_id:12!null\n" +
			"                         │   └─ Eq\n" +
			"                         │       ├─ mi.movie_id:12!null\n" +
			"                         │       └─ ci.movie_id:20!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ it.id:15!null\n" +
			"                         │   │   └─ mi.info_type_id:13!null\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ AND\n" +
			"                         │   │   │   ├─ NOT\n" +
			"                         │   │   │   │   └─ mi.info:2!null IS NULL\n" +
			"                         │   │   │   └─ Or\n" +
			"                         │   │   │       ├─ mi.info LIKE 'Japan:%201%'\n" +
			"                         │   │   │       └─ mi.info LIKE 'USA:%201%'\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ ProcessTable\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: movie_info\n" +
			"                         │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it.info:1!null\n" +
			"                         │       │   └─ release dates (longtext)\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ ProcessTable\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.id:27!null\n" +
			"                             │   └─ mc.company_id:18!null\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ Eq\n" +
			"                             │   │   ├─ mc.movie_id:17!null\n" +
			"                             │   │   └─ ci.movie_id:20!null\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ ProcessTable\n" +
			"                             │   │       └─ Table\n" +
			"                             │   │           ├─ name: movie_companies\n" +
			"                             │   │           └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ Eq\n" +
			"                             │       │   │   ├─ chn.id:24!null\n" +
			"                             │       │   │   └─ ci.person_role_id:21\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ HashIn\n" +
			"                             │       │   │   │   ├─ ci.note:3\n" +
			"                             │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ ProcessTable\n" +
			"                             │       │   │           └─ Table\n" +
			"                             │       │   │               ├─ name: cast_info\n" +
			"                             │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ ProcessTable\n" +
			"                             │       │           └─ Table\n" +
			"                             │       │               ├─ name: char_name\n" +
			"                             │       │               └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ keys: [ci.person_id:19!null]\n" +
			"                             │               ├─ colSet: (1-8)\n" +
			"                             │               ├─ tableId: 1\n" +
			"                             │               └─ Table\n" +
			"                             │                   ├─ name: aka_name\n" +
			"                             │                   └─ columns: [person_id]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ cn.country_code:1\n" +
			"                                 │   └─ [us] (longtext)\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ ProcessTable\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: company_name\n" +
			"                                             └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char_name, min(n.name) as voicing_actress_name, min(t.title) as voiced_action_movie_jap_eng]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2010)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (k.id = mk.keyword_id)\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_keyword\n" +
			"                     │   │       └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (k.keyword HASH IN ('hero', 'martial-arts', 'hand-to-hand-combat'))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: keyword\n" +
			"                     │               └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (it.id = mi.info_type_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%'))\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_info\n" +
			"                         │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (it.info = 'release dates')\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: info_type\n" +
			"                         │               └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ (cn.id = mc.company_id)\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ Table\n" +
			"                             │   │       ├─ name: movie_companies\n" +
			"                             │   │       └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ Table\n" +
			"                             │       │   │           ├─ name: cast_info\n" +
			"                             │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ Table\n" +
			"                             │       │           ├─ name: char_name\n" +
			"                             │       │           └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ columns: [person_id]\n" +
			"                             │               └─ keys: ci.person_id\n" +
			"                             └─ Filter\n" +
			"                                 ├─ (cn.country_code = '[us]')\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char_name, min(n.name) as voicing_actress_name, min(t.title) as voiced_action_movie_jap_eng]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (t.production_year > 2010)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (k.id = mk.keyword_id)\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_keyword\n" +
			"                     │   │       └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (k.keyword HASH IN ('hero', 'martial-arts', 'hand-to-hand-combat'))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: keyword\n" +
			"                     │               └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (it.id = mi.info_type_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%'))\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_info\n" +
			"                         │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (it.info = 'release dates')\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: info_type\n" +
			"                         │               └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ (cn.id = mc.company_id)\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ Table\n" +
			"                             │   │       ├─ name: movie_companies\n" +
			"                             │   │       └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ Table\n" +
			"                             │       │   │           ├─ name: cast_info\n" +
			"                             │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ Table\n" +
			"                             │       │           ├─ name: char_name\n" +
			"                             │       │           └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ columns: [person_id]\n" +
			"                             │               └─ keys: ci.person_id\n" +
			"                             └─ Filter\n" +
			"                                 ├─ (cn.country_code = '[us]')\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS voiced_char_name,
       MIN(n.name) AS voicing_actress_name,
       MIN(t.title) AS kung_fu_panda
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND cn.name = 'DreamWorks Animation'
  AND it.info = 'release dates'
  AND k.keyword IN ('hero',
                    'martial-arts',
                    'hand-to-hand-combat',
                    'computer-animated-movie')
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%201%'
       OR mi.info LIKE 'USA:%201%')
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.production_year > 2010
  AND t.title LIKE 'Kung Fu Panda%'
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mk.movie_id
  AND mi.movie_id = ci.movie_id
  AND mi.movie_id = mk.movie_id
  AND ci.movie_id = mk.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as voiced_char_name, min(n.name):1!null as voicing_actress_name, min(t.title):2!null as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:25!null), MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi.movie_id:12!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mc.movie_id:17!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ ci.movie_id:20!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   │   └─ GreaterThanOrEqual\n" +
			"         │   │   │       ├─ t.title:1!null\n" +
			"         │   │   │       └─ Kung Fu Panda (longtext)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.title:1!null\n" +
			"         │   │       └─ Kung Fu Pandaÿ (longtext)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ rt.id:3!null\n" +
			"             │   └─ ci.role_id:23!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:19!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ an.person_id:26!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%An%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ AND\n" +
			"                     │   ├─ AND\n" +
			"                     │   │   ├─ Eq\n" +
			"                     │   │   │   ├─ mc.movie_id:17!null\n" +
			"                     │   │   │   └─ mk.movie_id:8!null\n" +
			"                     │   │   └─ Eq\n" +
			"                     │   │       ├─ mi.movie_id:12!null\n" +
			"                     │   │       └─ mk.movie_id:8!null\n" +
			"                     │   └─ Eq\n" +
			"                     │       ├─ ci.movie_id:20!null\n" +
			"                     │       └─ mk.movie_id:8!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ k.id:10!null\n" +
			"                     │   │   └─ mk.keyword_id:9!null\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_keyword\n" +
			"                     │   │           └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ HashIn\n" +
			"                     │       │   ├─ k.keyword:1!null\n" +
			"                     │       │   └─ TUPLE(hero (longtext), martial-arts (longtext), hand-to-hand-combat (longtext), computer-animated-movie (longtext))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ ProcessTable\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: keyword\n" +
			"                     │                   └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ AND\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ mc.movie_id:17!null\n" +
			"                         │   │   └─ mi.movie_id:12!null\n" +
			"                         │   └─ Eq\n" +
			"                         │       ├─ mi.movie_id:12!null\n" +
			"                         │       └─ ci.movie_id:20!null\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ Eq\n" +
			"                         │   │   ├─ it.id:15!null\n" +
			"                         │   │   └─ mi.info_type_id:13!null\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ AND\n" +
			"                         │   │   │   ├─ NOT\n" +
			"                         │   │   │   │   └─ mi.info:2!null IS NULL\n" +
			"                         │   │   │   └─ Or\n" +
			"                         │   │   │       ├─ mi.info LIKE 'Japan:%201%'\n" +
			"                         │   │   │       └─ mi.info LIKE 'USA:%201%'\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ ProcessTable\n" +
			"                         │   │           └─ Table\n" +
			"                         │   │               ├─ name: movie_info\n" +
			"                         │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ Eq\n" +
			"                         │       │   ├─ it.info:1!null\n" +
			"                         │       │   └─ release dates (longtext)\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ ProcessTable\n" +
			"                         │               └─ Table\n" +
			"                         │                   ├─ name: info_type\n" +
			"                         │                   └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ Eq\n" +
			"                             │   ├─ cn.id:27!null\n" +
			"                             │   └─ mc.company_id:18!null\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ Eq\n" +
			"                             │   │   ├─ mc.movie_id:17!null\n" +
			"                             │   │   └─ ci.movie_id:20!null\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ ProcessTable\n" +
			"                             │   │       └─ Table\n" +
			"                             │   │           ├─ name: movie_companies\n" +
			"                             │   │           └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ Eq\n" +
			"                             │       │   │   ├─ chn.id:24!null\n" +
			"                             │       │   │   └─ ci.person_role_id:21\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ HashIn\n" +
			"                             │       │   │   │   ├─ ci.note:3\n" +
			"                             │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ ProcessTable\n" +
			"                             │       │   │           └─ Table\n" +
			"                             │       │   │               ├─ name: cast_info\n" +
			"                             │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ ProcessTable\n" +
			"                             │       │           └─ Table\n" +
			"                             │       │               ├─ name: char_name\n" +
			"                             │       │               └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ keys: [ci.person_id:19!null]\n" +
			"                             │               ├─ colSet: (1-8)\n" +
			"                             │               ├─ tableId: 1\n" +
			"                             │               └─ Table\n" +
			"                             │                   ├─ name: aka_name\n" +
			"                             │                   └─ columns: [person_id]\n" +
			"                             └─ Filter\n" +
			"                                 ├─ AND\n" +
			"                                 │   ├─ Eq\n" +
			"                                 │   │   ├─ cn.country_code:2\n" +
			"                                 │   │   └─ [us] (longtext)\n" +
			"                                 │   └─ Eq\n" +
			"                                 │       ├─ cn.name:1!null\n" +
			"                                 │       └─ DreamWorks Animation (longtext)\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ ProcessTable\n" +
			"                                         └─ Table\n" +
			"                                             ├─ name: company_name\n" +
			"                                             └─ columns: [id name country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char_name, min(n.name) as voicing_actress_name, min(t.title) as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year > 2010) AND (t.title >= 'Kung Fu Panda')) AND (t.title <= 'Kung Fu Pandaÿ'))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (k.id = mk.keyword_id)\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_keyword\n" +
			"                     │   │       └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (k.keyword HASH IN ('hero', 'martial-arts', 'hand-to-hand-combat', 'computer-animated-movie'))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: keyword\n" +
			"                     │               └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (it.id = mi.info_type_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%'))\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_info\n" +
			"                         │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (it.info = 'release dates')\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: info_type\n" +
			"                         │               └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ (cn.id = mc.company_id)\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ Table\n" +
			"                             │   │       ├─ name: movie_companies\n" +
			"                             │   │       └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ Table\n" +
			"                             │       │   │           ├─ name: cast_info\n" +
			"                             │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ Table\n" +
			"                             │       │           ├─ name: char_name\n" +
			"                             │       │           └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ columns: [person_id]\n" +
			"                             │               └─ keys: ci.person_id\n" +
			"                             └─ Filter\n" +
			"                                 ├─ ((cn.country_code = '[us]') AND (cn.name = 'DreamWorks Animation'))\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id name country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char_name, min(n.name) as voicing_actress_name, min(t.title) as kung_fu_panda]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year > 2010) AND (t.title >= 'Kung Fu Panda')) AND (t.title <= 'Kung Fu Pandaÿ'))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (rt.id = ci.role_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id))\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (k.id = mk.keyword_id)\n" +
			"                     │   ├─ TableAlias(mk)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_keyword\n" +
			"                     │   │       └─ columns: [movie_id keyword_id]\n" +
			"                     │   └─ Filter\n" +
			"                     │       ├─ (k.keyword HASH IN ('hero', 'martial-arts', 'hand-to-hand-combat', 'computer-animated-movie'))\n" +
			"                     │       └─ TableAlias(k)\n" +
			"                     │           └─ Table\n" +
			"                     │               ├─ name: keyword\n" +
			"                     │               └─ columns: [id keyword]\n" +
			"                     └─ InnerJoin\n" +
			"                         ├─ ((mc.movie_id = mi.movie_id) AND (mi.movie_id = ci.movie_id))\n" +
			"                         ├─ InnerJoin\n" +
			"                         │   ├─ (it.id = mi.info_type_id)\n" +
			"                         │   ├─ Filter\n" +
			"                         │   │   ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%201%' OR mi.info LIKE 'USA:%201%'))\n" +
			"                         │   │   └─ TableAlias(mi)\n" +
			"                         │   │       └─ Table\n" +
			"                         │   │           ├─ name: movie_info\n" +
			"                         │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                         │   └─ Filter\n" +
			"                         │       ├─ (it.info = 'release dates')\n" +
			"                         │       └─ TableAlias(it)\n" +
			"                         │           └─ Table\n" +
			"                         │               ├─ name: info_type\n" +
			"                         │               └─ columns: [id info]\n" +
			"                         └─ InnerJoin\n" +
			"                             ├─ (cn.id = mc.company_id)\n" +
			"                             ├─ InnerJoin\n" +
			"                             │   ├─ (mc.movie_id = ci.movie_id)\n" +
			"                             │   ├─ TableAlias(mc)\n" +
			"                             │   │   └─ Table\n" +
			"                             │   │       ├─ name: movie_companies\n" +
			"                             │   │       └─ columns: [movie_id company_id]\n" +
			"                             │   └─ LookupJoin\n" +
			"                             │       ├─ InnerJoin\n" +
			"                             │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                             │       │   ├─ Filter\n" +
			"                             │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                             │       │   │   └─ TableAlias(ci)\n" +
			"                             │       │   │       └─ Table\n" +
			"                             │       │   │           ├─ name: cast_info\n" +
			"                             │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                             │       │   └─ TableAlias(chn)\n" +
			"                             │       │       └─ Table\n" +
			"                             │       │           ├─ name: char_name\n" +
			"                             │       │           └─ columns: [id name]\n" +
			"                             │       └─ TableAlias(an)\n" +
			"                             │           └─ IndexedTableAccess(aka_name)\n" +
			"                             │               ├─ index: [aka_name.person_id]\n" +
			"                             │               ├─ columns: [person_id]\n" +
			"                             │               └─ keys: ci.person_id\n" +
			"                             └─ Filter\n" +
			"                                 ├─ ((cn.country_code = '[us]') AND (cn.name = 'DreamWorks Animation'))\n" +
			"                                 └─ TableAlias(cn)\n" +
			"                                     └─ Table\n" +
			"                                         ├─ name: company_name\n" +
			"                                         └─ columns: [id name country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS male_writer,
       MIN(t.title) AS violent_movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity')
  AND mi.info = 'Horror'
  AND n.gender = 'm'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as male_writer, min(t.title):3!null as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:13!null), MIN(mi_idx.info:4!null), MIN(n.name:18!null), MIN(t.title:21!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:20!null\n" +
			"         │   │   │   │   └─ mi.movie_id:11!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:20!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:20!null\n" +
			"         │   │       └─ ci.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:20!null\n" +
			"         │       └─ mk.movie_id:9!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:17!null\n" +
			"         │   │   └─ ci.person_id:14!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:3!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:1!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi_idx.movie_id:2!null\n" +
			"         │   │           │       └─ mk.movie_id:9!null\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: movie_info_idx\n" +
			"         │   │           │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi_idx.movie_id:2!null, mi_idx.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ Eq\n" +
			"         │   │                   │   ├─ k.id:5!null\n" +
			"         │   │                   │   └─ mk.keyword_id:10!null\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ HashIn\n" +
			"         │   │                   │   │   ├─ k.keyword:1!null\n" +
			"         │   │                   │   │   └─ TUPLE(murder (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: keyword\n" +
			"         │   │                   │               └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(k.id:5!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ it1.id:7!null\n" +
			"         │   │                           │   └─ mi.info_type_id:12!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ Eq\n" +
			"         │   │                           │   │   ├─ it1.info:1!null\n" +
			"         │   │                           │   │   └─ genres (longtext)\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           ├─ columns: [id info]\n" +
			"         │   │                           │           ├─ colSet: (8,9)\n" +
			"         │   │                           │           └─ tableId: 2\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(it1.id:7!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mi.info_type_id:3!null)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ Eq\n" +
			"         │   │                                   │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │                                   │   │   └─ mk.movie_id:9!null\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ ProcessTable\n" +
			"         │   │                                   │   │       └─ Table\n" +
			"         │   │                                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ Eq\n" +
			"         │   │                                   │       │   ├─ mi.info:2!null\n" +
			"         │   │                                   │       │   └─ Horror (longtext)\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ ProcessTable\n" +
			"         │   │                                   │               └─ Table\n" +
			"         │   │                                   │                   ├─ name: movie_info\n" +
			"         │   │                                   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ HashIn\n" +
			"         │   │                                       │   ├─ ci.note:2\n" +
			"         │   │                                       │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ keys: [mi.movie_id:11!null]\n" +
			"         │   │                                               ├─ colSet: (1-7)\n" +
			"         │   │                                               ├─ tableId: 1\n" +
			"         │   │                                               └─ Table\n" +
			"         │   │                                                   ├─ name: cast_info\n" +
			"         │   │                                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:2\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:11!null, mi_idx.movie_id:2!null, ci.movie_id:15!null, mk.movie_id:9!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'blood', 'gore', 'death', 'female-nudity'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info = 'Horror')\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'blood', 'gore', 'death', 'female-nudity'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info = 'Horror')\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS male_writer,
       MIN(t.title) AS violent_movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity')
  AND mi.info = 'Horror'
  AND n.gender = 'm'
  AND t.production_year > 2010
  AND t.title LIKE 'Vampire%'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as male_writer, min(t.title):3!null as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:13!null), MIN(mi_idx.info:4!null), MIN(n.name:18!null), MIN(t.title:21!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:20!null\n" +
			"         │   │   │   │   └─ mi.movie_id:11!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:20!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:20!null\n" +
			"         │   │       └─ ci.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:20!null\n" +
			"         │       └─ mk.movie_id:9!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:17!null\n" +
			"         │   │   └─ ci.person_id:14!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:3!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:1!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi_idx.movie_id:2!null\n" +
			"         │   │           │       └─ mk.movie_id:9!null\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: movie_info_idx\n" +
			"         │   │           │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi_idx.movie_id:2!null, mi_idx.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ Eq\n" +
			"         │   │                   │   ├─ k.id:5!null\n" +
			"         │   │                   │   └─ mk.keyword_id:10!null\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ HashIn\n" +
			"         │   │                   │   │   ├─ k.keyword:1!null\n" +
			"         │   │                   │   │   └─ TUPLE(murder (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: keyword\n" +
			"         │   │                   │               └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(k.id:5!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ it1.id:7!null\n" +
			"         │   │                           │   └─ mi.info_type_id:12!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ Eq\n" +
			"         │   │                           │   │   ├─ it1.info:1!null\n" +
			"         │   │                           │   │   └─ genres (longtext)\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           ├─ columns: [id info]\n" +
			"         │   │                           │           ├─ colSet: (8,9)\n" +
			"         │   │                           │           └─ tableId: 2\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(it1.id:7!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mi.info_type_id:3!null)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ Eq\n" +
			"         │   │                                   │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │                                   │   │   └─ mk.movie_id:9!null\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ ProcessTable\n" +
			"         │   │                                   │   │       └─ Table\n" +
			"         │   │                                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ Eq\n" +
			"         │   │                                   │       │   ├─ mi.info:2!null\n" +
			"         │   │                                   │       │   └─ Horror (longtext)\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ ProcessTable\n" +
			"         │   │                                   │               └─ Table\n" +
			"         │   │                                   │                   ├─ name: movie_info\n" +
			"         │   │                                   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ HashIn\n" +
			"         │   │                                       │   ├─ ci.note:2\n" +
			"         │   │                                       │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ keys: [mi.movie_id:11!null]\n" +
			"         │   │                                               ├─ colSet: (1-7)\n" +
			"         │   │                                               ├─ tableId: 1\n" +
			"         │   │                                               └─ Table\n" +
			"         │   │                                                   ├─ name: cast_info\n" +
			"         │   │                                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:2\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:11!null, mi_idx.movie_id:2!null, ci.movie_id:15!null, mk.movie_id:9!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ GreaterThan\n" +
			"                 │   │   │   ├─ t.production_year:2\n" +
			"                 │   │   │   └─ 2010 (smallint)\n" +
			"                 │   │   └─ GreaterThanOrEqual\n" +
			"                 │   │       ├─ t.title:1!null\n" +
			"                 │   │       └─ Vampire (longtext)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.title:1!null\n" +
			"                 │       └─ Vampireÿ (longtext)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'blood', 'gore', 'death', 'female-nudity'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info = 'Horror')\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.production_year > 2010) AND (t.title >= 'Vampire')) AND (t.title <= 'Vampireÿ'))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'blood', 'gore', 'death', 'female-nudity'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info = 'Horror')\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.production_year > 2010) AND (t.title >= 'Vampire')) AND (t.title <= 'Vampireÿ'))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS male_writer,
       MIN(t.title) AS violent_movie_title
FROM cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Action',
                  'Sci-Fi',
                  'Thriller',
                  'Crime',
                  'War')
  AND n.gender = 'm'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as male_writer, min(t.title):3!null as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:13!null), MIN(mi_idx.info:4!null), MIN(n.name:18!null), MIN(t.title:21!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:20!null\n" +
			"         │   │   │   │   └─ mi.movie_id:11!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:20!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:2!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:20!null\n" +
			"         │   │       └─ ci.movie_id:15!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:20!null\n" +
			"         │       └─ mk.movie_id:9!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:17!null\n" +
			"         │   │   └─ ci.person_id:14!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:3!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:1!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │           │   │   └─ mi_idx.movie_id:2!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi_idx.movie_id:2!null\n" +
			"         │   │           │       └─ mk.movie_id:9!null\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ ProcessTable\n" +
			"         │   │           │       └─ Table\n" +
			"         │   │           │           ├─ name: movie_info_idx\n" +
			"         │   │           │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi_idx.movie_id:2!null, mi_idx.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mi.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ Eq\n" +
			"         │   │                   │   ├─ k.id:5!null\n" +
			"         │   │                   │   └─ mk.keyword_id:10!null\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ HashIn\n" +
			"         │   │                   │   │   ├─ k.keyword:1!null\n" +
			"         │   │                   │   │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ ProcessTable\n" +
			"         │   │                   │           └─ Table\n" +
			"         │   │                   │               ├─ name: keyword\n" +
			"         │   │                   │               └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(k.id:5!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ it1.id:7!null\n" +
			"         │   │                           │   └─ mi.info_type_id:12!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ Eq\n" +
			"         │   │                           │   │   ├─ it1.info:1!null\n" +
			"         │   │                           │   │   └─ genres (longtext)\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           ├─ columns: [id info]\n" +
			"         │   │                           │           ├─ colSet: (8,9)\n" +
			"         │   │                           │           └─ tableId: 2\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(it1.id:7!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mi.info_type_id:3!null)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ Eq\n" +
			"         │   │                                   │   │   ├─ mi.movie_id:11!null\n" +
			"         │   │                                   │   │   └─ mk.movie_id:9!null\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ ProcessTable\n" +
			"         │   │                                   │   │       └─ Table\n" +
			"         │   │                                   │   │           ├─ name: movie_keyword\n" +
			"         │   │                                   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ HashIn\n" +
			"         │   │                                   │       │   ├─ mi.info:2!null\n" +
			"         │   │                                   │       │   └─ TUPLE(Horror (longtext), Action (longtext), Sci-Fi (longtext), Thriller (longtext), Crime (longtext), War (longtext))\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ ProcessTable\n" +
			"         │   │                                   │               └─ Table\n" +
			"         │   │                                   │                   ├─ name: movie_info\n" +
			"         │   │                                   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ HashIn\n" +
			"         │   │                                       │   ├─ ci.note:2\n" +
			"         │   │                                       │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ keys: [mi.movie_id:11!null]\n" +
			"         │   │                                               ├─ colSet: (1-7)\n" +
			"         │   │                                               ├─ tableId: 1\n" +
			"         │   │                                               └─ Table\n" +
			"         │   │                                                   ├─ name: cast_info\n" +
			"         │   │                                                   └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:2\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:11!null, mi_idx.movie_id:2!null, ci.movie_id:15!null, mk.movie_id:9!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as male_writer, min(t.title) as violent_movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ ((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mi_idx.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │           ├─ TableAlias(mi_idx)\n" +
			"         │   │           │   └─ Table\n" +
			"         │   │           │       ├─ name: movie_info_idx\n" +
			"         │   │           │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │               ├─ right-key: (mi.movie_id, mk.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                   ├─ Filter\n" +
			"         │   │                   │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                   │   └─ TableAlias(k)\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: keyword\n" +
			"         │   │                   │           └─ columns: [id keyword]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (k.id)\n" +
			"         │   │                       ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (it1.info = 'genres')\n" +
			"         │   │                           │   └─ TableAlias(it1)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: info_type\n" +
			"         │   │                           │           └─ columns: [id info]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (it1.id)\n" +
			"         │   │                               ├─ right-key: (mi.info_type_id)\n" +
			"         │   │                               └─ LookupJoin\n" +
			"         │   │                                   ├─ InnerJoin\n" +
			"         │   │                                   │   ├─ (mi.movie_id = mk.movie_id)\n" +
			"         │   │                                   │   ├─ TableAlias(mk)\n" +
			"         │   │                                   │   │   └─ Table\n" +
			"         │   │                                   │   │       ├─ name: movie_keyword\n" +
			"         │   │                                   │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                   │   └─ Filter\n" +
			"         │   │                                   │       ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │                                   │       └─ TableAlias(mi)\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: movie_info\n" +
			"         │   │                                   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                                   └─ Filter\n" +
			"         │   │                                       ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                       └─ TableAlias(ci)\n" +
			"         │   │                                           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                               ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                               ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                               └─ keys: mi.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS character_name,
       MIN(mi_idx.info) AS rating,
       MIN(n.name) AS playing_actor,
       MIN(t.title) AS complete_hero_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name IS NOT NULL
  AND (chn.name LIKE '%man%'
       OR chn.name LIKE '%Man%')
  AND it2.info = 'rating'
  AND k.keyword IN ('superhero',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence',
                    'magnet',
                    'web',
                    'claw',
                    'laser')
  AND kt.kind = 'movie'
  AND mi_idx.info > '7.0'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND ci.movie_id = cc.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND cc.movie_id = mi_idx.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as character_name, min(mi_idx.info):1!null as rating, min(n.name):2!null as playing_actor, min(t.title):3!null as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:22!null), MIN(mi_idx.info:15!null), MIN(n.name:28!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ n.id:27!null\n" +
			"         │   └─ ci.person_id:18!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │   │   └─ ci.movie_id:19!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:23!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:19!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ movie (longtext)\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it2.id:16!null\n" +
			"         │   │   │       │   └─ mi_idx.info_type_id:14!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ GreaterThan\n" +
			"         │   │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │   │       │   │   └─ 7.0 (longtext)\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it2.info:1!null\n" +
			"         │   │   │           │   └─ rating (longtext)\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ chn.id:21!null\n" +
			"         │   │       │   └─ ci.person_role_id:20\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ ProcessTable\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: cast_info\n" +
			"         │   │       │           └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ NOT\n" +
			"         │   │           │   │   └─ chn.name:1!null IS NULL\n" +
			"         │   │           │   └─ Or\n" +
			"         │   │           │       ├─ chn.name LIKE '%man%'\n" +
			"         │   │           │       └─ chn.name LIKE '%Man%'\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: char_name\n" +
			"         │   │                       └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:25!null\n" +
			"         │       │   └─ mk.keyword_id:24!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext), magnet (longtext), web (longtext), claw (longtext), laser (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ ProcessTable\n" +
			"                 └─ Table\n" +
			"                     ├─ name: name\n" +
			"                     └─ columns: [id name]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(n.name) as playing_actor, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi_idx.info > '7.0')\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id name]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(n.name) as playing_actor, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi_idx.info > '7.0')\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id name]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS character_name,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS complete_hero_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name IS NOT NULL
  AND (chn.name LIKE '%man%'
       OR chn.name LIKE '%Man%')
  AND it2.info = 'rating'
  AND k.keyword IN ('superhero',
                    'marvel-comics',
                    'based-on-comic',
                    'fight')
  AND kt.kind = 'movie'
  AND mi_idx.info > '8.0'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND ci.movie_id = cc.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND cc.movie_id = mi_idx.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as character_name, min(mi_idx.info):1!null as rating, min(t.title):2!null as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:22!null), MIN(mi_idx.info:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ n.id:27!null\n" +
			"         │   └─ ci.person_id:18!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │   │   └─ ci.movie_id:19!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:23!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:19!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ movie (longtext)\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it2.id:16!null\n" +
			"         │   │   │       │   └─ mi_idx.info_type_id:14!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ GreaterThan\n" +
			"         │   │   │       │   │   ├─ mi_idx.info:2!null\n" +
			"         │   │   │       │   │   └─ 8.0 (longtext)\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: movie_info_idx\n" +
			"         │   │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it2.info:1!null\n" +
			"         │   │   │           │   └─ rating (longtext)\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ chn.id:21!null\n" +
			"         │   │       │   └─ ci.person_role_id:20\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ ProcessTable\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: cast_info\n" +
			"         │   │       │           └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ NOT\n" +
			"         │   │           │   │   └─ chn.name:1!null IS NULL\n" +
			"         │   │           │   └─ Or\n" +
			"         │   │           │       ├─ chn.name LIKE '%man%'\n" +
			"         │   │           │       └─ chn.name LIKE '%Man%'\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: char_name\n" +
			"         │   │                       └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:25!null\n" +
			"         │       │   └─ mk.keyword_id:24!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), marvel-comics (longtext), based-on-comic (longtext), fight (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ ProcessTable\n" +
			"                 └─ Table\n" +
			"                     ├─ name: name\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi_idx.info > '8.0')\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'fight'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi_idx.info > '8.0')\n" +
			"         │   │   │       │   └─ TableAlias(mi_idx)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'fight'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS character_name,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS complete_hero_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE '%complete%'
  AND chn.name IS NOT NULL
  AND (chn.name LIKE '%man%'
       OR chn.name LIKE '%Man%')
  AND it2.info = 'rating'
  AND k.keyword IN ('superhero',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence',
                    'magnet',
                    'web',
                    'claw',
                    'laser')
  AND kt.kind = 'movie'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND t.id = cc.movie_id
  AND t.id = mi_idx.movie_id
  AND mk.movie_id = ci.movie_id
  AND mk.movie_id = cc.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND ci.movie_id = cc.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND cc.movie_id = mi_idx.movie_id
  AND chn.id = ci.person_role_id
  AND n.id = ci.person_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND it2.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as character_name, min(mi_idx.info):1!null as rating, min(t.title):2!null as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:22!null), MIN(mi_idx.info:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ n.id:27!null\n" +
			"         │   └─ ci.person_id:18!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │   │   └─ ci.movie_id:19!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:23!null\n" +
			"         │   │   │       └─ mi_idx.movie_id:13!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:23!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ci.movie_id:19!null\n" +
			"         │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi_idx.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ movie (longtext)\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it2.id:16!null\n" +
			"         │   │   │       │   └─ mi_idx.info_type_id:14!null\n" +
			"         │   │   │       ├─ TableAlias(mi_idx)\n" +
			"         │   │   │       │   └─ ProcessTable\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info_idx\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it2.info:1!null\n" +
			"         │   │   │           │   └─ rating (longtext)\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ chn.id:21!null\n" +
			"         │   │       │   └─ ci.person_role_id:20\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ ProcessTable\n" +
			"         │   │       │       └─ Table\n" +
			"         │   │       │           ├─ name: cast_info\n" +
			"         │   │       │           └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ NOT\n" +
			"         │   │           │   │   └─ chn.name:1!null IS NULL\n" +
			"         │   │           │   └─ Or\n" +
			"         │   │           │       ├─ chn.name LIKE '%man%'\n" +
			"         │   │           │       └─ chn.name LIKE '%Man%'\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ ProcessTable\n" +
			"         │   │                   └─ Table\n" +
			"         │   │                       ├─ name: char_name\n" +
			"         │   │                       └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:25!null\n" +
			"         │       │   └─ mk.keyword_id:24!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext), magnet (longtext), web (longtext), claw (longtext), laser (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ ProcessTable\n" +
			"                 └─ Table\n" +
			"                     ├─ name: name\n" +
			"                     └─ columns: [id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ TableAlias(mi_idx)\n" +
			"         │   │   │       │   └─ Table\n" +
			"         │   │   │       │       ├─ name: movie_info_idx\n" +
			"         │   │   │       │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as character_name, min(mi_idx.info) as rating, min(t.title) as complete_hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (n.id = ci.person_id)\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ ((((mk.movie_id = ci.movie_id) AND (mk.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ (ci.movie_id = cc.movie_id)\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ cct2.kind LIKE '%complete%'\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind = 'movie')\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   │       ├─ TableAlias(mi_idx)\n" +
			"         │   │   │       │   └─ Table\n" +
			"         │   │   │       │       ├─ name: movie_info_idx\n" +
			"         │   │   │       │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it2.info = 'rating')\n" +
			"         │   │   │           └─ TableAlias(it2)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (chn.id = ci.person_role_id)\n" +
			"         │   │       ├─ TableAlias(ci)\n" +
			"         │   │       │   └─ Table\n" +
			"         │   │       │       ├─ name: cast_info\n" +
			"         │   │       │       └─ columns: [person_id movie_id person_role_id]\n" +
			"         │   │       └─ Filter\n" +
			"         │   │           ├─ ((NOT(chn.name IS NULL)) AND (chn.name LIKE '%man%' OR chn.name LIKE '%Man%'))\n" +
			"         │   │           └─ TableAlias(chn)\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: char_name\n" +
			"         │   │                   └─ columns: [id name]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence', 'magnet', 'web', 'claw', 'laser'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ TableAlias(n)\n" +
			"             └─ Table\n" +
			"                 ├─ name: name\n" +
			"                 └─ columns: [id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS complete_western_sequel
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cct1.kind IN ('cast',
                    'crew')
  AND cct2.kind = 'complete'
  AND cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Sweden',
                  'Germany',
                  'Swedish',
                  'German')
  AND t.production_year BETWEEN 1950 AND 2000
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND t.id = cc.movie_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id
  AND ml.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = cc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(lt.link):1!null as link_type, min(t.title):2!null as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(lt.link:5!null), MIN(t.title:27!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ ml.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ t.id:26!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │   │       └─ mk.movie_id:15!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:19!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mi.movie_id:17!null\n" +
			"         │   │       └─ t.id:26!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:26!null\n" +
			"         │       └─ cc.movie_id:23\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ cct1.id:0!null\n" +
			"         │   │   └─ cc.subject_id:24!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ HashIn\n" +
			"         │   │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   └─ TUPLE(cast (longtext), crew (longtext))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: comp_cast_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(cc.subject_id:22!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ cct2.id:2!null\n" +
			"         │           │   └─ cc.status_id:25!null\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ cct2.kind:1!null\n" +
			"         │           │   │   └─ complete (longtext)\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           ├─ columns: [id kind]\n" +
			"         │           │           ├─ colSet: (7,8)\n" +
			"         │           │           └─ tableId: 3\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"         │               ├─ right-key: TUPLE(cc.status_id:21!null)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ lt.id:4!null\n" +
			"         │                   │   └─ ml.link_type_id:14!null\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ ProcessTable\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: link_type\n" +
			"         │                   │               └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: TUPLE(lt.id:4!null)\n" +
			"         │                       ├─ right-key: TUPLE(ml.link_type_id:8!null)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ Eq\n" +
			"         │                           │   ├─ mk.keyword_id:16!null\n" +
			"         │                           │   └─ k.id:6!null\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ Eq\n" +
			"         │                           │   │   ├─ k.keyword:1!null\n" +
			"         │                           │   │   └─ sequel (longtext)\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ ProcessTable\n" +
			"         │                           │           └─ Table\n" +
			"         │                           │               ├─ name: keyword\n" +
			"         │                           │               └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: TUPLE(k.id:6!null)\n" +
			"         │                               ├─ right-key: TUPLE(mk.keyword_id:8!null)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ Eq\n" +
			"         │                                   │   ├─ mc.company_type_id:21!null\n" +
			"         │                                   │   └─ ct.id:8!null\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ Eq\n" +
			"         │                                   │   │   ├─ ct.kind:1!null\n" +
			"         │                                   │   │   └─ production companies (longtext)\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ ProcessTable\n" +
			"         │                                   │           └─ Table\n" +
			"         │                                   │               ├─ name: company_type\n" +
			"         │                                   │               └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: TUPLE(ct.id:8!null)\n" +
			"         │                                       ├─ right-key: TUPLE(mc.company_type_id:11!null)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ Eq\n" +
			"         │                                           │   ├─ mc.company_id:20!null\n" +
			"         │                                           │   └─ cn.id:10!null\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ AND\n" +
			"         │                                           │   │   ├─ NOT\n" +
			"         │                                           │   │   │   └─ Eq\n" +
			"         │                                           │   │   │       ├─ cn.country_code:2\n" +
			"         │                                           │   │   │       └─ [pl] (longtext)\n" +
			"         │                                           │   │   └─ Or\n" +
			"         │                                           │   │       ├─ cn.name LIKE '%Film%'\n" +
			"         │                                           │   │       └─ cn.name LIKE '%Warner%'\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ ProcessTable\n" +
			"         │                                           │           └─ Table\n" +
			"         │                                           │               ├─ name: company_name\n" +
			"         │                                           │               └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: TUPLE(cn.id:10!null)\n" +
			"         │                                               ├─ right-key: TUPLE(mc.company_id:7!null)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ Eq\n" +
			"         │                                                   │   │   ├─ ml.movie_id:13!null\n" +
			"         │                                                   │   │   └─ mk.movie_id:15!null\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ ProcessTable\n" +
			"         │                                                   │   │       └─ Table\n" +
			"         │                                                   │   │           ├─ name: movie_link\n" +
			"         │                                                   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ Eq\n" +
			"         │                                                   │       │   │   ├─ mk.movie_id:15!null\n" +
			"         │                                                   │       │   │   └─ mi.movie_id:17!null\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ ProcessTable\n" +
			"         │                                                   │       │   │       └─ Table\n" +
			"         │                                                   │       │   │           ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ HashIn\n" +
			"         │                                                   │       │       │   ├─ mi.info:1!null\n" +
			"         │                                                   │       │       │   └─ TUPLE(Sweden (longtext), Germany (longtext), Swedish (longtext), German (longtext))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ ProcessTable\n" +
			"         │                                                   │       │               └─ Table\n" +
			"         │                                                   │       │                   ├─ name: movie_info\n" +
			"         │                                                   │       │                   └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note:3 IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ keys: [mi.movie_id:17!null]\n" +
			"         │                                                   │                   ├─ colSet: (23-27)\n" +
			"         │                                                   │                   ├─ tableId: 8\n" +
			"         │                                                   │                   └─ Table\n" +
			"         │                                                   │                       ├─ name: movie_companies\n" +
			"         │                                                   │                       └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ keys: [mc.movie_id:19!null]\n" +
			"         │                                                           ├─ colSet: (1-4)\n" +
			"         │                                                           ├─ tableId: 1\n" +
			"         │                                                           └─ Table\n" +
			"         │                                                               ├─ name: complete_cast\n" +
			"         │                                                               └─ columns: [movie_id subject_id status_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:13!null, mk.movie_id:15!null, mc.movie_id:19!null, mi.movie_id:17!null, cc.movie_id:23)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 1950 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2000 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ (cct2.kind = 'complete')\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ (cct2.kind = 'complete')\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2000))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS complete_western_sequel
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cct1.kind IN ('cast',
                    'crew')
  AND cct2.kind = 'complete'
  AND cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Sweden',
                  'Germany',
                  'Swedish',
                  'German')
  AND t.production_year = 1998
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND t.id = cc.movie_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id
  AND ml.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = cc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(lt.link):1!null as link_type, min(t.title):2!null as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(lt.link:5!null), MIN(t.title:27!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ ml.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ t.id:26!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │   │       └─ mk.movie_id:15!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:19!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mi.movie_id:17!null\n" +
			"         │   │       └─ t.id:26!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:26!null\n" +
			"         │       └─ cc.movie_id:23\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ cct1.id:0!null\n" +
			"         │   │   └─ cc.subject_id:24!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ HashIn\n" +
			"         │   │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   └─ TUPLE(cast (longtext), crew (longtext))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: comp_cast_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(cc.subject_id:22!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ cct2.id:2!null\n" +
			"         │           │   └─ cc.status_id:25!null\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ Eq\n" +
			"         │           │   │   ├─ cct2.kind:1!null\n" +
			"         │           │   │   └─ complete (longtext)\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           ├─ columns: [id kind]\n" +
			"         │           │           ├─ colSet: (7,8)\n" +
			"         │           │           └─ tableId: 3\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"         │               ├─ right-key: TUPLE(cc.status_id:21!null)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ lt.id:4!null\n" +
			"         │                   │   └─ ml.link_type_id:14!null\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ ProcessTable\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: link_type\n" +
			"         │                   │               └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: TUPLE(lt.id:4!null)\n" +
			"         │                       ├─ right-key: TUPLE(ml.link_type_id:8!null)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ Eq\n" +
			"         │                           │   ├─ mk.keyword_id:16!null\n" +
			"         │                           │   └─ k.id:6!null\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ Eq\n" +
			"         │                           │   │   ├─ k.keyword:1!null\n" +
			"         │                           │   │   └─ sequel (longtext)\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ ProcessTable\n" +
			"         │                           │           └─ Table\n" +
			"         │                           │               ├─ name: keyword\n" +
			"         │                           │               └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: TUPLE(k.id:6!null)\n" +
			"         │                               ├─ right-key: TUPLE(mk.keyword_id:8!null)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ Eq\n" +
			"         │                                   │   ├─ mc.company_type_id:21!null\n" +
			"         │                                   │   └─ ct.id:8!null\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ Eq\n" +
			"         │                                   │   │   ├─ ct.kind:1!null\n" +
			"         │                                   │   │   └─ production companies (longtext)\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ ProcessTable\n" +
			"         │                                   │           └─ Table\n" +
			"         │                                   │               ├─ name: company_type\n" +
			"         │                                   │               └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: TUPLE(ct.id:8!null)\n" +
			"         │                                       ├─ right-key: TUPLE(mc.company_type_id:11!null)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ Eq\n" +
			"         │                                           │   ├─ mc.company_id:20!null\n" +
			"         │                                           │   └─ cn.id:10!null\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ AND\n" +
			"         │                                           │   │   ├─ NOT\n" +
			"         │                                           │   │   │   └─ Eq\n" +
			"         │                                           │   │   │       ├─ cn.country_code:2\n" +
			"         │                                           │   │   │       └─ [pl] (longtext)\n" +
			"         │                                           │   │   └─ Or\n" +
			"         │                                           │   │       ├─ cn.name LIKE '%Film%'\n" +
			"         │                                           │   │       └─ cn.name LIKE '%Warner%'\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ ProcessTable\n" +
			"         │                                           │           └─ Table\n" +
			"         │                                           │               ├─ name: company_name\n" +
			"         │                                           │               └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: TUPLE(cn.id:10!null)\n" +
			"         │                                               ├─ right-key: TUPLE(mc.company_id:7!null)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ Eq\n" +
			"         │                                                   │   │   ├─ ml.movie_id:13!null\n" +
			"         │                                                   │   │   └─ mk.movie_id:15!null\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ ProcessTable\n" +
			"         │                                                   │   │       └─ Table\n" +
			"         │                                                   │   │           ├─ name: movie_link\n" +
			"         │                                                   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ Eq\n" +
			"         │                                                   │       │   │   ├─ mk.movie_id:15!null\n" +
			"         │                                                   │       │   │   └─ mi.movie_id:17!null\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ ProcessTable\n" +
			"         │                                                   │       │   │       └─ Table\n" +
			"         │                                                   │       │   │           ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ HashIn\n" +
			"         │                                                   │       │       │   ├─ mi.info:1!null\n" +
			"         │                                                   │       │       │   └─ TUPLE(Sweden (longtext), Germany (longtext), Swedish (longtext), German (longtext))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ ProcessTable\n" +
			"         │                                                   │       │               └─ Table\n" +
			"         │                                                   │       │                   ├─ name: movie_info\n" +
			"         │                                                   │       │                   └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note:3 IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ keys: [mi.movie_id:17!null]\n" +
			"         │                                                   │                   ├─ colSet: (23-27)\n" +
			"         │                                                   │                   ├─ tableId: 8\n" +
			"         │                                                   │                   └─ Table\n" +
			"         │                                                   │                       ├─ name: movie_companies\n" +
			"         │                                                   │                       └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ keys: [mc.movie_id:19!null]\n" +
			"         │                                                           ├─ colSet: (1-4)\n" +
			"         │                                                           ├─ tableId: 1\n" +
			"         │                                                           └─ Table\n" +
			"         │                                                               ├─ name: complete_cast\n" +
			"         │                                                               └─ columns: [movie_id subject_id status_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:13!null, mk.movie_id:15!null, mc.movie_id:19!null, mi.movie_id:17!null, cc.movie_id:23)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ t.production_year:2\n" +
			"                 │   └─ 1998 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ (cct2.kind = 'complete')\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year = 1998)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ (cct2.kind = 'complete')\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (t.production_year = 1998)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS producing_company,
       MIN(lt.link) AS link_type,
       MIN(t.title) AS complete_western_sequel
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind LIKE 'complete%'
  AND cn.country_code !='[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind ='production companies'
  AND k.keyword ='sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'English')
  AND t.production_year BETWEEN 1950 AND 2010
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND mi.movie_id = t.id
  AND t.id = cc.movie_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND ml.movie_id = mi.movie_id
  AND mk.movie_id = mi.movie_id
  AND mc.movie_id = mi.movie_id
  AND ml.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = cc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as producing_company, min(lt.link):1!null as link_type, min(t.title):2!null as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:11!null), MIN(lt.link:5!null), MIN(t.title:27!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ ml.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ t.id:26!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │   │       └─ mk.movie_id:15!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:19!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mi.movie_id:17!null\n" +
			"         │   │       └─ t.id:26!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:26!null\n" +
			"         │       └─ cc.movie_id:23\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ cct1.id:0!null\n" +
			"         │   │   └─ cc.subject_id:24!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   └─ cast (longtext)\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: comp_cast_type\n" +
			"         │   │               └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"         │       ├─ right-key: TUPLE(cc.subject_id:22!null)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ cct2.id:2!null\n" +
			"         │           │   └─ cc.status_id:25!null\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ AND\n" +
			"         │           │   │   ├─ GreaterThanOrEqual\n" +
			"         │           │   │   │   ├─ cct2.kind:1!null\n" +
			"         │           │   │   │   └─ complete (longtext)\n" +
			"         │           │   │   └─ LessThanOrEqual\n" +
			"         │           │   │       ├─ cct2.kind:1!null\n" +
			"         │           │   │       └─ completeÿ (longtext)\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           ├─ columns: [id kind]\n" +
			"         │           │           ├─ colSet: (7,8)\n" +
			"         │           │           └─ tableId: 3\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"         │               ├─ right-key: TUPLE(cc.status_id:21!null)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ Eq\n" +
			"         │                   │   ├─ lt.id:4!null\n" +
			"         │                   │   └─ ml.link_type_id:14!null\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ ProcessTable\n" +
			"         │                   │           └─ Table\n" +
			"         │                   │               ├─ name: link_type\n" +
			"         │                   │               └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: TUPLE(lt.id:4!null)\n" +
			"         │                       ├─ right-key: TUPLE(ml.link_type_id:8!null)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ Eq\n" +
			"         │                           │   ├─ mk.keyword_id:16!null\n" +
			"         │                           │   └─ k.id:6!null\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ Eq\n" +
			"         │                           │   │   ├─ k.keyword:1!null\n" +
			"         │                           │   │   └─ sequel (longtext)\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ ProcessTable\n" +
			"         │                           │           └─ Table\n" +
			"         │                           │               ├─ name: keyword\n" +
			"         │                           │               └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: TUPLE(k.id:6!null)\n" +
			"         │                               ├─ right-key: TUPLE(mk.keyword_id:8!null)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ Eq\n" +
			"         │                                   │   ├─ mc.company_type_id:21!null\n" +
			"         │                                   │   └─ ct.id:8!null\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ Eq\n" +
			"         │                                   │   │   ├─ ct.kind:1!null\n" +
			"         │                                   │   │   └─ production companies (longtext)\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ ProcessTable\n" +
			"         │                                   │           └─ Table\n" +
			"         │                                   │               ├─ name: company_type\n" +
			"         │                                   │               └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: TUPLE(ct.id:8!null)\n" +
			"         │                                       ├─ right-key: TUPLE(mc.company_type_id:11!null)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ Eq\n" +
			"         │                                           │   ├─ mc.company_id:20!null\n" +
			"         │                                           │   └─ cn.id:10!null\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ AND\n" +
			"         │                                           │   │   ├─ NOT\n" +
			"         │                                           │   │   │   └─ Eq\n" +
			"         │                                           │   │   │       ├─ cn.country_code:2\n" +
			"         │                                           │   │   │       └─ [pl] (longtext)\n" +
			"         │                                           │   │   └─ Or\n" +
			"         │                                           │   │       ├─ cn.name LIKE '%Film%'\n" +
			"         │                                           │   │       └─ cn.name LIKE '%Warner%'\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ ProcessTable\n" +
			"         │                                           │           └─ Table\n" +
			"         │                                           │               ├─ name: company_name\n" +
			"         │                                           │               └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: TUPLE(cn.id:10!null)\n" +
			"         │                                               ├─ right-key: TUPLE(mc.company_id:7!null)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ Eq\n" +
			"         │                                                   │   │   ├─ ml.movie_id:13!null\n" +
			"         │                                                   │   │   └─ mk.movie_id:15!null\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ ProcessTable\n" +
			"         │                                                   │   │       └─ Table\n" +
			"         │                                                   │   │           ├─ name: movie_link\n" +
			"         │                                                   │   │           └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ Eq\n" +
			"         │                                                   │       │   │   ├─ mk.movie_id:15!null\n" +
			"         │                                                   │       │   │   └─ mi.movie_id:17!null\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ ProcessTable\n" +
			"         │                                                   │       │   │       └─ Table\n" +
			"         │                                                   │       │   │           ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ HashIn\n" +
			"         │                                                   │       │       │   ├─ mi.info:1!null\n" +
			"         │                                                   │       │       │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), English (longtext))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ ProcessTable\n" +
			"         │                                                   │       │               └─ Table\n" +
			"         │                                                   │       │                   ├─ name: movie_info\n" +
			"         │                                                   │       │                   └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note:3 IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ keys: [mi.movie_id:17!null]\n" +
			"         │                                                   │                   ├─ colSet: (23-27)\n" +
			"         │                                                   │                   ├─ tableId: 8\n" +
			"         │                                                   │                   └─ Table\n" +
			"         │                                                   │                       ├─ name: movie_companies\n" +
			"         │                                                   │                       └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ keys: [mc.movie_id:19!null]\n" +
			"         │                                                           ├─ colSet: (1-4)\n" +
			"         │                                                           ├─ tableId: 1\n" +
			"         │                                                           └─ Table\n" +
			"         │                                                               ├─ name: complete_cast\n" +
			"         │                                                               └─ columns: [movie_id subject_id status_id]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(ml.movie_id:13!null, mk.movie_id:15!null, mc.movie_id:19!null, mi.movie_id:17!null, cc.movie_id:23)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 1950 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2010 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ ((cct2.kind >= 'complete') AND (cct2.kind <= 'completeÿ'))\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as producing_company, min(lt.link) as link_type, min(t.title) as complete_western_sequel]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(lt.link), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((ml.movie_id = t.id) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id)) AND (mi.movie_id = t.id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   └─ TableAlias(cct1)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: comp_cast_type\n" +
			"         │   │           └─ columns: [id kind]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (cct1.id)\n" +
			"         │       ├─ right-key: (cc.subject_id)\n" +
			"         │       └─ HashJoin\n" +
			"         │           ├─ (cct2.id = cc.status_id)\n" +
			"         │           ├─ Filter\n" +
			"         │           │   ├─ ((cct2.kind >= 'complete') AND (cct2.kind <= 'completeÿ'))\n" +
			"         │           │   └─ TableAlias(cct2)\n" +
			"         │           │       └─ Table\n" +
			"         │           │           ├─ name: comp_cast_type\n" +
			"         │           │           └─ columns: [id kind]\n" +
			"         │           └─ HashLookup\n" +
			"         │               ├─ left-key: (cct2.id)\n" +
			"         │               ├─ right-key: (cc.status_id)\n" +
			"         │               └─ HashJoin\n" +
			"         │                   ├─ (lt.id = ml.link_type_id)\n" +
			"         │                   ├─ Filter\n" +
			"         │                   │   ├─ lt.link LIKE '%follow%'\n" +
			"         │                   │   └─ TableAlias(lt)\n" +
			"         │                   │       └─ Table\n" +
			"         │                   │           ├─ name: link_type\n" +
			"         │                   │           └─ columns: [id link]\n" +
			"         │                   └─ HashLookup\n" +
			"         │                       ├─ left-key: (lt.id)\n" +
			"         │                       ├─ right-key: (ml.link_type_id)\n" +
			"         │                       └─ HashJoin\n" +
			"         │                           ├─ (mk.keyword_id = k.id)\n" +
			"         │                           ├─ Filter\n" +
			"         │                           │   ├─ (k.keyword = 'sequel')\n" +
			"         │                           │   └─ TableAlias(k)\n" +
			"         │                           │       └─ Table\n" +
			"         │                           │           ├─ name: keyword\n" +
			"         │                           │           └─ columns: [id keyword]\n" +
			"         │                           └─ HashLookup\n" +
			"         │                               ├─ left-key: (k.id)\n" +
			"         │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │                               └─ HashJoin\n" +
			"         │                                   ├─ (mc.company_type_id = ct.id)\n" +
			"         │                                   ├─ Filter\n" +
			"         │                                   │   ├─ (ct.kind = 'production companies')\n" +
			"         │                                   │   └─ TableAlias(ct)\n" +
			"         │                                   │       └─ Table\n" +
			"         │                                   │           ├─ name: company_type\n" +
			"         │                                   │           └─ columns: [id kind]\n" +
			"         │                                   └─ HashLookup\n" +
			"         │                                       ├─ left-key: (ct.id)\n" +
			"         │                                       ├─ right-key: (mc.company_type_id)\n" +
			"         │                                       └─ HashJoin\n" +
			"         │                                           ├─ (mc.company_id = cn.id)\n" +
			"         │                                           ├─ Filter\n" +
			"         │                                           │   ├─ ((NOT((cn.country_code = '[pl]'))) AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%'))\n" +
			"         │                                           │   └─ TableAlias(cn)\n" +
			"         │                                           │       └─ Table\n" +
			"         │                                           │           ├─ name: company_name\n" +
			"         │                                           │           └─ columns: [id name country_code]\n" +
			"         │                                           └─ HashLookup\n" +
			"         │                                               ├─ left-key: (cn.id)\n" +
			"         │                                               ├─ right-key: (mc.company_id)\n" +
			"         │                                               └─ LookupJoin\n" +
			"         │                                                   ├─ InnerJoin\n" +
			"         │                                                   │   ├─ (ml.movie_id = mk.movie_id)\n" +
			"         │                                                   │   ├─ TableAlias(ml)\n" +
			"         │                                                   │   │   └─ Table\n" +
			"         │                                                   │   │       ├─ name: movie_link\n" +
			"         │                                                   │   │       └─ columns: [movie_id link_type_id]\n" +
			"         │                                                   │   └─ LookupJoin\n" +
			"         │                                                   │       ├─ InnerJoin\n" +
			"         │                                                   │       │   ├─ (mk.movie_id = mi.movie_id)\n" +
			"         │                                                   │       │   ├─ TableAlias(mk)\n" +
			"         │                                                   │       │   │   └─ Table\n" +
			"         │                                                   │       │   │       ├─ name: movie_keyword\n" +
			"         │                                                   │       │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │                                                   │       │   └─ Filter\n" +
			"         │                                                   │       │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English'))\n" +
			"         │                                                   │       │       └─ TableAlias(mi)\n" +
			"         │                                                   │       │           └─ Table\n" +
			"         │                                                   │       │               ├─ name: movie_info\n" +
			"         │                                                   │       │               └─ columns: [movie_id info]\n" +
			"         │                                                   │       └─ Filter\n" +
			"         │                                                   │           ├─ mc.note IS NULL\n" +
			"         │                                                   │           └─ TableAlias(mc)\n" +
			"         │                                                   │               └─ IndexedTableAccess(movie_companies)\n" +
			"         │                                                   │                   ├─ index: [movie_companies.movie_id]\n" +
			"         │                                                   │                   ├─ columns: [movie_id company_id company_type_id note]\n" +
			"         │                                                   │                   └─ keys: mi.movie_id\n" +
			"         │                                                   └─ TableAlias(cc)\n" +
			"         │                                                       └─ IndexedTableAccess(complete_cast)\n" +
			"         │                                                           ├─ index: [complete_cast.movie_id]\n" +
			"         │                                                           ├─ columns: [movie_id subject_id status_id]\n" +
			"         │                                                           └─ keys: mc.movie_id\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (ml.movie_id, mk.movie_id, mc.movie_id, mi.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 1950) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS complete_euro_dark_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'crew'
  AND cct2.kind != 'complete+verified'
  AND cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Danish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2000
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:23!null), MIN(mi_idx.info:32!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mc.movie_id:18!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi_idx.movie_id:30!null\n" +
			"         │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:30!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:26!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:26!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   └─ mc.movie_id:18!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ NOT\n" +
			"         │   │   │   │   │       │   │   └─ Eq\n" +
			"         │   │   │   │   │       │   │       ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │       │   │       └─ complete+verified (longtext)\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ crew (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it1.id:16!null\n" +
			"         │   │   │       │   └─ mi.info_type_id:14!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ HashIn\n" +
			"         │   │   │       │   │   ├─ mi.info:2!null\n" +
			"         │   │   │       │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Danish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: movie_info\n" +
			"         │   │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it1.info:1!null\n" +
			"         │   │   │           │   └─ countries (longtext)\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ ct.id:25!null\n" +
			"         │   │       │   └─ mc.company_type_id:20!null\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ Eq\n" +
			"         │   │       │   │   ├─ cn.id:22!null\n" +
			"         │   │       │   │   └─ mc.company_id:19!null\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ NOT\n" +
			"         │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ ProcessTable\n" +
			"         │   │       │   │           └─ Table\n" +
			"         │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ NOT\n" +
			"         │   │       │       │   └─ Eq\n" +
			"         │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ ProcessTable\n" +
			"         │   │       │               └─ Table\n" +
			"         │   │       │                   ├─ name: company_name\n" +
			"         │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: company_type\n" +
			"         │   │                   └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:28!null\n" +
			"         │       │   └─ mk.keyword_id:27!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ it2.id:33!null\n" +
			"             │   └─ mi_idx.info_type_id:31!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ LessThan\n" +
			"             │   │   ├─ mi_idx.info:2!null\n" +
			"             │   │   └─ 8.5 (longtext)\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: movie_info_idx\n" +
			"             │               └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it2.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         ├─ columns: [id info]\n" +
			"                         ├─ colSet: (20,21)\n" +
			"                         └─ tableId: 7\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (NOT((cct2.kind = 'complete+verified')))\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'crew')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info < '8.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (NOT((cct2.kind = 'complete+verified')))\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'crew')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info < '8.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS complete_euro_dark_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'crew'
  AND cct2.kind != 'complete+verified'
  AND cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Sweden',
                  'Germany',
                  'Swedish',
                  'German')
  AND mi_idx.info > '6.5'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:23!null), MIN(mi_idx.info:32!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mc.movie_id:18!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi_idx.movie_id:30!null\n" +
			"         │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:30!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:26!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:26!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   └─ mc.movie_id:18!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ NOT\n" +
			"         │   │   │   │   │       │   │   └─ Eq\n" +
			"         │   │   │   │   │       │   │       ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │       │   │       └─ complete+verified (longtext)\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ crew (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it1.id:16!null\n" +
			"         │   │   │       │   └─ mi.info_type_id:14!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ HashIn\n" +
			"         │   │   │       │   │   ├─ mi.info:2!null\n" +
			"         │   │   │       │   │   └─ TUPLE(Sweden (longtext), Germany (longtext), Swedish (longtext), German (longtext))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: movie_info\n" +
			"         │   │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it1.info:1!null\n" +
			"         │   │   │           │   └─ countries (longtext)\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ ct.id:25!null\n" +
			"         │   │       │   └─ mc.company_type_id:20!null\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ Eq\n" +
			"         │   │       │   │   ├─ cn.id:22!null\n" +
			"         │   │       │   │   └─ mc.company_id:19!null\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ NOT\n" +
			"         │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ ProcessTable\n" +
			"         │   │       │   │           └─ Table\n" +
			"         │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ NOT\n" +
			"         │   │       │       │   └─ Eq\n" +
			"         │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ ProcessTable\n" +
			"         │   │       │               └─ Table\n" +
			"         │   │       │                   ├─ name: company_name\n" +
			"         │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: company_type\n" +
			"         │   │                   └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:28!null\n" +
			"         │       │   └─ mk.keyword_id:27!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ it2.id:33!null\n" +
			"             │   └─ mi_idx.info_type_id:31!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ GreaterThan\n" +
			"             │   │   ├─ mi_idx.info:2!null\n" +
			"             │   │   └─ 6.5 (longtext)\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: movie_info_idx\n" +
			"             │               └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it2.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         ├─ columns: [id info]\n" +
			"                         ├─ colSet: (20,21)\n" +
			"                         └─ tableId: 7\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (NOT((cct2.kind = 'complete+verified')))\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'crew')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info > '6.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (NOT((cct2.kind = 'complete+verified')))\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'crew')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Germany', 'Swedish', 'German'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info > '6.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn.name) AS movie_company,
       MIN(mi_idx.info) AS rating,
       MIN(t.title) AS complete_euro_dark_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     company_name AS cn,
     company_type AS ct,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     kind_type AS kt,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind = 'complete'
  AND cn.country_code != '[us]'
  AND it1.info = 'countries'
  AND it2.info = 'rating'
  AND k.keyword IN ('murder',
                    'murder-in-title',
                    'blood',
                    'violence')
  AND kt.kind IN ('movie',
                  'episode')
  AND mc.note NOT LIKE '%(USA)%'
  AND mc.note LIKE '%(200%)%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Danish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND mi_idx.info < '8.5'
  AND t.production_year > 2005
  AND kt.id = t.kind_id
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = mc.movie_id
  AND t.id = cc.movie_id
  AND mk.movie_id = mi.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND mk.movie_id = mc.movie_id
  AND mk.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi.movie_id = cc.movie_id
  AND mc.movie_id = mi_idx.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND k.id = mk.keyword_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND ct.id = mc.company_type_id
  AND cn.id = mc.company_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn.name):0!null as movie_company, min(mi_idx.info):1!null as rating, min(t.title):2!null as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn.name:23!null), MIN(mi_idx.info:32!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   │   └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ mc.movie_id:18!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mi_idx.movie_id:30!null\n" +
			"         │   │   │       └─ cc.movie_id:8\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │       └─ mi_idx.movie_id:30!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi_idx.movie_id:30!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mk.movie_id:26!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ mk.movie_id:26!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:0!null\n" +
			"         │   │       └─ mk.movie_id:26!null\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ mi.movie_id:13!null\n" +
			"         │   │   │   │   └─ mc.movie_id:18!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:0!null\n" +
			"         │   │   │       └─ mc.movie_id:18!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   └─ mi.movie_id:13!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ kt.id:11!null\n" +
			"         │   │   │   │   │   └─ t.kind_id:2!null\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   ├─ t.id:0!null\n" +
			"         │   │   │   │   │   │   └─ cc.movie_id:8\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ GreaterThan\n" +
			"         │   │   │   │   │   │   │   ├─ t.production_year:3\n" +
			"         │   │   │   │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: title\n" +
			"         │   │   │   │   │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │       │   ├─ cct2.id:4!null\n" +
			"         │   │   │   │   │       │   └─ cc.status_id:10!null\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ Eq\n" +
			"         │   │   │   │   │       │   │   ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │       │   │   └─ complete (longtext)\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │   │   │       │           └─ Table\n" +
			"         │   │   │   │   │       │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ Eq\n" +
			"         │   │   │   │   │           │   ├─ cct1.id:6!null\n" +
			"         │   │   │   │   │           │   └─ cc.subject_id:9!null\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ Eq\n" +
			"         │   │   │   │   │           │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │           │   │   └─ cast (longtext)\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           ├─ columns: [id kind]\n" +
			"         │   │   │   │   │           │           ├─ colSet: (5,6)\n" +
			"         │   │   │   │   │           │           └─ tableId: 2\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ ProcessTable\n" +
			"         │   │   │   │   │                   └─ Table\n" +
			"         │   │   │   │   │                       ├─ name: complete_cast\n" +
			"         │   │   │   │   │                       └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │       │   ├─ kt.kind:1!null\n" +
			"         │   │   │   │       │   └─ TUPLE(movie (longtext), episode (longtext))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │               └─ Table\n" +
			"         │   │   │   │                   ├─ name: kind_type\n" +
			"         │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ Eq\n" +
			"         │   │   │       │   ├─ it1.id:16!null\n" +
			"         │   │   │       │   └─ mi.info_type_id:14!null\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ HashIn\n" +
			"         │   │   │       │   │   ├─ mi.info:2!null\n" +
			"         │   │   │       │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Danish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ ProcessTable\n" +
			"         │   │   │       │           └─ Table\n" +
			"         │   │   │       │               ├─ name: movie_info\n" +
			"         │   │   │       │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ Eq\n" +
			"         │   │   │           │   ├─ it1.info:1!null\n" +
			"         │   │   │           │   └─ countries (longtext)\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ ProcessTable\n" +
			"         │   │   │                   └─ Table\n" +
			"         │   │   │                       ├─ name: info_type\n" +
			"         │   │   │                       └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ Eq\n" +
			"         │   │       │   ├─ ct.id:25!null\n" +
			"         │   │       │   └─ mc.company_type_id:20!null\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ Eq\n" +
			"         │   │       │   │   ├─ cn.id:22!null\n" +
			"         │   │       │   │   └─ mc.company_id:19!null\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ AND\n" +
			"         │   │       │   │   │   ├─ NOT\n" +
			"         │   │       │   │   │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │   │       │   │   │   └─ mc.note LIKE '%(200%)%'\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ ProcessTable\n" +
			"         │   │       │   │           └─ Table\n" +
			"         │   │       │   │               ├─ name: movie_companies\n" +
			"         │   │       │   │               └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ NOT\n" +
			"         │   │       │       │   └─ Eq\n" +
			"         │   │       │       │       ├─ cn.country_code:2\n" +
			"         │   │       │       │       └─ [us] (longtext)\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ ProcessTable\n" +
			"         │   │       │               └─ Table\n" +
			"         │   │       │                   ├─ name: company_name\n" +
			"         │   │       │                   └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ ProcessTable\n" +
			"         │   │               └─ Table\n" +
			"         │   │                   ├─ name: company_type\n" +
			"         │   │                   └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:28!null\n" +
			"         │       │   └─ mk.keyword_id:27!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(murder (longtext), murder-in-title (longtext), blood (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ it2.id:33!null\n" +
			"             │   └─ mi_idx.info_type_id:31!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ LessThan\n" +
			"             │   │   ├─ mi_idx.info:2!null\n" +
			"             │   │   └─ 8.5 (longtext)\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: movie_info_idx\n" +
			"             │               └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it2.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         ├─ columns: [id info]\n" +
			"                         ├─ colSet: (20,21)\n" +
			"                         └─ tableId: 7\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (cct2.kind = 'complete')\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info < '8.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn.name) as movie_company, min(mi_idx.info) as rating, min(t.title) as complete_euro_dark_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn.name), MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((((mi.movie_id = mi_idx.movie_id) AND (mc.movie_id = mi_idx.movie_id)) AND (mi_idx.movie_id = cc.movie_id)) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mi_idx.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (((mk.movie_id = mi.movie_id) AND (mk.movie_id = mc.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         │   ├─ InnerJoin\n" +
			"         │   │   ├─ ((mi.movie_id = mc.movie_id) AND (t.id = mc.movie_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ (t.id = mi.movie_id)\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (kt.id = t.kind_id)\n" +
			"         │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   ├─ (t.id = cc.movie_id)\n" +
			"         │   │   │   │   │   ├─ Filter\n" +
			"         │   │   │   │   │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   │   │   │   │   └─ TableAlias(t)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: title\n" +
			"         │   │   │   │   │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   │   │   │   │   └─ InnerJoin\n" +
			"         │   │   │   │   │       ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │       ├─ Filter\n" +
			"         │   │   │   │   │       │   ├─ (cct2.kind = 'complete')\n" +
			"         │   │   │   │   │       │   └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │       │       └─ Table\n" +
			"         │   │   │   │   │       │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │       │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │       └─ InnerJoin\n" +
			"         │   │   │   │   │           ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │           ├─ Filter\n" +
			"         │   │   │   │   │           │   ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │           │   └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │           │       └─ Table\n" +
			"         │   │   │   │   │           │           ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │           │           └─ columns: [id kind]\n" +
			"         │   │   │   │   │           └─ TableAlias(cc)\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: complete_cast\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   └─ Filter\n" +
			"         │   │   │   │       ├─ (kt.kind HASH IN ('movie', 'episode'))\n" +
			"         │   │   │   │       └─ TableAlias(kt)\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: kind_type\n" +
			"         │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   └─ InnerJoin\n" +
			"         │   │   │       ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │   │       ├─ Filter\n" +
			"         │   │   │       │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Danish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │   │   │       │   └─ TableAlias(mi)\n" +
			"         │   │   │       │       └─ Table\n" +
			"         │   │   │       │           ├─ name: movie_info\n" +
			"         │   │   │       │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │       └─ Filter\n" +
			"         │   │   │           ├─ (it1.info = 'countries')\n" +
			"         │   │   │           └─ TableAlias(it1)\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: info_type\n" +
			"         │   │   │                   └─ columns: [id info]\n" +
			"         │   │   └─ InnerJoin\n" +
			"         │   │       ├─ (ct.id = mc.company_type_id)\n" +
			"         │   │       ├─ InnerJoin\n" +
			"         │   │       │   ├─ (cn.id = mc.company_id)\n" +
			"         │   │       │   ├─ Filter\n" +
			"         │   │       │   │   ├─ ((NOT(mc.note LIKE '%(USA)%')) AND mc.note LIKE '%(200%)%')\n" +
			"         │   │       │   │   └─ TableAlias(mc)\n" +
			"         │   │       │   │       └─ Table\n" +
			"         │   │       │   │           ├─ name: movie_companies\n" +
			"         │   │       │   │           └─ columns: [movie_id company_id company_type_id note]\n" +
			"         │   │       │   └─ Filter\n" +
			"         │   │       │       ├─ (NOT((cn.country_code = '[us]')))\n" +
			"         │   │       │       └─ TableAlias(cn)\n" +
			"         │   │       │           └─ Table\n" +
			"         │   │       │               ├─ name: company_name\n" +
			"         │   │       │               └─ columns: [id name country_code]\n" +
			"         │   │       └─ TableAlias(ct)\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: company_type\n" +
			"         │   │               └─ columns: [id]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('murder', 'murder-in-title', 'blood', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (it2.id = mi_idx.info_type_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (mi_idx.info < '8.5')\n" +
			"             │   └─ TableAlias(mi_idx)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_info_idx\n" +
			"             │           └─ columns: [movie_id info_type_id info]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it2.info = 'rating')\n" +
			"                 └─ TableAlias(it2)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS voiced_char,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS voiced_animation
FROM aka_name AS an,
     complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     info_type AS it3,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     name AS n,
     person_info AS pi,
     role_type AS rt,
     title AS t
WHERE cct1.kind ='cast'
  AND cct2.kind ='complete+verified'
  AND chn.name = 'Queen'
  AND ci.note IN ('(voice)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND it3.info = 'trivia'
  AND k.keyword = 'computer-animation'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%200%'
       OR mi.info LIKE 'USA:%200%')
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.title = 'Shrek 2'
  AND t.production_year BETWEEN 2000 AND 2010
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mk.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = ci.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id
  AND n.id = pi.person_id
  AND ci.person_id = pi.person_id
  AND it3.id = pi.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as voiced_char, min(n.name):1!null as voicing_actress, min(t.title):2!null as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:9!null), MIN(n.name:31!null), MIN(t.title:38!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:37!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:25!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │   │       └─ mc.movie_id:23!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │       └─ ci.movie_id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:37!null\n" +
			"         │   │       └─ mk.movie_id:28!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:37!null\n" +
			"         │       └─ cc.movie_id:1\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ rt.id:35!null\n" +
			"         │   │   └─ ci.role_id:14!null\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ pi.person_id:33!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ it3.id:19!null\n" +
			"         │   │   │       └─ pi.info_type_id:34!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ n.id:30!null\n" +
			"         │   │   │   │   │   └─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ n.id:30!null\n" +
			"         │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ k.id:21!null\n" +
			"         │   │   │   │   │       └─ mk.keyword_id:29!null\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ it.id:17!null\n" +
			"         │   │   │   │   │   │       └─ mi.info_type_id:26!null\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ cn.id:15!null\n" +
			"         │   │   │   │   │   │   │       └─ mc.company_id:24!null\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct2.id:6!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.status_id:3!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.subject_id:2!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ cast (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (15,16)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ tableId: 4\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ chn.name:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       │   └─ Queen (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │                   ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   ├─ ci.note:3\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   └─ TUPLE((voice) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ keys: [chn.id:8!null]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (24-30)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ tableId: 6\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   ├─ name: cast_info\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   ├─ cn.country_code:1\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   └─ [us] (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │                   ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │                   └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │       │   ├─ it.info:1!null\n" +
			"         │   │   │   │   │   │   │   │   │       │   └─ release dates (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │                   ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │                   └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │       │   ├─ it3.info:1!null\n" +
			"         │   │   │   │   │   │   │   │       │   └─ trivia (longtext)\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               ├─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │               ├─ colSet: (40,41)\n" +
			"         │   │   │   │   │   │   │   │               └─ tableId: 9\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │       │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   │   │   │       │   └─ computer-animation (longtext)\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │                   ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │                   └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │               └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ AND\n" +
			"         │   │   │   │   │       │   ├─ NOT\n" +
			"         │   │   │   │   │       │   │   └─ mi.info:2!null IS NULL\n" +
			"         │   │   │   │   │       │   └─ Or\n" +
			"         │   │   │   │   │       │       ├─ mi.info LIKE 'Japan:%200%'\n" +
			"         │   │   │   │   │       │       └─ mi.info LIKE 'USA:%200%'\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ keys: [mc.movie_id:23!null]\n" +
			"         │   │   │   │   │               ├─ colSet: (50-54)\n" +
			"         │   │   │   │   │               ├─ tableId: 12\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: movie_info\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: movie_keyword\n" +
			"         │   │   │   │               └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ AND\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ n.gender:2\n" +
			"         │   │   │       │   │   └─ f (longtext)\n" +
			"         │   │   │       │   └─ n.name LIKE '%An%'\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: name\n" +
			"         │   │   │                   └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ keys: [n.id:30!null]\n" +
			"         │   │           ├─ colSet: (67-71)\n" +
			"         │   │           ├─ tableId: 15\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: person_info\n" +
			"         │   │               └─ columns: [person_id info_type_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.role_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(rt.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ rt.role:1!null\n" +
			"         │           │   └─ actress (longtext)\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: role_type\n" +
			"         │                       └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:25!null, mc.movie_id:23!null, ci.movie_id:11!null, mk.movie_id:28!null, cc.movie_id:1)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ t.title:1!null\n" +
			"                 │   │   │   └─ Shrek 2 (longtext)\n" +
			"                 │   │   └─ GreaterThanOrEqual\n" +
			"                 │   │       ├─ t.production_year:2\n" +
			"                 │   │       └─ 2000 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2010 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ (chn.name = 'Queen')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'trivia')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.title = 'Shrek 2') AND (t.production_year >= 2000)) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ (chn.name = 'Queen')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'trivia')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.title = 'Shrek 2') AND (t.production_year >= 2000)) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS voiced_char,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS voiced_animation
FROM aka_name AS an,
     complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     info_type AS it3,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     name AS n,
     person_info AS pi,
     role_type AS rt,
     title AS t
WHERE cct1.kind ='cast'
  AND cct2.kind ='complete+verified'
  AND chn.name = 'Queen'
  AND ci.note IN ('(voice)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND it3.info = 'height'
  AND k.keyword = 'computer-animation'
  AND mi.info LIKE 'USA:%200%'
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.title = 'Shrek 2'
  AND t.production_year BETWEEN 2000 AND 2005
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mk.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = ci.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id
  AND n.id = pi.person_id
  AND ci.person_id = pi.person_id
  AND it3.id = pi.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as voiced_char, min(n.name):1!null as voicing_actress, min(t.title):2!null as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:9!null), MIN(n.name:31!null), MIN(t.title:38!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:37!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:25!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │   │       └─ mc.movie_id:23!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │       └─ ci.movie_id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:37!null\n" +
			"         │   │       └─ mk.movie_id:28!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:37!null\n" +
			"         │       └─ cc.movie_id:1\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ rt.id:35!null\n" +
			"         │   │   └─ ci.role_id:14!null\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ pi.person_id:33!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ it3.id:19!null\n" +
			"         │   │   │       └─ pi.info_type_id:34!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ n.id:30!null\n" +
			"         │   │   │   │   │   └─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ n.id:30!null\n" +
			"         │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ k.id:21!null\n" +
			"         │   │   │   │   │       └─ mk.keyword_id:29!null\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ it.id:17!null\n" +
			"         │   │   │   │   │   │       └─ mi.info_type_id:26!null\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ cn.id:15!null\n" +
			"         │   │   │   │   │   │   │       └─ mc.company_id:24!null\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct2.id:6!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.status_id:3!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.subject_id:2!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ cast (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (15,16)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ tableId: 4\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ chn.name:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       │   └─ Queen (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │                   ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   ├─ ci.note:3\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   └─ TUPLE((voice) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ keys: [chn.id:8!null]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (24-30)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ tableId: 6\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   ├─ name: cast_info\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   ├─ cn.country_code:1\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   └─ [us] (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │                   ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │                   └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │       │   ├─ it.info:1!null\n" +
			"         │   │   │   │   │   │   │   │   │       │   └─ release dates (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │                   ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │                   └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │       │   ├─ it3.info:1!null\n" +
			"         │   │   │   │   │   │   │   │       │   └─ height (longtext)\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               ├─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │               ├─ colSet: (40,41)\n" +
			"         │   │   │   │   │   │   │   │               └─ tableId: 9\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │       │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   │   │   │       │   └─ computer-animation (longtext)\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │                   ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │                   └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │               └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ mi.info LIKE 'USA:%200%'\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ keys: [mc.movie_id:23!null]\n" +
			"         │   │   │   │   │               ├─ colSet: (50-54)\n" +
			"         │   │   │   │   │               ├─ tableId: 12\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: movie_info\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: movie_keyword\n" +
			"         │   │   │   │               └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ AND\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ n.gender:2\n" +
			"         │   │   │       │   │   └─ f (longtext)\n" +
			"         │   │   │       │   └─ n.name LIKE '%An%'\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: name\n" +
			"         │   │   │                   └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ keys: [n.id:30!null]\n" +
			"         │   │           ├─ colSet: (67-71)\n" +
			"         │   │           ├─ tableId: 15\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: person_info\n" +
			"         │   │               └─ columns: [person_id info_type_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.role_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(rt.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ rt.role:1!null\n" +
			"         │           │   └─ actress (longtext)\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: role_type\n" +
			"         │                       └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:25!null, mc.movie_id:23!null, ci.movie_id:11!null, mk.movie_id:28!null, cc.movie_id:1)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ t.title:1!null\n" +
			"                 │   │   │   └─ Shrek 2 (longtext)\n" +
			"                 │   │   └─ GreaterThanOrEqual\n" +
			"                 │   │       ├─ t.production_year:2\n" +
			"                 │   │       └─ 2000 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2005 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ (chn.name = 'Queen')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'height')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ mi.info LIKE 'USA:%200%'\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.title = 'Shrek 2') AND (t.production_year >= 2000)) AND (t.production_year <= 2005))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ (chn.name = 'Queen')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'height')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ mi.info LIKE 'USA:%200%'\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ (((t.title = 'Shrek 2') AND (t.production_year >= 2000)) AND (t.production_year <= 2005))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(chn.name) AS voiced_char,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS voiced_animation
FROM aka_name AS an,
     complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     info_type AS it,
     info_type AS it3,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_keyword AS mk,
     name AS n,
     person_info AS pi,
     role_type AS rt,
     title AS t
WHERE cct1.kind ='cast'
  AND cct2.kind ='complete+verified'
  AND ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND it.info = 'release dates'
  AND it3.info = 'trivia'
  AND k.keyword = 'computer-animation'
  AND mi.info IS NOT NULL
  AND (mi.info LIKE 'Japan:%200%'
       OR mi.info LIKE 'USA:%200%')
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2000 AND 2010
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND mc.movie_id = ci.movie_id
  AND mc.movie_id = mi.movie_id
  AND mc.movie_id = mk.movie_id
  AND mc.movie_id = cc.movie_id
  AND mi.movie_id = ci.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND cn.id = mc.company_id
  AND it.id = mi.info_type_id
  AND n.id = ci.person_id
  AND rt.id = ci.role_id
  AND n.id = an.person_id
  AND ci.person_id = an.person_id
  AND chn.id = ci.person_role_id
  AND n.id = pi.person_id
  AND ci.person_id = pi.person_id
  AND it3.id = pi.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(chn.name):0!null as voiced_char, min(n.name):1!null as voicing_actress, min(t.title):2!null as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(chn.name:9!null), MIN(n.name:31!null), MIN(t.title:38!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:37!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:25!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │   │       └─ mc.movie_id:23!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:37!null\n" +
			"         │   │   │       └─ ci.movie_id:11!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:37!null\n" +
			"         │   │       └─ mk.movie_id:28!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:37!null\n" +
			"         │       └─ cc.movie_id:1\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ rt.id:35!null\n" +
			"         │   │   └─ ci.role_id:14!null\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ pi.person_id:33!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ it3.id:19!null\n" +
			"         │   │   │       └─ pi.info_type_id:34!null\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ n.id:30!null\n" +
			"         │   │   │   │   │   └─ ci.person_id:10!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ n.id:30!null\n" +
			"         │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │       └─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ mk.movie_id:28!null\n" +
			"         │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │       ├─ k.id:21!null\n" +
			"         │   │   │   │   │       └─ mk.keyword_id:29!null\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ mi.movie_id:25!null\n" +
			"         │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │       ├─ it.id:17!null\n" +
			"         │   │   │   │   │   │       └─ mi.info_type_id:26!null\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │   │   └─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │       ├─ mc.movie_id:23!null\n" +
			"         │   │   │   │   │   │   │   │       └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │       ├─ cn.id:15!null\n" +
			"         │   │   │   │   │   │   │       └─ mc.company_id:24!null\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ AND\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.movie_id:1\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       ├─ ci.person_id:10!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ an.person_id:0!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct2.id:6!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.status_id:3!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ cct1.id:4!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ cc.subject_id:2!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct1.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ cast (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   ├─ cct2.kind:1!null\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       │   └─ complete+verified (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (15,16)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ tableId: 4\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ HashIn\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   ├─ ci.note:3\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ keys: [chn.id:8!null]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ colSet: (24-30)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ tableId: 6\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   ├─ name: cast_info\n" +
			"         │   │   │   │   │   │   │   │   │   │   │                   └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   ├─ cn.country_code:1\n" +
			"         │   │   │   │   │   │   │   │   │   │       │   └─ [us] (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │                   ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │                   └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │   │       │   ├─ it.info:1!null\n" +
			"         │   │   │   │   │   │   │   │   │       │   └─ release dates (longtext)\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │                   ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │                   └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │   │       │   ├─ it3.info:1!null\n" +
			"         │   │   │   │   │   │   │   │       │   └─ trivia (longtext)\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               ├─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │               ├─ colSet: (40,41)\n" +
			"         │   │   │   │   │   │   │   │               └─ tableId: 9\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ Eq\n" +
			"         │   │   │   │   │   │   │       │   ├─ k.keyword:1!null\n" +
			"         │   │   │   │   │   │   │       │   └─ computer-animation (longtext)\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ ProcessTable\n" +
			"         │   │   │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │   │   │                   ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │                   └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │               ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │               └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ AND\n" +
			"         │   │   │   │   │       │   ├─ NOT\n" +
			"         │   │   │   │   │       │   │   └─ mi.info:2!null IS NULL\n" +
			"         │   │   │   │   │       │   └─ Or\n" +
			"         │   │   │   │   │       │       ├─ mi.info LIKE 'Japan:%200%'\n" +
			"         │   │   │   │   │       │       └─ mi.info LIKE 'USA:%200%'\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ keys: [mc.movie_id:23!null]\n" +
			"         │   │   │   │   │               ├─ colSet: (50-54)\n" +
			"         │   │   │   │   │               ├─ tableId: 12\n" +
			"         │   │   │   │   │               └─ Table\n" +
			"         │   │   │   │   │                   ├─ name: movie_info\n" +
			"         │   │   │   │   │                   └─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ ProcessTable\n" +
			"         │   │   │   │           └─ Table\n" +
			"         │   │   │   │               ├─ name: movie_keyword\n" +
			"         │   │   │   │               └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ AND\n" +
			"         │   │   │       │   ├─ Eq\n" +
			"         │   │   │       │   │   ├─ n.gender:2\n" +
			"         │   │   │       │   │   └─ f (longtext)\n" +
			"         │   │   │       │   └─ n.name LIKE '%An%'\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ ProcessTable\n" +
			"         │   │   │               └─ Table\n" +
			"         │   │   │                   ├─ name: name\n" +
			"         │   │   │                   └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ keys: [n.id:30!null]\n" +
			"         │   │           ├─ colSet: (67-71)\n" +
			"         │   │           ├─ tableId: 15\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: person_info\n" +
			"         │   │               └─ columns: [person_id info_type_id]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.role_id:14!null)\n" +
			"         │       ├─ right-key: TUPLE(rt.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ rt.role:1!null\n" +
			"         │           │   └─ actress (longtext)\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: role_type\n" +
			"         │                       └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:25!null, mc.movie_id:23!null, ci.movie_id:11!null, mk.movie_id:28!null, cc.movie_id:1)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2000 (smallint)\n" +
			"                 │   └─ LessThanOrEqual\n" +
			"                 │       ├─ t.production_year:2\n" +
			"                 │       └─ 2010 (smallint)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'trivia')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(chn.name) as voiced_char, min(n.name) as voicing_actress, min(t.title) as voiced_animation]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mc.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = cc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (rt.id = ci.role_id)\n" +
			"         │   ├─ LookupJoin\n" +
			"         │   │   ├─ ((ci.person_id = pi.person_id) AND (it3.id = pi.info_type_id))\n" +
			"         │   │   ├─ InnerJoin\n" +
			"         │   │   │   ├─ ((n.id = ci.person_id) AND (n.id = an.person_id))\n" +
			"         │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   ├─ (((((mc.movie_id = mk.movie_id) AND (mi.movie_id = mk.movie_id)) AND (ci.movie_id = mk.movie_id)) AND (mk.movie_id = cc.movie_id)) AND (k.id = mk.keyword_id))\n" +
			"         │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   ├─ (((mi.movie_id = ci.movie_id) AND (mi.movie_id = cc.movie_id)) AND (it.id = mi.info_type_id))\n" +
			"         │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   ├─ (((mc.movie_id = ci.movie_id) AND (mc.movie_id = cc.movie_id)) AND (cn.id = mc.company_id))\n" +
			"         │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   ├─ LookupJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ ((ci.movie_id = cc.movie_id) AND (ci.person_id = an.person_id))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct2.id = cc.status_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ InnerJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ (cct1.id = cc.subject_id)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ CrossJoin\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   ├─ TableAlias(an)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ name: aka_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ columns: [person_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(cc)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: complete_cast\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [movie_id subject_id status_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct1.kind = 'cast')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct1)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       ├─ (cct2.kind = 'complete+verified')\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cct2)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               ├─ name: comp_cast_type\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   │               └─ columns: [id kind]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │   └─ TableAlias(chn)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           ├─ name: char_name\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   │           └─ columns: [id name]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"         │   │   │   │   │   │   │   │   │   │   │       └─ TableAlias(ci)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │           └─ IndexedTableAccess(cast_info)\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ index: [cast_info.person_role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               ├─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"         │   │   │   │   │   │   │   │   │   │   │               └─ keys: chn.id\n" +
			"         │   │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │   │       ├─ (cn.country_code = '[us]')\n" +
			"         │   │   │   │   │   │   │   │   │   │       └─ TableAlias(cn)\n" +
			"         │   │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │   │               ├─ name: company_name\n" +
			"         │   │   │   │   │   │   │   │   │   │               └─ columns: [id country_code]\n" +
			"         │   │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │   │       ├─ (it.info = 'release dates')\n" +
			"         │   │   │   │   │   │   │   │   │       └─ TableAlias(it)\n" +
			"         │   │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │   │       ├─ (it3.info = 'trivia')\n" +
			"         │   │   │   │   │   │   │   │       └─ TableAlias(it3)\n" +
			"         │   │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │   │               ├─ name: info_type\n" +
			"         │   │   │   │   │   │   │   │               └─ columns: [id info]\n" +
			"         │   │   │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │   │   │       ├─ (k.keyword = 'computer-animation')\n" +
			"         │   │   │   │   │   │   │       └─ TableAlias(k)\n" +
			"         │   │   │   │   │   │   │           └─ Table\n" +
			"         │   │   │   │   │   │   │               ├─ name: keyword\n" +
			"         │   │   │   │   │   │   │               └─ columns: [id keyword]\n" +
			"         │   │   │   │   │   │   └─ TableAlias(mc)\n" +
			"         │   │   │   │   │   │       └─ Table\n" +
			"         │   │   │   │   │   │           ├─ name: movie_companies\n" +
			"         │   │   │   │   │   │           └─ columns: [movie_id company_id]\n" +
			"         │   │   │   │   │   └─ Filter\n" +
			"         │   │   │   │   │       ├─ ((NOT(mi.info IS NULL)) AND (mi.info LIKE 'Japan:%200%' OR mi.info LIKE 'USA:%200%'))\n" +
			"         │   │   │   │   │       └─ TableAlias(mi)\n" +
			"         │   │   │   │   │           └─ IndexedTableAccess(movie_info)\n" +
			"         │   │   │   │   │               ├─ index: [movie_info.movie_id]\n" +
			"         │   │   │   │   │               ├─ columns: [movie_id info_type_id info]\n" +
			"         │   │   │   │   │               └─ keys: mc.movie_id\n" +
			"         │   │   │   │   └─ TableAlias(mk)\n" +
			"         │   │   │   │       └─ Table\n" +
			"         │   │   │   │           ├─ name: movie_keyword\n" +
			"         │   │   │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │   │   └─ Filter\n" +
			"         │   │   │       ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"         │   │   │       └─ TableAlias(n)\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: name\n" +
			"         │   │   │               └─ columns: [id name gender]\n" +
			"         │   │   └─ TableAlias(pi)\n" +
			"         │   │       └─ IndexedTableAccess(person_info)\n" +
			"         │   │           ├─ index: [person_info.person_id]\n" +
			"         │   │           ├─ columns: [person_id info_type_id]\n" +
			"         │   │           └─ keys: n.id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.role_id)\n" +
			"         │       ├─ right-key: (rt.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (rt.role = 'actress')\n" +
			"         │           └─ TableAlias(rt)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: role_type\n" +
			"         │                   └─ columns: [id role]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mc.movie_id, ci.movie_id, mk.movie_id, cc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year >= 2000) AND (t.production_year <= 2010))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code ='[de]'
  AND k.keyword ='character-name-in-title'
  AND cn.id = mc.company_id
  AND mc.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ cn.id:8!null\n" +
			"         │   │   │   └─ mc.company_id:3!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:2!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:4!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mc.movie_id:2!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.keyword_id:5!null\n" +
			"             │   │   └─ k.id:6!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ k.keyword:1!null\n" +
			"             │       │   └─ character-name-in-title (longtext)\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cn.country_code:1\n" +
			"                 │   └─ [de] (longtext)\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_name\n" +
			"                             └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[de]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[de]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code ='[nl]'
  AND k.keyword ='character-name-in-title'
  AND cn.id = mc.company_id
  AND mc.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ cn.id:8!null\n" +
			"         │   │   │   └─ mc.company_id:3!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:2!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:4!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mc.movie_id:2!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.keyword_id:5!null\n" +
			"             │   │   └─ k.id:6!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ k.keyword:1!null\n" +
			"             │       │   └─ character-name-in-title (longtext)\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cn.country_code:1\n" +
			"                 │   └─ [nl] (longtext)\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_name\n" +
			"                             └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[nl]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[nl]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code ='[sm]'
  AND k.keyword ='character-name-in-title'
  AND cn.id = mc.company_id
  AND mc.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ cn.id:8!null\n" +
			"         │   │   │   └─ mc.company_id:3!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:2!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:4!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mc.movie_id:2!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.keyword_id:5!null\n" +
			"             │   │   └─ k.id:6!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ k.keyword:1!null\n" +
			"             │       │   └─ character-name-in-title (longtext)\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cn.country_code:1\n" +
			"                 │   └─ [sm] (longtext)\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_name\n" +
			"                             └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[sm]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[sm]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM company_name AS cn,
     keyword AS k,
     movie_companies AS mc,
     movie_keyword AS mk,
     title AS t
WHERE cn.country_code ='[us]'
  AND k.keyword ='character-name-in-title'
  AND cn.id = mc.company_id
  AND mc.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND mc.movie_id = mk.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ cn.id:8!null\n" +
			"         │   │   │   └─ mc.company_id:3!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:2!null\n" +
			"         │   │       └─ mk.movie_id:4!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:4!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mc.movie_id:2!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ mk.keyword_id:5!null\n" +
			"             │   │   └─ k.id:6!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ k.keyword:1!null\n" +
			"             │       │   └─ character-name-in-title (longtext)\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cn.country_code:1\n" +
			"                 │   └─ [us] (longtext)\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_name\n" +
			"                             └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[us]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((cn.id = mc.company_id) AND (mc.movie_id = mk.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (mc.movie_id = t.id)\n" +
			"         │   ├─ TableAlias(t)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ TableAlias(mc)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: movie_companies\n" +
			"         │           └─ columns: [movie_id company_id]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (mk.keyword_id = k.id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (k.keyword = 'character-name-in-title')\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (cn.country_code = '[us]')\n" +
			"                 └─ TableAlias(cn)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_name\n" +
			"                         └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS complete_violent_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind IN ('cast',
                    'crew')
  AND cct2.kind ='complete+verified'
  AND ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Thriller')
  AND n.gender = 'm'
  AND t.production_year > 2000
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:27!null), MIN(n.name:16!null), MIN(t.title:13!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ cct1.id:0!null\n" +
			"         │   └─ cc.subject_id:5!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ HashIn\n" +
			"         │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   └─ TUPLE(cast (longtext), crew (longtext))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: comp_cast_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"             ├─ right-key: TUPLE(cc.subject_id:3!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cct2.id:2!null\n" +
			"                 │   └─ cc.status_id:6!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ cct2.kind:1!null\n" +
			"                 │   │   └─ complete+verified (longtext)\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           ├─ columns: [id kind]\n" +
			"                 │           ├─ colSet: (7,8)\n" +
			"                 │           └─ tableId: 3\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"                     ├─ right-key: TUPLE(cc.status_id:2!null)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ ci.movie_id:19!null\n" +
			"                         │   └─ cc.movie_id:4\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ ProcessTable\n" +
			"                         │       └─ Table\n" +
			"                         │           ├─ name: complete_cast\n" +
			"                         │           └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(cc.movie_id:4)\n" +
			"                             ├─ right-key: TUPLE(ci.movie_id:12!null)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ mi.movie_id:7!null\n" +
			"                                 │   └─ mi_idx.movie_id:25!null\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ Eq\n" +
			"                                 │   │   ├─ it1.id:10!null\n" +
			"                                 │   │   └─ mi.info_type_id:8!null\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ HashIn\n" +
			"                                 │   │   │   ├─ mi.info:2!null\n" +
			"                                 │   │   │   └─ TUPLE(Horror (longtext), Thriller (longtext))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ ProcessTable\n" +
			"                                 │   │           └─ Table\n" +
			"                                 │   │               ├─ name: movie_info\n" +
			"                                 │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ Eq\n" +
			"                                 │       │   ├─ it1.info:1!null\n" +
			"                                 │       │   └─ genres (longtext)\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ ProcessTable\n" +
			"                                 │               └─ Table\n" +
			"                                 │                   ├─ name: info_type\n" +
			"                                 │                   └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(mi.movie_id:7!null)\n" +
			"                                     ├─ right-key: TUPLE(mi_idx.movie_id:13!null)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ Eq\n" +
			"                                         │   ├─ mi_idx.movie_id:25!null\n" +
			"                                         │   └─ mk.movie_id:21!null\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ Eq\n" +
			"                                         │   │   ├─ t.id:12!null\n" +
			"                                         │   │   └─ mk.movie_id:21!null\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ Eq\n" +
			"                                         │   │   │   ├─ t.id:12!null\n" +
			"                                         │   │   │   └─ ci.movie_id:19!null\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ GreaterThan\n" +
			"                                         │   │   │   │   ├─ t.production_year:2\n" +
			"                                         │   │   │   │   └─ 2000 (smallint)\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ ProcessTable\n" +
			"                                         │   │   │           └─ Table\n" +
			"                                         │   │   │               ├─ name: title\n" +
			"                                         │   │   │               └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ Eq\n" +
			"                                         │   │       │   ├─ n.id:15!null\n" +
			"                                         │   │       │   └─ ci.person_id:18!null\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ Eq\n" +
			"                                         │   │       │   │   ├─ n.gender:2\n" +
			"                                         │   │       │   │   └─ m (longtext)\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ ProcessTable\n" +
			"                                         │   │       │           └─ Table\n" +
			"                                         │   │       │               ├─ name: name\n" +
			"                                         │   │       │               └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ HashIn\n" +
			"                                         │   │           │   ├─ ci.note:2\n" +
			"                                         │   │           │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ ProcessTable\n" +
			"                                         │   │                   └─ Table\n" +
			"                                         │   │                       ├─ name: cast_info\n" +
			"                                         │   │                       └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ Eq\n" +
			"                                         │       │   ├─ k.id:23!null\n" +
			"                                         │       │   └─ mk.keyword_id:22!null\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ ProcessTable\n" +
			"                                         │       │       └─ Table\n" +
			"                                         │       │           ├─ name: movie_keyword\n" +
			"                                         │       │           └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ HashIn\n" +
			"                                         │           │   ├─ k.keyword:1!null\n" +
			"                                         │           │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ ProcessTable\n" +
			"                                         │                   └─ Table\n" +
			"                                         │                       ├─ name: keyword\n" +
			"                                         │                       └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: TUPLE(mk.movie_id:21!null)\n" +
			"                                             ├─ right-key: TUPLE(mi_idx.movie_id:0!null)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ Eq\n" +
			"                                                 │   ├─ it2.id:28!null\n" +
			"                                                 │   └─ mi_idx.info_type_id:26!null\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ ProcessTable\n" +
			"                                                 │       └─ Table\n" +
			"                                                 │           ├─ name: movie_info_idx\n" +
			"                                                 │           └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ Eq\n" +
			"                                                     │   ├─ it2.info:1!null\n" +
			"                                                     │   └─ votes (longtext)\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             ├─ columns: [id info]\n" +
			"                                                             ├─ colSet: (18,19)\n" +
			"                                                             └─ tableId: 6\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ (t.production_year > 2000)\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ Table\n" +
			"                                         │   │   │           ├─ name: title\n" +
			"                                         │   │   │           └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ (t.production_year > 2000)\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ Table\n" +
			"                                         │   │   │           ├─ name: title\n" +
			"                                         │   │   │           └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS complete_gore_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind IN ('cast',
                    'crew')
  AND cct2.kind ='complete+verified'
  AND ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Thriller')
  AND n.gender = 'm'
  AND t.production_year > 2000
  AND (t.title LIKE '%Freddy%'
       OR t.title LIKE '%Jason%'
       OR t.title LIKE 'Saw%')
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as complete_gore_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:27!null), MIN(n.name:16!null), MIN(t.title:13!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ cct1.id:0!null\n" +
			"         │   └─ cc.subject_id:5!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ HashIn\n" +
			"         │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   └─ TUPLE(cast (longtext), crew (longtext))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: comp_cast_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"             ├─ right-key: TUPLE(cc.subject_id:3!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cct2.id:2!null\n" +
			"                 │   └─ cc.status_id:6!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ cct2.kind:1!null\n" +
			"                 │   │   └─ complete+verified (longtext)\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           ├─ columns: [id kind]\n" +
			"                 │           ├─ colSet: (7,8)\n" +
			"                 │           └─ tableId: 3\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"                     ├─ right-key: TUPLE(cc.status_id:2!null)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ ci.movie_id:19!null\n" +
			"                         │   └─ cc.movie_id:4\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ ProcessTable\n" +
			"                         │       └─ Table\n" +
			"                         │           ├─ name: complete_cast\n" +
			"                         │           └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(cc.movie_id:4)\n" +
			"                             ├─ right-key: TUPLE(ci.movie_id:12!null)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ mi.movie_id:7!null\n" +
			"                                 │   └─ mi_idx.movie_id:25!null\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ Eq\n" +
			"                                 │   │   ├─ it1.id:10!null\n" +
			"                                 │   │   └─ mi.info_type_id:8!null\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ HashIn\n" +
			"                                 │   │   │   ├─ mi.info:2!null\n" +
			"                                 │   │   │   └─ TUPLE(Horror (longtext), Thriller (longtext))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ ProcessTable\n" +
			"                                 │   │           └─ Table\n" +
			"                                 │   │               ├─ name: movie_info\n" +
			"                                 │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ Eq\n" +
			"                                 │       │   ├─ it1.info:1!null\n" +
			"                                 │       │   └─ genres (longtext)\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ ProcessTable\n" +
			"                                 │               └─ Table\n" +
			"                                 │                   ├─ name: info_type\n" +
			"                                 │                   └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(mi.movie_id:7!null)\n" +
			"                                     ├─ right-key: TUPLE(mi_idx.movie_id:13!null)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ Eq\n" +
			"                                         │   ├─ mi_idx.movie_id:25!null\n" +
			"                                         │   └─ mk.movie_id:21!null\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ Eq\n" +
			"                                         │   │   ├─ t.id:12!null\n" +
			"                                         │   │   └─ mk.movie_id:21!null\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ Eq\n" +
			"                                         │   │   │   ├─ t.id:12!null\n" +
			"                                         │   │   │   └─ ci.movie_id:19!null\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ AND\n" +
			"                                         │   │   │   │   ├─ GreaterThan\n" +
			"                                         │   │   │   │   │   ├─ t.production_year:2\n" +
			"                                         │   │   │   │   │   └─ 2000 (smallint)\n" +
			"                                         │   │   │   │   └─ Or\n" +
			"                                         │   │   │   │       ├─ Or\n" +
			"                                         │   │   │   │       │   ├─ t.title LIKE '%Freddy%'\n" +
			"                                         │   │   │   │       │   └─ t.title LIKE '%Jason%'\n" +
			"                                         │   │   │   │       └─ AND\n" +
			"                                         │   │   │   │           ├─ GreaterThanOrEqual\n" +
			"                                         │   │   │   │           │   ├─ t.title:1!null\n" +
			"                                         │   │   │   │           │   └─ Saw (longtext)\n" +
			"                                         │   │   │   │           └─ LessThanOrEqual\n" +
			"                                         │   │   │   │               ├─ t.title:1!null\n" +
			"                                         │   │   │   │               └─ Sawÿ (longtext)\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ ProcessTable\n" +
			"                                         │   │   │           └─ Table\n" +
			"                                         │   │   │               ├─ name: title\n" +
			"                                         │   │   │               └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ Eq\n" +
			"                                         │   │       │   ├─ n.id:15!null\n" +
			"                                         │   │       │   └─ ci.person_id:18!null\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ Eq\n" +
			"                                         │   │       │   │   ├─ n.gender:2\n" +
			"                                         │   │       │   │   └─ m (longtext)\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ ProcessTable\n" +
			"                                         │   │       │           └─ Table\n" +
			"                                         │   │       │               ├─ name: name\n" +
			"                                         │   │       │               └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ HashIn\n" +
			"                                         │   │           │   ├─ ci.note:2\n" +
			"                                         │   │           │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ ProcessTable\n" +
			"                                         │   │                   └─ Table\n" +
			"                                         │   │                       ├─ name: cast_info\n" +
			"                                         │   │                       └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ Eq\n" +
			"                                         │       │   ├─ k.id:23!null\n" +
			"                                         │       │   └─ mk.keyword_id:22!null\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ ProcessTable\n" +
			"                                         │       │       └─ Table\n" +
			"                                         │       │           ├─ name: movie_keyword\n" +
			"                                         │       │           └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ HashIn\n" +
			"                                         │           │   ├─ k.keyword:1!null\n" +
			"                                         │           │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ ProcessTable\n" +
			"                                         │                   └─ Table\n" +
			"                                         │                       ├─ name: keyword\n" +
			"                                         │                       └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: TUPLE(mk.movie_id:21!null)\n" +
			"                                             ├─ right-key: TUPLE(mi_idx.movie_id:0!null)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ Eq\n" +
			"                                                 │   ├─ it2.id:28!null\n" +
			"                                                 │   └─ mi_idx.info_type_id:26!null\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ ProcessTable\n" +
			"                                                 │       └─ Table\n" +
			"                                                 │           ├─ name: movie_info_idx\n" +
			"                                                 │           └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ Eq\n" +
			"                                                     │   ├─ it2.info:1!null\n" +
			"                                                     │   └─ votes (longtext)\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             ├─ columns: [id info]\n" +
			"                                                             ├─ colSet: (18,19)\n" +
			"                                                             └─ tableId: 6\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_gore_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ ((t.production_year > 2000) AND ((t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%') OR ((t.title >= 'Saw') AND (t.title <= 'Sawÿ'))))\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ Table\n" +
			"                                         │   │   │           ├─ name: title\n" +
			"                                         │   │   │           └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_gore_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind HASH IN ('cast', 'crew'))\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ Filter\n" +
			"                                         │   │   │   ├─ ((t.production_year > 2000) AND ((t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%') OR ((t.title >= 'Saw') AND (t.title <= 'Sawÿ'))))\n" +
			"                                         │   │   │   └─ TableAlias(t)\n" +
			"                                         │   │   │       └─ Table\n" +
			"                                         │   │   │           ├─ name: title\n" +
			"                                         │   │   │           └─ columns: [id title production_year]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS complete_violent_movie
FROM complete_cast AS cc,
     comp_cast_type AS cct1,
     comp_cast_type AS cct2,
     cast_info AS ci,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE cct1.kind = 'cast'
  AND cct2.kind ='complete+verified'
  AND ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Action',
                  'Sci-Fi',
                  'Thriller',
                  'Crime',
                  'War')
  AND n.gender = 'm'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = cc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = cc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = cc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = cc.movie_id
  AND mk.movie_id = cc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cct1.id = cc.subject_id
  AND cct2.id = cc.status_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:9!null), MIN(mi_idx.info:26!null), MIN(n.name:15!null), MIN(t.title:13!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ Eq\n" +
			"         │   ├─ cct1.id:0!null\n" +
			"         │   └─ cc.subject_id:5!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ cct1.kind:1!null\n" +
			"         │   │   └─ cast (longtext)\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: comp_cast_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(cct1.id:0!null)\n" +
			"             ├─ right-key: TUPLE(cc.subject_id:3!null)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ cct2.id:2!null\n" +
			"                 │   └─ cc.status_id:6!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ cct2.kind:1!null\n" +
			"                 │   │   └─ complete+verified (longtext)\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           ├─ columns: [id kind]\n" +
			"                 │           ├─ colSet: (7,8)\n" +
			"                 │           └─ tableId: 3\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: TUPLE(cct2.id:2!null)\n" +
			"                     ├─ right-key: TUPLE(cc.status_id:2!null)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ ci.movie_id:18!null\n" +
			"                         │   └─ cc.movie_id:4\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ ProcessTable\n" +
			"                         │       └─ Table\n" +
			"                         │           ├─ name: complete_cast\n" +
			"                         │           └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: TUPLE(cc.movie_id:4)\n" +
			"                             ├─ right-key: TUPLE(ci.movie_id:11!null)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ Eq\n" +
			"                                 │   ├─ mi.movie_id:7!null\n" +
			"                                 │   └─ mi_idx.movie_id:24!null\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ Eq\n" +
			"                                 │   │   ├─ it1.id:10!null\n" +
			"                                 │   │   └─ mi.info_type_id:8!null\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ HashIn\n" +
			"                                 │   │   │   ├─ mi.info:2!null\n" +
			"                                 │   │   │   └─ TUPLE(Horror (longtext), Action (longtext), Sci-Fi (longtext), Thriller (longtext), Crime (longtext), War (longtext))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ ProcessTable\n" +
			"                                 │   │           └─ Table\n" +
			"                                 │   │               ├─ name: movie_info\n" +
			"                                 │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ Eq\n" +
			"                                 │       │   ├─ it1.info:1!null\n" +
			"                                 │       │   └─ genres (longtext)\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ ProcessTable\n" +
			"                                 │               └─ Table\n" +
			"                                 │                   ├─ name: info_type\n" +
			"                                 │                   └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: TUPLE(mi.movie_id:7!null)\n" +
			"                                     ├─ right-key: TUPLE(mi_idx.movie_id:12!null)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ Eq\n" +
			"                                         │   ├─ mi_idx.movie_id:24!null\n" +
			"                                         │   └─ mk.movie_id:20!null\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ Eq\n" +
			"                                         │   │   ├─ t.id:12!null\n" +
			"                                         │   │   └─ mk.movie_id:20!null\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ Eq\n" +
			"                                         │   │   │   ├─ t.id:12!null\n" +
			"                                         │   │   │   └─ ci.movie_id:18!null\n" +
			"                                         │   │   ├─ TableAlias(t)\n" +
			"                                         │   │   │   └─ ProcessTable\n" +
			"                                         │   │   │       └─ Table\n" +
			"                                         │   │   │           ├─ name: title\n" +
			"                                         │   │   │           └─ columns: [id title]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ Eq\n" +
			"                                         │   │       │   ├─ n.id:14!null\n" +
			"                                         │   │       │   └─ ci.person_id:17!null\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ Eq\n" +
			"                                         │   │       │   │   ├─ n.gender:2\n" +
			"                                         │   │       │   │   └─ m (longtext)\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ ProcessTable\n" +
			"                                         │   │       │           └─ Table\n" +
			"                                         │   │       │               ├─ name: name\n" +
			"                                         │   │       │               └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ HashIn\n" +
			"                                         │   │           │   ├─ ci.note:2\n" +
			"                                         │   │           │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ ProcessTable\n" +
			"                                         │   │                   └─ Table\n" +
			"                                         │   │                       ├─ name: cast_info\n" +
			"                                         │   │                       └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ Eq\n" +
			"                                         │       │   ├─ k.id:22!null\n" +
			"                                         │       │   └─ mk.keyword_id:21!null\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ ProcessTable\n" +
			"                                         │       │       └─ Table\n" +
			"                                         │       │           ├─ name: movie_keyword\n" +
			"                                         │       │           └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ HashIn\n" +
			"                                         │           │   ├─ k.keyword:1!null\n" +
			"                                         │           │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ ProcessTable\n" +
			"                                         │                   └─ Table\n" +
			"                                         │                       ├─ name: keyword\n" +
			"                                         │                       └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: TUPLE(mk.movie_id:20!null)\n" +
			"                                             ├─ right-key: TUPLE(mi_idx.movie_id:0!null)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ Eq\n" +
			"                                                 │   ├─ it2.id:27!null\n" +
			"                                                 │   └─ mi_idx.info_type_id:25!null\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ ProcessTable\n" +
			"                                                 │       └─ Table\n" +
			"                                                 │           ├─ name: movie_info_idx\n" +
			"                                                 │           └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ Eq\n" +
			"                                                     │   ├─ it2.info:1!null\n" +
			"                                                     │   └─ votes (longtext)\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             ├─ columns: [id info]\n" +
			"                                                             ├─ colSet: (18,19)\n" +
			"                                                             └─ tableId: 6\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind = 'cast')\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ TableAlias(t)\n" +
			"                                         │   │   │   └─ Table\n" +
			"                                         │   │   │       ├─ name: title\n" +
			"                                         │   │   │       └─ columns: [id title]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as complete_violent_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (cct1.id = cc.subject_id)\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (cct1.kind = 'cast')\n" +
			"         │   └─ TableAlias(cct1)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: comp_cast_type\n" +
			"         │           └─ columns: [id kind]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (cct1.id)\n" +
			"             ├─ right-key: (cc.subject_id)\n" +
			"             └─ HashJoin\n" +
			"                 ├─ (cct2.id = cc.status_id)\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (cct2.kind = 'complete+verified')\n" +
			"                 │   └─ TableAlias(cct2)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: comp_cast_type\n" +
			"                 │           └─ columns: [id kind]\n" +
			"                 └─ HashLookup\n" +
			"                     ├─ left-key: (cct2.id)\n" +
			"                     ├─ right-key: (cc.status_id)\n" +
			"                     └─ HashJoin\n" +
			"                         ├─ (ci.movie_id = cc.movie_id)\n" +
			"                         ├─ TableAlias(cc)\n" +
			"                         │   └─ Table\n" +
			"                         │       ├─ name: complete_cast\n" +
			"                         │       └─ columns: [movie_id subject_id status_id]\n" +
			"                         └─ HashLookup\n" +
			"                             ├─ left-key: (cc.movie_id)\n" +
			"                             ├─ right-key: (ci.movie_id)\n" +
			"                             └─ HashJoin\n" +
			"                                 ├─ (mi.movie_id = mi_idx.movie_id)\n" +
			"                                 ├─ InnerJoin\n" +
			"                                 │   ├─ (it1.id = mi.info_type_id)\n" +
			"                                 │   ├─ Filter\n" +
			"                                 │   │   ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"                                 │   │   └─ TableAlias(mi)\n" +
			"                                 │   │       └─ Table\n" +
			"                                 │   │           ├─ name: movie_info\n" +
			"                                 │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                                 │   └─ Filter\n" +
			"                                 │       ├─ (it1.info = 'genres')\n" +
			"                                 │       └─ TableAlias(it1)\n" +
			"                                 │           └─ Table\n" +
			"                                 │               ├─ name: info_type\n" +
			"                                 │               └─ columns: [id info]\n" +
			"                                 └─ HashLookup\n" +
			"                                     ├─ left-key: (mi.movie_id)\n" +
			"                                     ├─ right-key: (mi_idx.movie_id)\n" +
			"                                     └─ HashJoin\n" +
			"                                         ├─ (mi_idx.movie_id = mk.movie_id)\n" +
			"                                         ├─ InnerJoin\n" +
			"                                         │   ├─ (t.id = mk.movie_id)\n" +
			"                                         │   ├─ InnerJoin\n" +
			"                                         │   │   ├─ (t.id = ci.movie_id)\n" +
			"                                         │   │   ├─ TableAlias(t)\n" +
			"                                         │   │   │   └─ Table\n" +
			"                                         │   │   │       ├─ name: title\n" +
			"                                         │   │   │       └─ columns: [id title]\n" +
			"                                         │   │   └─ InnerJoin\n" +
			"                                         │   │       ├─ (n.id = ci.person_id)\n" +
			"                                         │   │       ├─ Filter\n" +
			"                                         │   │       │   ├─ (n.gender = 'm')\n" +
			"                                         │   │       │   └─ TableAlias(n)\n" +
			"                                         │   │       │       └─ Table\n" +
			"                                         │   │       │           ├─ name: name\n" +
			"                                         │   │       │           └─ columns: [id name gender]\n" +
			"                                         │   │       └─ Filter\n" +
			"                                         │   │           ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"                                         │   │           └─ TableAlias(ci)\n" +
			"                                         │   │               └─ Table\n" +
			"                                         │   │                   ├─ name: cast_info\n" +
			"                                         │   │                   └─ columns: [person_id movie_id note]\n" +
			"                                         │   └─ InnerJoin\n" +
			"                                         │       ├─ (k.id = mk.keyword_id)\n" +
			"                                         │       ├─ TableAlias(mk)\n" +
			"                                         │       │   └─ Table\n" +
			"                                         │       │       ├─ name: movie_keyword\n" +
			"                                         │       │       └─ columns: [movie_id keyword_id]\n" +
			"                                         │       └─ Filter\n" +
			"                                         │           ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"                                         │           └─ TableAlias(k)\n" +
			"                                         │               └─ Table\n" +
			"                                         │                   ├─ name: keyword\n" +
			"                                         │                   └─ columns: [id keyword]\n" +
			"                                         └─ HashLookup\n" +
			"                                             ├─ left-key: (mk.movie_id)\n" +
			"                                             ├─ right-key: (mi_idx.movie_id)\n" +
			"                                             └─ InnerJoin\n" +
			"                                                 ├─ (it2.id = mi_idx.info_type_id)\n" +
			"                                                 ├─ TableAlias(mi_idx)\n" +
			"                                                 │   └─ Table\n" +
			"                                                 │       ├─ name: movie_info_idx\n" +
			"                                                 │       └─ columns: [movie_id info_type_id info]\n" +
			"                                                 └─ Filter\n" +
			"                                                     ├─ (it2.info = 'votes')\n" +
			"                                                     └─ TableAlias(it2)\n" +
			"                                                         └─ Table\n" +
			"                                                             ├─ name: info_type\n" +
			"                                                             └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS violent_liongate_movie
FROM cast_info AS ci,
     company_name AS cn,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND cn.name LIKE 'Lionsgate%'
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Thriller')
  AND n.gender = 'm'
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(mi_idx.info:9!null), MIN(n.name:22!null), MIN(t.title:25!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:24!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:2!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:24!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:24!null\n" +
			"         │   │   │       └─ ci.movie_id:19!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:24!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:24!null\n" +
			"         │       └─ mc.movie_id:16!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:21!null\n" +
			"         │   │   └─ ci.person_id:18!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:8!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:6!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:2!null\n" +
			"         │   │           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi.movie_id:2!null\n" +
			"         │   │           │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.id:5!null\n" +
			"         │   │           │   │   └─ mi.info_type_id:3!null\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ HashIn\n" +
			"         │   │           │   │   │   ├─ mi.info:2!null\n" +
			"         │   │           │   │   │   └─ TUPLE(Horror (longtext), Thriller (longtext))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ ProcessTable\n" +
			"         │   │           │   │           └─ Table\n" +
			"         │   │           │   │               ├─ name: movie_info\n" +
			"         │   │           │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ Eq\n" +
			"         │   │           │       │   ├─ it1.info:1!null\n" +
			"         │   │           │       │   └─ genres (longtext)\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               ├─ columns: [id info]\n" +
			"         │   │           │               ├─ colSet: (15,16)\n" +
			"         │   │           │               └─ tableId: 3\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi.movie_id:2!null, mi.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.movie_id:9!null, mi_idx.movie_id:0!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ AND\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                   │   └─ Eq\n" +
			"         │   │                   │       ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │       └─ mk.movie_id:14!null\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ ProcessTable\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(mi_idx.movie_id:7!null, mi_idx.movie_id:7!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mc.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ k.id:10!null\n" +
			"         │   │                           │   └─ mk.keyword_id:15!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ HashIn\n" +
			"         │   │                           │   │   ├─ k.keyword:1!null\n" +
			"         │   │                           │   │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ ProcessTable\n" +
			"         │   │                           │           └─ Table\n" +
			"         │   │                           │               ├─ name: keyword\n" +
			"         │   │                           │               └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(k.id:10!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ Eq\n" +
			"         │   │                                   │   ├─ cn.id:12!null\n" +
			"         │   │                                   │   └─ mc.company_id:17!null\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ AND\n" +
			"         │   │                                   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │                                   │   │   │   ├─ cn.name:1!null\n" +
			"         │   │                                   │   │   │   └─ Lionsgate (longtext)\n" +
			"         │   │                                   │   │   └─ LessThanOrEqual\n" +
			"         │   │                                   │   │       ├─ cn.name:1!null\n" +
			"         │   │                                   │   │       └─ Lionsgateÿ (longtext)\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ ProcessTable\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: company_name\n" +
			"         │   │                                   │               └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: TUPLE(cn.id:12!null)\n" +
			"         │   │                                       ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ Eq\n" +
			"         │   │                                           │   │   ├─ mk.movie_id:14!null\n" +
			"         │   │                                           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ ProcessTable\n" +
			"         │   │                                           │   │       └─ Table\n" +
			"         │   │                                           │   │           ├─ name: movie_keyword\n" +
			"         │   │                                           │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ ProcessTable\n" +
			"         │   │                                           │           └─ Table\n" +
			"         │   │                                           │               ├─ name: movie_companies\n" +
			"         │   │                                           │               └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ HashIn\n" +
			"         │   │                                               │   ├─ ci.note:2\n" +
			"         │   │                                               │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ keys: [mc.movie_id:16!null]\n" +
			"         │   │                                                       ├─ colSet: (1-7)\n" +
			"         │   │                                                       ├─ tableId: 1\n" +
			"         │   │                                                       └─ Table\n" +
			"         │   │                                                           ├─ name: cast_info\n" +
			"         │   │                                                           └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:18!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:2\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:2!null, mi_idx.movie_id:7!null, ci.movie_id:19!null, mk.movie_id:14!null, mc.movie_id:16!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ Table\n" +
			"         │   │                                           │           ├─ name: movie_companies\n" +
			"         │   │                                           │           └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ Table\n" +
			"         │   │                                           │           ├─ name: movie_companies\n" +
			"         │   │                                           │           └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS violent_liongate_movie
FROM cast_info AS ci,
     company_name AS cn,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND cn.name LIKE 'Lionsgate%'
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mc.note LIKE '%(Blu-ray)%'
  AND mi.info IN ('Horror',
                  'Thriller')
  AND n.gender = 'm'
  AND t.production_year > 2000
  AND (t.title LIKE '%Freddy%'
       OR t.title LIKE '%Jason%'
       OR t.title LIKE 'Saw%')
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(mi_idx.info:9!null), MIN(n.name:23!null), MIN(t.title:26!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:25!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:2!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:25!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:25!null\n" +
			"         │   │   │       └─ ci.movie_id:20!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:25!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:25!null\n" +
			"         │       └─ mc.movie_id:16!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:22!null\n" +
			"         │   │   └─ ci.person_id:19!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:8!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:6!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:2!null\n" +
			"         │   │           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi.movie_id:2!null\n" +
			"         │   │           │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.id:5!null\n" +
			"         │   │           │   │   └─ mi.info_type_id:3!null\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ HashIn\n" +
			"         │   │           │   │   │   ├─ mi.info:2!null\n" +
			"         │   │           │   │   │   └─ TUPLE(Horror (longtext), Thriller (longtext))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ ProcessTable\n" +
			"         │   │           │   │           └─ Table\n" +
			"         │   │           │   │               ├─ name: movie_info\n" +
			"         │   │           │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ Eq\n" +
			"         │   │           │       │   ├─ it1.info:1!null\n" +
			"         │   │           │       │   └─ genres (longtext)\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               ├─ columns: [id info]\n" +
			"         │   │           │               ├─ colSet: (15,16)\n" +
			"         │   │           │               └─ tableId: 3\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi.movie_id:2!null, mi.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.movie_id:9!null, mi_idx.movie_id:0!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ AND\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                   │   └─ Eq\n" +
			"         │   │                   │       ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │       └─ mk.movie_id:14!null\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ ProcessTable\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(mi_idx.movie_id:7!null, mi_idx.movie_id:7!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mc.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ k.id:10!null\n" +
			"         │   │                           │   └─ mk.keyword_id:15!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ HashIn\n" +
			"         │   │                           │   │   ├─ k.keyword:1!null\n" +
			"         │   │                           │   │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ ProcessTable\n" +
			"         │   │                           │           └─ Table\n" +
			"         │   │                           │               ├─ name: keyword\n" +
			"         │   │                           │               └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(k.id:10!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ Eq\n" +
			"         │   │                                   │   ├─ cn.id:12!null\n" +
			"         │   │                                   │   └─ mc.company_id:17!null\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ AND\n" +
			"         │   │                                   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │                                   │   │   │   ├─ cn.name:1!null\n" +
			"         │   │                                   │   │   │   └─ Lionsgate (longtext)\n" +
			"         │   │                                   │   │   └─ LessThanOrEqual\n" +
			"         │   │                                   │   │       ├─ cn.name:1!null\n" +
			"         │   │                                   │   │       └─ Lionsgateÿ (longtext)\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ ProcessTable\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: company_name\n" +
			"         │   │                                   │               └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: TUPLE(cn.id:12!null)\n" +
			"         │   │                                       ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ Eq\n" +
			"         │   │                                           │   │   ├─ mk.movie_id:14!null\n" +
			"         │   │                                           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ ProcessTable\n" +
			"         │   │                                           │   │       └─ Table\n" +
			"         │   │                                           │   │           ├─ name: movie_keyword\n" +
			"         │   │                                           │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ Filter\n" +
			"         │   │                                           │       ├─ mc.note LIKE '%(Blu-ray)%'\n" +
			"         │   │                                           │       └─ TableAlias(mc)\n" +
			"         │   │                                           │           └─ ProcessTable\n" +
			"         │   │                                           │               └─ Table\n" +
			"         │   │                                           │                   ├─ name: movie_companies\n" +
			"         │   │                                           │                   └─ columns: [movie_id company_id note]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ HashIn\n" +
			"         │   │                                               │   ├─ ci.note:2\n" +
			"         │   │                                               │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ keys: [mc.movie_id:16!null]\n" +
			"         │   │                                                       ├─ colSet: (1-7)\n" +
			"         │   │                                                       ├─ tableId: 1\n" +
			"         │   │                                                       └─ Table\n" +
			"         │   │                                                           ├─ name: cast_info\n" +
			"         │   │                                                           └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:19!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ n.gender:2\n" +
			"         │           │   └─ m (longtext)\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: name\n" +
			"         │                       └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:2!null, mi_idx.movie_id:7!null, ci.movie_id:20!null, mk.movie_id:14!null, mc.movie_id:16!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ Filter\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ GreaterThan\n" +
			"                 │   │   ├─ t.production_year:2\n" +
			"                 │   │   └─ 2000 (smallint)\n" +
			"                 │   └─ Or\n" +
			"                 │       ├─ Or\n" +
			"                 │       │   ├─ t.title LIKE '%Freddy%'\n" +
			"                 │       │   └─ t.title LIKE '%Jason%'\n" +
			"                 │       └─ AND\n" +
			"                 │           ├─ GreaterThanOrEqual\n" +
			"                 │           │   ├─ t.title:1!null\n" +
			"                 │           │   └─ Saw (longtext)\n" +
			"                 │           └─ LessThanOrEqual\n" +
			"                 │               ├─ t.title:1!null\n" +
			"                 │               └─ Sawÿ (longtext)\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: title\n" +
			"                             └─ columns: [id title production_year]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ Filter\n" +
			"         │   │                                           │       ├─ mc.note LIKE '%(Blu-ray)%'\n" +
			"         │   │                                           │       └─ TableAlias(mc)\n" +
			"         │   │                                           │           └─ Table\n" +
			"         │   │                                           │               ├─ name: movie_companies\n" +
			"         │   │                                           │               └─ columns: [movie_id company_id note]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year > 2000) AND ((t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%') OR ((t.title >= 'Saw') AND (t.title <= 'Sawÿ'))))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Thriller'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ Filter\n" +
			"         │   │                                           │       ├─ mc.note LIKE '%(Blu-ray)%'\n" +
			"         │   │                                           │       └─ TableAlias(mc)\n" +
			"         │   │                                           │           └─ Table\n" +
			"         │   │                                           │               ├─ name: movie_companies\n" +
			"         │   │                                           │               └─ columns: [movie_id company_id note]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (n.gender = 'm')\n" +
			"         │           └─ TableAlias(n)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name gender]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ Filter\n" +
			"                 ├─ ((t.production_year > 2000) AND ((t.title LIKE '%Freddy%' OR t.title LIKE '%Jason%') OR ((t.title >= 'Saw') AND (t.title <= 'Sawÿ'))))\n" +
			"                 └─ TableAlias(t)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title production_year]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi.info) AS movie_budget,
       MIN(mi_idx.info) AS movie_votes,
       MIN(n.name) AS writer,
       MIN(t.title) AS violent_liongate_movie
FROM cast_info AS ci,
     company_name AS cn,
     info_type AS it1,
     info_type AS it2,
     keyword AS k,
     movie_companies AS mc,
     movie_info AS mi,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE ci.note IN ('(writer)',
                  '(head writer)',
                  '(written by)',
                  '(story)',
                  '(story editor)')
  AND cn.name LIKE 'Lionsgate%'
  AND it1.info = 'genres'
  AND it2.info = 'votes'
  AND k.keyword IN ('murder',
                    'violence',
                    'blood',
                    'gore',
                    'death',
                    'female-nudity',
                    'hospital')
  AND mi.info IN ('Horror',
                  'Action',
                  'Sci-Fi',
                  'Thriller',
                  'Crime',
                  'War')
  AND t.id = mi.movie_id
  AND t.id = mi_idx.movie_id
  AND t.id = ci.movie_id
  AND t.id = mk.movie_id
  AND t.id = mc.movie_id
  AND ci.movie_id = mi.movie_id
  AND ci.movie_id = mi_idx.movie_id
  AND ci.movie_id = mk.movie_id
  AND ci.movie_id = mc.movie_id
  AND mi.movie_id = mi_idx.movie_id
  AND mi.movie_id = mk.movie_id
  AND mi.movie_id = mc.movie_id
  AND mi_idx.movie_id = mk.movie_id
  AND mi_idx.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id
  AND n.id = ci.person_id
  AND it1.id = mi.info_type_id
  AND it2.id = mi_idx.info_type_id
  AND k.id = mk.keyword_id
  AND cn.id = mc.company_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi.info):0!null as movie_budget, min(mi_idx.info):1!null as movie_votes, min(n.name):2!null as writer, min(t.title):3!null as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi.info:4!null), MIN(mi_idx.info:9!null), MIN(n.name:22!null), MIN(t.title:24!null)\n" +
			"     ├─ group: \n" +
			"     └─ HashJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ AND\n" +
			"         │   │   │   │   ├─ Eq\n" +
			"         │   │   │   │   │   ├─ t.id:23!null\n" +
			"         │   │   │   │   │   └─ mi.movie_id:2!null\n" +
			"         │   │   │   │   └─ Eq\n" +
			"         │   │   │   │       ├─ t.id:23!null\n" +
			"         │   │   │   │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │   │   └─ Eq\n" +
			"         │   │   │       ├─ t.id:23!null\n" +
			"         │   │   │       └─ ci.movie_id:19!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t.id:23!null\n" +
			"         │   │       └─ mk.movie_id:14!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:23!null\n" +
			"         │       └─ mc.movie_id:16!null\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ n.id:21!null\n" +
			"         │   │   └─ ci.person_id:18!null\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it2.id:0!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:8!null\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ Eq\n" +
			"         │   │   │   │   ├─ it2.info:1!null\n" +
			"         │   │   │   │   └─ votes (longtext)\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ ProcessTable\n" +
			"         │   │   │           └─ Table\n" +
			"         │   │   │               ├─ name: info_type\n" +
			"         │   │   │               └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: TUPLE(it2.id:0!null)\n" +
			"         │   │       ├─ right-key: TUPLE(mi_idx.info_type_id:6!null)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ AND\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ mi.movie_id:2!null\n" +
			"         │   │           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │           │   └─ Eq\n" +
			"         │   │           │       ├─ mi.movie_id:2!null\n" +
			"         │   │           │       └─ mi_idx.movie_id:7!null\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ Eq\n" +
			"         │   │           │   │   ├─ it1.id:5!null\n" +
			"         │   │           │   │   └─ mi.info_type_id:3!null\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ HashIn\n" +
			"         │   │           │   │   │   ├─ mi.info:2!null\n" +
			"         │   │           │   │   │   └─ TUPLE(Horror (longtext), Action (longtext), Sci-Fi (longtext), Thriller (longtext), Crime (longtext), War (longtext))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ ProcessTable\n" +
			"         │   │           │   │           └─ Table\n" +
			"         │   │           │   │               ├─ name: movie_info\n" +
			"         │   │           │   │               └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ Eq\n" +
			"         │   │           │       │   ├─ it1.info:1!null\n" +
			"         │   │           │       │   └─ genres (longtext)\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               ├─ columns: [id info]\n" +
			"         │   │           │               ├─ colSet: (15,16)\n" +
			"         │   │           │               └─ tableId: 3\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: TUPLE(mi.movie_id:2!null, mi.movie_id:2!null)\n" +
			"         │   │               ├─ right-key: TUPLE(mc.movie_id:9!null, mi_idx.movie_id:0!null)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ AND\n" +
			"         │   │                   │   ├─ Eq\n" +
			"         │   │                   │   │   ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                   │   └─ Eq\n" +
			"         │   │                   │       ├─ mi_idx.movie_id:7!null\n" +
			"         │   │                   │       └─ mk.movie_id:14!null\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ ProcessTable\n" +
			"         │   │                   │       └─ Table\n" +
			"         │   │                   │           ├─ name: movie_info_idx\n" +
			"         │   │                   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: TUPLE(mi_idx.movie_id:7!null, mi_idx.movie_id:7!null)\n" +
			"         │   │                       ├─ right-key: TUPLE(mc.movie_id:6!null, mk.movie_id:4!null)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ Eq\n" +
			"         │   │                           │   ├─ k.id:10!null\n" +
			"         │   │                           │   └─ mk.keyword_id:15!null\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ HashIn\n" +
			"         │   │                           │   │   ├─ k.keyword:1!null\n" +
			"         │   │                           │   │   └─ TUPLE(murder (longtext), violence (longtext), blood (longtext), gore (longtext), death (longtext), female-nudity (longtext), hospital (longtext))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ ProcessTable\n" +
			"         │   │                           │           └─ Table\n" +
			"         │   │                           │               ├─ name: keyword\n" +
			"         │   │                           │               └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: TUPLE(k.id:10!null)\n" +
			"         │   │                               ├─ right-key: TUPLE(mk.keyword_id:3!null)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ Eq\n" +
			"         │   │                                   │   ├─ cn.id:12!null\n" +
			"         │   │                                   │   └─ mc.company_id:17!null\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ AND\n" +
			"         │   │                                   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │                                   │   │   │   ├─ cn.name:1!null\n" +
			"         │   │                                   │   │   │   └─ Lionsgate (longtext)\n" +
			"         │   │                                   │   │   └─ LessThanOrEqual\n" +
			"         │   │                                   │   │       ├─ cn.name:1!null\n" +
			"         │   │                                   │   │       └─ Lionsgateÿ (longtext)\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ ProcessTable\n" +
			"         │   │                                   │           └─ Table\n" +
			"         │   │                                   │               ├─ name: company_name\n" +
			"         │   │                                   │               └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: TUPLE(cn.id:12!null)\n" +
			"         │   │                                       ├─ right-key: TUPLE(mc.company_id:3!null)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ Eq\n" +
			"         │   │                                           │   │   ├─ mk.movie_id:14!null\n" +
			"         │   │                                           │   │   └─ mc.movie_id:16!null\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ ProcessTable\n" +
			"         │   │                                           │   │       └─ Table\n" +
			"         │   │                                           │   │           ├─ name: movie_keyword\n" +
			"         │   │                                           │   │           └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ ProcessTable\n" +
			"         │   │                                           │           └─ Table\n" +
			"         │   │                                           │               ├─ name: movie_companies\n" +
			"         │   │                                           │               └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ HashIn\n" +
			"         │   │                                               │   ├─ ci.note:2\n" +
			"         │   │                                               │   └─ TUPLE((writer) (longtext), (head writer) (longtext), (written by) (longtext), (story) (longtext), (story editor) (longtext))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ keys: [mc.movie_id:16!null]\n" +
			"         │   │                                                       ├─ colSet: (1-7)\n" +
			"         │   │                                                       ├─ tableId: 1\n" +
			"         │   │                                                       └─ Table\n" +
			"         │   │                                                           ├─ name: cast_info\n" +
			"         │   │                                                           └─ columns: [person_id movie_id note]\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: TUPLE(ci.person_id:18!null)\n" +
			"         │       ├─ right-key: TUPLE(n.id:0!null)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: name\n" +
			"         │                   └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: TUPLE(mi.movie_id:2!null, mi_idx.movie_id:7!null, ci.movie_id:19!null, mk.movie_id:14!null, mc.movie_id:16!null)\n" +
			"             ├─ right-key: TUPLE(t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null, t.id:0!null)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: title\n" +
			"                         └─ columns: [id title]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ Table\n" +
			"         │   │                                           │           ├─ name: movie_companies\n" +
			"         │   │                                           │           └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: name\n" +
			"         │               └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi.info) as movie_budget, min(mi_idx.info) as movie_votes, min(n.name) as writer, min(t.title) as violent_liongate_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi.info), MIN(mi_idx.info), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ HashJoin\n" +
			"         ├─ (((((t.id = mi.movie_id) AND (t.id = mi_idx.movie_id)) AND (t.id = ci.movie_id)) AND (t.id = mk.movie_id)) AND (t.id = mc.movie_id))\n" +
			"         ├─ HashJoin\n" +
			"         │   ├─ (n.id = ci.person_id)\n" +
			"         │   ├─ HashJoin\n" +
			"         │   │   ├─ (it2.id = mi_idx.info_type_id)\n" +
			"         │   │   ├─ Filter\n" +
			"         │   │   │   ├─ (it2.info = 'votes')\n" +
			"         │   │   │   └─ TableAlias(it2)\n" +
			"         │   │   │       └─ Table\n" +
			"         │   │   │           ├─ name: info_type\n" +
			"         │   │   │           └─ columns: [id info]\n" +
			"         │   │   └─ HashLookup\n" +
			"         │   │       ├─ left-key: (it2.id)\n" +
			"         │   │       ├─ right-key: (mi_idx.info_type_id)\n" +
			"         │   │       └─ HashJoin\n" +
			"         │   │           ├─ ((mi.movie_id = mc.movie_id) AND (mi.movie_id = mi_idx.movie_id))\n" +
			"         │   │           ├─ InnerJoin\n" +
			"         │   │           │   ├─ (it1.id = mi.info_type_id)\n" +
			"         │   │           │   ├─ Filter\n" +
			"         │   │           │   │   ├─ (mi.info HASH IN ('Horror', 'Action', 'Sci-Fi', 'Thriller', 'Crime', 'War'))\n" +
			"         │   │           │   │   └─ TableAlias(mi)\n" +
			"         │   │           │   │       └─ Table\n" +
			"         │   │           │   │           ├─ name: movie_info\n" +
			"         │   │           │   │           └─ columns: [movie_id info_type_id info]\n" +
			"         │   │           │   └─ Filter\n" +
			"         │   │           │       ├─ (it1.info = 'genres')\n" +
			"         │   │           │       └─ TableAlias(it1)\n" +
			"         │   │           │           └─ Table\n" +
			"         │   │           │               ├─ name: info_type\n" +
			"         │   │           │               └─ columns: [id info]\n" +
			"         │   │           └─ HashLookup\n" +
			"         │   │               ├─ left-key: (mi.movie_id, mi.movie_id)\n" +
			"         │   │               ├─ right-key: (mc.movie_id, mi_idx.movie_id)\n" +
			"         │   │               └─ HashJoin\n" +
			"         │   │                   ├─ ((mi_idx.movie_id = mc.movie_id) AND (mi_idx.movie_id = mk.movie_id))\n" +
			"         │   │                   ├─ TableAlias(mi_idx)\n" +
			"         │   │                   │   └─ Table\n" +
			"         │   │                   │       ├─ name: movie_info_idx\n" +
			"         │   │                   │       └─ columns: [movie_id info_type_id info]\n" +
			"         │   │                   └─ HashLookup\n" +
			"         │   │                       ├─ left-key: (mi_idx.movie_id, mi_idx.movie_id)\n" +
			"         │   │                       ├─ right-key: (mc.movie_id, mk.movie_id)\n" +
			"         │   │                       └─ HashJoin\n" +
			"         │   │                           ├─ (k.id = mk.keyword_id)\n" +
			"         │   │                           ├─ Filter\n" +
			"         │   │                           │   ├─ (k.keyword HASH IN ('murder', 'violence', 'blood', 'gore', 'death', 'female-nudity', 'hospital'))\n" +
			"         │   │                           │   └─ TableAlias(k)\n" +
			"         │   │                           │       └─ Table\n" +
			"         │   │                           │           ├─ name: keyword\n" +
			"         │   │                           │           └─ columns: [id keyword]\n" +
			"         │   │                           └─ HashLookup\n" +
			"         │   │                               ├─ left-key: (k.id)\n" +
			"         │   │                               ├─ right-key: (mk.keyword_id)\n" +
			"         │   │                               └─ HashJoin\n" +
			"         │   │                                   ├─ (cn.id = mc.company_id)\n" +
			"         │   │                                   ├─ Filter\n" +
			"         │   │                                   │   ├─ ((cn.name >= 'Lionsgate') AND (cn.name <= 'Lionsgateÿ'))\n" +
			"         │   │                                   │   └─ TableAlias(cn)\n" +
			"         │   │                                   │       └─ Table\n" +
			"         │   │                                   │           ├─ name: company_name\n" +
			"         │   │                                   │           └─ columns: [id name]\n" +
			"         │   │                                   └─ HashLookup\n" +
			"         │   │                                       ├─ left-key: (cn.id)\n" +
			"         │   │                                       ├─ right-key: (mc.company_id)\n" +
			"         │   │                                       └─ LookupJoin\n" +
			"         │   │                                           ├─ InnerJoin\n" +
			"         │   │                                           │   ├─ (mk.movie_id = mc.movie_id)\n" +
			"         │   │                                           │   ├─ TableAlias(mk)\n" +
			"         │   │                                           │   │   └─ Table\n" +
			"         │   │                                           │   │       ├─ name: movie_keyword\n" +
			"         │   │                                           │   │       └─ columns: [movie_id keyword_id]\n" +
			"         │   │                                           │   └─ TableAlias(mc)\n" +
			"         │   │                                           │       └─ Table\n" +
			"         │   │                                           │           ├─ name: movie_companies\n" +
			"         │   │                                           │           └─ columns: [movie_id company_id]\n" +
			"         │   │                                           └─ Filter\n" +
			"         │   │                                               ├─ (ci.note HASH IN ('(writer)', '(head writer)', '(written by)', '(story)', '(story editor)'))\n" +
			"         │   │                                               └─ TableAlias(ci)\n" +
			"         │   │                                                   └─ IndexedTableAccess(cast_info)\n" +
			"         │   │                                                       ├─ index: [cast_info.movie_id]\n" +
			"         │   │                                                       ├─ columns: [person_id movie_id note]\n" +
			"         │   │                                                       └─ keys: mc.movie_id\n" +
			"         │   └─ HashLookup\n" +
			"         │       ├─ left-key: (ci.person_id)\n" +
			"         │       ├─ right-key: (n.id)\n" +
			"         │       └─ TableAlias(n)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: name\n" +
			"         │               └─ columns: [id name]\n" +
			"         └─ HashLookup\n" +
			"             ├─ left-key: (mi.movie_id, mi_idx.movie_id, ci.movie_id, mk.movie_id, mc.movie_id)\n" +
			"             ├─ right-key: (t.id, t.id, t.id, t.id, t.id)\n" +
			"             └─ TableAlias(t)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: title\n" +
			"                     └─ columns: [id title]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(lt.link) AS link_type,
       MIN(t1.title) AS first_movie,
       MIN(t2.title) AS second_movie
FROM keyword AS k,
     link_type AS lt,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t1,
     title AS t2
WHERE k.keyword ='10,000-mile-club'
  AND mk.keyword_id = k.id
  AND t1.id = mk.movie_id
  AND ml.movie_id = t1.id
  AND ml.linked_movie_id = t2.id
  AND lt.id = ml.link_type_id
  AND mk.movie_id = t1.id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(lt.link):0!null as link_type, min(t1.title):1!null as first_movie, min(t2.title):2!null as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(lt.link:6!null), MIN(t1.title:8!null), MIN(t2.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   └─ t1.id:7!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mk.movie_id:9!null\n" +
			"         │       └─ ml.movie_id:2!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ml.linked_movie_id:3!null\n" +
			"         │   │   └─ t2.id:0!null\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ lt.id:5!null\n" +
			"         │       │   └─ ml.link_type_id:4!null\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_link\n" +
			"         │       │           └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: link_type\n" +
			"         │                   └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t1.id:7!null\n" +
			"             │   │   └─ mk.movie_id:9!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ mk.movie_id:9!null\n" +
			"             │       └─ t1.id:7!null\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       ├─ columns: [id title]\n" +
			"             │       ├─ colSet: (13-24)\n" +
			"             │       └─ tableId: 5\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ mk.keyword_id:10!null\n" +
			"                 │   └─ k.id:11!null\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_keyword\n" +
			"                 │           └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ k.keyword:1!null\n" +
			"                     │   └─ 10,000-mile-club (longtext)\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: keyword\n" +
			"                                 └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(lt.link) as link_type, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(lt.link), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ml.movie_id = t1.id) AND (mk.movie_id = ml.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (ml.linked_movie_id = t2.id)\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (lt.id = ml.link_type_id)\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_link\n" +
			"         │       │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: link_type\n" +
			"         │               └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((t1.id = mk.movie_id) AND (mk.movie_id = t1.id))\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       └─ columns: [id title]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (mk.keyword_id = k.id)\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: movie_keyword\n" +
			"                 │       └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (k.keyword = '10,000-mile-club')\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(lt.link) as link_type, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(lt.link), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ml.movie_id = t1.id) AND (mk.movie_id = ml.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (ml.linked_movie_id = t2.id)\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (lt.id = ml.link_type_id)\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_link\n" +
			"         │       │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: link_type\n" +
			"         │               └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((t1.id = mk.movie_id) AND (mk.movie_id = t1.id))\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       └─ columns: [id title]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (mk.keyword_id = k.id)\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: movie_keyword\n" +
			"                 │       └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (k.keyword = '10,000-mile-club')\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(lt.link) AS link_type,
       MIN(t1.title) AS first_movie,
       MIN(t2.title) AS second_movie
FROM keyword AS k,
     link_type AS lt,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t1,
     title AS t2
WHERE k.keyword ='character-name-in-title'
  AND mk.keyword_id = k.id
  AND t1.id = mk.movie_id
  AND ml.movie_id = t1.id
  AND ml.linked_movie_id = t2.id
  AND lt.id = ml.link_type_id
  AND mk.movie_id = t1.id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(lt.link):0!null as link_type, min(t1.title):1!null as first_movie, min(t2.title):2!null as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(lt.link:6!null), MIN(t1.title:8!null), MIN(t2.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ml.movie_id:2!null\n" +
			"         │   │   └─ t1.id:7!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ mk.movie_id:9!null\n" +
			"         │       └─ ml.movie_id:2!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ml.linked_movie_id:3!null\n" +
			"         │   │   └─ t2.id:0!null\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ ProcessTable\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ lt.id:5!null\n" +
			"         │       │   └─ ml.link_type_id:4!null\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_link\n" +
			"         │       │           └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: link_type\n" +
			"         │                   └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ t1.id:7!null\n" +
			"             │   │   └─ mk.movie_id:9!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ mk.movie_id:9!null\n" +
			"             │       └─ t1.id:7!null\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       ├─ columns: [id title]\n" +
			"             │       ├─ colSet: (13-24)\n" +
			"             │       └─ tableId: 5\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ mk.keyword_id:10!null\n" +
			"                 │   └─ k.id:11!null\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_keyword\n" +
			"                 │           └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ k.keyword:1!null\n" +
			"                     │   └─ character-name-in-title (longtext)\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: keyword\n" +
			"                                 └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(lt.link) as link_type, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(lt.link), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ml.movie_id = t1.id) AND (mk.movie_id = ml.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (ml.linked_movie_id = t2.id)\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (lt.id = ml.link_type_id)\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_link\n" +
			"         │       │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: link_type\n" +
			"         │               └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((t1.id = mk.movie_id) AND (mk.movie_id = t1.id))\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       └─ columns: [id title]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (mk.keyword_id = k.id)\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: movie_keyword\n" +
			"                 │       └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (k.keyword = 'character-name-in-title')\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(lt.link) as link_type, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(lt.link), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ml.movie_id = t1.id) AND (mk.movie_id = ml.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (ml.linked_movie_id = t2.id)\n" +
			"         │   ├─ TableAlias(t2)\n" +
			"         │   │   └─ Table\n" +
			"         │   │       ├─ name: title\n" +
			"         │   │       └─ columns: [id title]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (lt.id = ml.link_type_id)\n" +
			"         │       ├─ TableAlias(ml)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_link\n" +
			"         │       │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"         │       └─ TableAlias(lt)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: link_type\n" +
			"         │               └─ columns: [id link]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ ((t1.id = mk.movie_id) AND (mk.movie_id = t1.id))\n" +
			"             ├─ TableAlias(t1)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: title\n" +
			"             │       └─ columns: [id title]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (mk.keyword_id = k.id)\n" +
			"                 ├─ TableAlias(mk)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: movie_keyword\n" +
			"                 │       └─ columns: [movie_id keyword_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (k.keyword = 'character-name-in-title')\n" +
			"                     └─ TableAlias(k)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn1.name) AS first_company,
       MIN(cn2.name) AS second_company,
       MIN(mi_idx1.info) AS first_rating,
       MIN(mi_idx2.info) AS second_rating,
       MIN(t1.title) AS first_movie,
       MIN(t2.title) AS second_movie
FROM company_name AS cn1,
     company_name AS cn2,
     info_type AS it1,
     info_type AS it2,
     kind_type AS kt1,
     kind_type AS kt2,
     link_type AS lt,
     movie_companies AS mc1,
     movie_companies AS mc2,
     movie_info_idx AS mi_idx1,
     movie_info_idx AS mi_idx2,
     movie_link AS ml,
     title AS t1,
     title AS t2
WHERE cn1.country_code = '[us]'
  AND it1.info = 'rating'
  AND it2.info = 'rating'
  AND kt1.kind IN ('tv series')
  AND kt2.kind IN ('tv series')
  AND lt.link IN ('sequel',
                  'follows',
                  'followed by')
  AND mi_idx2.info < '3.0'
  AND t2.production_year BETWEEN 2005 AND 2008
  AND lt.id = ml.link_type_id
  AND t1.id = ml.movie_id
  AND t2.id = ml.linked_movie_id
  AND it1.id = mi_idx1.info_type_id
  AND t1.id = mi_idx1.movie_id
  AND kt1.id = t1.kind_id
  AND cn1.id = mc1.company_id
  AND t1.id = mc1.movie_id
  AND ml.movie_id = mi_idx1.movie_id
  AND ml.movie_id = mc1.movie_id
  AND mi_idx1.movie_id = mc1.movie_id
  AND it2.id = mi_idx2.info_type_id
  AND t2.id = mi_idx2.movie_id
  AND kt2.id = t2.kind_id
  AND cn2.id = mc2.company_id
  AND t2.id = mc2.movie_id
  AND ml.linked_movie_id = mi_idx2.movie_id
  AND ml.linked_movie_id = mc2.movie_id
  AND mi_idx2.movie_id = mc2.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn1.name):0!null as first_company, min(cn2.name):1!null as second_company, min(mi_idx1.info):2!null as first_rating, min(mi_idx2.info):3!null as second_rating, min(t1.title):4!null as first_movie, min(t2.title):5!null as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn1.name:31!null), MIN(cn2.name:29!null), MIN(mi_idx1.info:23!null), MIN(mi_idx2.info:18!null), MIN(t1.title:7!null), MIN(t2.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t2.id:0!null\n" +
			"         │   │   │   └─ ml.linked_movie_id:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t2.id:0!null\n" +
			"         │   │       └─ mi_idx2.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t2.id:0!null\n" +
			"         │       └─ mc2.movie_id:26!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt2.id:4!null\n" +
			"         │   │   └─ t2.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t2.production_year:3\n" +
			"         │   │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t2.production_year:3\n" +
			"         │   │   │       └─ 2008 (smallint)\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ kt2.kind:1!null\n" +
			"         │       │   └─ TUPLE(tv series (longtext))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ t1.id:6!null\n" +
			"             │   │   │   └─ ml.movie_id:11!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ t1.id:6!null\n" +
			"             │   │       └─ mi_idx1.movie_id:21!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ t1.id:6!null\n" +
			"             │       └─ mc1.movie_id:33!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ kt1.id:9!null\n" +
			"             │   │   └─ t1.kind_id:8!null\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       ├─ columns: [id title kind_id]\n" +
			"             │   │       ├─ colSet: (49-60)\n" +
			"             │   │       └─ tableId: 13\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ HashIn\n" +
			"             │       │   ├─ kt1.kind:1!null\n" +
			"             │       │   └─ TUPLE(tv series (longtext))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               ├─ columns: [id kind]\n" +
			"             │               ├─ colSet: (19,20)\n" +
			"             │               └─ tableId: 5\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ mc1.movie_id:33!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ ml.movie_id:11!null\n" +
			"                 │       └─ mc1.movie_id:33!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ ml.movie_id:11!null\n" +
			"                 │   │   │   └─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ ml.linked_movie_id:12!null\n" +
			"                 │   │       └─ mi_idx2.movie_id:16!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ lt.id:14!null\n" +
			"                 │   │   │   └─ ml.link_type_id:13!null\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_link\n" +
			"                 │   │   │           └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ HashIn\n" +
			"                 │   │       │   ├─ lt.link:1!null\n" +
			"                 │   │       │   └─ TUPLE(sequel (longtext), follows (longtext), followed by (longtext))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: link_type\n" +
			"                 │   │                   └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ Eq\n" +
			"                 │       │   │   ├─ it2.id:19!null\n" +
			"                 │       │   │   └─ mi_idx2.info_type_id:17!null\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ LessThan\n" +
			"                 │       │   │   │   ├─ mi_idx2.info:2!null\n" +
			"                 │       │   │   │   └─ 3.0 (longtext)\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ ProcessTable\n" +
			"                 │       │   │           └─ Table\n" +
			"                 │       │   │               ├─ name: movie_info_idx\n" +
			"                 │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ Eq\n" +
			"                 │       │       │   ├─ it2.info:1!null\n" +
			"                 │       │       │   └─ rating (longtext)\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ ProcessTable\n" +
			"                 │       │               └─ Table\n" +
			"                 │       │                   ├─ name: info_type\n" +
			"                 │       │                   └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ Eq\n" +
			"                 │           │   │   ├─ it1.id:24!null\n" +
			"                 │           │   │   └─ mi_idx1.info_type_id:22!null\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       ├─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   │       ├─ colSet: (35-39)\n" +
			"                 │           │   │       └─ tableId: 10\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ Eq\n" +
			"                 │           │       │   ├─ it1.info:1!null\n" +
			"                 │           │       │   └─ rating (longtext)\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               ├─ columns: [id info]\n" +
			"                 │           │               ├─ colSet: (15,16)\n" +
			"                 │           │               └─ tableId: 3\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ Eq\n" +
			"                 │               │   │   ├─ cn2.id:28!null\n" +
			"                 │               │   │   └─ mc2.company_id:27!null\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ ProcessTable\n" +
			"                 │               │   │       └─ Table\n" +
			"                 │               │   │           ├─ name: movie_companies\n" +
			"                 │               │   │           └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ ProcessTable\n" +
			"                 │               │           └─ Table\n" +
			"                 │               │               ├─ name: company_name\n" +
			"                 │               │               └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ Eq\n" +
			"                 │                   │   ├─ cn1.country_code:2\n" +
			"                 │                   │   └─ [us] (longtext)\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           ├─ columns: [id name country_code]\n" +
			"                 │                           ├─ colSet: (1-7)\n" +
			"                 │                           └─ tableId: 1\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         ├─ columns: [movie_id company_id]\n" +
			"                         ├─ colSet: (25-29)\n" +
			"                         └─ tableId: 8\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t2.production_year >= 2005) AND (t2.production_year <= 2008))\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lt.link HASH IN ('sequel', 'follows', 'followed by'))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.0')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (cn1.country_code = '[us]')\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t2.production_year >= 2005) AND (t2.production_year <= 2008))\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lt.link HASH IN ('sequel', 'follows', 'followed by'))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.0')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (cn1.country_code = '[us]')\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn1.name) AS first_company,
       MIN(cn2.name) AS second_company,
       MIN(mi_idx1.info) AS first_rating,
       MIN(mi_idx2.info) AS second_rating,
       MIN(t1.title) AS first_movie,
       MIN(t2.title) AS second_movie
FROM company_name AS cn1,
     company_name AS cn2,
     info_type AS it1,
     info_type AS it2,
     kind_type AS kt1,
     kind_type AS kt2,
     link_type AS lt,
     movie_companies AS mc1,
     movie_companies AS mc2,
     movie_info_idx AS mi_idx1,
     movie_info_idx AS mi_idx2,
     movie_link AS ml,
     title AS t1,
     title AS t2
WHERE cn1.country_code = '[nl]'
  AND it1.info = 'rating'
  AND it2.info = 'rating'
  AND kt1.kind IN ('tv series')
  AND kt2.kind IN ('tv series')
  AND lt.link LIKE '%follow%'
  AND mi_idx2.info < '3.0'
  AND t2.production_year = 2007
  AND lt.id = ml.link_type_id
  AND t1.id = ml.movie_id
  AND t2.id = ml.linked_movie_id
  AND it1.id = mi_idx1.info_type_id
  AND t1.id = mi_idx1.movie_id
  AND kt1.id = t1.kind_id
  AND cn1.id = mc1.company_id
  AND t1.id = mc1.movie_id
  AND ml.movie_id = mi_idx1.movie_id
  AND ml.movie_id = mc1.movie_id
  AND mi_idx1.movie_id = mc1.movie_id
  AND it2.id = mi_idx2.info_type_id
  AND t2.id = mi_idx2.movie_id
  AND kt2.id = t2.kind_id
  AND cn2.id = mc2.company_id
  AND t2.id = mc2.movie_id
  AND ml.linked_movie_id = mi_idx2.movie_id
  AND ml.linked_movie_id = mc2.movie_id
  AND mi_idx2.movie_id = mc2.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn1.name):0!null as first_company, min(cn2.name):1!null as second_company, min(mi_idx1.info):2!null as first_rating, min(mi_idx2.info):3!null as second_rating, min(t1.title):4!null as first_movie, min(t2.title):5!null as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn1.name:31!null), MIN(cn2.name:29!null), MIN(mi_idx1.info:23!null), MIN(mi_idx2.info:18!null), MIN(t1.title:7!null), MIN(t2.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t2.id:0!null\n" +
			"         │   │   │   └─ ml.linked_movie_id:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t2.id:0!null\n" +
			"         │   │       └─ mi_idx2.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t2.id:0!null\n" +
			"         │       └─ mc2.movie_id:26!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt2.id:4!null\n" +
			"         │   │   └─ t2.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t2.production_year:3\n" +
			"         │   │   │   └─ 2007 (smallint)\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ kt2.kind:1!null\n" +
			"         │       │   └─ TUPLE(tv series (longtext))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ t1.id:6!null\n" +
			"             │   │   │   └─ ml.movie_id:11!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ t1.id:6!null\n" +
			"             │   │       └─ mi_idx1.movie_id:21!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ t1.id:6!null\n" +
			"             │       └─ mc1.movie_id:33!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ kt1.id:9!null\n" +
			"             │   │   └─ t1.kind_id:8!null\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       ├─ columns: [id title kind_id]\n" +
			"             │   │       ├─ colSet: (49-60)\n" +
			"             │   │       └─ tableId: 13\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ HashIn\n" +
			"             │       │   ├─ kt1.kind:1!null\n" +
			"             │       │   └─ TUPLE(tv series (longtext))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               ├─ columns: [id kind]\n" +
			"             │               ├─ colSet: (19,20)\n" +
			"             │               └─ tableId: 5\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ mc1.movie_id:33!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ ml.movie_id:11!null\n" +
			"                 │       └─ mc1.movie_id:33!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ ml.movie_id:11!null\n" +
			"                 │   │   │   └─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ ml.linked_movie_id:12!null\n" +
			"                 │   │       └─ mi_idx2.movie_id:16!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ lt.id:14!null\n" +
			"                 │   │   │   └─ ml.link_type_id:13!null\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_link\n" +
			"                 │   │   │           └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ lt.link LIKE '%follow%'\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: link_type\n" +
			"                 │   │                   └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ Eq\n" +
			"                 │       │   │   ├─ it2.id:19!null\n" +
			"                 │       │   │   └─ mi_idx2.info_type_id:17!null\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ LessThan\n" +
			"                 │       │   │   │   ├─ mi_idx2.info:2!null\n" +
			"                 │       │   │   │   └─ 3.0 (longtext)\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ ProcessTable\n" +
			"                 │       │   │           └─ Table\n" +
			"                 │       │   │               ├─ name: movie_info_idx\n" +
			"                 │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ Eq\n" +
			"                 │       │       │   ├─ it2.info:1!null\n" +
			"                 │       │       │   └─ rating (longtext)\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ ProcessTable\n" +
			"                 │       │               └─ Table\n" +
			"                 │       │                   ├─ name: info_type\n" +
			"                 │       │                   └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ Eq\n" +
			"                 │           │   │   ├─ it1.id:24!null\n" +
			"                 │           │   │   └─ mi_idx1.info_type_id:22!null\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       ├─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   │       ├─ colSet: (35-39)\n" +
			"                 │           │   │       └─ tableId: 10\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ Eq\n" +
			"                 │           │       │   ├─ it1.info:1!null\n" +
			"                 │           │       │   └─ rating (longtext)\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               ├─ columns: [id info]\n" +
			"                 │           │               ├─ colSet: (15,16)\n" +
			"                 │           │               └─ tableId: 3\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ Eq\n" +
			"                 │               │   │   ├─ cn2.id:28!null\n" +
			"                 │               │   │   └─ mc2.company_id:27!null\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ ProcessTable\n" +
			"                 │               │   │       └─ Table\n" +
			"                 │               │   │           ├─ name: movie_companies\n" +
			"                 │               │   │           └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ ProcessTable\n" +
			"                 │               │           └─ Table\n" +
			"                 │               │               ├─ name: company_name\n" +
			"                 │               │               └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ Eq\n" +
			"                 │                   │   ├─ cn1.country_code:2\n" +
			"                 │                   │   └─ [nl] (longtext)\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           ├─ columns: [id name country_code]\n" +
			"                 │                           ├─ colSet: (1-7)\n" +
			"                 │                           └─ tableId: 1\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         ├─ columns: [movie_id company_id]\n" +
			"                         ├─ colSet: (25-29)\n" +
			"                         └─ tableId: 8\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t2.production_year = 2007)\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ lt.link LIKE '%follow%'\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.0')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (cn1.country_code = '[nl]')\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t2.production_year = 2007)\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ lt.link LIKE '%follow%'\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.0')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (cn1.country_code = '[nl]')\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(cn1.name) AS first_company,
       MIN(cn2.name) AS second_company,
       MIN(mi_idx1.info) AS first_rating,
       MIN(mi_idx2.info) AS second_rating,
       MIN(t1.title) AS first_movie,
       MIN(t2.title) AS second_movie
FROM company_name AS cn1,
     company_name AS cn2,
     info_type AS it1,
     info_type AS it2,
     kind_type AS kt1,
     kind_type AS kt2,
     link_type AS lt,
     movie_companies AS mc1,
     movie_companies AS mc2,
     movie_info_idx AS mi_idx1,
     movie_info_idx AS mi_idx2,
     movie_link AS ml,
     title AS t1,
     title AS t2
WHERE cn1.country_code != '[us]'
  AND it1.info = 'rating'
  AND it2.info = 'rating'
  AND kt1.kind IN ('tv series',
                   'episode')
  AND kt2.kind IN ('tv series',
                   'episode')
  AND lt.link IN ('sequel',
                  'follows',
                  'followed by')
  AND mi_idx2.info < '3.5'
  AND t2.production_year BETWEEN 2000 AND 2010
  AND lt.id = ml.link_type_id
  AND t1.id = ml.movie_id
  AND t2.id = ml.linked_movie_id
  AND it1.id = mi_idx1.info_type_id
  AND t1.id = mi_idx1.movie_id
  AND kt1.id = t1.kind_id
  AND cn1.id = mc1.company_id
  AND t1.id = mc1.movie_id
  AND ml.movie_id = mi_idx1.movie_id
  AND ml.movie_id = mc1.movie_id
  AND mi_idx1.movie_id = mc1.movie_id
  AND it2.id = mi_idx2.info_type_id
  AND t2.id = mi_idx2.movie_id
  AND kt2.id = t2.kind_id
  AND cn2.id = mc2.company_id
  AND t2.id = mc2.movie_id
  AND ml.linked_movie_id = mi_idx2.movie_id
  AND ml.linked_movie_id = mc2.movie_id
  AND mi_idx2.movie_id = mc2.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(cn1.name):0!null as first_company, min(cn2.name):1!null as second_company, min(mi_idx1.info):2!null as first_rating, min(mi_idx2.info):3!null as second_rating, min(t1.title):4!null as first_movie, min(t2.title):5!null as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(cn1.name:31!null), MIN(cn2.name:29!null), MIN(mi_idx1.info:23!null), MIN(mi_idx2.info:18!null), MIN(t1.title:7!null), MIN(t2.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ t2.id:0!null\n" +
			"         │   │   │   └─ ml.linked_movie_id:12!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ t2.id:0!null\n" +
			"         │   │       └─ mi_idx2.movie_id:16!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t2.id:0!null\n" +
			"         │       └─ mc2.movie_id:26!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ kt2.id:4!null\n" +
			"         │   │   └─ t2.kind_id:2!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t2.production_year:3\n" +
			"         │   │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t2.production_year:3\n" +
			"         │   │   │       └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ kt2.kind:1!null\n" +
			"         │       │   └─ TUPLE(tv series (longtext), episode (longtext))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: kind_type\n" +
			"         │                   └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ t1.id:6!null\n" +
			"             │   │   │   └─ ml.movie_id:11!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ t1.id:6!null\n" +
			"             │   │       └─ mi_idx1.movie_id:21!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ t1.id:6!null\n" +
			"             │       └─ mc1.movie_id:33!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ kt1.id:9!null\n" +
			"             │   │   └─ t1.kind_id:8!null\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       ├─ columns: [id title kind_id]\n" +
			"             │   │       ├─ colSet: (49-60)\n" +
			"             │   │       └─ tableId: 13\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ HashIn\n" +
			"             │       │   ├─ kt1.kind:1!null\n" +
			"             │       │   └─ TUPLE(tv series (longtext), episode (longtext))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               ├─ columns: [id kind]\n" +
			"             │               ├─ colSet: (19,20)\n" +
			"             │               └─ tableId: 5\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ mc1.movie_id:33!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ ml.movie_id:11!null\n" +
			"                 │       └─ mc1.movie_id:33!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ ml.movie_id:11!null\n" +
			"                 │   │   │   └─ mi_idx1.movie_id:21!null\n" +
			"                 │   │   └─ Eq\n" +
			"                 │   │       ├─ ml.linked_movie_id:12!null\n" +
			"                 │   │       └─ mi_idx2.movie_id:16!null\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ lt.id:14!null\n" +
			"                 │   │   │   └─ ml.link_type_id:13!null\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ ProcessTable\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: movie_link\n" +
			"                 │   │   │           └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ HashIn\n" +
			"                 │   │       │   ├─ lt.link:1!null\n" +
			"                 │   │       │   └─ TUPLE(sequel (longtext), follows (longtext), followed by (longtext))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ ProcessTable\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: link_type\n" +
			"                 │   │                   └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ Eq\n" +
			"                 │       │   │   ├─ it2.id:19!null\n" +
			"                 │       │   │   └─ mi_idx2.info_type_id:17!null\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ LessThan\n" +
			"                 │       │   │   │   ├─ mi_idx2.info:2!null\n" +
			"                 │       │   │   │   └─ 3.5 (longtext)\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ ProcessTable\n" +
			"                 │       │   │           └─ Table\n" +
			"                 │       │   │               ├─ name: movie_info_idx\n" +
			"                 │       │   │               └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ Eq\n" +
			"                 │       │       │   ├─ it2.info:1!null\n" +
			"                 │       │       │   └─ rating (longtext)\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ ProcessTable\n" +
			"                 │       │               └─ Table\n" +
			"                 │       │                   ├─ name: info_type\n" +
			"                 │       │                   └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ Eq\n" +
			"                 │           │   │   ├─ it1.id:24!null\n" +
			"                 │           │   │   └─ mi_idx1.info_type_id:22!null\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       ├─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   │       ├─ colSet: (35-39)\n" +
			"                 │           │   │       └─ tableId: 10\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ Eq\n" +
			"                 │           │       │   ├─ it1.info:1!null\n" +
			"                 │           │       │   └─ rating (longtext)\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               ├─ columns: [id info]\n" +
			"                 │           │               ├─ colSet: (15,16)\n" +
			"                 │           │               └─ tableId: 3\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ Eq\n" +
			"                 │               │   │   ├─ cn2.id:28!null\n" +
			"                 │               │   │   └─ mc2.company_id:27!null\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ ProcessTable\n" +
			"                 │               │   │       └─ Table\n" +
			"                 │               │   │           ├─ name: movie_companies\n" +
			"                 │               │   │           └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ ProcessTable\n" +
			"                 │               │           └─ Table\n" +
			"                 │               │               ├─ name: company_name\n" +
			"                 │               │               └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ NOT\n" +
			"                 │                   │   └─ Eq\n" +
			"                 │                   │       ├─ cn1.country_code:2\n" +
			"                 │                   │       └─ [us] (longtext)\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           ├─ columns: [id name country_code]\n" +
			"                 │                           ├─ colSet: (1-7)\n" +
			"                 │                           └─ tableId: 1\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         ├─ columns: [movie_id company_id]\n" +
			"                         ├─ colSet: (25-29)\n" +
			"                         └─ tableId: 8\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t2.production_year >= 2000) AND (t2.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series', 'episode'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series', 'episode'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lt.link HASH IN ('sequel', 'follows', 'followed by'))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.5')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (NOT((cn1.country_code = '[us]')))\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(cn1.name) as first_company, min(cn2.name) as second_company, min(mi_idx1.info) as first_rating, min(mi_idx2.info) as second_rating, min(t1.title) as first_movie, min(t2.title) as second_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(cn1.name), MIN(cn2.name), MIN(mi_idx1.info), MIN(mi_idx2.info), MIN(t1.title), MIN(t2.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((t2.id = ml.linked_movie_id) AND (t2.id = mi_idx2.movie_id)) AND (t2.id = mc2.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (kt2.id = t2.kind_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ ((t2.production_year >= 2000) AND (t2.production_year <= 2010))\n" +
			"         │   │   └─ TableAlias(t2)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title kind_id production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (kt2.kind HASH IN ('tv series', 'episode'))\n" +
			"         │       └─ TableAlias(kt2)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: kind_type\n" +
			"         │               └─ columns: [id kind]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((t1.id = ml.movie_id) AND (t1.id = mi_idx1.movie_id)) AND (t1.id = mc1.movie_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (kt1.id = t1.kind_id)\n" +
			"             │   ├─ TableAlias(t1)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: title\n" +
			"             │   │       └─ columns: [id title kind_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (kt1.kind HASH IN ('tv series', 'episode'))\n" +
			"             │       └─ TableAlias(kt1)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: kind_type\n" +
			"             │               └─ columns: [id kind]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((mi_idx1.movie_id = mc1.movie_id) AND (ml.movie_id = mc1.movie_id))\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ ((ml.movie_id = mi_idx1.movie_id) AND (ml.linked_movie_id = mi_idx2.movie_id))\n" +
			"                 │   ├─ InnerJoin\n" +
			"                 │   │   ├─ (lt.id = ml.link_type_id)\n" +
			"                 │   │   ├─ TableAlias(ml)\n" +
			"                 │   │   │   └─ Table\n" +
			"                 │   │   │       ├─ name: movie_link\n" +
			"                 │   │   │       └─ columns: [movie_id linked_movie_id link_type_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ (lt.link HASH IN ('sequel', 'follows', 'followed by'))\n" +
			"                 │   │       └─ TableAlias(lt)\n" +
			"                 │   │           └─ Table\n" +
			"                 │   │               ├─ name: link_type\n" +
			"                 │   │               └─ columns: [id link]\n" +
			"                 │   └─ CrossJoin\n" +
			"                 │       ├─ InnerJoin\n" +
			"                 │       │   ├─ (it2.id = mi_idx2.info_type_id)\n" +
			"                 │       │   ├─ Filter\n" +
			"                 │       │   │   ├─ (mi_idx2.info < '3.5')\n" +
			"                 │       │   │   └─ TableAlias(mi_idx2)\n" +
			"                 │       │   │       └─ Table\n" +
			"                 │       │   │           ├─ name: movie_info_idx\n" +
			"                 │       │   │           └─ columns: [movie_id info_type_id info]\n" +
			"                 │       │   └─ Filter\n" +
			"                 │       │       ├─ (it2.info = 'rating')\n" +
			"                 │       │       └─ TableAlias(it2)\n" +
			"                 │       │           └─ Table\n" +
			"                 │       │               ├─ name: info_type\n" +
			"                 │       │               └─ columns: [id info]\n" +
			"                 │       └─ CrossJoin\n" +
			"                 │           ├─ InnerJoin\n" +
			"                 │           │   ├─ (it1.id = mi_idx1.info_type_id)\n" +
			"                 │           │   ├─ TableAlias(mi_idx1)\n" +
			"                 │           │   │   └─ Table\n" +
			"                 │           │   │       ├─ name: movie_info_idx\n" +
			"                 │           │   │       └─ columns: [movie_id info_type_id info]\n" +
			"                 │           │   └─ Filter\n" +
			"                 │           │       ├─ (it1.info = 'rating')\n" +
			"                 │           │       └─ TableAlias(it1)\n" +
			"                 │           │           └─ Table\n" +
			"                 │           │               ├─ name: info_type\n" +
			"                 │           │               └─ columns: [id info]\n" +
			"                 │           └─ CrossJoin\n" +
			"                 │               ├─ InnerJoin\n" +
			"                 │               │   ├─ (cn2.id = mc2.company_id)\n" +
			"                 │               │   ├─ TableAlias(mc2)\n" +
			"                 │               │   │   └─ Table\n" +
			"                 │               │   │       ├─ name: movie_companies\n" +
			"                 │               │   │       └─ columns: [movie_id company_id]\n" +
			"                 │               │   └─ TableAlias(cn2)\n" +
			"                 │               │       └─ Table\n" +
			"                 │               │           ├─ name: company_name\n" +
			"                 │               │           └─ columns: [id name]\n" +
			"                 │               └─ Filter\n" +
			"                 │                   ├─ (NOT((cn1.country_code = '[us]')))\n" +
			"                 │                   └─ TableAlias(cn1)\n" +
			"                 │                       └─ Table\n" +
			"                 │                           ├─ name: company_name\n" +
			"                 │                           └─ columns: [id name country_code]\n" +
			"                 └─ TableAlias(mc1)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: movie_companies\n" +
			"                         └─ columns: [movie_id company_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM keyword AS k,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE k.keyword LIKE '%sequel%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German')
  AND t.production_year > 2005
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi.movie_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.movie_id:5!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:5!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ mi.info:1!null\n" +
			"         │       │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info\n" +
			"         │                   └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:7!null\n" +
			"             │   └─ mk.keyword_id:6!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM keyword AS k,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE k.keyword LIKE '%sequel%'
  AND mi.info IN ('Bulgaria')
  AND t.production_year > 2010
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi.movie_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.movie_id:5!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:5!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ mi.info:1!null\n" +
			"         │       │   └─ TUPLE(Bulgaria (longtext))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info\n" +
			"         │                   └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:7!null\n" +
			"             │   └─ mk.keyword_id:6!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Bulgaria'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Bulgaria'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS movie_title
FROM keyword AS k,
     movie_info AS mi,
     movie_keyword AS mk,
     title AS t
WHERE k.keyword LIKE '%sequel%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND t.production_year > 1990
  AND t.id = mi.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi.movie_id
  AND k.id = mk.keyword_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ mk.movie_id:5!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:5!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1990 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ HashIn\n" +
			"         │       │   ├─ mi.info:1!null\n" +
			"         │       │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info\n" +
			"         │                   └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ k.id:7!null\n" +
			"             │   └─ mk.keyword_id:6!null\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: movie_keyword\n" +
			"             │           └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: keyword\n" +
			"                             └─ columns: [id keyword]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((mk.movie_id = mi.movie_id) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"         │       └─ TableAlias(mi)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info\n" +
			"         │               └─ columns: [movie_id info]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (k.id = mk.keyword_id)\n" +
			"             ├─ TableAlias(mk)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: movie_keyword\n" +
			"             │       └─ columns: [movie_id keyword_id]\n" +
			"             └─ Filter\n" +
			"                 ├─ k.keyword LIKE '%sequel%'\n" +
			"                 └─ TableAlias(k)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: keyword\n" +
			"                         └─ columns: [id keyword]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS movie_title
FROM info_type AS it,
     keyword AS k,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it.info ='rating'
  AND k.keyword LIKE '%sequel%'
  AND mi_idx.info > '5.0'
  AND t.production_year > 2005
  AND t.id = mi_idx.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:5!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it.id:10!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:6!null\n" +
			"         │   │       └─ mi_idx.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi_idx.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ GreaterThan\n" +
			"         │       │   ├─ mi_idx.info:2!null\n" +
			"         │       │   └─ 5.0 (longtext)\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info_idx\n" +
			"         │                   └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ k.id:8!null\n" +
			"             │   │   └─ mk.keyword_id:7!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: info_type\n" +
			"                             └─ columns: [id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '5.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '5.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS movie_title
FROM info_type AS it,
     keyword AS k,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it.info ='rating'
  AND k.keyword LIKE '%sequel%'
  AND mi_idx.info > '9.0'
  AND t.production_year > 2010
  AND t.id = mi_idx.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:5!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it.id:10!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:6!null\n" +
			"         │   │       └─ mi_idx.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi_idx.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ GreaterThan\n" +
			"         │       │   ├─ mi_idx.info:2!null\n" +
			"         │       │   └─ 9.0 (longtext)\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info_idx\n" +
			"         │                   └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ k.id:8!null\n" +
			"             │   │   └─ mk.keyword_id:7!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: info_type\n" +
			"                             └─ columns: [id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '9.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '9.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(mi_idx.info) AS rating,
       MIN(t.title) AS movie_title
FROM info_type AS it,
     keyword AS k,
     movie_info_idx AS mi_idx,
     movie_keyword AS mk,
     title AS t
WHERE it.info ='rating'
  AND k.keyword LIKE '%sequel%'
  AND mi_idx.info > '2.0'
  AND t.production_year > 1990
  AND t.id = mi_idx.movie_id
  AND t.id = mk.movie_id
  AND mk.movie_id = mi_idx.movie_id
  AND k.id = mk.keyword_id
  AND it.id = mi_idx.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(mi_idx.info):0!null as rating, min(t.title):1!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(mi_idx.info:5!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ it.id:10!null\n" +
			"         │   │   │   └─ mi_idx.info_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mk.movie_id:6!null\n" +
			"         │   │       └─ mi_idx.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mk.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mi_idx.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1990 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ GreaterThan\n" +
			"         │       │   ├─ mi_idx.info:2!null\n" +
			"         │       │   └─ 2.0 (longtext)\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_info_idx\n" +
			"         │                   └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ k.id:8!null\n" +
			"             │   │   └─ mk.keyword_id:7!null\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ ProcessTable\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_keyword\n" +
			"             │   │           └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: keyword\n" +
			"             │                   └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ it.info:1!null\n" +
			"                 │   └─ rating (longtext)\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: info_type\n" +
			"                             └─ columns: [id info]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '2.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(mi_idx.info) as rating, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(mi_idx.info), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((it.id = mi_idx.info_type_id) AND (mk.movie_id = mi_idx.movie_id)) AND (t.id = mk.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mi_idx.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mi_idx.info > '2.0')\n" +
			"         │       └─ TableAlias(mi_idx)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_info_idx\n" +
			"         │               └─ columns: [movie_id info_type_id info]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (k.id = mk.keyword_id)\n" +
			"             │   ├─ TableAlias(mk)\n" +
			"             │   │   └─ Table\n" +
			"             │   │       ├─ name: movie_keyword\n" +
			"             │   │       └─ columns: [movie_id keyword_id]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ k.keyword LIKE '%sequel%'\n" +
			"             │       └─ TableAlias(k)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: keyword\n" +
			"             │               └─ columns: [id keyword]\n" +
			"             └─ Filter\n" +
			"                 ├─ (it.info = 'rating')\n" +
			"                 └─ TableAlias(it)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: info_type\n" +
			"                         └─ columns: [id info]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS typical_european_movie
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     title AS t
WHERE ct.kind = 'production companies'
  AND mc.note LIKE '%(theatrical)%'
  AND mc.note LIKE '%(France)%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German')
  AND t.production_year > 2005
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND mc.movie_id = mi.movie_id
  AND ct.id = mc.company_type_id
  AND it.id = mi.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as typical_european_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ mc.note LIKE '%(theatrical)%'\n" +
			"         │       │   └─ mc.note LIKE '%(France)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:9!null\n" +
			"             │   │   └─ mi.info_type_id:7!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ HashIn\n" +
			"             │   │   │   ├─ mi.info:2!null\n" +
			"             │   │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: movie_info\n" +
			"             │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as typical_european_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mc.note LIKE '%(theatrical)%' AND mc.note LIKE '%(France)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as typical_european_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2005)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ (mc.note LIKE '%(theatrical)%' AND mc.note LIKE '%(France)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS american_vhs_movie
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     title AS t
WHERE ct.kind = 'production companies'
  AND mc.note LIKE '%(VHS)%'
  AND mc.note LIKE '%(USA)%'
  AND mc.note LIKE '%(1994)%'
  AND mi.info IN ('USA',
                  'America')
  AND t.production_year > 2010
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND mc.movie_id = mi.movie_id
  AND ct.id = mc.company_type_id
  AND it.id = mi.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as american_vhs_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ AND\n" +
			"         │       │   │   ├─ mc.note LIKE '%(VHS)%'\n" +
			"         │       │   │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │       │   └─ mc.note LIKE '%(1994)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:9!null\n" +
			"             │   │   └─ mi.info_type_id:7!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ HashIn\n" +
			"             │   │   │   ├─ mi.info:2!null\n" +
			"             │   │   │   └─ TUPLE(USA (longtext), America (longtext))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: movie_info\n" +
			"             │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as american_vhs_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((mc.note LIKE '%(VHS)%' AND mc.note LIKE '%(USA)%') AND mc.note LIKE '%(1994)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('USA', 'America'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as american_vhs_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((mc.note LIKE '%(VHS)%' AND mc.note LIKE '%(USA)%') AND mc.note LIKE '%(1994)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('USA', 'America'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(t.title) AS american_movie
FROM company_type AS ct,
     info_type AS it,
     movie_companies AS mc,
     movie_info AS mi,
     title AS t
WHERE ct.kind = 'production companies'
  AND mc.note NOT LIKE '%(TV)%'
  AND mc.note LIKE '%(USA)%'
  AND mi.info IN ('Sweden',
                  'Norway',
                  'Germany',
                  'Denmark',
                  'Swedish',
                  'Denish',
                  'Norwegian',
                  'German',
                  'USA',
                  'American')
  AND t.production_year > 1990
  AND t.id = mi.movie_id
  AND t.id = mc.movie_id
  AND mc.movie_id = mi.movie_id
  AND ct.id = mc.company_type_id
  AND it.id = mi.info_type_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(t.title):0!null as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ Eq\n" +
			"         │   │   │   ├─ ct.id:10!null\n" +
			"         │   │   │   └─ mc.company_type_id:4!null\n" +
			"         │   │   └─ Eq\n" +
			"         │   │       ├─ mc.movie_id:3!null\n" +
			"         │   │       └─ mi.movie_id:6!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mi.movie_id:6!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mc.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1990 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ AND\n" +
			"         │       │   ├─ NOT\n" +
			"         │       │   │   └─ mc.note LIKE '%(TV)%'\n" +
			"         │       │   └─ mc.note LIKE '%(USA)%'\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ ProcessTable\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: movie_companies\n" +
			"         │                   └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:9!null\n" +
			"             │   │   └─ mi.info_type_id:7!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ HashIn\n" +
			"             │   │   │   ├─ mi.info:2!null\n" +
			"             │   │   │   └─ TUPLE(Sweden (longtext), Norway (longtext), Germany (longtext), Denmark (longtext), Swedish (longtext), Denish (longtext), Norwegian (longtext), German (longtext), USA (longtext), American (longtext))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: movie_info\n" +
			"             │   │               └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ ct.kind:1!null\n" +
			"                 │   └─ production companies (longtext)\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ ProcessTable\n" +
			"                         └─ Table\n" +
			"                             ├─ name: company_type\n" +
			"                             └─ columns: [id kind]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(TV)%')) AND mc.note LIKE '%(USA)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ (((ct.id = mc.company_type_id) AND (mc.movie_id = mi.movie_id)) AND (t.id = mi.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mc.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 1990)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ Filter\n" +
			"         │       ├─ ((NOT(mc.note LIKE '%(TV)%')) AND mc.note LIKE '%(USA)%')\n" +
			"         │       └─ TableAlias(mc)\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: movie_companies\n" +
			"         │               └─ columns: [movie_id company_type_id note]\n" +
			"         └─ CrossJoin\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = mi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (mi.info HASH IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'USA', 'American'))\n" +
			"             │   │   └─ TableAlias(mi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: movie_info\n" +
			"             │   │           └─ columns: [movie_id info_type_id info]\n" +
			"             │   └─ TableAlias(it)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: info_type\n" +
			"             │           └─ columns: [id]\n" +
			"             └─ Filter\n" +
			"                 ├─ (ct.kind = 'production companies')\n" +
			"                 └─ TableAlias(ct)\n" +
			"                     └─ Table\n" +
			"                         ├─ name: company_type\n" +
			"                         └─ columns: [id kind]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS marvel_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword = 'marvel-cinematic-universe'
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2010
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2010 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ marvel-cinematic-universe (longtext)\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2010)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS hero_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword IN ('superhero',
                    'sequel',
                    'second-part',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence')
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2014
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2014 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), sequel (longtext), second-part (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2014)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2014)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS marvel_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword = 'marvel-cinematic-universe'
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2014
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2014 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ marvel-cinematic-universe (longtext)\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2014)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2014)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS hero_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword IN ('superhero',
                    'sequel',
                    'second-part',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence')
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2000
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), sequel (longtext), second-part (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS marvel_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword = 'marvel-cinematic-universe'
  AND n.name LIKE '%Downey%Robert%'
  AND t.production_year > 2000
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ Eq\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ marvel-cinematic-universe (longtext)\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: name\n" +
			"             │               └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as marvel_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword = 'marvel-cinematic-universe')\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ n.name LIKE '%Downey%Robert%'\n" +
			"             │   └─ TableAlias(n)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(k.keyword) AS movie_keyword,
       MIN(n.name) AS actor_name,
       MIN(t.title) AS hero_movie
FROM cast_info AS ci,
     keyword AS k,
     movie_keyword AS mk,
     name AS n,
     title AS t
WHERE k.keyword IN ('superhero',
                    'sequel',
                    'second-part',
                    'marvel-comics',
                    'based-on-comic',
                    'tv-special',
                    'fight',
                    'violence')
  AND t.production_year > 2000
  AND k.id = mk.keyword_id
  AND t.id = mk.movie_id
  AND t.id = ci.movie_id
  AND ci.movie_id = mk.movie_id
  AND n.id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(k.keyword):0!null as movie_keyword, min(n.name):1!null as actor_name, min(t.title):2!null as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(k.keyword:6!null), MIN(n.name:8!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ ci.movie_id:10!null\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ mk.movie_id:3!null\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ GreaterThan\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2000 (smallint)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ ProcessTable\n" +
			"         │   │           └─ Table\n" +
			"         │   │               ├─ name: title\n" +
			"         │   │               └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ Eq\n" +
			"         │       │   ├─ k.id:5!null\n" +
			"         │       │   └─ mk.keyword_id:4!null\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ ProcessTable\n" +
			"         │       │       └─ Table\n" +
			"         │       │           ├─ name: movie_keyword\n" +
			"         │       │           └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ HashIn\n" +
			"         │           │   ├─ k.keyword:1!null\n" +
			"         │           │   └─ TUPLE(superhero (longtext), sequel (longtext), second-part (longtext), marvel-comics (longtext), based-on-comic (longtext), tv-special (longtext), fight (longtext), violence (longtext))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ ProcessTable\n" +
			"         │                   └─ Table\n" +
			"         │                       ├─ name: keyword\n" +
			"         │                       └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ n.id:7!null\n" +
			"             │   └─ ci.person_id:9!null\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ ProcessTable\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: name\n" +
			"             │           └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ ProcessTable\n" +
			"                     └─ Table\n" +
			"                         ├─ name: cast_info\n" +
			"                         └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(k.keyword) as movie_keyword, min(n.name) as actor_name, min(t.title) as hero_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(k.keyword), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = mk.movie_id) AND (t.id = ci.movie_id))\n" +
			"         ├─ InnerJoin\n" +
			"         │   ├─ (t.id = mk.movie_id)\n" +
			"         │   ├─ Filter\n" +
			"         │   │   ├─ (t.production_year > 2000)\n" +
			"         │   │   └─ TableAlias(t)\n" +
			"         │   │       └─ Table\n" +
			"         │   │           ├─ name: title\n" +
			"         │   │           └─ columns: [id title production_year]\n" +
			"         │   └─ InnerJoin\n" +
			"         │       ├─ (k.id = mk.keyword_id)\n" +
			"         │       ├─ TableAlias(mk)\n" +
			"         │       │   └─ Table\n" +
			"         │       │       ├─ name: movie_keyword\n" +
			"         │       │       └─ columns: [movie_id keyword_id]\n" +
			"         │       └─ Filter\n" +
			"         │           ├─ (k.keyword HASH IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence'))\n" +
			"         │           └─ TableAlias(k)\n" +
			"         │               └─ Table\n" +
			"         │                   ├─ name: keyword\n" +
			"         │                   └─ columns: [id keyword]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (n.id = ci.person_id)\n" +
			"             ├─ TableAlias(n)\n" +
			"             │   └─ Table\n" +
			"             │       ├─ name: name\n" +
			"             │       └─ columns: [id name]\n" +
			"             └─ TableAlias(ci)\n" +
			"                 └─ Table\n" +
			"                     ├─ name: cast_info\n" +
			"                     └─ columns: [person_id movie_id]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS of_person,
       MIN(t.title) AS biography_movie
FROM aka_name AS an,
     cast_info AS ci,
     info_type AS it,
     link_type AS lt,
     movie_link AS ml,
     name AS n,
     person_info AS pi,
     title AS t
WHERE an.name LIKE '%a%'
  AND it.info ='mini biography'
  AND lt.link ='features'
  AND n.name_pcode_cf BETWEEN 'A' AND 'F'
  AND (n.gender='m'
       OR (n.gender = 'f'
           AND n.name LIKE 'B%'))
  AND pi.note ='Volker Boehm'
  AND t.production_year BETWEEN 1980 AND 1995
  AND n.id = an.person_id
  AND n.id = pi.person_id
  AND ci.person_id = n.id
  AND t.id = ci.movie_id
  AND ml.linked_movie_id = t.id
  AND lt.id = ml.link_type_id
  AND it.id = pi.info_type_id
  AND pi.person_id = an.person_id
  AND pi.person_id = ci.person_id
  AND an.person_id = ci.person_id
  AND ci.movie_id = ml.linked_movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as of_person, min(t.title):1!null as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:9!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ ci.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ ml.linked_movie_id:16!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1980 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:2\n" +
			"         │   │       └─ 1995 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ n.id:8!null\n" +
			"             │   │   │   └─ pi.person_id:3!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ pi.person_id:3!null\n" +
			"             │   │       └─ an.person_id:14!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ pi.person_id:3!null\n" +
			"             │       └─ ci.person_id:12!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:6!null\n" +
			"             │   │   └─ pi.info_type_id:4!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ pi.note:2\n" +
			"             │   │   │   └─ Volker Boehm (longtext)\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: person_info\n" +
			"             │   │               └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ mini biography (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ lt.id:18!null\n" +
			"                 │   └─ ml.link_type_id:17!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:13!null\n" +
			"                 │   │   └─ ml.linked_movie_id:16!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.id:8!null\n" +
			"                 │   │   │   └─ an.person_id:14!null\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   ├─ ci.person_id:12!null\n" +
			"                 │   │   │   │   └─ n.id:8!null\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   │   │   ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │   │   └─ A (longtext)\n" +
			"                 │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                 │   │   │   │   │   │       ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │       └─ F (longtext)\n" +
			"                 │   │   │   │   │   └─ Or\n" +
			"                 │   │   │   │   │       ├─ Eq\n" +
			"                 │   │   │   │   │       │   ├─ n.gender:2\n" +
			"                 │   │   │   │   │       │   └─ m (longtext)\n" +
			"                 │   │   │   │   │       └─ AND\n" +
			"                 │   │   │   │   │           ├─ Eq\n" +
			"                 │   │   │   │   │           │   ├─ n.gender:2\n" +
			"                 │   │   │   │   │           │   └─ f (longtext)\n" +
			"                 │   │   │   │   │           └─ AND\n" +
			"                 │   │   │   │   │               ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │               │   ├─ n.name:1!null\n" +
			"                 │   │   │   │   │               │   └─ B (longtext)\n" +
			"                 │   │   │   │   │               └─ LessThanOrEqual\n" +
			"                 │   │   │   │   │                   ├─ n.name:1!null\n" +
			"                 │   │   │   │   │                   └─ Bÿ (longtext)\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ ProcessTable\n" +
			"                 │   │   │   │           └─ Table\n" +
			"                 │   │   │   │               ├─ name: name\n" +
			"                 │   │   │   │               └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ ProcessTable\n" +
			"                 │   │   │           └─ Table\n" +
			"                 │   │   │               ├─ name: cast_info\n" +
			"                 │   │   │               └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ keys: [ci.person_id:12!null]\n" +
			"                 │   │               ├─ colSet: (1-8)\n" +
			"                 │   │               ├─ tableId: 1\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: aka_name\n" +
			"                 │   │                   └─ columns: [person_id name]\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: movie_link\n" +
			"                 │               └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ lt.link:1!null\n" +
			"                     │   └─ features (longtext)\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: link_type\n" +
			"                                 └─ columns: [id link]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as of_person, min(t.title) as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 1995))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (pi.note = 'Volker Boehm')\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'A') AND (n.name_pcode_cf <= 'F')) AND ((n.gender = 'm') OR ((n.gender = 'f') AND ((n.name >= 'B') AND (n.name <= 'Bÿ')))))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link = 'features')\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as of_person, min(t.title) as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 1995))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (pi.note = 'Volker Boehm')\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'A') AND (n.name_pcode_cf <= 'F')) AND ((n.gender = 'm') OR ((n.gender = 'f') AND ((n.name >= 'B') AND (n.name <= 'Bÿ')))))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link = 'features')\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS of_person,
       MIN(t.title) AS biography_movie
FROM aka_name AS an,
     cast_info AS ci,
     info_type AS it,
     link_type AS lt,
     movie_link AS ml,
     name AS n,
     person_info AS pi,
     title AS t
WHERE an.name LIKE '%a%'
  AND it.info ='mini biography'
  AND lt.link ='features'
  AND n.name_pcode_cf LIKE 'D%'
  AND n.gender='m'
  AND pi.note ='Volker Boehm'
  AND t.production_year BETWEEN 1980 AND 1984
  AND n.id = an.person_id
  AND n.id = pi.person_id
  AND ci.person_id = n.id
  AND t.id = ci.movie_id
  AND ml.linked_movie_id = t.id
  AND lt.id = ml.link_type_id
  AND it.id = pi.info_type_id
  AND pi.person_id = an.person_id
  AND pi.person_id = ci.person_id
  AND an.person_id = ci.person_id
  AND ci.movie_id = ml.linked_movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as of_person, min(t.title):1!null as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:9!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ ci.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ ml.linked_movie_id:16!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 1980 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:2\n" +
			"         │   │       └─ 1984 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ n.id:8!null\n" +
			"             │   │   │   └─ pi.person_id:3!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ pi.person_id:3!null\n" +
			"             │   │       └─ an.person_id:14!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ pi.person_id:3!null\n" +
			"             │       └─ ci.person_id:12!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:6!null\n" +
			"             │   │   └─ pi.info_type_id:4!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ pi.note:2\n" +
			"             │   │   │   └─ Volker Boehm (longtext)\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: person_info\n" +
			"             │   │               └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ mini biography (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ lt.id:18!null\n" +
			"                 │   └─ ml.link_type_id:17!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:13!null\n" +
			"                 │   │   └─ ml.linked_movie_id:16!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.id:8!null\n" +
			"                 │   │   │   └─ an.person_id:14!null\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   ├─ ci.person_id:12!null\n" +
			"                 │   │   │   │   └─ n.id:8!null\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   │   │   ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │   │   └─ D (longtext)\n" +
			"                 │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                 │   │   │   │   │   │       ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │       └─ Dÿ (longtext)\n" +
			"                 │   │   │   │   │   └─ Eq\n" +
			"                 │   │   │   │   │       ├─ n.gender:2\n" +
			"                 │   │   │   │   │       └─ m (longtext)\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ ProcessTable\n" +
			"                 │   │   │   │           └─ Table\n" +
			"                 │   │   │   │               ├─ name: name\n" +
			"                 │   │   │   │               └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ ProcessTable\n" +
			"                 │   │   │           └─ Table\n" +
			"                 │   │   │               ├─ name: cast_info\n" +
			"                 │   │   │               └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ keys: [ci.person_id:12!null]\n" +
			"                 │   │               ├─ colSet: (1-8)\n" +
			"                 │   │               ├─ tableId: 1\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: aka_name\n" +
			"                 │   │                   └─ columns: [person_id name]\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: movie_link\n" +
			"                 │               └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ lt.link:1!null\n" +
			"                     │   └─ features (longtext)\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: link_type\n" +
			"                                 └─ columns: [id link]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as of_person, min(t.title) as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 1984))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (pi.note = 'Volker Boehm')\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'D') AND (n.name_pcode_cf <= 'Dÿ')) AND (n.gender = 'm'))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link = 'features')\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as of_person, min(t.title) as biography_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 1984))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (pi.note = 'Volker Boehm')\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'D') AND (n.name_pcode_cf <= 'Dÿ')) AND (n.gender = 'm'))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link = 'features')\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(n.name) AS cast_member_name,
       MIN(pi.info) AS cast_member_info
FROM aka_name AS an,
     cast_info AS ci,
     info_type AS it,
     link_type AS lt,
     movie_link AS ml,
     name AS n,
     person_info AS pi,
     title AS t
WHERE an.name IS NOT NULL
  AND (an.name LIKE '%a%'
       OR an.name LIKE 'A%')
  AND it.info ='mini biography'
  AND lt.link IN ('references',
                  'referenced in',
                  'features',
                  'featured in')
  AND n.name_pcode_cf BETWEEN 'A' AND 'F'
  AND (n.gender='m'
       OR (n.gender = 'f'
           AND n.name LIKE 'A%'))
  AND pi.note IS NOT NULL
  AND t.production_year BETWEEN 1980 AND 2010
  AND n.id = an.person_id
  AND n.id = pi.person_id
  AND ci.person_id = n.id
  AND t.id = ci.movie_id
  AND ml.linked_movie_id = t.id
  AND lt.id = ml.link_type_id
  AND it.id = pi.info_type_id
  AND pi.person_id = an.person_id
  AND pi.person_id = ci.person_id
  AND an.person_id = ci.person_id
  AND ci.movie_id = ml.linked_movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(n.name):0!null as cast_member_name, min(pi.info):1!null as cast_member_info]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(n.name:9!null), MIN(pi.info:4!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ t.id:0!null\n" +
			"         │   │   └─ ci.movie_id:13!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ ml.linked_movie_id:16!null\n" +
			"         │       └─ t.id:0!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:1\n" +
			"         │   │   │   └─ 1980 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:1\n" +
			"         │   │       └─ 2010 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ AND\n" +
			"             │   ├─ AND\n" +
			"             │   │   ├─ Eq\n" +
			"             │   │   │   ├─ n.id:8!null\n" +
			"             │   │   │   └─ pi.person_id:2!null\n" +
			"             │   │   └─ Eq\n" +
			"             │   │       ├─ pi.person_id:2!null\n" +
			"             │   │       └─ an.person_id:14!null\n" +
			"             │   └─ Eq\n" +
			"             │       ├─ pi.person_id:2!null\n" +
			"             │       └─ ci.person_id:12!null\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ it.id:6!null\n" +
			"             │   │   └─ pi.info_type_id:3!null\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ NOT\n" +
			"             │   │   │   └─ pi.note:3 IS NULL\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ ProcessTable\n" +
			"             │   │           └─ Table\n" +
			"             │   │               ├─ name: person_info\n" +
			"             │   │               └─ columns: [person_id info_type_id info note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ Eq\n" +
			"             │       │   ├─ it.info:1!null\n" +
			"             │       │   └─ mini biography (longtext)\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ ProcessTable\n" +
			"             │               └─ Table\n" +
			"             │                   ├─ name: info_type\n" +
			"             │                   └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ Eq\n" +
			"                 │   ├─ lt.id:18!null\n" +
			"                 │   └─ ml.link_type_id:17!null\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ ci.movie_id:13!null\n" +
			"                 │   │   └─ ml.linked_movie_id:16!null\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.id:8!null\n" +
			"                 │   │   │   └─ an.person_id:14!null\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ Eq\n" +
			"                 │   │   │   │   ├─ ci.person_id:12!null\n" +
			"                 │   │   │   │   └─ n.id:8!null\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   ├─ AND\n" +
			"                 │   │   │   │   │   │   ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │   │   │   ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │   │   └─ A (longtext)\n" +
			"                 │   │   │   │   │   │   └─ LessThanOrEqual\n" +
			"                 │   │   │   │   │   │       ├─ n.name_pcode_cf:3\n" +
			"                 │   │   │   │   │   │       └─ F (longtext)\n" +
			"                 │   │   │   │   │   └─ Or\n" +
			"                 │   │   │   │   │       ├─ Eq\n" +
			"                 │   │   │   │   │       │   ├─ n.gender:2\n" +
			"                 │   │   │   │   │       │   └─ m (longtext)\n" +
			"                 │   │   │   │   │       └─ AND\n" +
			"                 │   │   │   │   │           ├─ Eq\n" +
			"                 │   │   │   │   │           │   ├─ n.gender:2\n" +
			"                 │   │   │   │   │           │   └─ f (longtext)\n" +
			"                 │   │   │   │   │           └─ AND\n" +
			"                 │   │   │   │   │               ├─ GreaterThanOrEqual\n" +
			"                 │   │   │   │   │               │   ├─ n.name:1!null\n" +
			"                 │   │   │   │   │               │   └─ A (longtext)\n" +
			"                 │   │   │   │   │               └─ LessThanOrEqual\n" +
			"                 │   │   │   │   │                   ├─ n.name:1!null\n" +
			"                 │   │   │   │   │                   └─ Aÿ (longtext)\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ ProcessTable\n" +
			"                 │   │   │   │           └─ Table\n" +
			"                 │   │   │   │               ├─ name: name\n" +
			"                 │   │   │   │               └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ ProcessTable\n" +
			"                 │   │   │           └─ Table\n" +
			"                 │   │   │               ├─ name: cast_info\n" +
			"                 │   │   │               └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ AND\n" +
			"                 │   │       │   ├─ NOT\n" +
			"                 │   │       │   │   └─ an.name:1!null IS NULL\n" +
			"                 │   │       │   └─ Or\n" +
			"                 │   │       │       ├─ an.name LIKE '%a%'\n" +
			"                 │   │       │       └─ AND\n" +
			"                 │   │       │           ├─ GreaterThanOrEqual\n" +
			"                 │   │       │           │   ├─ an.name:1!null\n" +
			"                 │   │       │           │   └─ A (longtext)\n" +
			"                 │   │       │           └─ LessThanOrEqual\n" +
			"                 │   │       │               ├─ an.name:1!null\n" +
			"                 │   │       │               └─ Aÿ (longtext)\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ keys: [ci.person_id:12!null]\n" +
			"                 │   │               ├─ colSet: (1-8)\n" +
			"                 │   │               ├─ tableId: 1\n" +
			"                 │   │               └─ Table\n" +
			"                 │   │                   ├─ name: aka_name\n" +
			"                 │   │                   └─ columns: [person_id name]\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: movie_link\n" +
			"                 │               └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ HashIn\n" +
			"                     │   ├─ lt.link:1!null\n" +
			"                     │   └─ TUPLE(references (longtext), referenced in (longtext), features (longtext), featured in (longtext))\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ ProcessTable\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: link_type\n" +
			"                                 └─ columns: [id link]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(n.name) as cast_member_name, min(pi.info) as cast_member_info]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(pi.info))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 2010))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (NOT(pi.note IS NULL))\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id info note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'A') AND (n.name_pcode_cf <= 'F')) AND ((n.gender = 'm') OR ((n.gender = 'f') AND ((n.name >= 'A') AND (n.name <= 'Aÿ')))))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ ((NOT(an.name IS NULL)) AND (an.name LIKE '%a%' OR ((an.name >= 'A') AND (an.name <= 'Aÿ'))))\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link HASH IN ('references', 'referenced in', 'features', 'featured in'))\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(n.name) as cast_member_name, min(pi.info) as cast_member_info]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(n.name), MIN(pi.info))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((t.id = ci.movie_id) AND (ml.linked_movie_id = t.id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 1980) AND (t.production_year <= 2010))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (((n.id = pi.person_id) AND (pi.person_id = an.person_id)) AND (pi.person_id = ci.person_id))\n" +
			"             ├─ InnerJoin\n" +
			"             │   ├─ (it.id = pi.info_type_id)\n" +
			"             │   ├─ Filter\n" +
			"             │   │   ├─ (NOT(pi.note IS NULL))\n" +
			"             │   │   └─ TableAlias(pi)\n" +
			"             │   │       └─ Table\n" +
			"             │   │           ├─ name: person_info\n" +
			"             │   │           └─ columns: [person_id info_type_id info note]\n" +
			"             │   └─ Filter\n" +
			"             │       ├─ (it.info = 'mini biography')\n" +
			"             │       └─ TableAlias(it)\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: info_type\n" +
			"             │               └─ columns: [id info]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ (lt.id = ml.link_type_id)\n" +
			"                 ├─ InnerJoin\n" +
			"                 │   ├─ (ci.movie_id = ml.linked_movie_id)\n" +
			"                 │   ├─ LookupJoin\n" +
			"                 │   │   ├─ (n.id = an.person_id)\n" +
			"                 │   │   ├─ InnerJoin\n" +
			"                 │   │   │   ├─ (ci.person_id = n.id)\n" +
			"                 │   │   │   ├─ Filter\n" +
			"                 │   │   │   │   ├─ (((n.name_pcode_cf >= 'A') AND (n.name_pcode_cf <= 'F')) AND ((n.gender = 'm') OR ((n.gender = 'f') AND ((n.name >= 'A') AND (n.name <= 'Aÿ')))))\n" +
			"                 │   │   │   │   └─ TableAlias(n)\n" +
			"                 │   │   │   │       └─ Table\n" +
			"                 │   │   │   │           ├─ name: name\n" +
			"                 │   │   │   │           └─ columns: [id name gender name_pcode_cf]\n" +
			"                 │   │   │   └─ TableAlias(ci)\n" +
			"                 │   │   │       └─ Table\n" +
			"                 │   │   │           ├─ name: cast_info\n" +
			"                 │   │   │           └─ columns: [person_id movie_id]\n" +
			"                 │   │   └─ Filter\n" +
			"                 │   │       ├─ ((NOT(an.name IS NULL)) AND (an.name LIKE '%a%' OR ((an.name >= 'A') AND (an.name <= 'Aÿ'))))\n" +
			"                 │   │       └─ TableAlias(an)\n" +
			"                 │   │           └─ IndexedTableAccess(aka_name)\n" +
			"                 │   │               ├─ index: [aka_name.person_id]\n" +
			"                 │   │               ├─ columns: [person_id name]\n" +
			"                 │   │               └─ keys: ci.person_id\n" +
			"                 │   └─ TableAlias(ml)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: movie_link\n" +
			"                 │           └─ columns: [linked_movie_id link_type_id]\n" +
			"                 └─ Filter\n" +
			"                     ├─ (lt.link HASH IN ('references', 'referenced in', 'features', 'featured in'))\n" +
			"                     └─ TableAlias(lt)\n" +
			"                         └─ Table\n" +
			"                             ├─ name: link_type\n" +
			"                             └─ columns: [id link]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an1.name) AS actress_pseudonym,
       MIN(t.title) AS japanese_movie_dubbed
FROM aka_name AS an1,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n1,
     role_type AS rt,
     title AS t
WHERE ci.note ='(voice: English version)'
  AND cn.country_code ='[jp]'
  AND mc.note LIKE '%(Japan)%'
  AND mc.note NOT LIKE '%(USA)%'
  AND n1.name LIKE '%Yo%'
  AND n1.name NOT LIKE '%Yu%'
  AND rt.role ='actress'
  AND an1.person_id = n1.id
  AND n1.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND an1.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an1.name):0!null as actress_pseudonym, min(t.title):1!null as japanese_movie_dubbed]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an1.name:14!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:6!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:12!null\n" +
			"             │   └─ rt.id:2!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ an1.person_id:13!null\n" +
			"                 │   │   └─ n1.id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n1.id:4!null\n" +
			"                 │       └─ ci.person_id:9!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ n1.name LIKE '%Yo%'\n" +
			"                 │   │   └─ NOT\n" +
			"                 │   │       └─ n1.name LIKE '%Yu%'\n" +
			"                 │   └─ TableAlias(n1)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:7!null\n" +
			"                     │   └─ cn.id:15!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:10!null\n" +
			"                     │   │   └─ mc.movie_id:6!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ mc.note LIKE '%(Japan)%'\n" +
			"                     │   │   │   └─ NOT\n" +
			"                     │   │   │       └─ mc.note LIKE '%(USA)%'\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_companies\n" +
			"                     │   │               └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ ci.note:2\n" +
			"                     │       │   │   └─ (voice: English version) (longtext)\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: cast_info\n" +
			"                     │       │               └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:9!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [jp] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an1.name) as actress_pseudonym, min(t.title) as japanese_movie_dubbed]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n1.name LIKE '%Yo%' AND (NOT(n1.name LIKE '%Yu%')))\n" +
			"                 │   └─ TableAlias(n1)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ (mc.note LIKE '%(Japan)%' AND (NOT(mc.note LIKE '%(USA)%')))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ (ci.note = '(voice: English version)')\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[jp]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an1.name) as actress_pseudonym, min(t.title) as japanese_movie_dubbed]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n1.name LIKE '%Yo%' AND (NOT(n1.name LIKE '%Yu%')))\n" +
			"                 │   └─ TableAlias(n1)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ (mc.note LIKE '%(Japan)%' AND (NOT(mc.note LIKE '%(USA)%')))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ (ci.note = '(voice: English version)')\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[jp]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS acress_pseudonym,
       MIN(t.title) AS japanese_anime_movie
FROM aka_name AS an,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note ='(voice: English version)'
  AND cn.country_code ='[jp]'
  AND mc.note LIKE '%(Japan)%'
  AND mc.note NOT LIKE '%(USA)%'
  AND (mc.note LIKE '%(2006)%'
       OR mc.note LIKE '%(2007)%')
  AND n.name LIKE '%Yo%'
  AND n.name NOT LIKE '%Yu%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2006 AND 2007
  AND (t.title LIKE 'One Piece%'
       OR t.title LIKE 'Dragon Ball Z%')
  AND an.person_id = n.id
  AND n.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND an.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as acress_pseudonym, min(t.title):1!null as japanese_anime_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:15!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:11!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ AND\n" +
			"         │   │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   │   └─ 2006 (smallint)\n" +
			"         │   │   │   └─ LessThanOrEqual\n" +
			"         │   │   │       ├─ t.production_year:2\n" +
			"         │   │   │       └─ 2007 (smallint)\n" +
			"         │   │   └─ Or\n" +
			"         │   │       ├─ AND\n" +
			"         │   │       │   ├─ GreaterThanOrEqual\n" +
			"         │   │       │   │   ├─ t.title:1!null\n" +
			"         │   │       │   │   └─ One Piece (longtext)\n" +
			"         │   │       │   └─ LessThanOrEqual\n" +
			"         │   │       │       ├─ t.title:1!null\n" +
			"         │   │       │       └─ One Pieceÿ (longtext)\n" +
			"         │   │       └─ AND\n" +
			"         │   │           ├─ GreaterThanOrEqual\n" +
			"         │   │           │   ├─ t.title:1!null\n" +
			"         │   │           │   └─ Dragon Ball Z (longtext)\n" +
			"         │   │           └─ LessThanOrEqual\n" +
			"         │   │               ├─ t.title:1!null\n" +
			"         │   │               └─ Dragon Ball Zÿ (longtext)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:13!null\n" +
			"             │   └─ rt.id:3!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ an.person_id:14!null\n" +
			"                 │   │   └─ n.id:5!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n.id:5!null\n" +
			"                 │       └─ ci.person_id:10!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ n.name LIKE '%Yo%'\n" +
			"                 │   │   └─ NOT\n" +
			"                 │   │       └─ n.name LIKE '%Yu%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:8!null\n" +
			"                     │   └─ cn.id:16!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:11!null\n" +
			"                     │   │   └─ mc.movie_id:7!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ AND\n" +
			"                     │   │   │   │   ├─ mc.note LIKE '%(Japan)%'\n" +
			"                     │   │   │   │   └─ NOT\n" +
			"                     │   │   │   │       └─ mc.note LIKE '%(USA)%'\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mc.note LIKE '%(2006)%'\n" +
			"                     │   │   │       └─ mc.note LIKE '%(2007)%'\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_companies\n" +
			"                     │   │               └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ ci.note:2\n" +
			"                     │       │   │   └─ (voice: English version) (longtext)\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: cast_info\n" +
			"                     │       │               └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:10!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [jp] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as acress_pseudonym, min(t.title) as japanese_anime_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year >= 2006) AND (t.production_year <= 2007)) AND (((t.title >= 'One Piece') AND (t.title <= 'One Pieceÿ')) OR ((t.title >= 'Dragon Ball Z') AND (t.title <= 'Dragon Ball Zÿ'))))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.name LIKE '%Yo%' AND (NOT(n.name LIKE '%Yu%')))\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((mc.note LIKE '%(Japan)%' AND (NOT(mc.note LIKE '%(USA)%'))) AND (mc.note LIKE '%(2006)%' OR mc.note LIKE '%(2007)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ (ci.note = '(voice: English version)')\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[jp]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as acress_pseudonym, min(t.title) as japanese_anime_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ (((t.production_year >= 2006) AND (t.production_year <= 2007)) AND (((t.title >= 'One Piece') AND (t.title <= 'One Pieceÿ')) OR ((t.title >= 'Dragon Ball Z') AND (t.title <= 'Dragon Ball Zÿ'))))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an.person_id = n.id) AND (n.id = ci.person_id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.name LIKE '%Yo%' AND (NOT(n.name LIKE '%Yu%')))\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((mc.note LIKE '%(Japan)%' AND (NOT(mc.note LIKE '%(USA)%'))) AND (mc.note LIKE '%(2006)%' OR mc.note LIKE '%(2007)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ Filter\n" +
			"                     │       │   ├─ (ci.note = '(voice: English version)')\n" +
			"                     │       │   └─ TableAlias(ci)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id note role_id]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[jp]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(a1.name) AS writer_pseudo_name,
       MIN(t.title) AS movie_title
FROM aka_name AS a1,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n1,
     role_type AS rt,
     title AS t
WHERE cn.country_code ='[us]'
  AND rt.role ='writer'
  AND a1.person_id = n1.id
  AND n1.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND a1.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(a1.name):0!null as writer_pseudo_name, min(t.title):1!null as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(a1.name:11!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:9!null\n" +
			"             │   └─ rt.id:2!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ writer (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ a1.person_id:10!null\n" +
			"                 │   │   └─ n1.id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n1.id:4!null\n" +
			"                 │       └─ ci.person_id:7!null\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:6!null\n" +
			"                     │   └─ cn.id:12!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:8!null\n" +
			"                     │   │   └─ mc.movie_id:5!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(a1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:7!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(a1.name) as writer_pseudo_name, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(a1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'writer')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((a1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: name\n" +
			"                 │       └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(a1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(a1.name) as writer_pseudo_name, min(t.title) as movie_title]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(a1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'writer')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((a1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: name\n" +
			"                 │       └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(a1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an1.name) AS costume_designer_pseudo,
       MIN(t.title) AS movie_with_costumes
FROM aka_name AS an1,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n1,
     role_type AS rt,
     title AS t
WHERE cn.country_code ='[us]'
  AND rt.role ='costume designer'
  AND an1.person_id = n1.id
  AND n1.id = ci.person_id
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND an1.person_id = ci.person_id
  AND ci.movie_id = mc.movie_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an1.name):0!null as costume_designer_pseudo, min(t.title):1!null as movie_with_costumes]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an1.name:11!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:8!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:5!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:9!null\n" +
			"             │   └─ rt.id:2!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ costume designer (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ an1.person_id:10!null\n" +
			"                 │   │   └─ n1.id:4!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ n1.id:4!null\n" +
			"                 │       └─ ci.person_id:7!null\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ ProcessTable\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:6!null\n" +
			"                     │   └─ cn.id:12!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:8!null\n" +
			"                     │   │   └─ mc.movie_id:5!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ ProcessTable\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: cast_info\n" +
			"                     │       │           └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:7!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an1.name) as costume_designer_pseudo, min(t.title) as movie_with_costumes]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'costume designer')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: name\n" +
			"                 │       └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an1.name) as costume_designer_pseudo, min(t.title) as movie_with_costumes]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an1.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'costume designer')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((an1.person_id = n1.id) AND (n1.id = ci.person_id))\n" +
			"                 ├─ TableAlias(n1)\n" +
			"                 │   └─ Table\n" +
			"                 │       ├─ name: name\n" +
			"                 │       └─ columns: [id]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ TableAlias(ci)\n" +
			"                     │       │   └─ Table\n" +
			"                     │       │       ├─ name: cast_info\n" +
			"                     │       │       └─ columns: [person_id movie_id role_id]\n" +
			"                     │       └─ TableAlias(an1)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS alternative_name,
       MIN(chn.name) AS character_name,
       MIN(t.title) AS movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND mc.note IS NOT NULL
  AND (mc.note LIKE '%(USA)%'
       OR mc.note LIKE '%(worldwide)%')
  AND n.gender ='f'
  AND n.name LIKE '%Ang%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2005 AND 2015
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND ci.movie_id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND n.id = ci.person_id
  AND chn.id = ci.person_role_id
  AND an.person_id = n.id
  AND an.person_id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as alternative_name, min(chn.name):1!null as character_name, min(t.title):2!null as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:19!null), MIN(chn.name:17!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:12!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2005 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:2\n" +
			"         │   │       └─ 2015 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:15!null\n" +
			"             │   └─ rt.id:3!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:11!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ an.person_id:18!null\n" +
			"                 │       └─ n.id:5!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%Ang%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:9!null\n" +
			"                     │   └─ cn.id:20!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:12!null\n" +
			"                     │   │   └─ mc.movie_id:8!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ NOT\n" +
			"                     │   │   │   │   └─ mc.note:2 IS NULL\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mc.note LIKE '%(USA)%'\n" +
			"                     │   │   │       └─ mc.note LIKE '%(worldwide)%'\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_companies\n" +
			"                     │   │               └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ chn.id:16!null\n" +
			"                     │       │   │   └─ ci.person_role_id:13\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ HashIn\n" +
			"                     │       │   │   │   ├─ ci.note:3\n" +
			"                     │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ ProcessTable\n" +
			"                     │       │   │           └─ Table\n" +
			"                     │       │   │               ├─ name: cast_info\n" +
			"                     │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: char_name\n" +
			"                     │       │               └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:11!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as character_name, min(t.title) as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2015))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Ang%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mc.note IS NULL)) AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as character_name, min(t.title) as movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2005) AND (t.production_year <= 2015))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Ang%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ ((NOT(mc.note IS NULL)) AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS alternative_name,
       MIN(chn.name) AS voiced_character,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS american_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note = '(voice)'
  AND cn.country_code ='[us]'
  AND mc.note LIKE '%(200%)%'
  AND (mc.note LIKE '%(USA)%'
       OR mc.note LIKE '%(worldwide)%')
  AND n.gender ='f'
  AND n.name LIKE '%Angel%'
  AND rt.role ='actress'
  AND t.production_year BETWEEN 2007 AND 2010
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND ci.movie_id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND n.id = ci.person_id
  AND chn.id = ci.person_role_id
  AND an.person_id = n.id
  AND an.person_id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as alternative_name, min(chn.name):1!null as voiced_character, min(n.name):2!null as voicing_actress, min(t.title):3!null as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:19!null), MIN(chn.name:17!null), MIN(n.name:6!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:12!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:8!null\n" +
			"         ├─ Filter\n" +
			"         │   ├─ AND\n" +
			"         │   │   ├─ GreaterThanOrEqual\n" +
			"         │   │   │   ├─ t.production_year:2\n" +
			"         │   │   │   └─ 2007 (smallint)\n" +
			"         │   │   └─ LessThanOrEqual\n" +
			"         │   │       ├─ t.production_year:2\n" +
			"         │   │       └─ 2010 (smallint)\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ ProcessTable\n" +
			"         │           └─ Table\n" +
			"         │               ├─ name: title\n" +
			"         │               └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:15!null\n" +
			"             │   └─ rt.id:3!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:5!null\n" +
			"                 │   │   └─ ci.person_id:11!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ an.person_id:18!null\n" +
			"                 │       └─ n.id:5!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%Angel%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:9!null\n" +
			"                     │   └─ cn.id:20!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:12!null\n" +
			"                     │   │   └─ mc.movie_id:8!null\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ AND\n" +
			"                     │   │   │   ├─ mc.note LIKE '%(200%)%'\n" +
			"                     │   │   │   └─ Or\n" +
			"                     │   │   │       ├─ mc.note LIKE '%(USA)%'\n" +
			"                     │   │   │       └─ mc.note LIKE '%(worldwide)%'\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ ProcessTable\n" +
			"                     │   │           └─ Table\n" +
			"                     │   │               ├─ name: movie_companies\n" +
			"                     │   │               └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ chn.id:16!null\n" +
			"                     │       │   │   └─ ci.person_role_id:13\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ Eq\n" +
			"                     │       │   │   │   ├─ ci.note:3\n" +
			"                     │       │   │   │   └─ (voice) (longtext)\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ ProcessTable\n" +
			"                     │       │   │           └─ Table\n" +
			"                     │       │   │               ├─ name: cast_info\n" +
			"                     │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: char_name\n" +
			"                     │       │               └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:11!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_character, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2007) AND (t.production_year <= 2010))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Angel%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ (mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note = '(voice)')\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_character, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ Filter\n" +
			"         │   ├─ ((t.production_year >= 2007) AND (t.production_year <= 2010))\n" +
			"         │   └─ TableAlias(t)\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title production_year]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%Angel%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ Filter\n" +
			"                     │   │   ├─ (mc.note LIKE '%(200%)%' AND (mc.note LIKE '%(USA)%' OR mc.note LIKE '%(worldwide)%'))\n" +
			"                     │   │   └─ TableAlias(mc)\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id note]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note = '(voice)')\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS alternative_name,
       MIN(chn.name) AS voiced_character_name,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS american_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND n.gender ='f'
  AND n.name LIKE '%An%'
  AND rt.role ='actress'
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND ci.movie_id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND n.id = ci.person_id
  AND chn.id = ci.person_role_id
  AND an.person_id = n.id
  AND an.person_id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as alternative_name, min(chn.name):1!null as voiced_character_name, min(n.name):2!null as voicing_actress, min(t.title):3!null as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:17!null), MIN(chn.name:15!null), MIN(n.name:5!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:13!null\n" +
			"             │   └─ rt.id:2!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:4!null\n" +
			"                 │   │   └─ ci.person_id:9!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ an.person_id:16!null\n" +
			"                 │       └─ n.id:4!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ AND\n" +
			"                 │   │   ├─ Eq\n" +
			"                 │   │   │   ├─ n.gender:2\n" +
			"                 │   │   │   └─ f (longtext)\n" +
			"                 │   │   └─ n.name LIKE '%An%'\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:8!null\n" +
			"                     │   └─ cn.id:18!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:10!null\n" +
			"                     │   │   └─ mc.movie_id:7!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ chn.id:14!null\n" +
			"                     │       │   │   └─ ci.person_role_id:11\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ HashIn\n" +
			"                     │       │   │   │   ├─ ci.note:3\n" +
			"                     │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ ProcessTable\n" +
			"                     │       │   │           └─ Table\n" +
			"                     │       │   │               ├─ name: cast_info\n" +
			"                     │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: char_name\n" +
			"                     │       │               └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:9!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_character_name, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_character_name, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ ((n.gender = 'f') AND n.name LIKE '%An%')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
	{
		Query: `
SELECT MIN(an.name) AS alternative_name,
       MIN(chn.name) AS voiced_char_name,
       MIN(n.name) AS voicing_actress,
       MIN(t.title) AS american_movie
FROM aka_name AS an,
     char_name AS chn,
     cast_info AS ci,
     company_name AS cn,
     movie_companies AS mc,
     name AS n,
     role_type AS rt,
     title AS t
WHERE ci.note IN ('(voice)',
                  '(voice: Japanese version)',
                  '(voice) (uncredited)',
                  '(voice: English version)')
  AND cn.country_code ='[us]'
  AND n.gender ='f'
  AND rt.role ='actress'
  AND ci.movie_id = t.id
  AND t.id = mc.movie_id
  AND ci.movie_id = mc.movie_id
  AND mc.company_id = cn.id
  AND ci.role_id = rt.id
  AND n.id = ci.person_id
  AND chn.id = ci.person_role_id
  AND an.person_id = n.id
  AND an.person_id = ci.person_id;

`,
		ExpectedPlan: "Project\n" +
			" ├─ columns: [min(an.name):0!null as alternative_name, min(chn.name):1!null as voiced_char_name, min(n.name):2!null as voicing_actress, min(t.title):3!null as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ select: MIN(an.name:17!null), MIN(chn.name:15!null), MIN(n.name:5!null), MIN(t.title:1!null)\n" +
			"     ├─ group: \n" +
			"     └─ InnerJoin\n" +
			"         ├─ AND\n" +
			"         │   ├─ Eq\n" +
			"         │   │   ├─ ci.movie_id:10!null\n" +
			"         │   │   └─ t.id:0!null\n" +
			"         │   └─ Eq\n" +
			"         │       ├─ t.id:0!null\n" +
			"         │       └─ mc.movie_id:7!null\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ ProcessTable\n" +
			"         │       └─ Table\n" +
			"         │           ├─ name: title\n" +
			"         │           └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ Eq\n" +
			"             │   ├─ ci.role_id:13!null\n" +
			"             │   └─ rt.id:2!null\n" +
			"             ├─ Filter\n" +
			"             │   ├─ Eq\n" +
			"             │   │   ├─ rt.role:1!null\n" +
			"             │   │   └─ actress (longtext)\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ ProcessTable\n" +
			"             │           └─ Table\n" +
			"             │               ├─ name: role_type\n" +
			"             │               └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ AND\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.id:4!null\n" +
			"                 │   │   └─ ci.person_id:9!null\n" +
			"                 │   └─ Eq\n" +
			"                 │       ├─ an.person_id:16!null\n" +
			"                 │       └─ n.id:4!null\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ Eq\n" +
			"                 │   │   ├─ n.gender:2\n" +
			"                 │   │   └─ f (longtext)\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ ProcessTable\n" +
			"                 │           └─ Table\n" +
			"                 │               ├─ name: name\n" +
			"                 │               └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ Eq\n" +
			"                     │   ├─ mc.company_id:8!null\n" +
			"                     │   └─ cn.id:18!null\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ Eq\n" +
			"                     │   │   ├─ ci.movie_id:10!null\n" +
			"                     │   │   └─ mc.movie_id:7!null\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ ProcessTable\n" +
			"                     │   │       └─ Table\n" +
			"                     │   │           ├─ name: movie_companies\n" +
			"                     │   │           └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ Eq\n" +
			"                     │       │   │   ├─ chn.id:14!null\n" +
			"                     │       │   │   └─ ci.person_role_id:11\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ HashIn\n" +
			"                     │       │   │   │   ├─ ci.note:3\n" +
			"                     │       │   │   │   └─ TUPLE((voice) (longtext), (voice: Japanese version) (longtext), (voice) (uncredited) (longtext), (voice: English version) (longtext))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ ProcessTable\n" +
			"                     │       │   │           └─ Table\n" +
			"                     │       │   │               ├─ name: cast_info\n" +
			"                     │       │   │               └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ ProcessTable\n" +
			"                     │       │           └─ Table\n" +
			"                     │       │               ├─ name: char_name\n" +
			"                     │       │               └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ keys: [ci.person_id:9!null]\n" +
			"                     │               ├─ colSet: (1-8)\n" +
			"                     │               ├─ tableId: 1\n" +
			"                     │               └─ Table\n" +
			"                     │                   ├─ name: aka_name\n" +
			"                     │                   └─ columns: [person_id name]\n" +
			"                     └─ Filter\n" +
			"                         ├─ Eq\n" +
			"                         │   ├─ cn.country_code:1\n" +
			"                         │   └─ [us] (longtext)\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ ProcessTable\n" +
			"                                 └─ Table\n" +
			"                                     ├─ name: company_name\n" +
			"                                     └─ columns: [id country_code]\n" +
			"",
		ExpectedEstimates: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_char_name, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.gender = 'f')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
		ExpectedAnalysis: "Project\n" +
			" ├─ columns: [min(an.name) as alternative_name, min(chn.name) as voiced_char_name, min(n.name) as voicing_actress, min(t.title) as american_movie]\n" +
			" └─ GroupBy\n" +
			"     ├─ SelectedExprs(MIN(an.name), MIN(chn.name), MIN(n.name), MIN(t.title))\n" +
			"     ├─ Grouping()\n" +
			"     └─ InnerJoin\n" +
			"         ├─ ((ci.movie_id = t.id) AND (t.id = mc.movie_id))\n" +
			"         ├─ TableAlias(t)\n" +
			"         │   └─ Table\n" +
			"         │       ├─ name: title\n" +
			"         │       └─ columns: [id title]\n" +
			"         └─ InnerJoin\n" +
			"             ├─ (ci.role_id = rt.id)\n" +
			"             ├─ Filter\n" +
			"             │   ├─ (rt.role = 'actress')\n" +
			"             │   └─ TableAlias(rt)\n" +
			"             │       └─ Table\n" +
			"             │           ├─ name: role_type\n" +
			"             │           └─ columns: [id role]\n" +
			"             └─ InnerJoin\n" +
			"                 ├─ ((n.id = ci.person_id) AND (an.person_id = n.id))\n" +
			"                 ├─ Filter\n" +
			"                 │   ├─ (n.gender = 'f')\n" +
			"                 │   └─ TableAlias(n)\n" +
			"                 │       └─ Table\n" +
			"                 │           ├─ name: name\n" +
			"                 │           └─ columns: [id name gender]\n" +
			"                 └─ InnerJoin\n" +
			"                     ├─ (mc.company_id = cn.id)\n" +
			"                     ├─ InnerJoin\n" +
			"                     │   ├─ (ci.movie_id = mc.movie_id)\n" +
			"                     │   ├─ TableAlias(mc)\n" +
			"                     │   │   └─ Table\n" +
			"                     │   │       ├─ name: movie_companies\n" +
			"                     │   │       └─ columns: [movie_id company_id]\n" +
			"                     │   └─ LookupJoin\n" +
			"                     │       ├─ InnerJoin\n" +
			"                     │       │   ├─ (chn.id = ci.person_role_id)\n" +
			"                     │       │   ├─ Filter\n" +
			"                     │       │   │   ├─ (ci.note HASH IN ('(voice)', '(voice: Japanese version)', '(voice) (uncredited)', '(voice: English version)'))\n" +
			"                     │       │   │   └─ TableAlias(ci)\n" +
			"                     │       │   │       └─ Table\n" +
			"                     │       │   │           ├─ name: cast_info\n" +
			"                     │       │   │           └─ columns: [person_id movie_id person_role_id note role_id]\n" +
			"                     │       │   └─ TableAlias(chn)\n" +
			"                     │       │       └─ Table\n" +
			"                     │       │           ├─ name: char_name\n" +
			"                     │       │           └─ columns: [id name]\n" +
			"                     │       └─ TableAlias(an)\n" +
			"                     │           └─ IndexedTableAccess(aka_name)\n" +
			"                     │               ├─ index: [aka_name.person_id]\n" +
			"                     │               ├─ columns: [person_id name]\n" +
			"                     │               └─ keys: ci.person_id\n" +
			"                     └─ Filter\n" +
			"                         ├─ (cn.country_code = '[us]')\n" +
			"                         └─ TableAlias(cn)\n" +
			"                             └─ Table\n" +
			"                                 ├─ name: company_name\n" +
			"                                 └─ columns: [id country_code]\n" +
			"",
	},
}
